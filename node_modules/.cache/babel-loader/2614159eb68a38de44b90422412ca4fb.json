{"ast":null,"code":"import _slicedToArray from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _defineProperty from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{connect}from'react-redux';import{injectIntl}from'react-intl';import{Row,Col}from'react-bootstrap';import{toast}from'react-toastify';import{process}from'@progress/kendo-data-query';import DataGrid from'../../components/data-grid/data-grid.component';import DateTimePicker from'../../components/date-time-picker/date-time-picker.component';import{ListWrapper}from'../../components/client-group.styles';import AddSampleCollection from'../storagemanagement//AddSampleCollection';import SlideOutModal from'../../components/slide-out-modal/SlideOutModal';import Esign from'../audittrail/Esign';import{SampleCycle,transactionStatus}from'../../components/Enumeration';import{DEFAULT_RETURN}from'../../actions/LoginTypes';import FormSelectSearch from'../../components/form-select-search/form-select-search.component';import{callService,crudMaster,updateStore,validateEsignCredential,getComboSampleCollection,getBarcodeDataCollection,saveCollection,getActiveSampleCollectionById,getSampleCollection,validateEsignCredentialSampleCollection}from'../../actions';import{sortData,getControlMap,getStartOfDay,getEndOfDay,convertDateValuetoString,rearrangeDateFormat,constructOptionList,Lims_JSON_stringify,formatInputDate,showEsign}from'../../components/CommonScript';var mapStateToProps=function mapStateToProps(state){return{Login:state.Login};};var SampleCollection=/*#__PURE__*/function(_React$Component){_inherits(SampleCollection,_React$Component);var _super=_createSuper(SampleCollection);function SampleCollection(props){var _this;_classCallCheck(this,SampleCollection);_this=_super.call(this,props);_this.closeModal=function(){var loadEsign=_this.props.Login.loadEsign;var openModal=_this.props.Login.openModal;var selectedRecord=_this.props.Login.selectedRecord;if(_this.props.Login.loadEsign){if(_this.props.Login.operation===\"delete\"){loadEsign=false;openModal=false;selectedRecord={};}else{loadEsign=false;selectedRecord['esignpassword']=\"\";selectedRecord['esignreason']=\"\";selectedRecord['esigncomments']=\"\";}}else{openModal=false;selectedRecord={};}var updateInfo={typeName:DEFAULT_RETURN,data:{openModal:openModal,loadEsign:loadEsign,selectedRecord:selectedRecord}};_this.props.updateStore(updateInfo);};_this.dataStateChange=function(event){_this.setState({dataResult:process(_this.state.data,event.dataState),dataState:event.dataState});};_this.validateEsign=function(){var inputParam={inputData:{\"userinfo\":_objectSpread(_objectSpread({},_this.props.Login.userInfo),{},{sreason:_this.state.selectedRecord[\"esigncomments\"],nreasoncode:_this.state.selectedRecord[\"esignreason\"]&&_this.state.selectedRecord[\"esignreason\"].value,spredefinedreason:_this.state.selectedRecord[\"esignreason\"]&&_this.state.selectedRecord[\"esignreason\"].label}),password:_this.state.selectedRecord[\"esignpassword\"]},screenData:_this.props.Login.screenData};if(_this.props.Login.operation==='update'){_this.props.validateEsignCredentialSampleCollection(inputParam,\"openModal\");}else{_this.props.validateEsignCredential(inputParam,\"openModal\");}};_this.deleteRecord=function(deleteParam){var _inputData;var obj=convertDateValuetoString(_this.props.Login.masterData.FromDate,_this.props.Login.masterData.ToDate,_this.props.Login.userInfo);var fromDate=obj.fromDate;var toDate=obj.toDate;var inputParam={classUrl:_this.props.Login.inputParam.classUrl,methodUrl:_this.props.Login.inputParam.methodUrl,displayName:_this.props.Login.inputParam.displayName,inputData:(_inputData={},_defineProperty(_inputData,_this.props.Login.inputParam.methodUrl.toLowerCase(),deleteParam.selectedRecord),_defineProperty(_inputData,\"userinfo\",_this.props.Login.userInfo),_defineProperty(_inputData,\"fromDate\",fromDate),_defineProperty(_inputData,\"toDate\",toDate),_defineProperty(_inputData,\"nprojecttypecode\",_this.props.Login.masterData.selectedProjectType.value||-1),_defineProperty(_inputData,\"nsamplecollectioncode\",deleteParam.selectedRecord['nsamplecollectioncode']),_inputData),operation:deleteParam.operation,dataState:_this.state.dataState};if(showEsign(_this.props.Login.userRoleControlRights,_this.props.Login.userInfo.nformcode,deleteParam.ncontrolCode)){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:_this.props.Login.masterData},openModal:true,screenName:_this.props.intl.formatMessage({id:_this.props.Login.inputParam.displayName}),operation:deleteParam.operation}};_this.props.updateStore(updateInfo);}else{_this.props.crudMaster(inputParam,_this.props.Login.masterData,\"openModal\");}};_this.onSaveClick=function(saveType,formRef){var selectedRecord=_this.state.selectedRecord||{};var sbarcodeid=_this.props.Login.masterData.barcodedata;if(selectedRecord[\"sbarcodeid\"]&&selectedRecord[\"sbarcodeid\"].length===parseInt(_this.props.Login.masterData.nbarcodelength&&_this.props.Login.masterData.nbarcodelength)){var invalidbarcode=selectedRecord[\"sbarcodeid\"].substring(1,2);if(parseInt(invalidbarcode)===SampleCycle.COLLECTION){if(sbarcodeid!=undefined&&sbarcodeid!=''){var inputData={};inputData[\"storagesamplecollection\"]={};if(_this.props.Login.operation===\"create\"){inputData[\"storagesamplecollection\"][\"nunitcode\"]=selectedRecord[\"nunitcode\"]?selectedRecord[\"nunitcode\"].value:-1;inputData[\"storagesamplecollection\"][\"nsampleqty\"]=selectedRecord[\"nsampleqty\"]?Number(selectedRecord[\"nsampleqty\"]):-1;inputData[\"storagesamplecollection\"][\"jsondata\"]=Lims_JSON_stringify(JSON.stringify(_this.props.Login.masterData.barcodedata));}inputData[\"storagesamplecollection\"][\"nprojecttypecode\"]=_this.props.Login.masterData.selectedProjectType.value||transactionStatus.NA;if(_this.props.Login.operation===\"update\"){inputData[\"storagesamplecollection\"][\"nsamplecollectioncode\"]=_this.props.Login.selectedId;}inputData[\"storagesamplecollection\"][\"sbarcodeid\"]=selectedRecord[\"sbarcodeid\"]?selectedRecord[\"sbarcodeid\"]:-1;inputData[\"storagesamplecollection\"][\"dcollectiondate\"]=formatInputDate(selectedRecord[\"dcollectiondate\"],false);inputData[\"storagesamplecollection\"][\"scomments\"]=selectedRecord[\"scomments\"]&&selectedRecord[\"scomments\"]||\"\";inputData[\"storagesamplecollection\"][\"ntzcollectiondatetime\"]=selectedRecord[\"ntzcollectiondatetime\"]&&selectedRecord[\"ntzcollectiondatetime\"].value||transactionStatus.NA;inputData[\"storagesamplecollection\"][\"noffsetdcollectiondatetime\"]=selectedRecord[\"noffsetdcollectiondatetime\"]&&selectedRecord[\"noffsetdcollectiondatetime\"].value||transactionStatus.NA;var obj=convertDateValuetoString(_this.props.Login.masterData.FromDate,_this.props.Login.masterData.ToDate,_this.props.Login.userInfo);var fromDate=obj.fromDate;var toDate=obj.toDate;inputData[\"fromDate\"]=fromDate;inputData[\"toDate\"]=toDate;inputData[\"nprojecttypecode\"]=_this.props.Login.masterData.selectedProjectType.value||transactionStatus.NA;inputData[\"userinfo\"]=_objectSpread(_objectSpread({},_this.props.Login.userInfo),{},{sformname:Lims_JSON_stringify(_this.props.Login.userInfo.sformname),smodulename:Lims_JSON_stringify(_this.props.Login.userInfo.smodulename)});var inputParam={nformcode:_this.props.Login.userInfo.nformcode,classUrl:\"storagesamplecollection\",methodUrl:\"SampleCollection\",inputData:inputData,operation:_this.props.Login.operation,saveType:saveType,formRef:formRef,selectedRecord:_this.state.selectedRecord||{}};var masterData=_this.props.Login.masterData;if(showEsign(_this.props.Login.userRoleControlRights,_this.props.Login.userInfo.nformcode,_this.props.Login.ncontrolcode)){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:masterData},saveType:saveType}};_this.props.updateStore(updateInfo);}else{_this.props.saveCollection(inputParam,masterData);}}else{toast.warn(_this.props.intl.formatMessage({id:\"IDS_CLICKENTERTOJSONRECORD\"}));}}else{toast.warn(_this.props.intl.formatMessage({id:\"IDS_INVALIDBARCODEID\"//ALPD-4498 Changed IDS to throw alert correctly by VISHAKH\n}));}}else{toast.warn(_this.props.intl.formatMessage({id:\"IDS_INVALIDABARCODE\"//ALPD-4498 Changed IDS to throw alert correctly by VISHAKH\n}));}};_this.onComboChange=function(comboData,fieldName){var selectedRecord=_this.state.selectedRecord||{};if(fieldName===\"nprojecttypecode\"){var inputData=[];var obj=convertDateValuetoString(_this.props.Login.masterData.FromDate,_this.props.Login.masterData.ToDate,_this.props.Login.userInfo);var fromDate=obj.fromDate;var toDate=obj.toDate;inputData[\"fromDate\"]=fromDate;inputData[\"toDate\"]=toDate;inputData={userinfo:_this.props.Login.userInfo,nprojecttypecode:parseInt(comboData.value),selectedProjectType:comboData,toDate:toDate,fromDate:fromDate};var masterData=_objectSpread({},_this.props.Login.masterData);var inputParam={masterData:masterData,inputData:inputData};_this.props.getSampleCollection(inputParam);}else{selectedRecord[fieldName]=comboData;_this.setState({selectedRecord:selectedRecord});}};_this.handleDateChangeSlidout=function(dateName,dateValue){var selectedRecord=_this.state.selectedRecord||{};selectedRecord[dateName]=dateValue;_this.setState({selectedRecord:selectedRecord});};_this.autoSaveGetDataCollection=function(event){var selectedRecord=_this.state.selectedRecord||{};/*  let nsamplecyclestartpostion=this.props.Login.masterData&&this.props.Login.masterData.samplecyclestartpostion || -1;\r\n        let samplecyclenfieldlength=this.props.Login.masterData&&this.props.Login.masterData.samplecyclenfieldlength || -1;*/event.stopPropagation();var invalidbarcode=event.target.value.substring(1,2);if(parseInt(selectedRecord[\"sbarcodeid\"]&&selectedRecord[\"sbarcodeid\"].length)===parseInt(_this.props.Login.masterData.nbarcodelength&&_this.props.Login.masterData.nbarcodelength)&&event.keyCode===13){if(parseInt(invalidbarcode)===SampleCycle.COLLECTION){var inputParam={nprojecttypecode:_this.props.Login.masterData.selectedProjectType.value,spositionvalue:event.target.value,userinfo:_this.props.Login.userInfo,nbarcodeLength:parseInt(_this.props.Login.masterData.nbarcodelength&&_this.props.Login.masterData.nbarcodelength),jsondata:{},masterData:_this.props.Login.masterData,selectedRecord:selectedRecord||{}};_this.props.getBarcodeDataCollection(inputParam);}else{toast.warn(_this.props.intl.formatMessage({id:\"IDS_INVALIDBARCODEID\"}));}}// else {\n//     toast.warn(\n//         this.props.intl.formatMessage({\n//             id: \"IDS_INVALIDBARCODELENGTH\",\n//         })\n//     );\n// }\n};_this.onInputOnChange=function(event,fieldname){var selectedRecord=_this.state.selectedRecord||{};if(fieldname==='nsampleqty'){if(/^\\d{0,3}(\\.\\d{0,2})?$/.test(event.target.value)||event.target.value===\"\"){selectedRecord[fieldname]=event.target.value;}}else if(event.target.type==='checkbox'){selectedRecord[event.target.name]=event.target.checked===true?transactionStatus.YES:transactionStatus.NO;}else{selectedRecord[event.target.name]=event.target.value;}_this.setState({selectedRecord:selectedRecord});};_this.handleDateChange=function(dateName,dateValue){var selectedRecord=_this.state.selectedRecord;if(dateValue===null){dateValue=new Date();}if(dateName==='todate'){selectedRecord[dateName]=dateValue;}else{selectedRecord[dateName]=dateValue;}selectedRecord[dateName]=dateValue;// this.setState({ selectedRecord });\n// this.reloadData(selectedRecord, true);\nvar dateObj={};var obj=convertDateValuetoString(selectedRecord['fromdate']&&selectedRecord['fromdate']||_this.props.Login.masterData.FromDate,selectedRecord['todate']&&selectedRecord['todate']||_this.props.Login.masterData.ToDate,_this.props.Login.userInfo);var fromDate=obj.fromDate;var toDate=obj.toDate;var inputParam={inputData:{\"userinfo\":_this.props.Login.userInfo,fromDate:fromDate,toDate:toDate,selectedProjectType:_this.props.Login.masterData.selectedProjectType,nprojecttypecode:_this.props.Login.masterData.selectedProjectType&&_this.props.Login.masterData.selectedProjectType.value||-1}};_this.props.getSampleCollection(inputParam);};_this.reloadData=function(){//this.searchRef.current.value = \"\";\nvar fromDate=_this.props.Login.masterData.FromDate;var toDate=_this.props.Login.masterData.ToDate;var obj=convertDateValuetoString(fromDate,toDate,_this.props.Login.userInfo,true);var inputParam={inputData:{\"userinfo\":_this.props.Login.userInfo,fromDate:obj.fromDate,toDate:obj.toDate,\"nprojecttypecode\":_this.props.Login.masterData.selectedProjectType.value||-1// currentdate: isDateChange === true ? null : formatInputDate(new Date(), true)\n},classUrl:'storagesamplecollection',methodUrl:\"SampleCollection\",displayName:\"IDS_SAMPLECOLLECTION\",userInfo:_this.props.Login.userInfo,selectedRecord:_this.state.selectedRecord||{}};_this.props.getSampleCollection(inputParam);};_this.searchRef=React.createRef();var dataState={skip:0,take:_this.props.Login.settings?parseInt(_this.props.Login.settings[14]):5};_this.state={data:[],masterStatus:\"\",error:\"\",selectedRecord:{},dataResult:[],dataState:dataState,userRoleControlRights:[],controlMap:new Map()};return _this;}_createClass(SampleCollection,[{key:\"gridfillingColumn\",value:function gridfillingColumn(data,barcodeFields){//  const tempArray = [];\nvar temparray1=[{idsName:'IDS_BARCODEID',dataField:'sbarcodeid',width:'250px',mandatoryLabel:'IDS_ENTER',controlType:'textinput'},{idsName:'IDS_SAMPLEQTY',dataField:'nsampleqty',width:'200px',mandatoryLabel:'IDS_ENTER',controlType:'textinput'},{idsName:'IDS_UNIT',dataField:'sunitname',width:'200px',mandatoryLabel:'IDS_SELECT',controlType:'selectbox'},{idsName:'IDS_SAMPLECOLLECTIONDATE',dataField:'scollectiondate',width:'200px'}];/*let temparray2 = []\r\n        barcodeFields&&barcodeFields.forEach(item=>{\r\n            data && data.forEach((item) => {\r\n                const entries = Object.entries(item.jsondata);\r\n                if (entries.length > 0) {\r\n                    entries.forEach(([key]) => {\r\n                        const keyExists = temparray2.some(column => column.idsName === key);\r\n                        if (!keyExists) {\r\n                            if(item.sfieldname===key){\r\n                                temparray2.push({\r\n                                    idsName: key,\r\n                                    dataField: key,\r\n                                    width: '250px'\r\n                                });\r\n                            }\r\n                           \r\n                        }\r\n    \r\n    \r\n                    });\r\n                }\r\n            });\r\n        });*/var temparray2=[];barcodeFields&&barcodeFields.forEach(function(barcodeItem){data&&data.forEach(function(dataItem){var entries=Object.entries(dataItem.jsondata);if(entries.length>0){entries.forEach(function(_ref){var _ref2=_slicedToArray(_ref,1),key=_ref2[0];var keyExists=temparray2.some(function(column){return column.idsName===key;});if(!keyExists){if(barcodeItem.sfieldname===key){temparray2.push({idsName:key,dataField:key,width:'250px'});}}});}});});var newArray=[].concat(temparray1,temparray2);newArray.push({idsName:'IDS_COMMENTS',dataField:'scomments',width:'250px'});return newArray;}},{key:\"render\",value:function render(){var _this2=this;var fromDate=\"\";var toDate=\"\";var extractedColumnList=this.gridfillingColumn(this.props.Login.masterData.SampleCollection&&this.props.Login.masterData.SampleCollection||[],this.props.Login.masterData.jsondataBarcodeFields&&this.props.Login.masterData.jsondataBarcodeFields);this.extractedColumnList=extractedColumnList;var addId=this.state.controlMap.has(\"AddStorageSampleCollection\")&&this.state.controlMap.get(\"AddStorageSampleCollection\").ncontrolcode;var editId=this.state.controlMap.has(\"EditStorageSampleCollection\")&&this.state.controlMap.get(\"EditStorageSampleCollection\").ncontrolcode;var deleteId=this.state.controlMap.has(\"DeleteStorageSampleCollection\")&&this.state.controlMap.get(\"DeleteStorageSampleCollection\").ncontrolcode;var editParam={screenName:this.props.Login.displayName,operation:\"update\",userInfo:this.props.Login.userInfo,ncontrolcode:editId,masterData:this.props.Login.masterData,inputParam:this.props.Login.inputParam,primaryKeyField:\"nsamplecollectioncode\",selectedRecord:this.state.selectedRecord||{},dataState:this.state.dataState};var addParam={screenName:this.props.Login.displayName,primaryKeyField:\"nsamplecollectioncode\",primaryKeyValue:undefined,operation:\"create\",inputParam:this.props.Login.inputParam,userInfo:this.props.Login.userInfo,ncontrolcode:addId,selectedRecord:this.state.selectedRecord,masterData:this.props.Login.masterData};//ALPD-4618--Vignesh R(01-08-2024)\nvar deleteParam={operation:\"delete\",ncontrolcode:deleteId,selectedRecord:this.state.selectedRecord};if(this.props.Login.masterData&&this.props.Login.masterData.FromDate){fromDate=this.state.selectedRecord[\"fromdate\"]&&getStartOfDay(this.state.selectedRecord[\"fromdate\"])||rearrangeDateFormat(this.props.Login.userInfo,this.props.Login.masterData.FromDate);toDate=this.state.selectedRecord[\"todate\"]&&getEndOfDay(this.state.selectedRecord[\"todate\"])||rearrangeDateFormat(this.props.Login.userInfo,this.props.Login.masterData.ToDate);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(ListWrapper,{className:\"client-list-content\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:2},/*#__PURE__*/React.createElement(DateTimePicker,{name:\"fromdate\",label:this.props.intl.formatMessage({id:\"IDS_FROM\"}),className:\"form-control\",placeholderText:\"Select date..\",selected:this.state.selectedRecord[\"fromdate\"]||fromDate,dateFormat:this.props.Login.userInfo.ssitedate,isClearable:false,onChange:function onChange(date){return _this2.handleDateChange(\"fromdate\",date);},value:this.state.selectedRecord[\"fromdate\"]||fromDate})),/*#__PURE__*/React.createElement(Col,{md:2},/*#__PURE__*/React.createElement(DateTimePicker,{name:\"todate\",label:this.props.intl.formatMessage({id:\"IDS_TO\"}),className:\"form-control\",placeholderText:\"Select date..\",selected:this.state.selectedRecord[\"todate\"]||toDate,dateFormat:this.props.Login.userInfo.ssitedate,isClearable:false,onChange:function onChange(date){return _this2.handleDateChange(\"todate\",date);},value:this.state.selectedRecord[\"todate\"]||toDate})),/*#__PURE__*/React.createElement(Col,{md:2},/*#__PURE__*/React.createElement(FormSelectSearch,{formLabel:this.props.intl.formatMessage({id:\"IDS_PROJECTTYPE\"}),isSearchable:true,name:\"nprojecttypecode\",isDisabled:false,placeholder:this.props.intl.formatMessage({id:\"IDS_SELECTRECORD\"}),isMandatory:true,isClearable:false,options:this.state.projectType,value:this.state.selectedRecord[\"nprojecttypecode\"]&&this.state.selectedRecord[\"nprojecttypecode\"]||this.props.Login.masterData.selectedProjectType,defaultValue:this.state.selectedRecord[\"nprojecttypecode\"],onChange:function onChange(event){return _this2.onComboChange(event,\"nprojecttypecode\");},closeMenuOnSelect:true})),\"    \"),this.state.data?/*#__PURE__*/React.createElement(DataGrid,{primaryKeyField:\"nsamplecollectioncode\",data:this.state.data,dataResult:this.state.dataResult,dataState:this.state.dataState,dataStateChange:this.dataStateChange,extractedColumnList:this.extractedColumnList,reloadData:this.reloadData,controlMap:this.state.controlMap,userRoleControlRights:this.state.userRoleControlRights,inputParam:this.props.Login.inputParam,userInfo:this.props.Login.userInfo,scrollable:\"scrollable\",pageable:true,isComponent:true,gridHeight:'600px',isToolBarRequired:true,isActionRequired:true,expandField:\"expanded\",selectedId:this.props.Login.selectedId,addRecord:function addRecord(){return _this2.props.getComboSampleCollection(addParam);},deleteParam:deleteParam,deleteRecord:this.deleteRecord,fetchRecord:this.props.getActiveSampleCollectionById,editParam:editParam//ATE234 Janakumar ALPD-5577 Sample Storage-->while download the pdf, screen getting freezed\n,isDownloadPDFRequired:false,isDownloadExcelRequired:true}):\"\"))),this.props.Login.openModal&&/*#__PURE__*/React.createElement(SlideOutModal,{show:this.props.Login.openModal,closeModal:this.closeModal,operation:this.props.Login.operation,inputParam:this.props.Login.inputParam,screenName:this.props.Login.screenName,onSaveClick:this.onSaveClick,size:'lg',esign:this.props.Login.loadEsign,validateEsign:this.validateEsign,masterStatus:this.props.Login.masterStatus,updateStore:this.props.updateStore,selectedRecord:this.state.selectedRecord||{},showSaveContinue:true,mandatoryFields:[{\"mandatory\":true,\"idsName\":\"IDS_BARCODEID\",\"dataField\":\"sbarcodeid\",\"width\":\"250px\",\"mandatoryLabel\":\"IDS_ENTER\",\"controlType\":\"textinput\"},{\"mandatory\":true,\"idsName\":\"IDS_SAMPLEQTY\",\"dataField\":\"nsampleqty\",\"width\":\"250px\",\"mandatoryLabel\":\"IDS_ENTER\",\"controlType\":\"textinput\"},{\"mandatory\":true,\"idsName\":\"IDS_UNIT\",\"dataField\":\"nunitcode\",\"width\":\"250px\",\"mandatoryLabel\":\"IDS_SELECT\",\"controlType\":\"selectbox\"}],addComponent:this.props.Login.loadEsign?/*#__PURE__*/React.createElement(Esign,{operation:this.props.Login.operation,formatMessage:this.props.intl.formatMessage,onInputOnChange:this.onInputOnChange,inputParam:this.props.Login.inputParam,selectedRecord:this.state.selectedRecord||{}}):/*#__PURE__*/React.createElement(AddSampleCollection,{autoSaveGetDataCollection:this.autoSaveGetDataCollection,barcodedata:this.props.Login.masterData.barcodedata,barcodeFields:this.props.Login.masterData.jsondataBarcodeFields,selectedRecord:this.state.selectedRecord||{},onInputOnChange:this.onInputOnChange,onComboChange:this.onComboChange,formatMessage:this.props.intl.formatMessage,operation:this.props.Login.operation,unit:this.props.Login.unit,userInfo:this.props.Login.userInfo,handleDateChangeSlidout:this.handleDateChangeSlidout,selectedProjectType:this.props.Login.masterData.selectedProjectType})}));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(previousProps){var projectType=this.state.projectType;var bool=false;if(this.props.Login.selectedRecord!==previousProps.Login.selectedRecord){this.setState({selectedRecord:this.props.Login.selectedRecord});}if(this.props.Login.masterData.projectType!==previousProps.Login.masterData.projectType){var projectTypeMap=constructOptionList(this.props.Login.masterData.projectType||[],\"nprojecttypecode\",\"sprojecttypename\",undefined,undefined,undefined);projectType=projectTypeMap.get(\"OptionList\");bool=true;}if(this.props.Login.masterData.selectedProjectType!==previousProps.Login.masterData.selectedProjectType){var _projectTypeMap=constructOptionList(this.props.Login.masterData.projectType||[],\"nprojecttypecode\",\"sprojecttypename\",undefined,undefined,undefined);projectType=_projectTypeMap.get(\"OptionList\");bool=true;}// if (this.props.Login.masterData.SampleCollection !== previousProps.Login.masterData.SampleCollection) {\n//     let samplecollect = [];\n//     samplecollect =\n//         this.props.Login.masterData.SampleCollection && this.props.Login.masterData.SampleCollection.map(sampleItem => {\n//             const entries = Object.entries(sampleItem.jsondata);\n//             if (entries.length > 0) {\n//                 const newItem = { ...sampleItem };\n//                 entries.forEach(([key, value]) => {\n//                     newItem[key] = value;\n//                 });\n//                 return newItem;\n//             }\n//             return sampleItem;\n//         });\n//     // let { dataState } = this.state;\n//     // if (dataState === undefined) {\n//     //     dataState = { skip: 0, take: this.state.dataState.take }\n//     // }\n//     // if (this.state.dataResult.data) {\n//     //     if (this.state.dataResult.data.length === 1) {\n//     //         let skipcount = this.state.dataState.skip > 0 ? (this.state.dataState.skip - this.state.dataState.take) :\n//     //             this.state.dataState.skip\n//     //         dataState = { skip: skipcount, take: this.state.dataState.take }\n//     //     }\n//     // }\n//     this.setState({\n//         data: samplecollect,\n//         dataResult: process(samplecollect || []),\n//     });\n// }\nif(this.props.Login.masterData!==previousProps.Login.masterData){var temporaryStorage=[];if(this.props.Login.userInfo.nformcode!==previousProps.Login.userInfo.nformcode){var userRoleControlRights=[];if(this.props.Login.userRoleControlRights){this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]&&Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(function(item){return userRoleControlRights.push(item.ncontrolcode);});}var controlMap=getControlMap(this.props.Login.userRoleControlRights,this.props.Login.userInfo.nformcode);temporaryStorage=this.props.Login.masterData.SampleCollection&&this.props.Login.masterData.SampleCollection.map(function(sampleItem){var entries=Object.entries(sampleItem.jsondata);if(entries.length>0){var newItem=_objectSpread({},sampleItem);entries.forEach(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];newItem[key]=value;});return newItem;}return sampleItem;});// let { dataState } = this.state;\n// if (dataState === undefined) {\n//     dataState = { skip: 0, take: this.state.dataState.take }\n// }\n// if (this.state.dataResult.data) {\n//     if (this.state.dataResult.data.length === 1) {\n//         let skipcount = this.state.dataState.skip > 0 ? (this.state.dataState.skip - this.state.dataState.take) :\n//             this.state.dataState.skip\n//         dataState = { skip: skipcount, take: this.state.dataState.take }\n//     }\n// }\nthis.setState({userRoleControlRights:userRoleControlRights,controlMap:controlMap,data:temporaryStorage,dataResult:process(temporaryStorage||[],this.state.dataState)});}else{//jana ALPD-4694 Temporary Storage-->While Try to Delete the Records the Fields are Align Wrongly\nvar samplecollect=[];samplecollect=this.props.Login.masterData.SampleCollection&&this.props.Login.masterData.SampleCollection.map(function(sampleItem){var entries=Object.entries(sampleItem.jsondata);if(entries.length>0){var newItem=_objectSpread({},sampleItem);entries.forEach(function(_ref5){var _ref6=_slicedToArray(_ref5,2),key=_ref6[0],value=_ref6[1];newItem[key]=value;});return newItem;}return sampleItem;});var dataState=this.state.dataState;if(this.props.Login.dataState===undefined||this.props.Login.masterData.selectedProjectType!==previousProps.Login.masterData.selectedProjectType){dataState={skip:0,take:this.state.dataState.take};}if(this.state.dataResult.data){if(this.state.dataResult.data.length===1){var skipcount=this.state.dataState.skip>0?this.state.dataState.skip-this.state.dataState.take:this.state.dataState.skip;dataState={skip:skipcount,take:this.state.dataState.take};}}this.setState({data:samplecollect,selectedRecord:this.props.Login.selectedRecord,dataResult:process(samplecollect||[],dataState),dataState:dataState});}/*  else {\r\n                  if (this.props.Login.masterData.SampleCollection) {\r\n                      let samplecollect = [];\r\n                      samplecollect =\r\n                          this.props.Login.masterData.SampleCollection && this.props.Login.masterData.SampleCollection.map(sampleItem => {\r\n                              const entries = Object.entries(sampleItem.jsondata);\r\n                              if (entries.length > 0) {\r\n                                  const newItem = { ...sampleItem };\r\n                                  entries.forEach(([key, value]) => {\r\n  \r\n                                      newItem[key] = value;\r\n  \r\n                                  });\r\n                                  return newItem;\r\n                              }\r\n                              return sampleItem;\r\n                          });\r\n  \r\n                      this.setState({\r\n                          data: samplecollect,\r\n                          dataState: { skip: 0, take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5 },\r\n                          dataResult: process(samplecollect || [], { skip: 0, take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5 }),\r\n                      });\r\n                  }\r\n              }*/}else if(this.props.Login.selectedRecord!==previousProps.Login.selectedRecord){this.setState({selectedRecord:this.props.Login.selectedRecord});}if(this.props.Login.masterData.jsondataBarcodeFields!==previousProps.Login.masterData.jsondataBarcodeFields){var retrievedData=sortData(this.props.Login.masterData.jsondataBarcodeFields,\"ascending\",\"nsorter\");this.setState({jsondataBarcodeFields:retrievedData});}if(bool){this.setState({projectType:projectType});}}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){if(props.Login.masterStatus!==\"\"&&props.Login.masterStatus!==state.masterStatus){toast.warn(props.Login.masterStatus);props.Login.masterStatus=\"\";}if(props.Login.error!==state.error){toast.error(props.Login.error);props.Login.error=\"\";}return null;}}]);return SampleCollection;}(React.Component);export default connect(mapStateToProps,{callService:callService,crudMaster:crudMaster,updateStore:updateStore,validateEsignCredential:validateEsignCredential,getComboSampleCollection:getComboSampleCollection,getBarcodeDataCollection:getBarcodeDataCollection,saveCollection:saveCollection,getActiveSampleCollectionById:getActiveSampleCollectionById,getSampleCollection:getSampleCollection,validateEsignCredentialSampleCollection:validateEsignCredentialSampleCollection})(injectIntl(SampleCollection));","map":{"version":3,"sources":["E:/WorkingFolder/React_Postgres/ALPD/branches/SOURCE-513-PROD/SOURCE-513-ALPD-5500/QuaLISWeb/src/pages/storagemanagement/SampleCollection.jsx"],"names":["React","connect","injectIntl","Row","Col","toast","process","DataGrid","DateTimePicker","ListWrapper","AddSampleCollection","SlideOutModal","Esign","SampleCycle","transactionStatus","DEFAULT_RETURN","FormSelectSearch","callService","crudMaster","updateStore","validateEsignCredential","getComboSampleCollection","getBarcodeDataCollection","saveCollection","getActiveSampleCollectionById","getSampleCollection","validateEsignCredentialSampleCollection","sortData","getControlMap","getStartOfDay","getEndOfDay","convertDateValuetoString","rearrangeDateFormat","constructOptionList","Lims_JSON_stringify","formatInputDate","showEsign","mapStateToProps","state","Login","SampleCollection","props","closeModal","loadEsign","openModal","selectedRecord","operation","updateInfo","typeName","data","dataStateChange","event","setState","dataResult","dataState","validateEsign","inputParam","inputData","userInfo","sreason","nreasoncode","value","spredefinedreason","label","password","screenData","deleteRecord","deleteParam","obj","masterData","FromDate","ToDate","fromDate","toDate","classUrl","methodUrl","displayName","toLowerCase","selectedProjectType","userRoleControlRights","nformcode","ncontrolCode","screenName","intl","formatMessage","id","onSaveClick","saveType","formRef","sbarcodeid","barcodedata","length","parseInt","nbarcodelength","invalidbarcode","substring","COLLECTION","undefined","Number","JSON","stringify","NA","selectedId","sformname","smodulename","ncontrolcode","warn","onComboChange","comboData","fieldName","userinfo","nprojecttypecode","handleDateChangeSlidout","dateName","dateValue","autoSaveGetDataCollection","stopPropagation","target","keyCode","spositionvalue","nbarcodeLength","jsondata","onInputOnChange","fieldname","test","type","name","checked","YES","NO","handleDateChange","Date","dateObj","reloadData","searchRef","createRef","skip","take","settings","masterStatus","error","controlMap","Map","barcodeFields","temparray1","idsName","dataField","width","mandatoryLabel","controlType","temparray2","forEach","barcodeItem","dataItem","entries","Object","key","keyExists","some","column","sfieldname","push","newArray","extractedColumnList","gridfillingColumn","jsondataBarcodeFields","addId","has","get","editId","deleteId","editParam","primaryKeyField","addParam","primaryKeyValue","ssitedate","date","projectType","unit","previousProps","bool","projectTypeMap","temporaryStorage","values","map","item","sampleItem","newItem","samplecollect","skipcount","retrievedData","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { injectIntl } from 'react-intl';\r\nimport { Row, Col } from 'react-bootstrap';\r\nimport { toast } from 'react-toastify';\r\nimport { process } from '@progress/kendo-data-query';\r\nimport DataGrid from '../../components/data-grid/data-grid.component';\r\nimport DateTimePicker from '../../components/date-time-picker/date-time-picker.component';\r\nimport { ListWrapper } from '../../components/client-group.styles';\r\nimport AddSampleCollection from '../storagemanagement//AddSampleCollection';\r\nimport SlideOutModal from '../../components/slide-out-modal/SlideOutModal';\r\nimport Esign from '../audittrail/Esign';\r\nimport { SampleCycle,transactionStatus } from '../../components/Enumeration';\r\nimport { DEFAULT_RETURN } from '../../actions/LoginTypes';\r\nimport FormSelectSearch from '../../components/form-select-search/form-select-search.component';\r\n\r\nimport {\r\n    callService, crudMaster,\r\n    updateStore, validateEsignCredential, getComboSampleCollection, getBarcodeDataCollection, saveCollection, getActiveSampleCollectionById, getSampleCollection, validateEsignCredentialSampleCollection\r\n} from '../../actions';\r\nimport { sortData,getControlMap, getStartOfDay, getEndOfDay, convertDateValuetoString, rearrangeDateFormat, constructOptionList, Lims_JSON_stringify, formatInputDate, showEsign } from '../../components/CommonScript'\r\n\r\n\r\nconst mapStateToProps = state => {\r\n    return ({ Login: state.Login })\r\n}\r\n\r\nclass SampleCollection extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.searchRef = React.createRef();\r\n\r\n        const dataState = {\r\n            skip: 0,\r\n            take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5,\r\n        };\r\n        this.state = {\r\n            data: [], masterStatus: \"\", error: \"\", selectedRecord: {},\r\n            dataResult: [],\r\n            dataState: dataState,\r\n            userRoleControlRights: [],\r\n            controlMap: new Map(),\r\n        };\r\n\r\n\r\n\r\n    }\r\n    closeModal = () => {\r\n        let loadEsign = this.props.Login.loadEsign;\r\n        let openModal = this.props.Login.openModal;\r\n        let selectedRecord = this.props.Login.selectedRecord;\r\n        if (this.props.Login.loadEsign) {\r\n            if (this.props.Login.operation === \"delete\") {\r\n                loadEsign = false;\r\n                openModal = false;\r\n                selectedRecord = {};\r\n            }\r\n            else {\r\n                loadEsign = false;\r\n                selectedRecord['esignpassword'] = \"\"\r\n                selectedRecord['esignreason'] = \"\"\r\n                selectedRecord['esigncomments'] = \"\"\r\n            }\r\n        }\r\n        else {\r\n            openModal = false;\r\n            selectedRecord = {};\r\n        }\r\n\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: { openModal, loadEsign, selectedRecord }\r\n        }\r\n\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n\r\n\r\n    dataStateChange = (event) => {\r\n        this.setState({\r\n            dataResult: process(this.state.data, event.dataState),\r\n            dataState: event.dataState\r\n        });\r\n    }\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n\r\n        if (props.Login.masterStatus !== \"\" && props.Login.masterStatus !== state.masterStatus) {\r\n            toast.warn(props.Login.masterStatus);\r\n            props.Login.masterStatus = \"\";\r\n        }\r\n\r\n        if (props.Login.error !== state.error) {\r\n            toast.error(props.Login.error)\r\n            props.Login.error = \"\";\r\n        }\r\n        return null;\r\n    }\r\n\r\n    gridfillingColumn(data, barcodeFields) {\r\n        //  const tempArray = [];\r\n        const temparray1 = [{ idsName: 'IDS_BARCODEID', dataField: 'sbarcodeid', width: '250px', mandatoryLabel: 'IDS_ENTER', controlType: 'textinput' },\r\n        { idsName: 'IDS_SAMPLEQTY', dataField: 'nsampleqty', width: '200px', mandatoryLabel: 'IDS_ENTER', controlType: 'textinput' },\r\n        { idsName: 'IDS_UNIT', dataField: 'sunitname', width: '200px', mandatoryLabel: 'IDS_SELECT', controlType: 'selectbox' },\r\n        { idsName: 'IDS_SAMPLECOLLECTIONDATE', dataField: 'scollectiondate', width: '200px' }\r\n        ];\r\n        /*let temparray2 = []\r\n        barcodeFields&&barcodeFields.forEach(item=>{\r\n            data && data.forEach((item) => {\r\n                const entries = Object.entries(item.jsondata);\r\n                if (entries.length > 0) {\r\n                    entries.forEach(([key]) => {\r\n                        const keyExists = temparray2.some(column => column.idsName === key);\r\n                        if (!keyExists) {\r\n                            if(item.sfieldname===key){\r\n                                temparray2.push({\r\n                                    idsName: key,\r\n                                    dataField: key,\r\n                                    width: '250px'\r\n                                });\r\n                            }\r\n                           \r\n                        }\r\n    \r\n    \r\n                    });\r\n                }\r\n            });\r\n        });*/\r\n\r\n        let temparray2 = [];\r\n        barcodeFields && barcodeFields.forEach(barcodeItem => {\r\n            data && data.forEach(dataItem => {\r\n                const entries = Object.entries(dataItem.jsondata);\r\n                if (entries.length > 0) {\r\n                    entries.forEach(([key]) => {\r\n                        const keyExists = temparray2.some(column => column.idsName === key);\r\n                        if (!keyExists) {\r\n                            if (barcodeItem.sfieldname === key) {\r\n                                temparray2.push({\r\n                                    idsName: key,\r\n                                    dataField: key,\r\n                                    width: '250px'\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        const newArray = [...temparray1, ...temparray2]\r\n        newArray.push({ idsName: 'IDS_COMMENTS', dataField: 'scomments', width: '250px' })\r\n        return newArray;\r\n    }\r\n\r\n\r\n    validateEsign = () => {\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": {\r\n                    ...this.props.Login.userInfo,\r\n                    sreason: this.state.selectedRecord[\"esigncomments\"],\r\n                    nreasoncode: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\r\n                    spredefinedreason: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label,\r\n\r\n                },\r\n                password: this.state.selectedRecord[\"esignpassword\"]\r\n            },\r\n            screenData: this.props.Login.screenData\r\n        }\r\n\r\n        if (this.props.Login.operation === 'update') {\r\n            this.props.validateEsignCredentialSampleCollection(inputParam, \"openModal\");\r\n        } else {\r\n            this.props.validateEsignCredential(inputParam, \"openModal\");\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        let fromDate = \"\";\r\n        let toDate = \"\";\r\n        const extractedColumnList = this.gridfillingColumn(this.props.Login.masterData.SampleCollection && this.props.Login.masterData.SampleCollection \r\n            || [], this.props.Login.masterData.jsondataBarcodeFields && this.props.Login.masterData.jsondataBarcodeFields);\r\n        this.extractedColumnList = extractedColumnList;\r\n\r\n\r\n        const addId = this.state.controlMap.has(\"AddStorageSampleCollection\") && this.state.controlMap.get(\"AddStorageSampleCollection\").ncontrolcode;\r\n        const editId = this.state.controlMap.has(\"EditStorageSampleCollection\") && this.state.controlMap.get(\"EditStorageSampleCollection\").ncontrolcode;\r\n        const deleteId = this.state.controlMap.has(\"DeleteStorageSampleCollection\") && this.state.controlMap.get(\"DeleteStorageSampleCollection\").ncontrolcode;\r\n\r\n        const editParam = {\r\n            screenName: this.props.Login.displayName,\r\n            operation: \"update\",\r\n            userInfo: this.props.Login.userInfo,\r\n            ncontrolcode: editId,\r\n            masterData: this.props.Login.masterData,\r\n            inputParam: this.props.Login.inputParam,\r\n            primaryKeyField: \"nsamplecollectioncode\",\r\n            selectedRecord: this.state.selectedRecord || {},\r\n            dataState:this.state.dataState\r\n\r\n\r\n        };\r\n        const addParam = {\r\n            screenName: this.props.Login.displayName, primaryKeyField: \"nsamplecollectioncode\", primaryKeyValue: undefined,\r\n            operation: \"create\", inputParam: this.props.Login.inputParam, userInfo: this.props.Login.userInfo, ncontrolcode: addId,\r\n            selectedRecord: this.state.selectedRecord,\r\n            masterData: this.props.Login.masterData\r\n        };\r\n//ALPD-4618--Vignesh R(01-08-2024)\r\n        const deleteParam = { operation: \"delete\",ncontrolcode:deleteId,  selectedRecord: this.state.selectedRecord };\r\n\r\n        if (this.props.Login.masterData && this.props.Login.masterData.FromDate) {\r\n            fromDate = (this.state.selectedRecord[\"fromdate\"] && getStartOfDay(this.state.selectedRecord[\"fromdate\"])) || rearrangeDateFormat(this.props.Login.userInfo, this.props.Login.masterData.FromDate);\r\n            toDate = (this.state.selectedRecord[\"todate\"] && getEndOfDay(this.state.selectedRecord[\"todate\"])) || rearrangeDateFormat(this.props.Login.userInfo, this.props.Login.masterData.ToDate);\r\n        }\r\n        return (\r\n            <>\r\n                {/* <Preloader loadng={this.props.Login.loading}/> */}\r\n                <Row>\r\n                    <Col>\r\n                        <ListWrapper className=\"client-list-content\">\r\n                            <Row>\r\n                                <Col md={2}>\r\n                                    <DateTimePicker\r\n                                        name={\"fromdate\"}\r\n                                        label={this.props.intl.formatMessage({ id: \"IDS_FROM\" })}\r\n                                        className='form-control'\r\n                                        placeholderText=\"Select date..\"\r\n                                        selected={this.state.selectedRecord[\"fromdate\"] || fromDate}\r\n                                        dateFormat={this.props.Login.userInfo.ssitedate}\r\n                                        isClearable={false}\r\n                                        onChange={date => this.handleDateChange(\"fromdate\", date)}\r\n                                        value={this.state.selectedRecord[\"fromdate\"] || fromDate}\r\n\r\n                                    />\r\n                                </Col>\r\n                                <Col md={2}>\r\n                                    <DateTimePicker\r\n                                        name={\"todate\"}\r\n                                        label={this.props.intl.formatMessage({ id: \"IDS_TO\" })}\r\n                                        className='form-control'\r\n                                        placeholderText=\"Select date..\"\r\n                                        selected={this.state.selectedRecord[\"todate\"] || toDate}\r\n                                        dateFormat={this.props.Login.userInfo.ssitedate}\r\n                                        isClearable={false}\r\n                                        onChange={date => this.handleDateChange(\"todate\", date)}\r\n                                        value={this.state.selectedRecord[\"todate\"] || toDate}\r\n\r\n                                    />\r\n                                </Col>\r\n                                <Col md={2}>\r\n                                    <FormSelectSearch\r\n                                        formLabel={this.props.intl.formatMessage({ id: \"IDS_PROJECTTYPE\" })}\r\n                                        isSearchable={true}\r\n                                        name={\"nprojecttypecode\"}\r\n                                        isDisabled={false}\r\n                                        placeholder={this.props.intl.formatMessage({ id: \"IDS_SELECTRECORD\" })}\r\n                                        isMandatory={true}\r\n                                        isClearable={false}\r\n                                        options={this.state.projectType}\r\n                                        value={this.state.selectedRecord[\"nprojecttypecode\"] && this.state.selectedRecord[\"nprojecttypecode\"] || this.props.Login.masterData.selectedProjectType}\r\n                                        defaultValue={this.state.selectedRecord[\"nprojecttypecode\"]}\r\n                                        onChange={(event) => this.onComboChange(event, \"nprojecttypecode\")}\r\n                                        closeMenuOnSelect={true}\r\n                                    >\r\n                                    </FormSelectSearch>\r\n                                </Col>    {/* <Col></Col> */}\r\n                            </Row>\r\n\r\n                            {this.state.data ?\r\n                                <DataGrid\r\n                                    primaryKeyField={\"nsamplecollectioncode\"}\r\n                                    data={this.state.data}\r\n                                    dataResult={this.state.dataResult}\r\n                                    dataState={this.state.dataState}\r\n                                    dataStateChange={this.dataStateChange}\r\n                                    extractedColumnList={this.extractedColumnList}\r\n                                    reloadData={this.reloadData}\r\n                                    controlMap={this.state.controlMap}\r\n                                    userRoleControlRights={this.state.userRoleControlRights}\r\n                                    inputParam={this.props.Login.inputParam}\r\n                                    userInfo={this.props.Login.userInfo}\r\n                                    scrollable={\"scrollable\"}\r\n                                    pageable={true}\r\n                                    isComponent={true}\r\n                                    gridHeight={'600px'}\r\n                                    isToolBarRequired={true}\r\n                                    isActionRequired={true}\r\n                                    expandField=\"expanded\"\r\n                                    selectedId={this.props.Login.selectedId}\r\n                                    addRecord={() => this.props.getComboSampleCollection(addParam)}\r\n                                    deleteParam={deleteParam}\r\n                                    deleteRecord={this.deleteRecord}\r\n                                    fetchRecord={this.props.getActiveSampleCollectionById}\r\n                                    editParam={editParam}\r\n                                    //ATE234 Janakumar ALPD-5577 Sample Storage-->while download the pdf, screen getting freezed\r\n                                    isDownloadPDFRequired={false}\r\n                                    isDownloadExcelRequired={true}\r\n                                />\r\n                                : \"\"}\r\n                        </ListWrapper>\r\n                    </Col>\r\n                </Row>\r\n\r\n                {this.props.Login.openModal &&\r\n                    <SlideOutModal show={this.props.Login.openModal}\r\n                        closeModal={this.closeModal}\r\n                        operation={this.props.Login.operation}\r\n                        inputParam={this.props.Login.inputParam}\r\n                        screenName={this.props.Login.screenName}\r\n                        onSaveClick={this.onSaveClick}\r\n                        size={'lg'}\r\n                        esign={this.props.Login.loadEsign}\r\n                        validateEsign={this.validateEsign}\r\n                        masterStatus={this.props.Login.masterStatus}\r\n                        updateStore={this.props.updateStore}\r\n                        selectedRecord={this.state.selectedRecord || {}}\r\n                        showSaveContinue={true}\r\n                        mandatoryFields={[\r\n                            { \"mandatory\": true, \"idsName\": \"IDS_BARCODEID\", \"dataField\": \"sbarcodeid\", \"width\": \"250px\", \"mandatoryLabel\": \"IDS_ENTER\", \"controlType\": \"textinput\" },\r\n                            { \"mandatory\": true, \"idsName\": \"IDS_SAMPLEQTY\", \"dataField\": \"nsampleqty\", \"width\": \"250px\", \"mandatoryLabel\": \"IDS_ENTER\", \"controlType\": \"textinput\" },\r\n                            { \"mandatory\": true, \"idsName\": \"IDS_UNIT\", \"dataField\": \"nunitcode\", \"width\": \"250px\", \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }]}\r\n\r\n                        addComponent={this.props.Login.loadEsign ?\r\n                            <Esign\r\n                                operation={this.props.Login.operation}\r\n                                formatMessage={this.props.intl.formatMessage}\r\n                                onInputOnChange={this.onInputOnChange}\r\n                                inputParam={this.props.Login.inputParam}\r\n                                selectedRecord={this.state.selectedRecord || {}}\r\n                            />\r\n                            : <AddSampleCollection\r\n                                autoSaveGetDataCollection={this.autoSaveGetDataCollection}\r\n                                barcodedata={this.props.Login.masterData.barcodedata}\r\n                                barcodeFields={this.props.Login.masterData.jsondataBarcodeFields}\r\n                                selectedRecord={this.state.selectedRecord || {}}\r\n                                onInputOnChange={this.onInputOnChange}\r\n                                onComboChange={this.onComboChange}\r\n                                formatMessage={this.props.intl.formatMessage}\r\n                                operation={this.props.Login.operation}\r\n                                unit={this.props.Login.unit}\r\n                                userInfo={this.props.Login.userInfo}\r\n                                handleDateChangeSlidout={this.handleDateChangeSlidout}\r\n                                selectedProjectType={this.props.Login.masterData.selectedProjectType}\r\n\r\n                            />}\r\n                    />\r\n                }\r\n            </>\r\n        );\r\n    }\r\n    deleteRecord = (deleteParam) => {\r\n        let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n        let fromDate = obj.fromDate;\r\n        let toDate = obj.toDate;\r\n        const inputParam = {\r\n            classUrl: this.props.Login.inputParam.classUrl,\r\n            methodUrl: this.props.Login.inputParam.methodUrl,\r\n            displayName: this.props.Login.inputParam.displayName,\r\n            inputData: {\r\n                [this.props.Login.inputParam.methodUrl.toLowerCase()]: deleteParam.selectedRecord,\r\n                \"userinfo\": this.props.Login.userInfo,\r\n\r\n                \"fromDate\": fromDate,\r\n                \"toDate\": toDate,\r\n                \"nprojecttypecode\": this.props.Login.masterData.selectedProjectType.value || -1,\r\n                \"nsamplecollectioncode\": deleteParam.selectedRecord['nsamplecollectioncode']\r\n\r\n            },\r\n            operation: deleteParam.operation,\r\n            dataState: this.state.dataState\r\n        }\r\n\r\n        if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, deleteParam.ncontrolCode)) {\r\n            const updateInfo = {\r\n                typeName: DEFAULT_RETURN,\r\n                data: {\r\n                    loadEsign: true, screenData: { inputParam, masterData: this.props.Login.masterData },\r\n                    openModal: true, screenName: this.props.intl.formatMessage({ id: this.props.Login.inputParam.displayName }),\r\n                    operation: deleteParam.operation\r\n                }\r\n            }\r\n            this.props.updateStore(updateInfo);\r\n        }\r\n        else {\r\n            this.props.crudMaster(inputParam, this.props.Login.masterData, \"openModal\");\r\n        }\r\n    }\r\n    onSaveClick = (saveType, formRef) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        const sbarcodeid = this.props.Login.masterData.barcodedata;\r\n        if (selectedRecord[\"sbarcodeid\"] && selectedRecord[\"sbarcodeid\"].length === parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength)) {\r\n\r\n            let invalidbarcode = selectedRecord[\"sbarcodeid\"].substring(1, 2);\r\n            if (parseInt(invalidbarcode) === SampleCycle.COLLECTION) {\r\n\r\n                if (sbarcodeid != undefined && sbarcodeid != '') {\r\n\r\n                    let inputData = {};\r\n                    inputData[\"storagesamplecollection\"] = {};\r\n                    if (this.props.Login.operation === \"create\") {\r\n\r\n                        inputData[\"storagesamplecollection\"][\"nunitcode\"] = selectedRecord[\"nunitcode\"] ? selectedRecord[\"nunitcode\"].value : -1;\r\n                        inputData[\"storagesamplecollection\"][\"nsampleqty\"] = selectedRecord[\"nsampleqty\"] ? Number(selectedRecord[\"nsampleqty\"]) : -1;\r\n                        inputData[\"storagesamplecollection\"][\"jsondata\"] = Lims_JSON_stringify(JSON.stringify(this.props.Login.masterData.barcodedata));\r\n                    }\r\n                    inputData[\"storagesamplecollection\"][\"nprojecttypecode\"] = this.props.Login.masterData.selectedProjectType.value || transactionStatus.NA;\r\n                    if (this.props.Login.operation === \"update\") {\r\n                        inputData[\"storagesamplecollection\"][\"nsamplecollectioncode\"] = this.props.Login.selectedId;\r\n                    }\r\n                    inputData[\"storagesamplecollection\"][\"sbarcodeid\"] = selectedRecord[\"sbarcodeid\"] ? selectedRecord[\"sbarcodeid\"] : -1;\r\n\r\n                    inputData[\"storagesamplecollection\"][\"dcollectiondate\"] = formatInputDate(selectedRecord[\"dcollectiondate\"], false);\r\n                    inputData[\"storagesamplecollection\"][\"scomments\"] = selectedRecord[\"scomments\"] && selectedRecord[\"scomments\"] || \"\";\r\n                    inputData[\"storagesamplecollection\"][\"ntzcollectiondatetime\"] = selectedRecord[\"ntzcollectiondatetime\"] && selectedRecord[\"ntzcollectiondatetime\"].value || transactionStatus.NA\r\n                    inputData[\"storagesamplecollection\"][\"noffsetdcollectiondatetime\"] = selectedRecord[\"noffsetdcollectiondatetime\"] && selectedRecord[\"noffsetdcollectiondatetime\"].value || transactionStatus.NA\r\n                    let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n                    let fromDate = obj.fromDate;\r\n                    let toDate = obj.toDate;\r\n                    inputData[\"fromDate\"] = fromDate;\r\n                    inputData[\"toDate\"] = toDate;\r\n                    inputData[\"nprojecttypecode\"] = this.props.Login.masterData.selectedProjectType.value || transactionStatus.NA;\r\n                    inputData[\"userinfo\"] = {\r\n                        ...this.props.Login.userInfo,\r\n                        sformname: Lims_JSON_stringify(this.props.Login.userInfo.sformname),\r\n                        smodulename: Lims_JSON_stringify(this.props.Login.userInfo.smodulename)\r\n                    }\r\n\r\n\r\n\r\n                    const inputParam = {\r\n                        nformcode: this.props.Login.userInfo.nformcode,\r\n                        classUrl: \"storagesamplecollection\",\r\n                        methodUrl: \"SampleCollection\",\r\n                        inputData: inputData,\r\n                        operation: this.props.Login.operation,\r\n                        saveType, formRef,\r\n                        selectedRecord: this.state.selectedRecord || {}\r\n                    }\r\n\r\n                    const masterData = this.props.Login.masterData;\r\n\r\n                    if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolcode)) {\r\n                        const updateInfo = {\r\n                            typeName: DEFAULT_RETURN,\r\n                            data: {\r\n                                loadEsign: true, screenData: { inputParam, masterData }, saveType\r\n                            }\r\n                        }\r\n                        this.props.updateStore(updateInfo);\r\n                    }\r\n                    else {\r\n                        this.props.saveCollection(inputParam, masterData);\r\n                    }\r\n                } else {\r\n                    toast.warn(\r\n                        this.props.intl.formatMessage({\r\n                            id: \"IDS_CLICKENTERTOJSONRECORD\",\r\n                        })\r\n                    );\r\n                }\r\n\r\n            } else {\r\n                toast.warn(\r\n                    this.props.intl.formatMessage({\r\n                        id: \"IDS_INVALIDBARCODEID\", //ALPD-4498 Changed IDS to throw alert correctly by VISHAKH\r\n                    })\r\n                );\r\n            }\r\n        } else {\r\n            toast.warn(\r\n                this.props.intl.formatMessage({\r\n                    id: \"IDS_INVALIDABARCODE\",  //ALPD-4498 Changed IDS to throw alert correctly by VISHAKH\r\n                })\r\n            );\r\n        }\r\n\r\n    }\r\n\r\n    onComboChange = (comboData, fieldName) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n\r\n        if (fieldName === \"nprojecttypecode\") {\r\n            let inputData = [];\r\n            let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n            let fromDate = obj.fromDate;\r\n            let toDate = obj.toDate;\r\n            inputData[\"fromDate\"] = fromDate;\r\n            inputData[\"toDate\"] = toDate;\r\n            inputData = {\r\n                userinfo: this.props.Login.userInfo,\r\n                nprojecttypecode: parseInt(comboData.value),\r\n                selectedProjectType: comboData,\r\n                toDate: toDate,\r\n                fromDate: fromDate\r\n            }\r\n            const masterData = { ...this.props.Login.masterData }\r\n            const inputParam = { masterData, inputData }\r\n            this.props.getSampleCollection(inputParam)\r\n        } else {\r\n            selectedRecord[fieldName] = comboData;\r\n            this.setState({ selectedRecord });\r\n        }\r\n\r\n    }\r\n    handleDateChangeSlidout = (dateName, dateValue) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n        selectedRecord[dateName] = dateValue;\r\n        this.setState({ selectedRecord });\r\n    };\r\n    autoSaveGetDataCollection = (event) => {\r\n        let selectedRecord = this.state.selectedRecord || {}\r\n      /*  let nsamplecyclestartpostion=this.props.Login.masterData&&this.props.Login.masterData.samplecyclestartpostion || -1;\r\n        let samplecyclenfieldlength=this.props.Login.masterData&&this.props.Login.masterData.samplecyclenfieldlength || -1;*/\r\n\r\n        event.stopPropagation();\r\n        let invalidbarcode = event.target.value.substring(1, 2);\r\n      \r\n        if (parseInt(selectedRecord[\"sbarcodeid\"] && selectedRecord[\"sbarcodeid\"].length) === parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength)\r\n            && event.keyCode === 13) {\r\n\r\n            if (parseInt(invalidbarcode) === SampleCycle.COLLECTION) {\r\n\r\n                let inputParam = {\r\n                    nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\r\n                    spositionvalue: event.target.value,\r\n                    userinfo: this.props.Login.userInfo,\r\n                    nbarcodeLength: parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength),\r\n                    jsondata: {},\r\n                    masterData: this.props.Login.masterData,\r\n                    selectedRecord: selectedRecord || {}\r\n                }\r\n                this.props.getBarcodeDataCollection(inputParam);\r\n            }\r\n            else {\r\n                toast.warn(\r\n                    this.props.intl.formatMessage({\r\n                        id: \"IDS_INVALIDBARCODEID\",\r\n                    })\r\n                );\r\n            }\r\n        }\r\n        // else {\r\n        //     toast.warn(\r\n        //         this.props.intl.formatMessage({\r\n        //             id: \"IDS_INVALIDBARCODELENGTH\",\r\n        //         })\r\n        //     );\r\n        // }\r\n    };\r\n\r\n    onInputOnChange = (event, fieldname) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n        if (fieldname === 'nsampleqty') {\r\n            if (/^\\d{0,3}(\\.\\d{0,2})?$/.test(event.target.value) || event.target.value === \"\") {\r\n\r\n                selectedRecord[fieldname] = event.target.value;\r\n\r\n            }\r\n        }\r\n        else if (event.target.type === 'checkbox') {\r\n            selectedRecord[event.target.name] = event.target.checked === true ? transactionStatus.YES : transactionStatus.NO;\r\n        }\r\n        else {\r\n            selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n\r\n    }\r\n\r\n    componentDidUpdate(previousProps) {\r\n        let { projectType } = this.state;\r\n        let bool = false;\r\n        if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n            this.setState({ selectedRecord: this.props.Login.selectedRecord });\r\n        }\r\n\r\n        if (this.props.Login.masterData.projectType !== previousProps.Login.masterData.projectType) {\r\n            const projectTypeMap = constructOptionList(this.props.Login.masterData.projectType || [], \"nprojecttypecode\",\r\n                \"sprojecttypename\", undefined, undefined, undefined);\r\n            projectType = projectTypeMap.get(\"OptionList\");\r\n            bool = true;\r\n\r\n        }\r\n        if (this.props.Login.masterData.selectedProjectType !== previousProps.Login.masterData.selectedProjectType) {\r\n            const projectTypeMap = constructOptionList(this.props.Login.masterData.projectType || [], \"nprojecttypecode\",\r\n                \"sprojecttypename\", undefined, undefined, undefined);\r\n            projectType = projectTypeMap.get(\"OptionList\");\r\n            bool = true;\r\n        }\r\n\r\n        // if (this.props.Login.masterData.SampleCollection !== previousProps.Login.masterData.SampleCollection) {\r\n        //     let samplecollect = [];\r\n        //     samplecollect =\r\n        //         this.props.Login.masterData.SampleCollection && this.props.Login.masterData.SampleCollection.map(sampleItem => {\r\n        //             const entries = Object.entries(sampleItem.jsondata);\r\n        //             if (entries.length > 0) {\r\n        //                 const newItem = { ...sampleItem };\r\n        //                 entries.forEach(([key, value]) => {\r\n\r\n        //                     newItem[key] = value;\r\n\r\n        //                 });\r\n        //                 return newItem;\r\n        //             }\r\n        //             return sampleItem;\r\n        //         });\r\n\r\n        //     // let { dataState } = this.state;\r\n        //     // if (dataState === undefined) {\r\n        //     //     dataState = { skip: 0, take: this.state.dataState.take }\r\n        //     // }\r\n        //     // if (this.state.dataResult.data) {\r\n        //     //     if (this.state.dataResult.data.length === 1) {\r\n        //     //         let skipcount = this.state.dataState.skip > 0 ? (this.state.dataState.skip - this.state.dataState.take) :\r\n        //     //             this.state.dataState.skip\r\n        //     //         dataState = { skip: skipcount, take: this.state.dataState.take }\r\n        //     //     }\r\n        //     // }\r\n\r\n        //     this.setState({\r\n        //         data: samplecollect,\r\n        //         dataResult: process(samplecollect || []),\r\n        //     });\r\n        // }\r\n\r\n        if (this.props.Login.masterData !== previousProps.Login.masterData) {\r\n            let temporaryStorage = [];\r\n            if (this.props.Login.userInfo.nformcode !== previousProps.Login.userInfo.nformcode) {\r\n                const userRoleControlRights = [];\r\n                if (this.props.Login.userRoleControlRights) {\r\n                    this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode] && Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(item =>\r\n                        userRoleControlRights.push(item.ncontrolcode))\r\n                }\r\n                const controlMap = getControlMap(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode)\r\n\r\n                temporaryStorage =\r\n                    this.props.Login.masterData.SampleCollection && this.props.Login.masterData.SampleCollection.map(sampleItem => {\r\n                        const entries = Object.entries(sampleItem.jsondata);\r\n                        if (entries.length > 0) {\r\n                            const newItem = { ...sampleItem };\r\n                            entries.forEach(([key, value]) => {\r\n\r\n                                newItem[key] = value;\r\n\r\n                            });\r\n                            return newItem;\r\n                        }\r\n                        return sampleItem;\r\n                    });\r\n                // let { dataState } = this.state;\r\n                // if (dataState === undefined) {\r\n                //     dataState = { skip: 0, take: this.state.dataState.take }\r\n                // }\r\n                // if (this.state.dataResult.data) {\r\n                //     if (this.state.dataResult.data.length === 1) {\r\n                //         let skipcount = this.state.dataState.skip > 0 ? (this.state.dataState.skip - this.state.dataState.take) :\r\n                //             this.state.dataState.skip\r\n                //         dataState = { skip: skipcount, take: this.state.dataState.take }\r\n                //     }\r\n                // }\r\n\r\n                this.setState({\r\n                    userRoleControlRights, controlMap, data: temporaryStorage,\r\n                    dataResult: process(temporaryStorage || [],this.state.dataState),\r\n                });\r\n            }else {\r\n                //jana ALPD-4694 Temporary Storage-->While Try to Delete the Records the Fields are Align Wrongly\r\n                let samplecollect = [];\r\n                samplecollect =\r\n                    this.props.Login.masterData.SampleCollection && this.props.Login.masterData.SampleCollection.map(sampleItem => {\r\n                        const entries = Object.entries(sampleItem.jsondata);\r\n                        if (entries.length > 0) {\r\n                            const newItem = { ...sampleItem };\r\n                            entries.forEach(([key, value]) => {\r\n    \r\n                                newItem[key] = value;\r\n    \r\n                            });\r\n                            return newItem;\r\n                        }\r\n                        return sampleItem;\r\n                    });\r\n                    let {dataState}=this.state;\r\n                    if(this.props.Login.dataState===undefined  || this.props.Login.masterData.selectedProjectType !== previousProps.Login.masterData.selectedProjectType){\r\n                        dataState={skip:0,take:this.state.dataState.take}\r\n                    }\r\n                     if(this.state.dataResult.data){\r\n                         if(this.state.dataResult.data.length ===1){\r\n                            let skipcount=this.state.dataState.skip>0?(this.state.dataState.skip-this.state.dataState.take):\r\n                            this.state.dataState.skip\r\n                             dataState={skip:skipcount,take:this.state.dataState.take}\r\n                         }\r\n                     \r\n                }\r\n            \r\n                 this.setState({\r\n                    data: samplecollect, selectedRecord: this.props.Login.selectedRecord,\r\n                    dataResult: process(samplecollect || [],dataState),\r\n                    dataState\r\n                });\r\n            }\r\n            /*  else {\r\n                  if (this.props.Login.masterData.SampleCollection) {\r\n                      let samplecollect = [];\r\n                      samplecollect =\r\n                          this.props.Login.masterData.SampleCollection && this.props.Login.masterData.SampleCollection.map(sampleItem => {\r\n                              const entries = Object.entries(sampleItem.jsondata);\r\n                              if (entries.length > 0) {\r\n                                  const newItem = { ...sampleItem };\r\n                                  entries.forEach(([key, value]) => {\r\n  \r\n                                      newItem[key] = value;\r\n  \r\n                                  });\r\n                                  return newItem;\r\n                              }\r\n                              return sampleItem;\r\n                          });\r\n  \r\n                      this.setState({\r\n                          data: samplecollect,\r\n                          dataState: { skip: 0, take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5 },\r\n                          dataResult: process(samplecollect || [], { skip: 0, take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5 }),\r\n                      });\r\n                  }\r\n              }*/\r\n        }else if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n            this.setState({ selectedRecord: this.props.Login.selectedRecord });\r\n        }\r\n\r\n        if (this.props.Login.masterData.jsondataBarcodeFields !== previousProps.Login.masterData.jsondataBarcodeFields) {\r\n            const retrievedData = sortData(this.props.Login.masterData.jsondataBarcodeFields,\"ascending\",\"nsorter\");\r\n            this.setState({ jsondataBarcodeFields: retrievedData });\r\n        }\r\n\r\n        if (bool) {\r\n            this.setState({\r\n                projectType\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    handleDateChange = (dateName, dateValue) => {\r\n        const { selectedRecord } = this.state;\r\n        if (dateValue === null) {\r\n            dateValue = new Date();\r\n        }\r\n        if (dateName === 'todate') {\r\n            selectedRecord[dateName] = dateValue;\r\n\r\n        }\r\n        else {\r\n            selectedRecord[dateName] = dateValue;\r\n\r\n        }\r\n        selectedRecord[dateName] = dateValue;\r\n        // this.setState({ selectedRecord });\r\n        // this.reloadData(selectedRecord, true);\r\n\r\n        let dateObj = {};\r\n        let obj = convertDateValuetoString(selectedRecord['fromdate'] && selectedRecord['fromdate'] || this.props.Login.masterData.FromDate, selectedRecord['todate'] && selectedRecord['todate'] || this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n        let fromDate = obj.fromDate;\r\n        let toDate = obj.toDate;\r\n\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": this.props.Login.userInfo,\r\n                fromDate: fromDate,\r\n                toDate: toDate,\r\n                selectedProjectType: this.props.Login.masterData.selectedProjectType,\r\n                nprojecttypecode: this.props.Login.masterData.selectedProjectType && this.props.Login.masterData.selectedProjectType.value || -1\r\n            }\r\n        };\r\n        this.props.getSampleCollection(inputParam);\r\n    }\r\n\r\n    reloadData = () => {\r\n        //this.searchRef.current.value = \"\";\r\n        let fromDate = this.props.Login.masterData.FromDate;\r\n        let toDate = this.props.Login.masterData.ToDate;\r\n\r\n        let obj = convertDateValuetoString(fromDate, toDate, this.props.Login.userInfo, true);\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": this.props.Login.userInfo,\r\n                fromDate: obj.fromDate,\r\n                toDate: obj.toDate,\r\n                \"nprojecttypecode\": this.props.Login.masterData.selectedProjectType.value || -1\r\n                // currentdate: isDateChange === true ? null : formatInputDate(new Date(), true)\r\n            },\r\n            classUrl: 'storagesamplecollection',\r\n            methodUrl: \"SampleCollection\",\r\n            displayName: \"IDS_SAMPLECOLLECTION\",\r\n            userInfo: this.props.Login.userInfo,\r\n            selectedRecord: this.state.selectedRecord || {}\r\n        };\r\n        this.props.getSampleCollection(inputParam);\r\n    }\r\n\r\n\r\n}\r\nexport default connect(mapStateToProps, {\r\n    callService, crudMaster,\r\n    updateStore, validateEsignCredential, getComboSampleCollection, getBarcodeDataCollection, saveCollection, getActiveSampleCollectionById, getSampleCollection, validateEsignCredentialSampleCollection\r\n})(injectIntl(SampleCollection));"]},"metadata":{},"sourceType":"module"}