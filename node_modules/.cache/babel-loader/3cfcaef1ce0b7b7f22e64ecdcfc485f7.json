{"ast":null,"code":"import _defineProperty from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{Button,Col,Modal,Row}from'react-bootstrap';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faSave}from'@fortawesome/free-solid-svg-icons';import{FormattedMessage,injectIntl}from'react-intl';import{TouchBackend}from'react-dnd-touch-backend';import{HTML5Backend}from'react-dnd-html5-backend';import{DndProvider}from'react-dnd';import device from'current-device';// import MoreOptions from '../../components/configureui/MoreOptions';\nimport Dynamicinput from'../../components/droparea/Dynamicinputs';import{connect}from'react-redux';import{updateStore,crudMaster,getTableColumns}from'../../actions/index';import{SampleType,transactionStatus}from'../../components/Enumeration';import{DEFAULT_RETURN}from'../../actions/LoginTypes';import{showEsign}from'../../components/CommonScript';import AlertModal from'./AlertModal';import FormInput from'../../components/form-input/form-input.component';import{getcomponentdata,getValidComponent,replaceChildFromChildren}from'../../components/droparea/helpers';import{InstrumentDefaultTemplate,productDefaultTemplate}from'./DefaultTemplates';import{ReactComponents}from'../../components/Enumeration';import ConfirmMessage from'../../components/confirm-alert/confirm-message.component';import{toast}from'react-toastify';var mapStateToProps=function mapStateToProps(state){return{Login:state.Login};};var PreRegDesignPopUp=/*#__PURE__*/function(_React$Component){_inherits(PreRegDesignPopUp,_React$Component);var _super=_createSuper(PreRegDesignPopUp);function PreRegDesignPopUp(props){var _this;_classCallCheck(this,PreRegDesignPopUp);_this=_super.call(this,props);_this.setLayout=function(design,splitDropZonePath,remove,removeChild){var selectedFieldRecord={};if(remove===undefined){selectedFieldRecord=getcomponentdata(design,splitDropZonePath.split(\"-\"));}else if(removeChild){var childRecord={};_this.state.toBeDeleted.deleteComponent.child.map(function(myChild){childRecord=getcomponentdata(design,myChild.childPath.split(\"-\"));childRecord['childValue']=undefined;childRecord['parentPath']=undefined;childRecord['valuecolumn']=undefined;design=replaceChildFromChildren(design,myChild.childPath.split(\"-\"),childRecord);return null;});}design=_this.updatePath(design);// if (selectedFieldRecord.child) {\n//     let childRecord = {}\n//     selectedFieldRecord.child.map(myChild => {\n//         childRecord = getcomponentdata(design, myChild.childPath.split(\"-\"))\n//         childRecord['parentPath'] = splitDropZonePath.split(\"-\").length === 4 ? splitDropZonePath : splitDropZonePath + '-0';\n//         design = replaceChildFromChildren(design, splitDropZonePath.split(\"-\"), childRecord)\n//         return null;\n//     })\n// }\n// if (selectedFieldRecord.childValue) {\n//     let parentData = getcomponentdata(this.state.design, selectedFieldRecord.parentPath.split(\"-\"));\n//     let newChildData = []\n//     parentData.child.map(child => child.label === selectedFieldRecord.label ?\n//         newChildData.push({ ...child, childPath: splitDropZonePath.split(\"-\").length === 4 ? splitDropZonePath : splitDropZonePath + '-0' }) :\n//         newChildData.push(child))\n//     parentData = { ...parentData, child: newChildData };\n//     design = replaceChildFromChildren(design, selectedFieldRecord.parentPath.split(\"-\"), parentData)\n// }\nvar components=_this.getComponents(design);var validComponents=getValidComponent(selectedFieldRecord,components,_this.props.Login.columnInfo);_this.setState({showConfirmAlert:false,toBeDeleted:{},design:design,selectedFieldRecord:selectedFieldRecord,components:components,validComponents:validComponents,selectedComponentpath:splitDropZonePath.split(\"-\").length>1?splitDropZonePath:'0-0-'+splitDropZonePath});};_this.updatePath=function(design){design.map(function(row,rowIndex){return row.children.map(function(column,columnIndex){return column.children.map(function(componnetrow,compRowIndex){if(componnetrow.hasOwnProperty('children')){componnetrow.children.map(function(component,compIndex){if(component.child){var newChild=[];component.child.map(function(childComp){var obj=_this.getIndexByLabel(design,childComp.label);newChild.push(_objectSpread(_objectSpread({},childComp),{},{childPath:obj.path}));var newObj=_objectSpread(_objectSpread({},obj.object),{},{parentPath:\"\".concat(rowIndex,\"-\").concat(columnIndex,\"-\").concat(compRowIndex,\"-\").concat(compIndex)});design=replaceChildFromChildren(design,obj.path.split(\"-\"),newObj);});component=_objectSpread(_objectSpread({},component),{},{child:newChild});design=replaceChildFromChildren(design,[rowIndex,columnIndex,compRowIndex,compIndex],component);}});}else{if(componnetrow.child){var newChild=[];componnetrow.child.map(function(childComp){var obj=_this.getIndexByLabel(design,childComp.label);newChild.push(_objectSpread(_objectSpread({},childComp),{},{childPath:obj.path}));var newObj=_objectSpread(_objectSpread({},obj.object),{},{parentPath:\"\".concat(rowIndex,\"-\").concat(columnIndex,\"-\").concat(compRowIndex,\"-0\")});design=replaceChildFromChildren(design,obj.path.split(\"-\"),newObj);});componnetrow=_objectSpread(_objectSpread({},componnetrow),{},{child:newChild});design=replaceChildFromChildren(design,[rowIndex,columnIndex,compRowIndex,0],componnetrow);}}});});});return design;};_this.validateDelete=function(design,splitDropZonePath){var path=splitDropZonePath.split(\"-\");var showAlert=false;var toBeDeleted={};// let component = {}\n// let row = this.state.design[path[0]]\n// let column = row.children[path[1]]\n// let compRow = column.children[path[2]]\n// if (compRow.type === 'componentrow')\n//     component = compRow.children[path[3]]\n// else\n//     component = compRow\nvar component=getcomponentdata(_this.state.design,path);if(component.child&&component.child.length>0){var childRecord={};component.child.map(function(myChild){childRecord=getcomponentdata(design,myChild.childPath.split(\"-\"));childRecord['childValue']=undefined;childRecord['parentPath']=undefined;childRecord['valuecolumn']=undefined;if(myChild.componentcode!==ReactComponents.COMBO){childRecord['column']=undefined;}design=replaceChildFromChildren(design,myChild.childPath.split(\"-\"),childRecord);return null;});showAlert=true;toBeDeleted={design:design,splitDropZonePath:splitDropZonePath,deleteComponent:component};// this.showAlert(true, toBeDeleted);\n}if(component.childValue){var parentData=getcomponentdata(_this.state.design,component.parentPath.split(\"-\"));var newChildData=parentData.child.filter(function(child){return child.label!==component.label;});parentData=_objectSpread(_objectSpread({},parentData),{},{child:newChildData});design=replaceChildFromChildren(design,component.parentPath.split(\"-\"),parentData);toBeDeleted={design:design,splitDropZonePath:splitDropZonePath,deleteComponent:component};}if(showAlert){_this.showAlert(true,toBeDeleted);}else{_this.setLayout(design,splitDropZonePath,true);}};_this.confirmAlert=function(){_this.confirmMessage.confirm(\"Warning\",\"Warning\",_this.props.intl.formatMessage({id:\"IDS_PARENTCOMPONENTCANNOTBEDELETED\"}),_this.props.intl.formatMessage({id:\"IDS_OK\"}),_this.props.intl.formatMessage({id:\"IDS_CANCEL\"}),function(){return _this.setLayout(_this.state.toBeDeleted.design,_this.state.toBeDeleted.splitDropZonePath,true,true);},undefined,function(){return _this.showAlert(false);});};_this.showAlert=function(bool,toBeDeleted){// const updateInfo = {\n//     typeName: DEFAULT_RETURN,\n//     data: { showConfirmAlert: bool, toBeDeleted }\n// }\n// this.props.updateStore(updateInfo);\n_this.setState({showConfirmAlert:bool,toBeDeleted:toBeDeleted});};_this.onclickcomponent=function(event,data,path){var selectedFieldRecord=_objectSpread({},data);var components=_this.getComponents(_this.state.design);var componentData={components:components,selectedComponentpath:path};if(selectedFieldRecord.componentcode===ReactComponents.COMBO&&selectedFieldRecord.source&&(_this.props.Login.columnInfo===undefined||_this.props.Login.columnInfo[selectedFieldRecord.source]===undefined)){_this.props.getTableColumns(_this.state.design,selectedFieldRecord,selectedFieldRecord.source,_this.props.Login.userInfo,\"\",_this.props.Login.columnInfo,componentData);}else{var validComponents=getValidComponent(selectedFieldRecord,components,_this.props.Login.columnInfo);var tableColumn=selectedFieldRecord.source?_this.props.Login.columnInfo[selectedFieldRecord.source].tableColumn:[];if(selectedFieldRecord.componentcode!==ReactComponents.COMBO){if(_this.props.Login.columnInfo&&selectedFieldRecord.childValue&&_this.props.Login.columnInfo[selectedFieldRecord.childValue.source]){tableColumn=_this.props.Login.columnInfo[selectedFieldRecord.childValue.source].tableColumn;_this.setState({selectedComponentpath:path,selectedFieldRecord:selectedFieldRecord,components:components,tableColumn:tableColumn,validComponents:validComponents});}else{if(selectedFieldRecord.childValue){_this.props.getTableColumns(_this.state.design,selectedFieldRecord,selectedFieldRecord.childValue.source,_this.props.Login.userInfo,\"\",_this.props.Login.columnInfo,componentData);}else{_this.setState({selectedComponentpath:path,selectedFieldRecord:selectedFieldRecord,components:components,tableColumn:tableColumn,validComponents:validComponents});}}}else{_this.setState({selectedComponentpath:path,selectedFieldRecord:selectedFieldRecord,components:components,tableColumn:tableColumn,validComponents:validComponents});}}};_this.getComponents=function(design){var components=[];design.map(function(row,rowIndex){row.children.map(function(column,columnIndex){column.children.map(function(componnet,compindex){return componnet.hasOwnProperty(\"children\")?componnet.children.map(function(componnetrow,compRowIndex){return componnetrow.label&&components.push({label:componnetrow.label,value:componnetrow.label,// item: componnetrow,\nsource:componnetrow.source,child:componnetrow.child,valuemember:componnetrow.valuemember,path:\"\".concat(rowIndex,\"-\").concat(columnIndex,\"-\").concat(compindex,\"-\").concat(compRowIndex)});}):componnet.label&&components.push({label:componnet.label,value:componnet.label,// item: componnet,\nsource:componnet.source,child:componnet.child,valuemember:componnet.valuemember,path:\"\".concat(rowIndex,\"-\").concat(columnIndex,\"-\").concat(compindex,\"-0\")});});return null;});return null;});return components;};_this.getValueMembers=function(selectedFieldRecord){if(selectedFieldRecord.childValue){var valueColumn=[];_this.props.Login.columnInfo&&_this.props.Login.columnInfo[selectedFieldRecord.source]&&_this.props.Login.columnInfo[selectedFieldRecord.source].numericColumns.map(function(x){if(x.foriegntablename===selectedFieldRecord.childValue.source)valueColumn.push({label:x.displayname[_this.props.Login.userInfo.language],value:x.tablecolumnname});return null;});if(valueColumn.length){return valueColumn;}else{_this.props.Login.columnInfo&&_this.props.Login.columnInfo[selectedFieldRecord.childValue.source]&&_this.props.Login.columnInfo[selectedFieldRecord.childValue.source].numericColumns.map(function(x){if(x.foriegntablename===selectedFieldRecord.source)valueColumn.push({label:x.displayname[_this.props.Login.userInfo.language],value:x.tablecolumnname});return null;});return valueColumn;}}else{return null;}};_this.onInputOnChange=function(event){var selectedFieldRecord=_this.state.selectedFieldRecord||{};if(event.target.type==='checkbox'){if(event.target.name==='timeonly'){selectedFieldRecord['dateonly']=false;}if(event.target.name==='dateonly'){selectedFieldRecord['timeonly']=false;}selectedFieldRecord[event.target.name]=event.target.checked;}else{if(event.target.name==='label'){selectedFieldRecord[event.target.name]=event.target.value;selectedFieldRecord['displayname']=_objectSpread(_objectSpread({},selectedFieldRecord['displayname']),{},_defineProperty({},_this.props.Login.language,event.target.value));}else{selectedFieldRecord[event.target.name]=event.target.value;}}// this.setState({ selectedFieldRecord });\n_this.saveComponentProperties(selectedFieldRecord);};_this.onNumericInputChange=function(event){var selectedFieldRecord=_this.state.selectedFieldRecord||{};var value=event.target.value;if(!isNaN(value)){// if (parseInt(value) < 10) {\nselectedFieldRecord[event.target.name]=value;_this.saveComponentProperties(selectedFieldRecord);// }\n}};_this.onComboChange=function(comboData,comboName){var selectedFieldRecord=_this.state.selectedFieldRecord;if(selectedFieldRecord.label){if(comboName==='table'){selectedFieldRecord[comboName]=comboData;selectedFieldRecord['source']=comboData.value;var splititemarray=_this.state.selectedComponentpath.split(\"-\");var newdata=_objectSpread({},selectedFieldRecord);var design=replaceChildFromChildren(_this.state.design,splititemarray,newdata);_this.props.getTableColumns(design,selectedFieldRecord,comboData.value,_this.props.Login.userInfo,splititemarray,_this.props.Login.columnInfo);}else if(comboName==='column'){selectedFieldRecord[comboName]=comboData;selectedFieldRecord['displaymember']=comboData.value;if(comboData.item.ismultilingual){selectedFieldRecord['isMultiLingual']=true;}var _splititemarray=_this.state.selectedComponentpath.split(\"-\");var _newdata=_objectSpread({},selectedFieldRecord);var _design=replaceChildFromChildren(_this.state.design,_splititemarray,_newdata);_this.setState({design:_design,selectedFieldRecord:selectedFieldRecord});}else if(comboName==='childValue'){if(comboData){// selectedFieldRecord[comboName] = comboData;\nvar _splititemarray2=_this.state.selectedComponentpath.split(\"-\");var _design2=_this.state.design;if(selectedFieldRecord.parentPath){var oldParentData=getcomponentdata(_this.state.design,selectedFieldRecord.parentPath.split(\"-\"));if(oldParentData.child){var newChildData1=oldParentData.child.filter(function(child){return child.label!==selectedFieldRecord.label;});oldParentData=_objectSpread(_objectSpread({},oldParentData),{},{child:newChildData1});_design2=replaceChildFromChildren(_this.state.design,selectedFieldRecord.parentPath.split(\"-\"),oldParentData);}}var parentData=getcomponentdata(_design2,comboData.path.split(\"-\"));selectedFieldRecord['childValue']=comboData;selectedFieldRecord['parentPath']=comboData.path;var _newdata2=_objectSpread({},selectedFieldRecord);_design2=replaceChildFromChildren(_design2,_splititemarray2,_newdata2);var newChildData=parentData.child||[];var validateChild=newChildData.filter(function(x){return x.label===selectedFieldRecord.label;});if(validateChild.length===0){var valueMemberOptions=_this.getValueMembers(selectedFieldRecord);if(valueMemberOptions.length===1){newChildData.push({label:selectedFieldRecord.label,tablecolumnname:valueMemberOptions[0].value,childPath:_this.state.selectedComponentpath});}else{newChildData.push({label:selectedFieldRecord.label,childPath:_this.state.selectedComponentpath});}}parentData=_objectSpread(_objectSpread({},parentData),{},{child:newChildData});_design2=replaceChildFromChildren(_design2,comboData.path.split(\"-\"),parentData);if(selectedFieldRecord.componentcode===ReactComponents.COMBO){_this.setState({design:_design2,selectedFieldRecord:selectedFieldRecord});}else{_this.props.getTableColumns(_design2,selectedFieldRecord,selectedFieldRecord.childValue.source,_this.props.Login.userInfo,_splititemarray2,_this.props.Login.columnInfo,{components:_this.state.components,selectedComponentpath:_this.state.selectedComponentpath},true);}}else{var _splititemarray3=_this.state.selectedComponentpath.split(\"-\");var _parentData=getcomponentdata(_this.state.design,selectedFieldRecord.parentPath.split(\"-\"));var _newChildData=_parentData.child.filter(function(child){return child.label!==selectedFieldRecord.label;});_parentData=_objectSpread(_objectSpread({},_parentData),{},{child:_newChildData});var _design3=replaceChildFromChildren(_this.state.design,selectedFieldRecord.parentPath.split(\"-\"),_parentData);selectedFieldRecord['childValue']=comboData;if(selectedFieldRecord.componentcode!==ReactComponents.COMBO)selectedFieldRecord['column']=comboData;var _newdata3=_objectSpread({},selectedFieldRecord);_design3=replaceChildFromChildren(_design3,_splititemarray3,_newdata3);if(selectedFieldRecord.componentcode===ReactComponents.COMBO){_this.setState({design:_design3,selectedFieldRecord:selectedFieldRecord});}else{_this.setState({design:_design3,selectedFieldRecord:selectedFieldRecord,tableColumn:[]});}}}else if(comboName==='valuecolumn'){selectedFieldRecord['valuecolumn']=comboData;var _parentData2=getcomponentdata(_this.state.design,selectedFieldRecord.parentPath.split(\"-\"));var _newChildData2=[];_parentData2.child.map(function(child){if(child.label===selectedFieldRecord.label){_newChildData2.push(_objectSpread(_objectSpread({},child),{},{tablecolumnname:comboData.value}));}else{_newChildData2.push(child);}return null;});_parentData2=_objectSpread(_objectSpread({},_parentData2),{},{child:_newChildData2});var _design4=replaceChildFromChildren(_this.state.design,selectedFieldRecord.parentPath.split(\"-\"),_parentData2);var _newdata4=_objectSpread({},selectedFieldRecord);_design4=replaceChildFromChildren(_design4,_this.state.selectedComponentpath.split(\"-\"),_newdata4);_this.setState({design:_design4,selectedFieldRecord:selectedFieldRecord});}else{selectedFieldRecord[comboName]=comboData;var _splititemarray4=_this.state.selectedComponentpath.split(\"-\");var _newdata5=_objectSpread({},selectedFieldRecord);var _design5=replaceChildFromChildren(_this.state.design,_splititemarray4,_newdata5);_this.setState({design:_design5,selectedFieldRecord:selectedFieldRecord});}}else{toast.warn(_this.props.intl.formatMessage({id:\"IDS_ENTERLABEL\"}));}};_this.addTag=function(tags){var selectedFieldRecord=_this.state.selectedFieldRecord||{};selectedFieldRecord['radioOptions']=tags;_this.saveComponentProperties(selectedFieldRecord);};_this.saveComponentProperties=function(selectedFieldRecord){var splititemarray=_this.state.selectedComponentpath.split(\"-\");// const selectedFieldRecord = this.state.selectedFieldRecord;\nvar newdata=_objectSpread({},selectedFieldRecord);var design=replaceChildFromChildren(_this.state.design,splititemarray,newdata);_this.setState({design:design,selectedFieldRecord:selectedFieldRecord});};_this.handleSaveClick=function(saveType){if(_this.state.selectedRecord.templateName&&_this.state.selectedRecord.templateName!==\"\"){var inputData=[];var selectedId=null;inputData[\"userinfo\"]=_this.props.Login.userInfo;var dataState=undefined;if(_this.props.Login.operation===\"update\"){// edit\nselectedId=_this.state.selectedRecord.nchecklistqbcode;dataState=_this.state.dataState;inputData[\"registrationtemplate\"]={nreactregtemplatecode:_this.props.Login.masterData.selectedTemplate.nreactregtemplatecode,nsampletypecode:_this.props.nsampletypecode,sregtemplatename:_this.state.selectedRecord.templateName,jsonString:JSON.stringify(_this.state.design),jsondata:_this.state.design,ntransactionstatus:transactionStatus.DRAFT};}else{//add               \ninputData[\"registrationtemplate\"]={nsampletypecode:_this.props.nsampletypecode,sregtemplatename:_this.state.selectedRecord.templateName,jsonString:JSON.stringify(_this.state.design),ntransactionstatus:transactionStatus.DRAFT};}var postParam={inputListName:\"RegistrationTemplate\",selectedObject:\"selectedTemplate\",primaryKeyField:\"nreactregtemplatecode\",fetchUrl:\"dynamicpreregdesign/getRegistrationTemplateById\",fecthInputObject:{userinfo:_this.props.Login.userInfo,nsampletypecode:_this.props.nsampletypecode},masterData:_this.props.Login.masterData};var inputParam={methodUrl:'RegistrationTemplate',classUrl:'dynamicpreregdesign',displayName:_this.props.Login.inputParam.displayName?_this.props.Login.inputParam.displayName:'',inputData:inputData,postParam:postParam,searchRef:_this.props.searchRef,operation:_this.props.Login.operation,saveType:saveType,dataState:dataState,selectedId:selectedId};var masterData=_this.props.Login.masterData;if(showEsign(_this.props.Login.userRoleControlRights,_this.props.Login.userInfo.nformcode,_this.props.Login.ncontrolcode)){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:masterData},saveType:saveType}};_this.props.updateStore(updateInfo);}else{_this.props.crudMaster(inputParam,masterData,\"openPortal\");}}else{toast.info(_this.props.intl.formatMessage({id:\"IDS_ENTERTEMPLATENAME\"}));}};_this.confirmMessage=new ConfirmMessage();_this.state={nflag:1,design:_this.props.Login.operation==='update'?_this.props.Login.design:_this.props.nsampletypecode===SampleType.PRODUCT?productDefaultTemplate:_this.props.nsampletypecode===SampleType.INSTRUMENT?InstrumentDefaultTemplate:[],selectedRecord:_this.props.Login.selectedRecord||{},selectedFieldRecord:{},selectedComponentpath:\"\",components:[],validComponents:[],showConfirmAlert:false,toBeDeleted:{}};return _this;}_createClass(PreRegDesignPopUp,[{key:\"render\",value:function render(){var _this2=this;// const selectedFieldRecord = JSON.parse(JSON.stringify(this.state.selectedFieldRecord))\nreturn/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal,{centered:true,scrollable:true,bsPrefix:\"model model_zindex\",show:this.props.Login.openPortal,onHide:this.props.closeModal,dialogClassName:\"\".concat(this.state.nflag&&this.state.nflag===2?'alert-popup':'',\" modal-fullscreen\"),backdrop:\"static\",keyboard:false,enforceFocus:false,\"aria-labelledby\":\"example-custom-modal-styling-title\"},/*#__PURE__*/React.createElement(Modal.Header,{className:\"d-flex align-items-center\"},/*#__PURE__*/React.createElement(Modal.Title,{id:\"add\",className:\"header-primary flex-grow-1\"},\"\".concat(this.props.Login.operation===\"update\"?this.props.intl.formatMessage({id:\"IDS_EDIT\"}):this.props.intl.formatMessage({id:\"IDS_ADD\"}),\" \").concat(this.props.intl.formatMessage({id:\"IDS_DESIGNTEMPLATE\"}))),/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Button,{className:\"btn-user btn-cancel\",variant:\"\",onClick:this.props.closeModal},/*#__PURE__*/React.createElement(FormattedMessage,{id:\"IDS_CANCEL\",defaultMessage:\"Cancel\"})),/*#__PURE__*/React.createElement(Button,{className:\" btn-user btn-primary-blue\",onClick:function onClick(){return _this2.setState({openAlertModal:true,templateName:\"\"});}},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faSave}),\" \",/*#__PURE__*/React.createElement(FormattedMessage,{id:\"IDS_SAVE\",defaultMessage:\"Save\"})))),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(\"div\",{className:\"modal-inner-content\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:12,className:\"p-0\"},/*#__PURE__*/React.createElement(DndProvider,{backend:device.os!=='android'?HTML5Backend:TouchBackend,options:{enableMouseEvents:true}},/*#__PURE__*/React.createElement(Dynamicinput,{layout:this.state.design,reactInputFields:this.props.Login.ReactInputFields||{},setLayout:this.setLayout,reactComponents:this.props.Login.ReactComponents||{},onInputOnChange:this.onInputOnChange,onNumericInputChange:this.onNumericInputChange,onComboChange:this.onComboChange,selectedFieldRecord:this.state.selectedFieldRecord,onclickcomponent:this.onclickcomponent,ReactTables:this.props.Login.ReactTables,tableColumn:this.state.tableColumn,inputFields:this.state.validComponents,addChildMapping:this.addChildMapping,valueMembers:this.getValueMembers(this.state.selectedFieldRecord),validateDelete:this.validateDelete,addTag:this.addTag}))))))),/*#__PURE__*/React.createElement(AlertModal,{openAlertModal:this.state.openAlertModal,modalTitle:\"IDS_ENTERTEMPLATENAME\",closeModal:function closeModal(){return _this2.setState({openAlertModal:false,templateName:\"\"});},onSaveClick:this.handleSaveClick,modalBody:/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(FormInput,{label:this.props.intl.formatMessage({id:\"IDS_TEMPLATENAME\"}),name:\"templatename\",type:\"text\",onChange:function onChange(event){return _this2.setState({selectedRecord:_objectSpread(_objectSpread({},_this2.state.selectedRecord),{},{templateName:event.target.value})});},placeholder:this.props.intl.formatMessage({id:\"IDS_TEMPLATENAME\"}),value:this.state.selectedRecord.templateName?this.state.selectedRecord.templateName:\"\",isMandatory:true,required:true,maxLength:\"30\"})))}),this.state.showConfirmAlert?this.confirmAlert():\"\");}},{key:\"componentDidUpdate\",value:function componentDidUpdate(previousProps){var updateState=false;var _this$state=this.state,openAlertModal=_this$state.openAlertModal,design=_this$state.design,selectedRecord=_this$state.selectedRecord,selectedFieldRecord=_this$state.selectedFieldRecord,selectedComponentpath=_this$state.selectedComponentpath,components=_this$state.components,validComponents=_this$state.validComponents,tableColumn=_this$state.tableColumn,showConfirmAlert=_this$state.showConfirmAlert;if(this.props.Login.openPortal===false&&previousProps.Login.openPortal){updateState=true;openAlertModal=false;}if(this.props.Login.design!==previousProps.Login.design){updateState=true;design=this.props.Login.design;}if(this.props.Login.selectedRecord!==previousProps.Login.selectedRecord){selectedRecord=this.props.Login.selectedRecord;updateState=true;}if(this.props.Login.selectedFieldRecord!==previousProps.Login.selectedFieldRecord){selectedFieldRecord=this.props.Login.selectedFieldRecord;updateState=true;}if(this.props.Login.selectedFieldRecord!==previousProps.Login.selectedFieldRecord){if(this.props.Login.selectedComponentpath&&this.props.Login.selectedComponentpath!==previousProps.Login.selectedFieldRecord){selectedComponentpath=this.props.Login.selectedComponentpath;}selectedFieldRecord=this.props.Login.selectedFieldRecord;components=this.props.Login.components;validComponents=this.props.Login.validComponents;tableColumn=this.props.Login.tableColumn;updateState=true;}if(updateState){this.setState({openAlertModal:openAlertModal,design:design,selectedRecord:selectedRecord,selectedFieldRecord:selectedFieldRecord,tableColumn:tableColumn,selectedComponentpath:selectedComponentpath,components:components,validComponents:validComponents,showConfirmAlert:showConfirmAlert});}}},{key:\"getIndexByLabel\",value:function getIndexByLabel(design,label){var obj={};design.map(function(row,rowIndex){return row.children.map(function(column,columnIndex){return column.children.map(function(componnetrow,compRowIndex){if(componnetrow.hasOwnProperty('children')){componnetrow.children.map(function(component,compIndex){if(component.label===label){obj={object:component,path:\"\".concat(rowIndex,\"-\").concat(columnIndex,\"-\").concat(compRowIndex,\"-\").concat(compIndex)};// break;\n}return null;});}else{if(componnetrow.label===label){obj={object:componnetrow,path:\"\".concat(rowIndex,\"-\").concat(columnIndex,\"-\").concat(compRowIndex,\"-0\")};// return obj;\n// break;\n}}return null;});});});return obj;}}]);return PreRegDesignPopUp;}(React.Component);export default connect(mapStateToProps,{updateStore:updateStore,crudMaster:crudMaster,getTableColumns:getTableColumns})(injectIntl(PreRegDesignPopUp));","map":{"version":3,"sources":["D:/Postgres_workingFolder/QuaLISWeb/src/pages/dynamicpreregdesign/PreRegDesignPopUp.jsx"],"names":["React","Button","Col","Modal","Row","FontAwesomeIcon","faSave","FormattedMessage","injectIntl","TouchBackend","HTML5Backend","DndProvider","device","Dynamicinput","connect","updateStore","crudMaster","getTableColumns","SampleType","transactionStatus","DEFAULT_RETURN","showEsign","AlertModal","FormInput","getcomponentdata","getValidComponent","replaceChildFromChildren","InstrumentDefaultTemplate","productDefaultTemplate","ReactComponents","ConfirmMessage","toast","mapStateToProps","state","Login","PreRegDesignPopUp","props","setLayout","design","splitDropZonePath","remove","removeChild","selectedFieldRecord","undefined","split","childRecord","toBeDeleted","deleteComponent","child","map","myChild","childPath","updatePath","components","getComponents","validComponents","columnInfo","setState","showConfirmAlert","selectedComponentpath","length","row","rowIndex","children","column","columnIndex","componnetrow","compRowIndex","hasOwnProperty","component","compIndex","newChild","childComp","obj","getIndexByLabel","label","push","path","newObj","object","parentPath","validateDelete","showAlert","componentcode","COMBO","childValue","parentData","newChildData","filter","confirmAlert","confirmMessage","confirm","intl","formatMessage","id","bool","onclickcomponent","event","data","componentData","source","userInfo","tableColumn","componnet","compindex","value","valuemember","getValueMembers","valueColumn","numericColumns","x","foriegntablename","displayname","language","tablecolumnname","onInputOnChange","target","type","name","checked","saveComponentProperties","onNumericInputChange","isNaN","onComboChange","comboData","comboName","splititemarray","newdata","item","ismultilingual","oldParentData","newChildData1","validateChild","valueMemberOptions","warn","addTag","tags","handleSaveClick","saveType","selectedRecord","templateName","inputData","selectedId","dataState","operation","nchecklistqbcode","nreactregtemplatecode","masterData","selectedTemplate","nsampletypecode","sregtemplatename","jsonString","JSON","stringify","jsondata","ntransactionstatus","DRAFT","postParam","inputListName","selectedObject","primaryKeyField","fetchUrl","fecthInputObject","userinfo","inputParam","methodUrl","classUrl","displayName","searchRef","userRoleControlRights","nformcode","ncontrolcode","updateInfo","typeName","loadEsign","screenData","info","nflag","PRODUCT","INSTRUMENT","openPortal","closeModal","openAlertModal","os","enableMouseEvents","ReactInputFields","ReactTables","addChildMapping","previousProps","updateState","Component"],"mappings":"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","sourcesContent":["\r\nimport React from 'react';\r\nimport { Button, Col, Modal, Row } from 'react-bootstrap';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faSave } from '@fortawesome/free-solid-svg-icons';\r\nimport { FormattedMessage, injectIntl } from 'react-intl';\r\nimport { TouchBackend } from 'react-dnd-touch-backend'\r\nimport { HTML5Backend } from 'react-dnd-html5-backend'\r\nimport { DndProvider } from 'react-dnd'\r\nimport device from 'current-device';\r\n// import MoreOptions from '../../components/configureui/MoreOptions';\r\nimport Dynamicinput from '../../components/droparea/Dynamicinputs';\r\nimport { connect } from 'react-redux';\r\nimport { updateStore, crudMaster, getTableColumns } from '../../actions/index'\r\nimport { SampleType, transactionStatus } from '../../components/Enumeration';\r\nimport { DEFAULT_RETURN } from '../../actions/LoginTypes';\r\nimport { showEsign } from '../../components/CommonScript';\r\nimport AlertModal from './AlertModal'\r\nimport FormInput from '../../components/form-input/form-input.component';\r\nimport { getcomponentdata, getValidComponent, replaceChildFromChildren } from '../../components/droparea/helpers';\r\nimport { InstrumentDefaultTemplate, productDefaultTemplate } from './DefaultTemplates';\r\nimport { ReactComponents } from '../../components/Enumeration';\r\nimport ConfirmMessage from '../../components/confirm-alert/confirm-message.component';\r\nimport { toast } from 'react-toastify';\r\nconst mapStateToProps = state => {\r\n    return ({ Login: state.Login })\r\n}\r\nclass PreRegDesignPopUp extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.confirmMessage = new ConfirmMessage();\r\n        this.state = {\r\n            nflag: 1,\r\n            design: this.props.Login.operation === 'update' ? this.props.Login.design :\r\n                this.props.nsampletypecode === SampleType.PRODUCT ? productDefaultTemplate :\r\n                    this.props.nsampletypecode === SampleType.INSTRUMENT ? InstrumentDefaultTemplate : [],\r\n            selectedRecord: this.props.Login.selectedRecord || {},\r\n            selectedFieldRecord: {},\r\n            selectedComponentpath: \"\",\r\n            components: [],\r\n            validComponents: [],\r\n            showConfirmAlert: false,\r\n            toBeDeleted: {}\r\n\r\n\r\n        }\r\n    }\r\n    render() {\r\n        // const selectedFieldRecord = JSON.parse(JSON.stringify(this.state.selectedFieldRecord))\r\n        return (\r\n            <>\r\n                <Modal\r\n                    centered\r\n                    scrollable\r\n                    bsPrefix=\"model model_zindex\"\r\n                    show={this.props.Login.openPortal}\r\n                    onHide={this.props.closeModal}\r\n                    dialogClassName={`${this.state.nflag && this.state.nflag === 2 ? 'alert-popup' : ''} modal-fullscreen`}\r\n                    backdrop=\"static\"\r\n                    keyboard={false}\r\n                    enforceFocus={false}\r\n                    aria-labelledby=\"example-custom-modal-styling-title\"\r\n                >\r\n                    <Modal.Header className=\"d-flex align-items-center\">\r\n                        <Modal.Title id=\"add\" className=\"header-primary flex-grow-1\">\r\n                            {`${this.props.Login.operation === \"update\" ? this.props.intl.formatMessage({ id: \"IDS_EDIT\" }) : this.props.intl.formatMessage({ id: \"IDS_ADD\" })} ${this.props.intl.formatMessage({ id: \"IDS_DESIGNTEMPLATE\" })}`}\r\n                        </Modal.Title>\r\n                        <>\r\n                            <Button className=\"btn-user btn-cancel\" variant=\"\" onClick={this.props.closeModal}>\r\n                                <FormattedMessage id='IDS_CANCEL' defaultMessage='Cancel' />\r\n                            </Button>\r\n                            <Button className=\" btn-user btn-primary-blue\" onClick={() => this.setState({ openAlertModal: true, templateName: \"\" })}>\r\n                                <FontAwesomeIcon icon={faSave} /> { }\r\n                                <FormattedMessage id={\"IDS_SAVE\"} defaultMessage={\"Save\"} />\r\n                            </Button>\r\n                        </>\r\n                    </Modal.Header>\r\n                    <Modal.Body>\r\n                        <div className=\"modal-inner-content\">\r\n                            <Row>\r\n                                <Col md={12} className='p-0'>\r\n                                    <DndProvider backend={device.os !== 'android' ? HTML5Backend : TouchBackend} options={{ enableMouseEvents: true }} >\r\n                                        <Dynamicinput\r\n                                            layout={this.state.design}\r\n                                            reactInputFields={this.props.Login.ReactInputFields || {}}\r\n                                            setLayout={this.setLayout}\r\n                                            reactComponents={this.props.Login.ReactComponents || {}}\r\n                                            onInputOnChange={this.onInputOnChange}\r\n                                            onNumericInputChange={this.onNumericInputChange}\r\n                                            onComboChange={this.onComboChange}\r\n                                            selectedFieldRecord={this.state.selectedFieldRecord}\r\n                                            onclickcomponent={this.onclickcomponent}\r\n                                            ReactTables={this.props.Login.ReactTables}\r\n                                            tableColumn={this.state.tableColumn}\r\n                                            inputFields={this.state.validComponents}\r\n                                            addChildMapping={this.addChildMapping}\r\n                                            valueMembers={this.getValueMembers(this.state.selectedFieldRecord)}\r\n                                            validateDelete={this.validateDelete}\r\n                                            addTag={this.addTag}\r\n                                        />\r\n                                    </DndProvider>\r\n                                </Col>\r\n                            </Row>\r\n                        </div>\r\n                    </Modal.Body>\r\n                </Modal>\r\n                <AlertModal\r\n                    openAlertModal={this.state.openAlertModal}\r\n                    modalTitle={\"IDS_ENTERTEMPLATENAME\"}\r\n                    closeModal={() => this.setState({ openAlertModal: false, templateName: \"\" })}\r\n                    onSaveClick={this.handleSaveClick}\r\n                    modalBody={\r\n                        <Row>\r\n                            <Col>\r\n                                <FormInput\r\n                                    label={this.props.intl.formatMessage({ id: \"IDS_TEMPLATENAME\" })}\r\n                                    name={\"templatename\"}\r\n                                    type=\"text\"\r\n                                    onChange={(event) => this.setState({ selectedRecord: { ...this.state.selectedRecord, templateName: event.target.value } })}\r\n                                    placeholder={this.props.intl.formatMessage({ id: \"IDS_TEMPLATENAME\" })}\r\n                                    value={this.state.selectedRecord.templateName ? this.state.selectedRecord.templateName : \"\"}\r\n                                    isMandatory={true}\r\n                                    required={true}\r\n                                    maxLength={\"30\"}\r\n                                />\r\n                            </Col>\r\n                        </Row>\r\n                    }\r\n                />\r\n                {this.state.showConfirmAlert ? this.confirmAlert() : \"\"}\r\n            </>\r\n        );\r\n    }\r\n    componentDidUpdate(previousProps) {\r\n        let updateState = false;\r\n        let { openAlertModal, design, selectedRecord, selectedFieldRecord,\r\n            selectedComponentpath, components, validComponents, tableColumn,\r\n            showConfirmAlert } = this.state\r\n        if (this.props.Login.openPortal === false && previousProps.Login.openPortal) {\r\n            updateState = true;\r\n            openAlertModal = false;\r\n        }\r\n        if (this.props.Login.design !== previousProps.Login.design) {\r\n            updateState = true;\r\n            design = this.props.Login.design;\r\n        }\r\n        if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n            selectedRecord = this.props.Login.selectedRecord;\r\n            updateState = true;\r\n        }\r\n        if (this.props.Login.selectedFieldRecord !== previousProps.Login.selectedFieldRecord) {\r\n            selectedFieldRecord = this.props.Login.selectedFieldRecord;\r\n            updateState = true;\r\n        }\r\n        if (this.props.Login.selectedFieldRecord !== previousProps.Login.selectedFieldRecord) {\r\n            if (this.props.Login.selectedComponentpath && this.props.Login.selectedComponentpath !== previousProps.Login.selectedFieldRecord) {\r\n                selectedComponentpath = this.props.Login.selectedComponentpath\r\n            }\r\n\r\n            selectedFieldRecord = this.props.Login.selectedFieldRecord\r\n            components = this.props.Login.components\r\n            validComponents = this.props.Login.validComponents\r\n            tableColumn = this.props.Login.tableColumn\r\n            updateState = true;\r\n\r\n        }\r\n        if (updateState) {\r\n            this.setState({\r\n                openAlertModal, design, selectedRecord, selectedFieldRecord,\r\n                tableColumn, selectedComponentpath, components, validComponents,\r\n                showConfirmAlert\r\n            })\r\n        }\r\n    }\r\n    setLayout = (design, splitDropZonePath, remove, removeChild) => {\r\n        let selectedFieldRecord = {}\r\n        if (remove === undefined) {\r\n            selectedFieldRecord = getcomponentdata(design, splitDropZonePath.split(\"-\"))\r\n        }\r\n        else if (removeChild) {\r\n            let childRecord = {}\r\n            this.state.toBeDeleted.deleteComponent.child.map(myChild => {\r\n                childRecord = getcomponentdata(design, myChild.childPath.split(\"-\"))\r\n                childRecord['childValue'] = undefined;\r\n                childRecord['parentPath'] = undefined;\r\n                childRecord['valuecolumn'] = undefined;\r\n\r\n                design = replaceChildFromChildren(design, myChild.childPath.split(\"-\"), childRecord)\r\n                return null;\r\n            })\r\n        }\r\n        design = this.updatePath(design)\r\n        // if (selectedFieldRecord.child) {\r\n        //     let childRecord = {}\r\n        //     selectedFieldRecord.child.map(myChild => {\r\n        //         childRecord = getcomponentdata(design, myChild.childPath.split(\"-\"))\r\n        //         childRecord['parentPath'] = splitDropZonePath.split(\"-\").length === 4 ? splitDropZonePath : splitDropZonePath + '-0';\r\n        //         design = replaceChildFromChildren(design, splitDropZonePath.split(\"-\"), childRecord)\r\n        //         return null;\r\n        //     })\r\n        // }\r\n        // if (selectedFieldRecord.childValue) {\r\n        //     let parentData = getcomponentdata(this.state.design, selectedFieldRecord.parentPath.split(\"-\"));\r\n        //     let newChildData = []\r\n        //     parentData.child.map(child => child.label === selectedFieldRecord.label ?\r\n        //         newChildData.push({ ...child, childPath: splitDropZonePath.split(\"-\").length === 4 ? splitDropZonePath : splitDropZonePath + '-0' }) :\r\n        //         newChildData.push(child))\r\n        //     parentData = { ...parentData, child: newChildData };\r\n        //     design = replaceChildFromChildren(design, selectedFieldRecord.parentPath.split(\"-\"), parentData)\r\n\r\n        // }\r\n        const components = this.getComponents(design)\r\n        let validComponents = getValidComponent(selectedFieldRecord, components, this.props.Login.columnInfo)\r\n        this.setState({ showConfirmAlert: false, toBeDeleted: {}, design, selectedFieldRecord: selectedFieldRecord, components, validComponents, selectedComponentpath: splitDropZonePath.split(\"-\").length > 1 ? splitDropZonePath : '0-0-' + splitDropZonePath })\r\n    }\r\n    updatePath = (design) => {\r\n        design.map((row, rowIndex) =>\r\n            row.children.map((column, columnIndex) =>\r\n                column.children.map((componnetrow, compRowIndex) => {\r\n                    if (componnetrow.hasOwnProperty('children')) {\r\n                        componnetrow.children.map((component, compIndex) => {\r\n                            if (component.child) {\r\n                                let newChild = [];\r\n                                component.child.map(childComp => {\r\n                                    const obj = this.getIndexByLabel(design, childComp.label);\r\n                                    newChild.push({ ...childComp, childPath: obj.path });\r\n                                    const newObj = { ...obj.object, parentPath: `${rowIndex}-${columnIndex}-${compRowIndex}-${compIndex}` };\r\n                                    design = replaceChildFromChildren(design, obj.path.split(\"-\"), newObj);\r\n                                })\r\n                                component = { ...component, child: newChild }\r\n                                design = replaceChildFromChildren(design, [rowIndex, columnIndex, compRowIndex, compIndex], component);\r\n                            }\r\n                        })\r\n                    } else {\r\n                        if (componnetrow.child) {\r\n                            let newChild = [];\r\n                            componnetrow.child.map(childComp => {\r\n                                const obj = this.getIndexByLabel(design, childComp.label);\r\n                                newChild.push({ ...childComp, childPath: obj.path });\r\n                                const newObj = { ...obj.object, parentPath: `${rowIndex}-${columnIndex}-${compRowIndex}-0` };\r\n                                design = replaceChildFromChildren(design, obj.path.split(\"-\"), newObj);\r\n                            })\r\n                            componnetrow = { ...componnetrow, child: newChild }\r\n                            design = replaceChildFromChildren(design, [rowIndex, columnIndex, compRowIndex, 0], componnetrow);\r\n                        }\r\n                    }\r\n                })\r\n            )\r\n        )\r\n        return design;\r\n    }\r\n    getIndexByLabel(design, label) {\r\n        let obj = {};\r\n        design.map((row, rowIndex) =>\r\n            row.children.map((column, columnIndex) =>\r\n                column.children.map((componnetrow, compRowIndex) => {\r\n                    if (componnetrow.hasOwnProperty('children')) {\r\n                        componnetrow.children.map((component, compIndex) => {\r\n                            if (component.label === label) {\r\n                                obj = {\r\n                                    object: component,\r\n                                    path: `${rowIndex}-${columnIndex}-${compRowIndex}-${compIndex}`\r\n                                }\r\n                                // break;\r\n                            }\r\n\r\n                            return null;\r\n                        })\r\n                    } else {\r\n                        if (componnetrow.label === label) {\r\n                            obj = {\r\n                                object: componnetrow,\r\n                                path: `${rowIndex}-${columnIndex}-${compRowIndex}-0`\r\n                            }\r\n                            // return obj;\r\n                            // break;\r\n                        }\r\n                    }\r\n                    return null;\r\n                })\r\n            )\r\n        )\r\n        return obj;\r\n    }\r\n    validateDelete = (design, splitDropZonePath) => {\r\n        const path = splitDropZonePath.split(\"-\")\r\n        let showAlert = false;\r\n        let toBeDeleted = {};\r\n        // let component = {}\r\n        // let row = this.state.design[path[0]]\r\n        // let column = row.children[path[1]]\r\n        // let compRow = column.children[path[2]]\r\n        // if (compRow.type === 'componentrow')\r\n        //     component = compRow.children[path[3]]\r\n        // else\r\n        //     component = compRow\r\n        let component = getcomponentdata(this.state.design, path)\r\n        if (component.child && component.child.length > 0) {\r\n\r\n            let childRecord = {}\r\n            component.child.map(myChild => {\r\n                childRecord = getcomponentdata(design, myChild.childPath.split(\"-\"))\r\n                childRecord['childValue'] = undefined;\r\n                childRecord['parentPath'] = undefined;\r\n                childRecord['valuecolumn'] = undefined;\r\n                if (myChild.componentcode !== ReactComponents.COMBO) {\r\n                    childRecord['column'] = undefined;\r\n                }\r\n                design = replaceChildFromChildren(design, myChild.childPath.split(\"-\"), childRecord)\r\n                return null;\r\n            })\r\n            showAlert = true;\r\n            toBeDeleted = { design, splitDropZonePath, deleteComponent: component }\r\n            // this.showAlert(true, toBeDeleted);\r\n        }\r\n        if (component.childValue) {\r\n            let parentData = getcomponentdata(this.state.design, component.parentPath.split(\"-\"));\r\n            let newChildData = parentData.child.filter(child => child.label !== component.label)\r\n            parentData = { ...parentData, child: newChildData };\r\n            design = replaceChildFromChildren(design, component.parentPath.split(\"-\"), parentData)\r\n            toBeDeleted = { design, splitDropZonePath, deleteComponent: component }\r\n\r\n        }\r\n        if (showAlert) {\r\n            this.showAlert(true, toBeDeleted);\r\n        }\r\n        else {\r\n            this.setLayout(design, splitDropZonePath, true)\r\n        }\r\n    }\r\n    confirmAlert = () => {\r\n        this.confirmMessage.confirm(\"Warning\", \"Warning\",\r\n            this.props.intl.formatMessage({ id: \"IDS_PARENTCOMPONENTCANNOTBEDELETED\" }),\r\n            this.props.intl.formatMessage({ id: \"IDS_OK\" }),\r\n            this.props.intl.formatMessage({ id: \"IDS_CANCEL\" }),\r\n            () => this.setLayout(this.state.toBeDeleted.design, this.state.toBeDeleted.splitDropZonePath, true, true),\r\n            undefined,\r\n            () => this.showAlert(false));\r\n    }\r\n    showAlert = (bool, toBeDeleted) => {\r\n        // const updateInfo = {\r\n        //     typeName: DEFAULT_RETURN,\r\n        //     data: { showConfirmAlert: bool, toBeDeleted }\r\n        // }\r\n        // this.props.updateStore(updateInfo);\r\n        this.setState({ showConfirmAlert: bool, toBeDeleted })\r\n    }\r\n    onclickcomponent = (event, data, path) => {\r\n        const selectedFieldRecord = { ...data }\r\n        const components = this.getComponents(this.state.design)\r\n        let componentData = { components, selectedComponentpath: path }\r\n\r\n        if (selectedFieldRecord.componentcode === ReactComponents.COMBO &&\r\n            selectedFieldRecord.source &&\r\n            (this.props.Login.columnInfo === undefined ||\r\n                this.props.Login.columnInfo[selectedFieldRecord.source] === undefined)) {\r\n            this.props.getTableColumns(this.state.design, selectedFieldRecord,\r\n                selectedFieldRecord.source, this.props.Login.userInfo,\r\n                \"\", this.props.Login.columnInfo, componentData)\r\n        } else {\r\n            const validComponents = getValidComponent(selectedFieldRecord, components, this.props.Login.columnInfo)\r\n            let tableColumn = selectedFieldRecord.source ? this.props.Login.columnInfo[selectedFieldRecord.source].tableColumn : [];\r\n            if (selectedFieldRecord.componentcode !== ReactComponents.COMBO) {\r\n                if (this.props.Login.columnInfo && selectedFieldRecord.childValue && this.props.Login.columnInfo[selectedFieldRecord.childValue.source]) {\r\n                    tableColumn = this.props.Login.columnInfo[selectedFieldRecord.childValue.source].tableColumn;\r\n                    this.setState({\r\n                        selectedComponentpath: path,\r\n                        selectedFieldRecord: selectedFieldRecord,\r\n                        components,\r\n                        tableColumn,\r\n                        validComponents\r\n                    })\r\n                } else {\r\n                    if (selectedFieldRecord.childValue) {\r\n                        this.props.getTableColumns(this.state.design, selectedFieldRecord,\r\n                            selectedFieldRecord.childValue.source, this.props.Login.userInfo,\r\n                            \"\", this.props.Login.columnInfo, componentData);\r\n                    } else {\r\n                        this.setState({\r\n                            selectedComponentpath: path,\r\n                            selectedFieldRecord: selectedFieldRecord,\r\n                            components,\r\n                            tableColumn,\r\n                            validComponents\r\n                        })\r\n                    }\r\n                }\r\n            } else {\r\n                this.setState({\r\n                    selectedComponentpath: path,\r\n                    selectedFieldRecord: selectedFieldRecord,\r\n                    components,\r\n                    tableColumn,\r\n                    validComponents\r\n                })\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n    getComponents = (design) => {\r\n        let components = [];\r\n        design.map((row, rowIndex) => {\r\n            row.children.map((column, columnIndex) => {\r\n                column.children.map((componnet, compindex) =>\r\n                    componnet.hasOwnProperty(\"children\") ?\r\n                        componnet.children.map((componnetrow, compRowIndex) =>\r\n                            componnetrow.label && components.push({\r\n                                label: componnetrow.label,\r\n                                value: componnetrow.label,\r\n                                // item: componnetrow,\r\n                                source: componnetrow.source,\r\n                                child: componnetrow.child,\r\n                                valuemember: componnetrow.valuemember,\r\n                                path: `${rowIndex}-${columnIndex}-${compindex}-${compRowIndex}`\r\n                            })\r\n                        )\r\n                        :\r\n                        componnet.label && components.push({\r\n                            label: componnet.label,\r\n                            value: componnet.label,\r\n                            // item: componnet,\r\n                            source: componnet.source,\r\n                            child: componnet.child,\r\n                            valuemember: componnet.valuemember,\r\n                            path: `${rowIndex}-${columnIndex}-${compindex}-0`\r\n                        })\r\n                )\r\n                return null;\r\n            })\r\n            return null;\r\n        })\r\n        return components;\r\n    }\r\n    getValueMembers = (selectedFieldRecord) => {\r\n        if (selectedFieldRecord.childValue) {\r\n            let valueColumn = [];\r\n            this.props.Login.columnInfo &&\r\n                this.props.Login.columnInfo[selectedFieldRecord.source] &&\r\n                this.props.Login.columnInfo[selectedFieldRecord.source].numericColumns.map(x => {\r\n                    if (x.foriegntablename === selectedFieldRecord.childValue.source)\r\n                        valueColumn.push(\r\n                            {\r\n                                label: x.displayname[this.props.Login.userInfo.language],\r\n                                value: x.tablecolumnname\r\n                            }\r\n                        )\r\n                    return null;\r\n                })\r\n            if (valueColumn.length) {\r\n\r\n                return valueColumn;\r\n\r\n            } else {\r\n                this.props.Login.columnInfo &&\r\n                    this.props.Login.columnInfo[selectedFieldRecord.childValue.source] &&\r\n                    this.props.Login.columnInfo[selectedFieldRecord.childValue.source].numericColumns.map(x => {\r\n                        if (x.foriegntablename === selectedFieldRecord.source)\r\n                            valueColumn.push(\r\n                                {\r\n                                    label: x.displayname[this.props.Login.userInfo.language],\r\n                                    value: x.tablecolumnname\r\n                                }\r\n                            )\r\n                        return null;\r\n                    })\r\n                return valueColumn;\r\n            }\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    onInputOnChange = (event) => {\r\n        const selectedFieldRecord = this.state.selectedFieldRecord || {};\r\n        if (event.target.type === 'checkbox') {\r\n            if (event.target.name === 'timeonly') {\r\n                selectedFieldRecord['dateonly'] = false;\r\n            }\r\n            if (event.target.name === 'dateonly') {\r\n                selectedFieldRecord['timeonly'] = false;\r\n            }\r\n            selectedFieldRecord[event.target.name] = event.target.checked;\r\n        }\r\n        else {\r\n            if (event.target.name === 'label') {\r\n                selectedFieldRecord[event.target.name] = event.target.value;\r\n                selectedFieldRecord['displayname'] = {\r\n                    ...selectedFieldRecord['displayname'],\r\n                    [this.props.Login.language]:event.target.value\r\n                }\r\n            } else {\r\n                selectedFieldRecord[event.target.name] = event.target.value;\r\n            }\r\n        }\r\n        \r\n        // this.setState({ selectedFieldRecord });\r\n        this.saveComponentProperties(selectedFieldRecord)\r\n    }\r\n    onNumericInputChange = (event) => {\r\n        const selectedFieldRecord = this.state.selectedFieldRecord || {};\r\n        let value = event.target.value;\r\n        if (!isNaN(value)) {\r\n            // if (parseInt(value) < 10) {\r\n            selectedFieldRecord[event.target.name] = value;\r\n            this.saveComponentProperties(selectedFieldRecord);\r\n            // }\r\n        }\r\n    }\r\n    onComboChange = (comboData, comboName) => {\r\n        let { selectedFieldRecord } = this.state;\r\n        if (selectedFieldRecord.label) {\r\n            if (comboName === 'table') {\r\n                selectedFieldRecord[comboName] = comboData;\r\n                selectedFieldRecord['source'] = comboData.value;\r\n                const splititemarray = this.state.selectedComponentpath.split(\"-\")\r\n                const newdata = { ...selectedFieldRecord }\r\n                const design = replaceChildFromChildren(this.state.design, splititemarray, newdata)\r\n                this.props.getTableColumns(design, selectedFieldRecord, comboData.value, this.props.Login.userInfo, splititemarray, this.props.Login.columnInfo)\r\n            } else if (comboName === 'column') {\r\n                selectedFieldRecord[comboName] = comboData;\r\n                selectedFieldRecord['displaymember'] = comboData.value;\r\n                if (comboData.item.ismultilingual) {\r\n                    selectedFieldRecord['isMultiLingual'] = true;\r\n                }\r\n                const splititemarray = this.state.selectedComponentpath.split(\"-\")\r\n                const newdata = { ...selectedFieldRecord }\r\n                const design = replaceChildFromChildren(this.state.design, splititemarray, newdata)\r\n                this.setState({ design, selectedFieldRecord })\r\n            } else if (comboName === 'childValue') {\r\n                if (comboData) {\r\n                    // selectedFieldRecord[comboName] = comboData;\r\n                    const splititemarray = this.state.selectedComponentpath.split(\"-\")\r\n                    let design = this.state.design\r\n                    if (selectedFieldRecord.parentPath) {\r\n                        let oldParentData = getcomponentdata(this.state.design, selectedFieldRecord.parentPath.split(\"-\"));\r\n                        if (oldParentData.child) {\r\n                            let newChildData1 = oldParentData.child.filter(child => child.label !== selectedFieldRecord.label);\r\n                            oldParentData = { ...oldParentData, child: newChildData1 };\r\n                            design = replaceChildFromChildren(this.state.design, selectedFieldRecord.parentPath.split(\"-\"), oldParentData)\r\n                        }\r\n\r\n                    }\r\n                    let parentData = getcomponentdata(design, comboData.path.split(\"-\"));\r\n                    selectedFieldRecord['childValue'] = comboData\r\n                    selectedFieldRecord['parentPath'] = comboData.path\r\n                    const newdata = { ...selectedFieldRecord }\r\n                    design = replaceChildFromChildren(design, splititemarray, newdata)\r\n                    let newChildData = parentData.child || [];\r\n                    let validateChild = newChildData.filter(x => x.label === selectedFieldRecord.label)\r\n                    if (validateChild.length === 0) {\r\n                        let valueMemberOptions = this.getValueMembers(selectedFieldRecord);\r\n                        if (valueMemberOptions.length === 1) {\r\n                            newChildData.push({ label: selectedFieldRecord.label, tablecolumnname: valueMemberOptions[0].value, childPath: this.state.selectedComponentpath })\r\n                        } else {\r\n                            newChildData.push({ label: selectedFieldRecord.label, childPath: this.state.selectedComponentpath })\r\n                        }\r\n\r\n                    }\r\n                    parentData = { ...parentData, child: newChildData };\r\n                    design = replaceChildFromChildren(design, comboData.path.split(\"-\"), parentData)\r\n                    if (selectedFieldRecord.componentcode === ReactComponents.COMBO) {\r\n                        this.setState({ design, selectedFieldRecord });\r\n                    } else {\r\n                        this.props.getTableColumns(design, selectedFieldRecord,\r\n                            selectedFieldRecord.childValue.source, this.props.Login.userInfo,\r\n                            splititemarray, this.props.Login.columnInfo,\r\n                            { components: this.state.components, selectedComponentpath: this.state.selectedComponentpath },\r\n                            true)\r\n                    }\r\n\r\n                } else {\r\n\r\n                    const splititemarray = this.state.selectedComponentpath.split(\"-\")\r\n\r\n                    let parentData = getcomponentdata(this.state.design, selectedFieldRecord.parentPath.split(\"-\"));\r\n                    let newChildData = parentData.child.filter(child => child.label !== selectedFieldRecord.label)\r\n                    parentData = { ...parentData, child: newChildData };\r\n                    let design = replaceChildFromChildren(this.state.design, selectedFieldRecord.parentPath.split(\"-\"), parentData)\r\n                    selectedFieldRecord['childValue'] = comboData\r\n                    if (selectedFieldRecord.componentcode !== ReactComponents.COMBO)\r\n                        selectedFieldRecord['column'] = comboData\r\n                    const newdata = { ...selectedFieldRecord }\r\n                    design = replaceChildFromChildren(design, splititemarray, newdata)\r\n                    if (selectedFieldRecord.componentcode === ReactComponents.COMBO) {\r\n                        this.setState({ design, selectedFieldRecord });\r\n                    } else {\r\n                        this.setState({ design, selectedFieldRecord, tableColumn: [] })\r\n                    }\r\n                }\r\n\r\n            } else if (comboName === 'valuecolumn') {\r\n                selectedFieldRecord['valuecolumn'] = comboData;\r\n                let parentData = getcomponentdata(this.state.design, selectedFieldRecord.parentPath.split(\"-\"));\r\n                let newChildData = []\r\n                parentData.child.map(child => {\r\n                    if (child.label === selectedFieldRecord.label) {\r\n                        newChildData.push({\r\n                            ...child, tablecolumnname: comboData.value\r\n                        })\r\n                    } else {\r\n                        newChildData.push(child)\r\n                    }\r\n                    return null;\r\n                })\r\n                parentData = { ...parentData, child: newChildData };\r\n                let design = replaceChildFromChildren(this.state.design, selectedFieldRecord.parentPath.split(\"-\"), parentData)\r\n                const newdata = { ...selectedFieldRecord }\r\n                design = replaceChildFromChildren(design, this.state.selectedComponentpath.split(\"-\"), newdata)\r\n                this.setState({ design, selectedFieldRecord });\r\n            } else {\r\n                selectedFieldRecord[comboName] = comboData;\r\n                const splititemarray = this.state.selectedComponentpath.split(\"-\")\r\n                const newdata = { ...selectedFieldRecord }\r\n                const design = replaceChildFromChildren(this.state.design, splititemarray, newdata)\r\n                this.setState({ design, selectedFieldRecord });\r\n            }\r\n        } else {\r\n            toast.warn(this.props.intl.formatMessage({id:\"IDS_ENTERLABEL\"}))\r\n        }\r\n\r\n    }\r\n    addTag = (tags) => {\r\n        const selectedFieldRecord = this.state.selectedFieldRecord || {};\r\n\r\n        selectedFieldRecord['radioOptions'] = tags;\r\n        this.saveComponentProperties(selectedFieldRecord);\r\n\r\n    }\r\n    saveComponentProperties = (selectedFieldRecord) => {\r\n        const splititemarray = this.state.selectedComponentpath.split(\"-\")\r\n        // const selectedFieldRecord = this.state.selectedFieldRecord;\r\n        const newdata = { ...selectedFieldRecord }\r\n        const design = replaceChildFromChildren(this.state.design, splititemarray, newdata)\r\n        this.setState({ design, selectedFieldRecord })\r\n    }\r\n    handleSaveClick = (saveType) => {\r\n        if (this.state.selectedRecord.templateName && this.state.selectedRecord.templateName !== \"\") {\r\n            let inputData = [];\r\n            let selectedId = null;\r\n            inputData[\"userinfo\"] = this.props.Login.userInfo;\r\n            let dataState = undefined;\r\n            if (this.props.Login.operation === \"update\") {\r\n                // edit\r\n                selectedId = this.state.selectedRecord.nchecklistqbcode\r\n                dataState = this.state.dataState\r\n                inputData[\"registrationtemplate\"] = {\r\n                    nreactregtemplatecode: this.props.Login.masterData.selectedTemplate.nreactregtemplatecode,\r\n                    nsampletypecode: this.props.nsampletypecode,\r\n                    sregtemplatename: this.state.selectedRecord.templateName,\r\n                    jsonString: JSON.stringify(this.state.design),\r\n                    jsondata:this.state.design,\r\n                    ntransactionstatus: transactionStatus.DRAFT\r\n                }\r\n            }\r\n            else {\r\n                //add               \r\n                inputData[\"registrationtemplate\"] =\r\n                {\r\n                    nsampletypecode: this.props.nsampletypecode,\r\n                    sregtemplatename: this.state.selectedRecord.templateName,\r\n                    jsonString: JSON.stringify(this.state.design),\r\n                    ntransactionstatus: transactionStatus.DRAFT\r\n                };\r\n            }\r\n            const postParam = {\r\n                inputListName: \"RegistrationTemplate\",\r\n                selectedObject: \"selectedTemplate\",\r\n                primaryKeyField: \"nreactregtemplatecode\",\r\n                fetchUrl: \"dynamicpreregdesign/getRegistrationTemplateById\",\r\n                fecthInputObject: {\r\n                    userinfo: this.props.Login.userInfo, nsampletypecode: this.props.nsampletypecode\r\n                },\r\n                masterData: this.props.Login.masterData\r\n            }\r\n            const inputParam = {\r\n                methodUrl: 'RegistrationTemplate',\r\n                classUrl: 'dynamicpreregdesign',\r\n                displayName: this.props.Login.inputParam.displayName ? this.props.Login.inputParam.displayName : '',\r\n                inputData: inputData,postParam,\r\n                searchRef: this.props.searchRef,\r\n                operation: this.props.Login.operation,\r\n                saveType, dataState, selectedId\r\n            }\r\n            const masterData = this.props.Login.masterData;\r\n\r\n            if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolcode)) {\r\n                const updateInfo = {\r\n                    typeName: DEFAULT_RETURN,\r\n                    data: {\r\n                        loadEsign: true, screenData: { inputParam, masterData }, saveType\r\n                    }\r\n                }\r\n                this.props.updateStore(updateInfo);\r\n            }\r\n            else {\r\n                this.props.crudMaster(inputParam, masterData, \"openPortal\");\r\n            }\r\n        } else {\r\n            toast.info(this.props.intl.formatMessage({id:\"IDS_ENTERTEMPLATENAME\"}))\r\n        }\r\n    }\r\n}\r\nexport default connect(mapStateToProps, { updateStore, crudMaster, getTableColumns })(injectIntl(PreRegDesignPopUp))"]},"metadata":{},"sourceType":"module"}