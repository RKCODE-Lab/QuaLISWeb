{"ast":null,"code":"import _classCallCheck from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';//createRef\nimport{connect}from'react-redux';import{injectIntl}from'react-intl';import{Row,Col}from'react-bootstrap';import{Grid,GridColumn,GridColumnMenuFilter}from'@progress/kendo-react-grid';import{Draggable,Droppable}from'react-drag-and-drop';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faGripVertical}from'@fortawesome/free-solid-svg-icons';import FormInput from'../../components/form-input/form-input.component';import FormTextarea from'../../components/form-textarea/form-textarea.component';import FormSelectSearch from'../../components/form-select-search/form-select-search.component';import{callService,crudMaster,validateEsignCredential,updateStore,getSQLQueryDetail,getSQLQueryComboService,filterColumnData,comboChangeQueryType,executeUserQuery,comboColumnValues,getColumnNamesByTableName}from'../../actions';import{AtTableWrap}from'../../components/data-grid/data-grid.styles';import{process}from'@progress/kendo-data-query';import ColumnMenu from'../../components/data-grid/ColumnMenu';import{tableType,queryTypeFilter}from'../../components/Enumeration';var AddQuery=/*#__PURE__*/function(_Component){_inherits(AddQuery,_Component);var _super=_createSuper(AddQuery);function AddQuery(_props){var _this;_classCallCheck(this,AddQuery);_this=_super.call(this,_props);_this.tableDataStateChange=function(event){_this.setState({dataStateTable:event.dataState});};_this.expandChange=function(event){event.dataItem.expanded=!event.dataItem.expanded;_this.forceUpdate();};_this.detailBand=function(props){var columnName=_this.props.tableList.filter(function(p){return p.stable===props.dataItem.tableName;});return/*#__PURE__*/React.createElement(Grid,{data:columnName//resizable\n//scrollable={\"scrollable\"}\n},/*#__PURE__*/React.createElement(GridColumn,{width:\"48px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Draggable,{type:'dragcolumn',data:row.dataItem.stable+\".\"+row.dataItem.scolumn},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faGripVertical,className:\"dragicon\"})));}}),/*#__PURE__*/React.createElement(GridColumn,{width:\"336px\",field:\"scolumn\",title:_this.props.intl.formatMessage({id:\"IDS_COLUMN_NAME\"})}));};_this.state={dataStateTable:{skip:0}};return _this;}_createClass(AddQuery,[{key:\"columnProps\",value:function columnProps(field){if(!this.props.hideColumnFilter){return{field:field,columnMenu:ColumnMenu,headerClassName:this.isColumnActive(field,this.state.dataStateTable)?'active':''};}}},{key:\"isColumnActive\",value:function isColumnActive(field,dataState){return GridColumnMenuFilter.active(field,dataState.filter);}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:6},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:12},/*#__PURE__*/React.createElement(FormSelectSearch,{name:\"ntabletypecode\",formLabel:this.props.intl.formatMessage({id:\"IDS_TABLETYPE\"}),isSearchable:false,isDisabled:false,isMulti:false,placeholder:\"Please Select...\",isMandatory:true,options:this.props.tableType// optionId='ntabletypecode'\n// optionValue='stabletype'\n,defaultValue:this.props.selectedTableType[\"ntabletypecode\"],showOption:true,required:true,value:this.props.selectedTableType[\"ntabletypecode\"]?this.props.selectedTableType[\"ntabletypecode\"]:\"\",closeMenuOnSelect:true,alphabeticalSort:true,onChange:function onChange(event){return _this2.props.onComboChange(event,'ntabletypecode');}//  sortField={\"ntabletypecode\"}\n//  sortOrder={\"ascending\"}\n}),this.props.tableTypeCode===tableType.ALL?\"\":/*#__PURE__*/React.createElement(FormSelectSearch,{name:\"nformcode\",formLabel:this.props.intl.formatMessage({id:this.props.tableTypeCode===tableType.MODULES?\"IDS_MODULENAME\":this.props.tableTypeCode===tableType.FORMS?\"IDS_FORMNAME\":\"IDS_FORMNAME\"}),isSearchable:true,isDisabled:this.props.tableTypeCode===tableType.ALL?true:false,isMulti:false,placeholder:\"Please Select...\",isMandatory:true,options:this.props.moduleFormName||[],optionId:\"nformcode\",optionValue:\"sformname\",defaultValue:this.props.selectedRecord[\"nformcode\"],showOption:true,required:true,value:this.props.selectedRecord[\"nformcode\"]?this.props.selectedRecord[\"nformcode\"]:\"\",closeMenuOnSelect:true//alphabeticalSort={true}\n,onChange:function onChange(event){return _this2.props.onComboChange(event,'nformcode');}//sortField={\"nformcode\"}\n//sortOrder={\"ascending\"}\n}),/*#__PURE__*/React.createElement(AtTableWrap,{className:\"at-list-table\"},/*#__PURE__*/React.createElement(Grid,{style:{height:'600px'},data:process(this.props.tableName,this.state.dataStateTable)//{...this.dataStateTable}\n,onDataStateChange:this.tableDataStateChange,dataState:this.state.dataStateTable,detail:this.detailBand,expandField:\"expanded\",onExpandChange:this.expandChange//data={process(this.props.tableList, this.props.dataStateTable)}\n},/*#__PURE__*/React.createElement(GridColumn,{width:\"48px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Draggable,{type:\"dragtable\",data:row.dataItem.tableName},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faGripVertical,className:\"dragicon\"})));}}),/*#__PURE__*/React.createElement(GridColumn,Object.assign({width:\"425px\",field:\"tableName\"},this.columnProps(\"tableName\"),{title:this.props.intl.formatMessage({id:\"IDS_TABLE_NAME\"})}))))))),/*#__PURE__*/React.createElement(Col,{md:6},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:12},/*#__PURE__*/React.createElement(FormInput,{name:\"ssqlqueryname\",label:this.props.intl.formatMessage({id:\"IDS_SQLQUERYNAME\"}),type:\"text\",onChange:function onChange(event){return _this2.props.onInputOnChange(event);},placeholder:this.props.intl.formatMessage({id:\"IDS_SQLQUERYNAME\"}),value:this.props.selectedRecord[\"ssqlqueryname\"],isMandatory:true,required:true,maxLength:100}),/*#__PURE__*/React.createElement(Droppable,{types:['dragcolumn','dragtable'],onDrop:function onDrop(event){return _this2.props.onDrop(event);}},/*#__PURE__*/React.createElement(FormTextarea,{name:\"ssqlquery\",label:this.props.intl.formatMessage({id:\"IDS_SQLQUERY\"}),onChange:function onChange(event){return _this2.props.onInputOnChange(event);},placeholder:this.props.intl.formatMessage({id:\"IDS_SQLQUERY\"}),value:this.props.selectedRecord[\"ssqlquery\"],rows:15,isMandatory:true,required:true,maxLength:10000})),this.props.queryTypeCode===queryTypeFilter.LIMSALERTQUERY&&/*#__PURE__*/React.createElement(FormInput,{name:\"sscreenheader\",label:this.props.intl.formatMessage({id:\"IDS_SCREENHEADER\"}),type:\"text\",onChange:function onChange(event){return _this2.props.onInputOnChange(event);},placeholder:this.props.intl.formatMessage({id:\"IDS_SCREENHEADER\"}),value:this.props.selectedRecord[\"sscreenheader\"],isMandatory:true,required:true,maxLength:100,isDisabled:this.props.queryTypeCode===2?false:true}),this.props.queryTypeCode===queryTypeFilter.LIMSFILTERQUERY&&/*#__PURE__*/React.createElement(FormInput,{name:\"svaluemember\",label:this.props.intl.formatMessage({id:\"IDS_SVALUEMEMBER\"}),type:\"text\",onChange:function onChange(event){return _this2.props.onInputOnChange(event);},placeholder:this.props.intl.formatMessage({id:\"IDS_SVALUEMEMBER\"}),value:this.props.selectedRecord[\"svaluemember\"],isMandatory:true,required:true,maxLength:100}),this.props.queryTypeCode===queryTypeFilter.LIMSFILTERQUERY&&/*#__PURE__*/React.createElement(FormInput,{name:\"sdisplaymember\",label:this.props.intl.formatMessage({id:\"IDS_SDISPLAYMEMBER\"}),type:\"text\",onChange:function onChange(event){return _this2.props.onInputOnChange(event);},placeholder:this.props.intl.formatMessage({id:\"IDS_SDISPLAYMEMBER\"}),value:this.props.selectedRecord[\"sdisplaymember\"],isMandatory:true,required:true,maxLength:100}),this.props.queryTypeCode===queryTypeFilter.LIMSDASHBOARDQUERY&&/*#__PURE__*/React.createElement(FormSelectSearch,{name:\"ncharttypecode\",formLabel:this.props.intl.formatMessage({id:\"IDS_CHARTTYPE\"}),isSearchable:true,placeholder:\"Please Select...\",isMandatory:true,options:this.props.chartList,optionId:\"ncharttypecode\",optionValue:\"schartname\",value:this.props.selectedRecord[\"ncharttypecode\"],defaultValue:this.props.selectedRecord[\"ncharttypecode\"],onChange:function onChange(event){return _this2.props.onComboChange(event,'ncharttypecode');},closeMenuOnSelect:true,alphabeticalSort:true,isDisabled:this.props.queryTypeCode===1?false:true})))));}}]);return AddQuery;}(Component);var mapStateToProps=function mapStateToProps(state){return{Login:state.Login};};export default connect(mapStateToProps,{callService:callService,crudMaster:crudMaster,updateStore:updateStore,filterColumnData:filterColumnData,validateEsignCredential:validateEsignCredential,getSQLQueryDetail:getSQLQueryDetail,getSQLQueryComboService:getSQLQueryComboService,comboChangeQueryType:comboChangeQueryType,executeUserQuery:executeUserQuery,comboColumnValues:comboColumnValues,getColumnNamesByTableName:getColumnNamesByTableName})(injectIntl(AddQuery));","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/pages/dashboard/AddQuery.jsx"],"names":["React","Component","connect","injectIntl","Row","Col","Grid","GridColumn","GridColumnMenuFilter","Draggable","Droppable","FontAwesomeIcon","faGripVertical","FormInput","FormTextarea","FormSelectSearch","callService","crudMaster","validateEsignCredential","updateStore","getSQLQueryDetail","getSQLQueryComboService","filterColumnData","comboChangeQueryType","executeUserQuery","comboColumnValues","getColumnNamesByTableName","AtTableWrap","process","ColumnMenu","tableType","queryTypeFilter","AddQuery","props","tableDataStateChange","event","setState","dataStateTable","dataState","expandChange","dataItem","expanded","forceUpdate","detailBand","columnName","tableList","filter","p","stable","tableName","row","scolumn","intl","formatMessage","id","state","skip","field","hideColumnFilter","columnMenu","headerClassName","isColumnActive","active","selectedTableType","onComboChange","tableTypeCode","ALL","MODULES","FORMS","moduleFormName","selectedRecord","height","columnProps","onInputOnChange","onDrop","queryTypeCode","LIMSALERTQUERY","LIMSFILTERQUERY","LIMSDASHBOARDQUERY","chartList","mapStateToProps","Login"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';//createRef\r\nimport { connect } from 'react-redux';\r\nimport { injectIntl } from 'react-intl';\r\nimport { Row, Col } from 'react-bootstrap';\r\nimport { Grid, GridColumn, GridColumnMenuFilter } from '@progress/kendo-react-grid';\r\nimport { Draggable, Droppable } from 'react-drag-and-drop';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faGripVertical } from '@fortawesome/free-solid-svg-icons';\r\nimport FormInput from '../../components/form-input/form-input.component';\r\nimport FormTextarea from '../../components/form-textarea/form-textarea.component';\r\nimport FormSelectSearch from '../../components/form-select-search/form-select-search.component'\r\nimport {\r\n    callService, crudMaster, validateEsignCredential, updateStore, getSQLQueryDetail,\r\n    getSQLQueryComboService, filterColumnData, comboChangeQueryType, executeUserQuery, comboColumnValues, getColumnNamesByTableName\r\n} from '../../actions';\r\nimport { AtTableWrap } from '../../components/data-grid/data-grid.styles';\r\nimport { process } from '@progress/kendo-data-query';\r\nimport ColumnMenu from '../../components/data-grid/ColumnMenu';\r\nimport { tableType,queryTypeFilter} from '../../components/Enumeration';\r\n\r\n\r\nclass AddQuery extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = ({\r\n            dataStateTable: { skip: 0 },\r\n        });\r\n\r\n    }\r\n    tableDataStateChange = (event) => {\r\n        this.setState({\r\n            dataStateTable: event.dataState\r\n        });\r\n    }\r\n    expandChange = (event) => {\r\n        event.dataItem.expanded = !event.dataItem.expanded;\r\n        this.forceUpdate();\r\n    }\r\n\r\n    detailBand = (props) => {\r\n        const columnName = this.props.tableList.filter(p => p.stable === props.dataItem.tableName)\r\n\r\n        return (\r\n            <Grid\r\n                data={columnName}\r\n                //resizable\r\n                //scrollable={\"scrollable\"}\r\n            >\r\n\r\n                <GridColumn\r\n                    width=\"48px\"\r\n                    cell={(row) => (\r\n                        <td>\r\n                            <Draggable type={'dragcolumn'} data={row.dataItem.stable + \".\" + row.dataItem.scolumn}>\r\n                                <FontAwesomeIcon icon={faGripVertical} className=\"dragicon\" />\r\n                            </Draggable>\r\n                        </td>\r\n                    )}\r\n                />\r\n\r\n                <GridColumn\r\n                    width={\"336px\"}\r\n                    field=\"scolumn\"\r\n                    title={this.props.intl.formatMessage({ id: \"IDS_COLUMN_NAME\" })}\r\n                />\r\n\r\n            </Grid>\r\n        );\r\n    }\r\n    columnProps(field) {\r\n        if (!this.props.hideColumnFilter) {\r\n            return {\r\n                field: field,\r\n                columnMenu: ColumnMenu,\r\n                headerClassName: this.isColumnActive(field, this.state.dataStateTable) ? 'active' : ''\r\n            };\r\n        }\r\n    }\r\n\r\n    isColumnActive(field, dataState) {\r\n        return GridColumnMenuFilter.active(field, dataState.filter)\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Row>\r\n                <Col md={6}>\r\n                    <Row>\r\n                        <Col md={12}>\r\n                        <FormSelectSearch\r\n                        name={\"ntabletypecode\"}\r\n                        formLabel={this.props.intl.formatMessage({ id: \"IDS_TABLETYPE\" })}\r\n                        isSearchable={false}\r\n                        isDisabled={false}\r\n                        isMulti={false}\r\n                        placeholder=\"Please Select...\"\r\n                        isMandatory={true}\r\n                        options={this.props.tableType}\r\n                        // optionId='ntabletypecode'\r\n                        // optionValue='stabletype'\r\n                        defaultValue={this.props.selectedTableType[\"ntabletypecode\"]}\r\n                        showOption={true}\r\n                        required={true}\r\n                        value={this.props.selectedTableType[\"ntabletypecode\"] ? this.props.selectedTableType[\"ntabletypecode\"] : \"\"}\r\n                        closeMenuOnSelect={true}\r\n                        alphabeticalSort={true}\r\n                        onChange={(event) => this.props.onComboChange(event, 'ntabletypecode')}\r\n                        //  sortField={\"ntabletypecode\"}\r\n                        //  sortOrder={\"ascending\"}\r\n\r\n                    >\r\n                    </FormSelectSearch>\r\n                    {this.props.tableTypeCode === tableType.ALL ? \"\":\r\n                    <FormSelectSearch\r\n                        name={\"nformcode\"}\r\n                        formLabel={this.props.intl.formatMessage({ id: this.props.tableTypeCode === tableType.MODULES ? \"IDS_MODULENAME\": this.props.tableTypeCode === tableType.FORMS ? \"IDS_FORMNAME\" : \"IDS_FORMNAME\" })}\r\n                        isSearchable={true}\r\n                        isDisabled={this.props.tableTypeCode === tableType.ALL ? true : false}\r\n                        isMulti={false}\r\n                        placeholder=\"Please Select...\"\r\n                        isMandatory={true}\r\n                        options={this.props.moduleFormName || [] }\r\n                        optionId='nformcode'\r\n                        optionValue='sformname'\r\n                        defaultValue={this.props.selectedRecord[\"nformcode\"]}\r\n                        showOption={true}\r\n                        required={true}\r\n                        value={this.props.selectedRecord[\"nformcode\"] ? this.props.selectedRecord[\"nformcode\"] : \"\"}\r\n                        closeMenuOnSelect={true}\r\n                        //alphabeticalSort={true}\r\n                        onChange={(event) => this.props.onComboChange(event, 'nformcode')}\r\n                         //sortField={\"nformcode\"}\r\n                         //sortOrder={\"ascending\"}\r\n\r\n                    >\r\n                    </FormSelectSearch>\r\n                    }\r\n                            <AtTableWrap className=\"at-list-table\">\r\n                                <Grid\r\n                                    style={{ height: '600px' }}\r\n                                    data={process(this.props.tableName, this.state.dataStateTable)}\r\n                                    //{...this.dataStateTable}\r\n                                    onDataStateChange={this.tableDataStateChange}\r\n                                    dataState={this.state.dataStateTable}\r\n                                    detail={this.detailBand}\r\n                                    expandField=\"expanded\"\r\n                                    onExpandChange={this.expandChange}\r\n                                //data={process(this.props.tableList, this.props.dataStateTable)}\r\n\r\n                                >\r\n                                    <GridColumn\r\n                                        width=\"48px\"\r\n                                        cell={(row) => (\r\n                                            <td >\r\n                                                <Draggable type=\"dragtable\" data={row.dataItem.tableName}>\r\n                                                    <FontAwesomeIcon icon={faGripVertical} className=\"dragicon\"></FontAwesomeIcon>\r\n                                                </Draggable>\r\n                                            </td>\r\n                                        )}\r\n                                    />\r\n\r\n                                    <GridColumn\r\n                                        width={\"425px\"}\r\n                                        field=\"tableName\"\r\n                                        {...this.columnProps(\"tableName\")}\r\n                                        title={this.props.intl.formatMessage({ id: \"IDS_TABLE_NAME\" })}\r\n                                    />\r\n                                </Grid>\r\n                            </AtTableWrap>\r\n                        </Col>\r\n                    </Row>\r\n                </Col>\r\n\r\n                <Col md={6}>\r\n                    <Row>\r\n                        <Col md={12}>\r\n                            <FormInput\r\n                                name={\"ssqlqueryname\"}\r\n                                label={this.props.intl.formatMessage({ id: \"IDS_SQLQUERYNAME\" })}\r\n                                type=\"text\"\r\n                                onChange={(event) => this.props.onInputOnChange(event)}\r\n                                placeholder={this.props.intl.formatMessage({ id: \"IDS_SQLQUERYNAME\" })}\r\n                                value={this.props.selectedRecord[\"ssqlqueryname\"]}\r\n                                isMandatory={true}\r\n                                required={true}\r\n                                maxLength={100}\r\n\r\n                            />\r\n\r\n                            <Droppable\r\n                                types={['dragcolumn', 'dragtable']}\r\n                                onDrop={event => this.props.onDrop(event)}\r\n                            >\r\n\r\n                                <FormTextarea\r\n                                    name={\"ssqlquery\"}\r\n                                    label={this.props.intl.formatMessage({ id: \"IDS_SQLQUERY\" })}\r\n                                    onChange={(event) => this.props.onInputOnChange(event)}\r\n                                    placeholder={this.props.intl.formatMessage({ id: \"IDS_SQLQUERY\" })}\r\n                                    value={this.props.selectedRecord[\"ssqlquery\"]}\r\n                                    rows={15}\r\n                                    isMandatory={true}\r\n                                    required={true}\r\n                                    maxLength={10000}\r\n                                />\r\n                            </Droppable>\r\n\r\n\r\n                            {/* {this.props.queryTypeCode === 12 &&\r\n                                <FormInput\r\n                                    name={\"sscreenrecordquery\"}\r\n                                    label={this.props.intl.formatMessage({ id: \"IDS_SCREENRECORDQUERY\" })}\r\n                                    type=\"text\"\r\n                                    onChange={(event) => this.props.onInputOnChange(event)}\r\n                                    placeholder={this.props.intl.formatMessage({ id: \"IDS_SCREENRECORDQUERY\" })}\r\n                                    value={this.props.selectedRecord[\"sscreenrecordquery\"]}\r\n                                    isMandatory={true}\r\n                                    required={true}\r\n                                    maxLength={100}\r\n                                    isDisabled={this.props.queryTypeCode === 2 ? false : true}\r\n                                    isVisible={false}\r\n                                />\r\n                            } */}\r\n                            {this.props.queryTypeCode ===  queryTypeFilter.LIMSALERTQUERY &&\r\n                                <FormInput\r\n                                    name={\"sscreenheader\"}\r\n                                    label={this.props.intl.formatMessage({ id: \"IDS_SCREENHEADER\" })}\r\n                                    type=\"text\"\r\n                                    onChange={(event) => this.props.onInputOnChange(event)}\r\n                                    placeholder={this.props.intl.formatMessage({ id: \"IDS_SCREENHEADER\" })}\r\n                                    value={this.props.selectedRecord[\"sscreenheader\"]}\r\n                                    isMandatory={true}\r\n                                    required={true}\r\n                                    maxLength={100}\r\n                                    isDisabled={this.props.queryTypeCode === 2 ? false : true}\r\n                                />\r\n                            }\r\n                            {this.props.queryTypeCode === queryTypeFilter.LIMSFILTERQUERY &&\r\n                                <FormInput\r\n                                    name={\"svaluemember\"}\r\n                                    label={this.props.intl.formatMessage({ id: \"IDS_SVALUEMEMBER\" })}\r\n                                    type=\"text\"\r\n                                    onChange={(event) => this.props.onInputOnChange(event)}\r\n                                    placeholder={this.props.intl.formatMessage({ id: \"IDS_SVALUEMEMBER\" })}\r\n                                    value={this.props.selectedRecord[\"svaluemember\"]}\r\n                                    isMandatory={true}\r\n                                    required={true}\r\n                                    maxLength={100}\r\n\r\n                                />\r\n                            }\r\n                            {this.props.queryTypeCode === queryTypeFilter.LIMSFILTERQUERY &&\r\n                                <FormInput\r\n                                    name={\"sdisplaymember\"}\r\n                                    label={this.props.intl.formatMessage({ id: \"IDS_SDISPLAYMEMBER\" })}\r\n                                    type=\"text\"\r\n                                    onChange={(event) => this.props.onInputOnChange(event)}\r\n                                    placeholder={this.props.intl.formatMessage({ id: \"IDS_SDISPLAYMEMBER\" })}\r\n                                    value={this.props.selectedRecord[\"sdisplaymember\"]}\r\n                                    isMandatory={true}\r\n                                    required={true}\r\n                                    maxLength={100}\r\n\r\n                                />\r\n                            }\r\n                            {this.props.queryTypeCode === queryTypeFilter.LIMSDASHBOARDQUERY &&\r\n                                <FormSelectSearch\r\n                                    name={\"ncharttypecode\"}\r\n                                    formLabel={this.props.intl.formatMessage({ id: \"IDS_CHARTTYPE\" })}\r\n                                    isSearchable={true}\r\n\r\n\r\n                                    placeholder=\"Please Select...\"\r\n                                    isMandatory={true}\r\n                                    options={this.props.chartList}\r\n                                    optionId='ncharttypecode'\r\n                                    optionValue='schartname'\r\n                                    value={this.props.selectedRecord[\"ncharttypecode\"]}\r\n                                    defaultValue={this.props.selectedRecord[\"ncharttypecode\"]}\r\n\r\n                                    onChange={(event) => this.props.onComboChange(event, 'ncharttypecode')}\r\n                                    closeMenuOnSelect={true}\r\n                                    alphabeticalSort={true}\r\n                                    isDisabled={this.props.queryTypeCode === 1 ? false : true}\r\n                                />\r\n                            }\r\n                        </Col>\r\n                    </Row>\r\n                </Col>\r\n            </Row>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        Login: state.Login\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, {\r\n    callService, crudMaster, updateStore, filterColumnData, validateEsignCredential, getSQLQueryDetail, getSQLQueryComboService, comboChangeQueryType, executeUserQuery, comboColumnValues, getColumnNamesByTableName\r\n})(injectIntl(AddQuery));"]},"metadata":{},"sourceType":"module"}