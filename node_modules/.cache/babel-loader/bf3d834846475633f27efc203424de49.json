{"ast":null,"code":"var _jsxFileName = \"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\src\\\\pages\\\\testmanagement\\\\MethodValidityView.jsx\";\nimport React, { Component } from \"react\";\nimport { toast } from \"react-toastify\";\nimport { injectIntl } from \"react-intl\";\nimport rsapi from \"../../rsapi\";\nimport { process } from \"@progress/kendo-data-query\";\nimport { Row } from \"react-bootstrap\";\nimport \"../../assets/styles/lims-global-theme.css\";\nimport SlideOutModal from \"../../components/slide-out-modal/SlideOutModal\";\nimport { DEFAULT_RETURN } from \"../../actions/LoginTypes\";\nimport { showEsign, getControlMap, create_UUID, onDropAttachFileList, convertDateValuetoString, deleteAttachmentDropZone, formatInputDate, rearrangeDateFormat } from \"../../components/CommonScript\";\nimport Esign from \"../audittrail/Esign\";\nimport AddMethodValidity from \"./AddMethodValidity\"; //import ValidateFormula from './ValidateFormula';\n\nimport { parameterType, transactionStatus, operators, attachmentType, FORMULAFIELDTYPE } from \"../../components/Enumeration\";\nimport CustomTab from \"../../components/custom-tabs/custom-tabs.component\";\nimport MethodValidityTab from \"./MethodValidityTab\";\nimport ConfirmMessage from \"../../components/confirm-alert/confirm-message.component\";\nimport { ChartLegendTitle } from \"@progress/kendo-react-charts\";\nimport { rearrangeDateFormatDateOnly } from './../../components/CommonScript';\n\nclass MethodValidityView extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleDateChange = (dateName, dateValue, sdatename) => {\n      const {\n        selectedRecord\n      } = this.state; // if(dateName === \"dvaliditystartdate\")\n      // {\n      //   selectedRecord[\"dvalidityenddate\"] = dateValue;  \n      // }\n\n      selectedRecord[dateName] = dateValue;\n      selectedRecord[sdatename] = dateValue;\n      this.setState({\n        selectedRecord\n      });\n    };\n\n    this.onTabChange = tabProps => {\n      const screenName = tabProps.screenName;\n      const updateInfo = {\n        typeName: DEFAULT_RETURN,\n        data: {\n          screenName\n        }\n      };\n      this.props.updateStore(updateInfo);\n    };\n\n    this.tabDetail = () => {\n      const tabMap = new Map();\n\n      for (let i = 0; i < this.props.masterData[\"MethodValidity\"].length; i++) {\n        this.props.masterData[\"MethodValidity\"][i].svaliditystartdate = rearrangeDateFormatDateOnly(this.props.userInfo, this.props.masterData[\"MethodValidity\"][i].svaliditystartdate);\n        this.props.masterData[\"MethodValidity\"][i].svalidityenddate = rearrangeDateFormatDateOnly(this.props.userInfo, this.props.masterData[\"MethodValidity\"][i].svalidityenddate);\n      }\n\n      tabMap.set(\"IDS_METHODVALIDITY\", /*#__PURE__*/React.createElement(MethodValidityTab, {\n        controlMap: this.props.controlMap,\n        userRoleControlRights: this.props.userRoleControlRights,\n        operation: this.props.operation,\n        dataResult: process(this.props.masterData[\"MethodValidity\"], this.props.screenName === undefined || this.props.screenName === \"IDS_METHODVALIDITY\" ? this.state.methodvalidityDataState : {\n          skip: 0,\n          take: 10\n        }),\n        dataState: this.props.screenName === undefined || this.props.screenName === \"IDS_METHODVALIDITY\" ? this.state.methodvalidityDataState : {\n          skip: 0,\n          take: 10\n        },\n        dataStateChange: event => this.setState({\n          methodvalidityDataState: event.dataState\n        }),\n        selectedMethod: this.props.masterData.SelectedMethod,\n        fetchMethodValidityById: this.props.fetchMethodValidityById,\n        editParam: this.props.editParam,\n        userInfo: this.props.userInfo,\n        inputParam: this.props.inputParam,\n        selectedComponent: this.state.selectedComponent,\n        handleComponentRowClick: this.handleComponentRowClick,\n        formatMessage: this.props.intl.formatMessage,\n        deleteRecord: this.deleteRecord,\n        onApproveClick: this.onApproveClick,\n        openChildModal: this.openChildModal,\n        defaultRecord: this.defaultRecord,\n        selectedId: this.props.selectedId,\n        getAvailableValidityData: this.props.getAvailableValidityData,\n        MethodValidity: this.props.masterData.MethodValidity || [],\n        screenName: \"IDS_METHODVALIDITY\",\n        approveParam: this.props.approveParam,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 7\n        }\n      }));\n      return tabMap;\n    };\n\n    this.handleComponentRowClick = event => {\n      let selectedComponent = event.dataItem; // let SelectedTest = this.props.Login.Test && this.props.Login.Test[selectedComponent.slno] ? this.props.Login.Test[selectedComponent.slno] : [];\n\n      const updateInfo = {\n        typeName: DEFAULT_RETURN,\n        data: {\n          operation: \"\" // SelectedTest, selectedComponent,\n          // testDataState: {\n          //     skip: 0, take: this.props.Login.settings ?\n          //         parseInt(this.props.Login.settings[14]) : 5\n          // }\n\n        }\n      };\n      this.props.updateStore(updateInfo);\n      this.setState({\n        selectedComponent\n      });\n    };\n\n    this.openChildModal = () => {\n      const addParam = {\n        screenName: \"IDS_METHOD\",\n        operation: \"create\",\n        primaryKeyName: \"nmethodvaliditycode\",\n        masterData: this.props.masterData,\n        userInfo: this.props.userInfo\n      };\n      this.props.getMethodValidityUTCDate(addParam); //let selectedRecord={};\n      // const updateInfo = {\n      //   typeName: DEFAULT_RETURN,\n      //   data: { openChildModal: true,operation:\"create\" },\n      // };//,selectedRecord\n      // this.props.updateStore(updateInfo);\n    };\n\n    this.onApproveClick = (selectedDataItem, operation, primaryKeyName) => {\n      if (selectedDataItem.dataItem.ntransactionstatus === transactionStatus.DRAFT) {\n        // if (this.state.selectedComponent.ntransactionstatus === transactionStatus.DRAFT) {\n        const approveId = this.props.controlMap.has(\"ApproveMethodValidity\") && this.props.controlMap.get(\"ApproveMethodValidity\").ncontrolcode;\n        let inputData = [];\n        inputData[\"userinfo\"] = this.props.userInfo; //add               \n\n        let postParam = undefined;\n        inputData[\"methodvalidity\"] = selectedDataItem.dataItem;\n        postParam = {\n          inputListName: \"MethodValidity\",\n          selectedObject: \"selectedComponent\",\n          primaryKeyField: \"nmethodvaliditycode\"\n        };\n        const inputParam = {\n          classUrl: \"method\",\n          methodUrl: \"MethodValidity\",\n          inputData: inputData,\n          operation: \"approve\",\n          postParam\n        };\n        let saveType;\n        const masterData = this.props.masterData;\n        const esignNeeded = showEsign(this.props.esignRights, this.props.userInfo.nformcode, approveId);\n\n        if (esignNeeded) {\n          const updateInfo = {\n            typeName: DEFAULT_RETURN,\n            data: {\n              loadEsign: true,\n              screenData: {\n                inputParam,\n                masterData\n              },\n              screenName: \"IDS_METHOD\",\n              openChildModal: true,\n              operation: \"approve\",\n              selectedRecord: {}\n            }\n          };\n          this.props.updateStore(updateInfo);\n        } else {\n          this.props.crudMaster(inputParam, masterData, \"openChildModal\", {});\n        } //  }\n        // else {\n        //     toast.warn(this.props.intl.formatMessage({ id: \"IDS_SELECTDRAFTRECORDTOAPPROVE\" }));\n        // }\n\n      } else {\n        toast.warn(this.props.intl.formatMessage({\n          id: \"IDS_NOTEDITDELETEMETHODVALIDITY\"\n        }));\n      }\n    };\n\n    this.deleteRecord = deleteParam => {\n      if (deleteParam.selectedRecord.ntransactionstatus === transactionStatus.DRAFT) {\n        const methodUrl = deleteParam.methodUrl;\n        const selected = deleteParam.selectedRecord;\n        let dataState = undefined;\n\n        if (this.props.screenName === \"IDS_SECTION\") {\n          dataState = this.state.methodValidityDataState;\n        }\n\n        const inputParam = {\n          inputData: {\n            [methodUrl.toLowerCase()]: selected,\n            userinfo: this.props.userInfo\n          },\n          classUrl: \"method\",\n          operation: deleteParam.operation,\n          methodUrl: methodUrl,\n          screenName: \"IDS_METHOD\",\n          dataState\n        };\n        const masterData = this.props.masterData;\n\n        if (showEsign(this.props.esignRights, this.props.userInfo.nformcode, deleteParam.ncontrolCode)) {\n          const updateInfo = {\n            typeName: DEFAULT_RETURN,\n            data: {\n              loadEsign: true,\n              screenData: {\n                inputParam,\n                masterData\n              },\n              openChildModal: true,\n              screenName: \"IDS_METHOD\",\n              operation: deleteParam.operation,\n              selectedRecord: {}\n            }\n          };\n          this.props.updateStore(updateInfo);\n        } else {\n          this.props.crudMaster(inputParam, masterData, \"openChildModal\", {});\n        }\n      } else {\n        toast.warn(this.props.intl.formatMessage({\n          id: \"IDS_NOTEDITDELETEMETHODVALIDITY\"\n        }));\n      }\n    };\n\n    this.defaultRecord = (defaultParam, event) => {\n      const methodUrl = defaultParam.methodUrl;\n      let dataItem = defaultParam.selectedRecord; // dataItem[\"ndefaultstatus\"] = transactionStatus.YES;\n\n      let dataState = undefined;\n\n      if (this.props.screenName === \"IDS_SECTION\") {\n        dataState = this.state.methodValidityDataState;\n      }\n\n      const inputParam = {\n        inputData: {\n          [methodUrl.toLowerCase()]: dataItem,\n          userinfo: this.props.userInfo\n        },\n        classUrl: \"method\",\n        operation: \"setDefault\",\n        methodUrl: methodUrl,\n        dataState\n      };\n      const masterData = this.props.masterData;\n\n      if (showEsign(this.props.esignRights, this.props.userInfo.nformcode, defaultParam.ncontrolCode)) {\n        const updateInfo = {\n          typeName: DEFAULT_RETURN,\n          data: {\n            loadEsign: true,\n            screenData: {\n              inputParam,\n              masterData\n            },\n            openChildModal: true,\n            screenName: \"Method\",\n            operation: defaultParam.operation,\n            selectedRecord: {}\n          }\n        };\n        this.props.updateStore(updateInfo);\n      } else {\n        this.props.crudMaster(inputParam, masterData, \"openChildModal\", {});\n      }\n    };\n\n    this.closeModal = () => {\n      let loadEsign = this.props.loadEsign;\n      let openChildModal = this.props.openChildModal;\n      let selectedRecord = this.props.selectedRecord;\n      let selectedId = this.props.selectedId;\n\n      if (this.props.loadEsign) {\n        if (this.props.operation === \"delete\" || this.props.operation === \"approve\") {\n          loadEsign = false;\n          openChildModal = false;\n          selectedRecord = {};\n        } else {\n          loadEsign = false;\n          selectedRecord[\"agree\"] = 4;\n          selectedRecord[\"esignpassword\"] = \"\";\n          selectedRecord[\"esigncomments\"] = \"\";\n        }\n      } else {\n        openChildModal = false;\n        selectedRecord = {};\n        selectedId = null;\n      }\n\n      const updateInfo = {\n        typeName: DEFAULT_RETURN,\n        data: {\n          openChildModal,\n          loadEsign,\n          selectedRecord,\n          selectedId\n        }\n      };\n      this.props.updateStore(updateInfo);\n    };\n\n    this.onComboChange = (comboData, fieldName, caseNo) => {\n      let selectedRecord = this.state.selectedRecord || {};\n\n      switch (caseNo) {\n        case 1:\n          if (fieldName === \"sparametername\") {\n            selectedRecord[fieldName] = comboData;\n            selectedRecord[\"sparametersynonym\"] = comboData.value;\n          } else {\n            selectedRecord[fieldName] = comboData;\n          }\n\n          this.setState({\n            selectedRecord\n          });\n          break;\n\n        case 2:\n          const parameterData = this.props.parameterData;\n          let item = comboData[\"item\"];\n          let needUnit = true;\n          let needRoundingDigit = true;\n          let needCodedResult = true;\n          let needActualResult = true;\n          let npredefinedcode = 4;\n\n          if (item[\"nunitrequired\"] === 3) {\n            needUnit = false;\n            selectedRecord[\"nunitcode\"] = this.props.parameterData.defaultUnit;\n          } else {\n            selectedRecord[\"nunitcode\"] = \"\";\n          }\n\n          if (item[\"nroundingrequired\"] === 3) {\n            needRoundingDigit = false;\n          } else {\n            selectedRecord[\"nroundingdigits\"] = \"\";\n          }\n\n          if (item[\"npredefinedrequired\"] === 3) {\n            needCodedResult = false;\n            npredefinedcode = item[\"npredefinedrequired\"];\n          } else {\n            selectedRecord[\"spredefinedname\"] = \"\";\n          }\n\n          if (item[\"ngraderequired\"] === 3) {\n            needActualResult = false;\n            selectedRecord[\"ngradecode\"] = this.props.parameterData.defaultGrade;\n          } else {\n            selectedRecord[\"ngradecode\"] = \"\";\n          }\n\n          selectedRecord[fieldName] = comboData;\n          const parameterInfo = {\n            typeName: DEFAULT_RETURN,\n            data: {\n              selectedRecord,\n              parameterData: { ...parameterData,\n                needUnit,\n                needRoundingDigit,\n                needCodedResult,\n                needActualResult,\n                npredefinedcode\n              }\n            }\n          };\n          this.props.updateStore(parameterInfo);\n          break;\n\n        case 3:\n          selectedRecord[fieldName] = comboData;\n          this.props.formulaChangeFunction({\n            ntestcategorycode: comboData.value,\n            nFlag: 2,\n            userinfo: this.props.userInfo\n          }, this.props.formulaData, 1, selectedRecord, \"/changeTestCatgoryInFormula\");\n          break;\n\n        case 4:\n          selectedRecord[fieldName] = comboData;\n          this.props.formulaChangeFunction({\n            ntestcode: comboData.value,\n            nFlag: 3,\n            userinfo: this.props.userInfo\n          }, this.props.formulaData, 2, selectedRecord, \"/changeTestInFormula\");\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    this.onEsignInputOnChange = event => {\n      const selectedRecord = this.state.selectedRecord || {};\n\n      if (event.target.type === \"checkbox\") {\n        selectedRecord[event.target.name] = event.target.checked === true ? 3 : 4;\n      } else {\n        selectedRecord[event.target.name] = event.target.value;\n      }\n\n      this.setState({\n        selectedRecord\n      });\n    };\n\n    this.onInputOnChange = (event, caseNo, optional) => {\n      const selectedRecord = this.state.selectedRecord || {};\n\n      switch (caseNo) {\n        case 1:\n          if (event.target.type === \"checkbox\") {\n            selectedRecord[event.target.name] = event.target.checked === true ? transactionStatus.YES : transactionStatus.NO;\n          } else if (event.target.type === \"radio\") {\n            selectedRecord[event.target.name] = optional; //  selectedRecord[\"sfilename\"]=\"\";\n          } else {\n            selectedRecord[event.target.name] = event.target.value;\n          }\n\n          this.setState({\n            selectedRecord\n          });\n          break;\n\n        case 4:\n          const inputValue = event.target.value;\n\n          if (/^-?\\d*?\\.?\\d*?$/.test(inputValue) || inputValue === \"\") {\n            selectedRecord[event.target.name] = event.target.value;\n          }\n\n          this.setState({\n            selectedRecord\n          });\n          break;\n\n        case 5:\n          if (optional.ndynamicformulafieldcode === FORMULAFIELDTYPE.INTEGER && optional.sdescription.indexOf(\"P$\") === -1) {\n            const value = event.target.value.replace(/[^-^0-9]/g, \"\");\n            const dynamicField = this.state.dynamicField || [];\n\n            if (/^-?\\d*?$/.test(value)) {\n              if (!selectedRecord[\"formulainput\"]) {\n                selectedRecord[\"formulainput\"] = {};\n              }\n\n              selectedRecord[\"formulainput\"][event.target.name] = value;\n              dynamicField[event.target.name] = {\n                sparameter: optional.sdescription,\n                svalues: value\n              };\n            } else if (value === \"\") {\n              if (!selectedRecord[\"formulainput\"]) {\n                selectedRecord[\"formulainput\"] = {};\n              }\n\n              selectedRecord[\"formulainput\"][event.target.name] = value;\n              dynamicField[event.target.name] = {\n                sparameter: optional.sdescription,\n                svalues: value\n              };\n            }\n\n            this.setState({\n              dynamicField,\n              selectedRecord\n            });\n            break;\n          } else {\n            const value = event.target.value.replace(/[^-^0-9.]/g, \"\");\n            const dynamicField = this.state.dynamicField || [];\n\n            if (/^-?\\d*?\\.?\\d*?$/.test(value) || value !== \"\") {\n              if (!selectedRecord[\"formulainput\"]) {\n                selectedRecord[\"formulainput\"] = {};\n              }\n\n              selectedRecord[\"formulainput\"][event.target.name] = value;\n              dynamicField[event.target.name] = {\n                sparameter: optional.sdescription,\n                svalues: value\n              };\n            }\n\n            this.setState({\n              dynamicField,\n              selectedRecord\n            });\n            break;\n          }\n\n        default:\n          break;\n      }\n    };\n\n    this.onSaveClick = (saveType, formRef) => {\n      //add / edit\n      let inputData = [];\n      inputData[\"userinfo\"] = this.props.userInfo;\n      let postParam = undefined;\n      let editId = this.props.controlMap.has(\"AddMethodValidity\") && this.props.controlMap.get(\"AddMethodValidity\").ncontrolcode; // if (this.state.selectedRecord[\"ncommentsubtypecode\"].value === 3) {\n      //     if (this.state.selectedRecord[\"spredefinedname\"] === undefined || \n      //          this.state.selectedRecord[\"spredefinedname\"] === \"\") {\n      //         toast.info(\"Enter PreDefined Name\");\n      //         return;\n      //     }\n      // }\n      //   if (this.state.selectedRecord[\"dvalidityenddate\"] !== undefined && this.state.selectedRecord[\"dvaliditystartdate\"] !== undefined) {\n      //     if (this.state.selectedRecord[\"dvalidityenddate\"] < this.state.selectedRecord[\"dvaliditystartdate\"]) {\n      //         toast.info(this.props.intl.formatMessage({ id: \"IDS_ENDDATEGRATERTHANSTARTDATE\" }));\n      //         return;\n      //     }\n      // }\n\n      let obj = convertDateValuetoString(this.state.selectedRecord[\"dvaliditystartdate\"] ? this.state.selectedRecord[\"dvaliditystartdate\"] : new Date(), this.state.selectedRecord[\"dvalidityenddate\"] ? this.state.selectedRecord[\"dvalidityenddate\"] : new Date(), this.props.userInfo);\n      this.state.selectedRecord[\"svaliditystartdate\"] = obj.fromDate;\n      this.state.selectedRecord[\"svalidityenddate\"] = obj.toDate;\n\n      if (this.props.operation === \"update\") {\n        // edit\n        postParam = {\n          inputListName: \"methodvalidity\",\n          selectedObject: \"MethodValidity\",\n          primaryKeyField: \"nmethodvaliditycode\",\n          primaryKeyValue: this.state.selectedRecord[\"nmethodvaliditycode\"],\n          fetchUrl: \"method/getActiveMethodValidityById\",\n          fecthInputObject: {\n            userinfo: this.props.userInfo\n          },\n          masterData: this.props.masterData\n        };\n        inputData[\"methodvalidity\"] = {\n          \"nsitecode\": this.props.userInfo.nmastersitecode\n        };\n        inputData[\"methodvalidity\"][\"dvaliditystartdate\"] = this.state.selectedRecord[\"dvaliditystartdate\"] ? formatInputDate(this.state.selectedRecord[\"dvaliditystartdate\"]) : formatInputDate(new Date());\n        inputData[\"methodvalidity\"][\"dvalidityenddate\"] = this.state.selectedRecord[\"dvalidityenddate\"] ? this.state.selectedRecord[\"dvalidityenddate\"] : new Date();\n        inputData[\"methodvalidity\"][\"svaliditystartdate\"] = this.state.selectedRecord[\"svaliditystartdate\"] ? this.state.selectedRecord[\"svaliditystartdate\"] : new Date();\n        inputData[\"methodvalidity\"][\"svalidityenddate\"] = this.state.selectedRecord[\"svalidityenddate\"] ? this.state.selectedRecord[\"svalidityenddate\"] : new Date();\n        inputData[\"methodvalidity\"][\"nmethodcode\"] = this.props.selectedMethod.nmethodcode;\n        inputData[\"methodvalidity\"][\"nmethodvaliditycode\"] = this.state.selectedRecord[\"nmethodvaliditycode\"] ? this.state.selectedRecord[\"nmethodvaliditycode\"] : 0;\n        editId = this.props.controlMap.has(\"EditMethodValidity\") && this.props.controlMap.get(\"EditMethodValidity\").ncontrolcode;\n      } else {\n        inputData[\"methodvalidity\"] = {\n          \"nsitecode\": this.props.userInfo.nmastersitecode\n        };\n        inputData[\"methodvalidity\"][\"dvaliditystartdate\"] = this.state.selectedRecord[\"dvaliditystartdate\"] ? this.state.selectedRecord[\"dvaliditystartdate\"] : new Date();\n        inputData[\"methodvalidity\"][\"dvalidityenddate\"] = this.state.selectedRecord[\"dvalidityenddate\"] ? this.state.selectedRecord[\"dvalidityenddate\"] : new Date();\n        inputData[\"methodvalidity\"][\"svaliditystartdate\"] = this.state.selectedRecord[\"svaliditystartdate\"] ? this.state.selectedRecord[\"svaliditystartdate\"] : new Date();\n        inputData[\"methodvalidity\"][\"svalidityenddate\"] = this.state.selectedRecord[\"svalidityenddate\"] ? this.state.selectedRecord[\"svalidityenddate\"] : new Date();\n        inputData[\"methodvalidity\"][\"nmethodcode\"] = this.props.selectedMethod.nmethodcode;\n      }\n\n      const inputParam = {\n        classUrl: \"method\",\n        methodUrl: \"MethodValidity\",\n        displayName: \"IDS_METHOD\",\n        inputData: inputData,\n        operation: this.props.operation,\n        saveType,\n        formRef,\n        postParam,\n        searchRef: this.searchRef\n      };\n      const masterData = this.props.masterData;\n      const esignNeeded = showEsign(this.props.esignRights, this.props.userInfo.nformcode, editId);\n\n      if (esignNeeded) {\n        const updateInfo = {\n          typeName: DEFAULT_RETURN,\n          data: {\n            loadEsign: true,\n            screenData: {\n              inputParam,\n              masterData\n            },\n            saveType\n          }\n        };\n        this.props.updateStore(updateInfo);\n      } else {\n        this.props.crudMaster(inputParam, masterData, \"openChildModal\");\n      }\n    };\n\n    this.validateEsign = () => {\n      const inputParam = {\n        inputData: {\n          \"userinfo\": { ...this.props.userInfo,\n            sreason: this.state.selectedRecord[\"esigncomments\"],\n            nreasoncode: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\n            spredefinedreason: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label\n          },\n          password: this.state.selectedRecord[\"esignpassword\"]\n        },\n        screenData: this.props.screenData\n      };\n      this.props.validateEsignCredential(inputParam, \"openChildModal\");\n    };\n\n    this.ConfirmDelete = (deleteParam, deleteID) => {\n      this.confirmMessage.confirm(\"deleteMessage\", this.props.intl.formatMessage({\n        id: \"IDS_DELETE\"\n      }), this.props.intl.formatMessage({\n        id: \"IDS_DEFAULTCONFIRMMSG\"\n      }), this.props.intl.formatMessage({\n        id: \"IDS_OK\"\n      }), this.props.intl.formatMessage({\n        id: \"IDS_CANCEL\"\n      }), () => this.deleteRecord(deleteParam));\n    };\n\n    this.state = {\n      selectedRecord: {},\n      fieldFlag: true,\n      operatorFlag: false,\n      functionFlag: true,\n      methodvalidityDataState: {\n        skip: 0,\n        take: 10\n      },\n      methodDataState: {\n        skip: 0,\n        take: 10\n      },\n      selectedComponent: \"\"\n    };\n    this.confirmMessage = new ConfirmMessage();\n  }\n\n  render() {\n    const {\n      SelectedMethod\n    } = this.props.masterData;\n    const mandatoryFields = [{\n      idsName: \"IDS_VALIDITYSTARTDATE\",\n      dataField: \"dvaliditystartdate\",\n      mandatoryLabel: \"IDS_SELECT\",\n      controlType: \"selectbox\"\n    }, {\n      idsName: \"IDS_VALIDITYENDDATE\",\n      dataField: \"dvalidityenddate\",\n      mandatoryLabel: \"IDS_SELECT\",\n      controlType: \"selectbox\"\n    }];\n    return /*#__PURE__*/React.createElement(React.Fragment, null, SelectedMethod && /*#__PURE__*/React.createElement(CustomTab, {\n      tabDetail: this.tabDetail(),\n      onTabChange: this.onTabChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }\n    }), this.props.openChildModal && /*#__PURE__*/React.createElement(SlideOutModal, {\n      show: this.props.openChildModal,\n      closeModal: this.closeModal,\n      operation: this.props.operation,\n      inputParam: this.props.inputParam,\n      screenName: \"IDS_METHODVALIDITY\",\n      onSaveClick: this.onSaveClick,\n      esign: this.props.loadEsign,\n      validateEsign: this.validateEsign,\n      selectedRecord: this.state.selectedRecord || {},\n      mandatoryFields: this.mandatoryFields,\n      addComponent: this.props.loadEsign ? /*#__PURE__*/React.createElement(Esign, {\n        operation: this.props.operation,\n        onInputOnChange: this.onEsignInputOnChange,\n        inputParam: this.props.inputParam,\n        selectedRecord: this.state.selectedRecord || {},\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 17\n        }\n      }) : /*#__PURE__*/React.createElement(AddMethodValidity, {\n        selectedRecord: this.state.selectedRecord || {},\n        methodvalidity: this.props.MethodValidity,\n        handleDateChange: this.handleDateChange,\n        userInfo: this.props.userInfo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }\n    }));\n  }\n\n  componentDidUpdate(previousProps) {\n    if (this.props.selectedRecord !== previousProps.selectedRecord) {\n      this.setState({\n        selectedRecord: this.props.selectedRecord\n      });\n    }\n\n    if (this.props.masterData !== previousProps.masterData) {\n      let {\n        methodValidityDataState,\n        selectedRecord\n      } = this.state;\n\n      if (this.props.dataState === undefined) {\n        if (this.props.screenName === \"IDS_METHODVALIDITY\") {\n          methodValidityDataState = {\n            skip: 0,\n            take: 10\n          };\n        }\n      } //this.props.masterData.MethodValidity\n\n\n      this.setState({\n        methodValidityDataState,\n        selectedRecord\n      });\n    }\n\n    if (this.props.Login !== previousProps.Login) {\n      this.PrevoiusLoginData = previousProps;\n    } // if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\n    //     this.setState({ selectedRecord: this.props.Login.selectedRecord });\n    // }\n    // if (this.props.Login.userInfo.nformcode !== previousProps.Login.userInfo.nformcode) {\n    //     const userRoleControlRights = [];\n    //     if (this.props.Login.userRoleControlRights) {\n    //         this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode] && Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(item =>\n    //             userRoleControlRights.push(item.ncontrolcode))\n    //     }\n    //     const controlMap = getControlMap(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode)\n    //     this.setState({ userRoleControlRights, controlMap });\n    // }\n\n  }\n\n}\n\nexport default injectIntl(MethodValidityView);","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/pages/testmanagement/MethodValidityView.jsx"],"names":["React","Component","toast","injectIntl","rsapi","process","Row","SlideOutModal","DEFAULT_RETURN","showEsign","getControlMap","create_UUID","onDropAttachFileList","convertDateValuetoString","deleteAttachmentDropZone","formatInputDate","rearrangeDateFormat","Esign","AddMethodValidity","parameterType","transactionStatus","operators","attachmentType","FORMULAFIELDTYPE","CustomTab","MethodValidityTab","ConfirmMessage","ChartLegendTitle","rearrangeDateFormatDateOnly","MethodValidityView","constructor","props","handleDateChange","dateName","dateValue","sdatename","selectedRecord","state","setState","onTabChange","tabProps","screenName","updateInfo","typeName","data","updateStore","tabDetail","tabMap","Map","i","masterData","length","svaliditystartdate","userInfo","svalidityenddate","set","controlMap","userRoleControlRights","operation","undefined","methodvalidityDataState","skip","take","event","dataState","SelectedMethod","fetchMethodValidityById","editParam","inputParam","selectedComponent","handleComponentRowClick","intl","formatMessage","deleteRecord","onApproveClick","openChildModal","defaultRecord","selectedId","getAvailableValidityData","MethodValidity","approveParam","dataItem","addParam","primaryKeyName","getMethodValidityUTCDate","selectedDataItem","ntransactionstatus","DRAFT","approveId","has","get","ncontrolcode","inputData","postParam","inputListName","selectedObject","primaryKeyField","classUrl","methodUrl","saveType","esignNeeded","esignRights","nformcode","loadEsign","screenData","crudMaster","warn","id","deleteParam","selected","methodValidityDataState","toLowerCase","userinfo","ncontrolCode","defaultParam","closeModal","onComboChange","comboData","fieldName","caseNo","value","parameterData","item","needUnit","needRoundingDigit","needCodedResult","needActualResult","npredefinedcode","defaultUnit","defaultGrade","parameterInfo","formulaChangeFunction","ntestcategorycode","nFlag","formulaData","ntestcode","onEsignInputOnChange","target","type","name","checked","onInputOnChange","optional","YES","NO","inputValue","test","ndynamicformulafieldcode","INTEGER","sdescription","indexOf","replace","dynamicField","sparameter","svalues","onSaveClick","formRef","editId","obj","Date","fromDate","toDate","primaryKeyValue","fetchUrl","fecthInputObject","nmastersitecode","selectedMethod","nmethodcode","displayName","searchRef","validateEsign","sreason","nreasoncode","spredefinedreason","label","password","validateEsignCredential","ConfirmDelete","deleteID","confirmMessage","confirm","fieldFlag","operatorFlag","functionFlag","methodDataState","render","mandatoryFields","idsName","dataField","mandatoryLabel","controlType","componentDidUpdate","previousProps","Login","PrevoiusLoginData"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport { injectIntl } from \"react-intl\";\r\nimport rsapi from \"../../rsapi\";\r\nimport { process } from \"@progress/kendo-data-query\";\r\nimport { Row } from \"react-bootstrap\";\r\nimport \"../../assets/styles/lims-global-theme.css\";\r\nimport SlideOutModal from \"../../components/slide-out-modal/SlideOutModal\";\r\nimport { DEFAULT_RETURN } from \"../../actions/LoginTypes\";\r\nimport {\r\n  showEsign,\r\n  getControlMap,\r\n  create_UUID,\r\n  onDropAttachFileList,\r\n  convertDateValuetoString,\r\n  deleteAttachmentDropZone,\r\n  formatInputDate,\r\n  rearrangeDateFormat,\r\n} from \"../../components/CommonScript\";\r\nimport Esign from \"../audittrail/Esign\";\r\nimport AddMethodValidity from \"./AddMethodValidity\";\r\n//import ValidateFormula from './ValidateFormula';\r\nimport {\r\n  parameterType,\r\n  transactionStatus,\r\n  operators,\r\n  attachmentType,\r\n  FORMULAFIELDTYPE,\r\n} from \"../../components/Enumeration\";\r\nimport CustomTab from \"../../components/custom-tabs/custom-tabs.component\";\r\nimport MethodValidityTab from \"./MethodValidityTab\";\r\nimport ConfirmMessage from \"../../components/confirm-alert/confirm-message.component\";\r\nimport { ChartLegendTitle } from \"@progress/kendo-react-charts\";\r\nimport { rearrangeDateFormatDateOnly } from './../../components/CommonScript';\r\n\r\nclass MethodValidityView extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      selectedRecord: {},\r\n      fieldFlag: true,\r\n      operatorFlag: false,\r\n      functionFlag: true,\r\n      methodvalidityDataState: { skip: 0, take: 10 },\r\n      methodDataState: { skip: 0, take: 10 },\r\n      selectedComponent:\"\"\r\n    };\r\n    this.confirmMessage = new ConfirmMessage();\r\n  }\r\n\r\n  render() {\r\n    const { SelectedMethod } = this.props.masterData;\r\n    \r\n    const mandatoryFields = [\r\n      {\r\n        idsName: \"IDS_VALIDITYSTARTDATE\",\r\n        dataField: \"dvaliditystartdate\",\r\n        mandatoryLabel: \"IDS_SELECT\",\r\n        controlType: \"selectbox\",\r\n      },\r\n      {\r\n        idsName: \"IDS_VALIDITYENDDATE\",\r\n        dataField: \"dvalidityenddate\",\r\n        mandatoryLabel: \"IDS_SELECT\",\r\n        controlType: \"selectbox\",\r\n      },\r\n    ];\r\n    return (\r\n      <>\r\n        {SelectedMethod && (\r\n          <CustomTab\r\n            tabDetail={this.tabDetail()}\r\n            onTabChange={this.onTabChange}\r\n          />\r\n        )}\r\n\r\n        {this.props.openChildModal && (\r\n          <SlideOutModal\r\n            show={this.props.openChildModal}\r\n            closeModal={this.closeModal}\r\n            operation={this.props.operation}\r\n            inputParam={this.props.inputParam}\r\n            screenName={\"IDS_METHODVALIDITY\"}\r\n            onSaveClick={this.onSaveClick}\r\n            esign={this.props.loadEsign}\r\n            validateEsign={this.validateEsign}\r\n            selectedRecord={this.state.selectedRecord || {}}\r\n            mandatoryFields={this.mandatoryFields}\r\n            addComponent={\r\n              this.props.loadEsign ? (\r\n                <Esign\r\n                  operation={this.props.operation}\r\n                  onInputOnChange={this.onEsignInputOnChange}\r\n                  inputParam={this.props.inputParam}\r\n                  selectedRecord={this.state.selectedRecord || {}}\r\n                />\r\n              ) : (\r\n                <AddMethodValidity\r\n                  selectedRecord={this.state.selectedRecord || {}}\r\n                  methodvalidity={this.props.MethodValidity}\r\n                  handleDateChange={this.handleDateChange}\r\n                  userInfo={this.props.userInfo}\r\n                />\r\n              )\r\n            }\r\n          />\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n  handleDateChange = (dateName, dateValue, sdatename) => {\r\n    const { selectedRecord } = this.state;\r\n    // if(dateName === \"dvaliditystartdate\")\r\n    // {\r\n    //   selectedRecord[\"dvalidityenddate\"] = dateValue;  \r\n    // }\r\n    selectedRecord[dateName] = dateValue;\r\n    selectedRecord[sdatename] = dateValue;\r\n    this.setState({ selectedRecord });\r\n  };\r\n  onTabChange = (tabProps) => {\r\n    const screenName = tabProps.screenName;\r\n    const updateInfo = {\r\n      typeName: DEFAULT_RETURN,\r\n      data: { screenName },\r\n    };\r\n    this.props.updateStore(updateInfo);\r\n  };\r\n  tabDetail = () => {\r\n    const tabMap = new Map();\r\n\r\n    for(let i=0;i<this.props.masterData[\"MethodValidity\"].length;i++)\r\n    {\r\n      this.props.masterData[\"MethodValidity\"][i].svaliditystartdate=rearrangeDateFormatDateOnly(this.props.userInfo,this.props.masterData[\"MethodValidity\"][i].svaliditystartdate);\r\n      this.props.masterData[\"MethodValidity\"][i].svalidityenddate=rearrangeDateFormatDateOnly(this.props.userInfo,this.props.masterData[\"MethodValidity\"][i].svalidityenddate);\r\n    }\r\n\r\n    tabMap.set(\r\n      \"IDS_METHODVALIDITY\",\r\n      <MethodValidityTab\r\n        controlMap={this.props.controlMap}\r\n        userRoleControlRights={this.props.userRoleControlRights}\r\n        operation = {this.props.operation}\r\n        dataResult={process(\r\n          this.props.masterData[\"MethodValidity\"],\r\n          this.props.screenName === undefined ||\r\n            this.props.screenName === \"IDS_METHODVALIDITY\"\r\n            ? this.state.methodvalidityDataState\r\n            : { skip: 0, take: 10 }\r\n        )}\r\n        dataState={\r\n          this.props.screenName === undefined ||\r\n          this.props.screenName === \"IDS_METHODVALIDITY\"\r\n            ? this.state.methodvalidityDataState\r\n            : { skip: 0, take: 10 }\r\n        }\r\n        dataStateChange={(event) =>\r\n          this.setState({ methodvalidityDataState: event.dataState })\r\n        }\r\n        selectedMethod={this.props.masterData.SelectedMethod}\r\n        fetchMethodValidityById={this.props.fetchMethodValidityById}\r\n        editParam={this.props.editParam}\r\n        userInfo={this.props.userInfo}\r\n        inputParam={this.props.inputParam}\r\n        selectedComponent={this.state.selectedComponent}\r\n        handleComponentRowClick={this.handleComponentRowClick}\r\n        formatMessage={this.props.intl.formatMessage}\r\n        deleteRecord={this.deleteRecord}\r\n        onApproveClick={this.onApproveClick}\r\n        openChildModal={this.openChildModal}\r\n        defaultRecord={this.defaultRecord}\r\n        selectedId={this.props.selectedId}\r\n        getAvailableValidityData={this.props.getAvailableValidityData}\r\n        MethodValidity={this.props.masterData.MethodValidity || []}\r\n        screenName=\"IDS_METHODVALIDITY\"\r\n        approveParam={this.props.approveParam}\r\n      />\r\n    );\r\n\r\n    return tabMap;\r\n  };\r\n  handleComponentRowClick = (event) => {\r\n    let selectedComponent = event.dataItem;\r\n    // let SelectedTest = this.props.Login.Test && this.props.Login.Test[selectedComponent.slno] ? this.props.Login.Test[selectedComponent.slno] : [];\r\n    const updateInfo = {\r\n        typeName: DEFAULT_RETURN,\r\n        data: {\r\n          operation:\"\"\r\n            // SelectedTest, selectedComponent,\r\n            // testDataState: {\r\n            //     skip: 0, take: this.props.Login.settings ?\r\n            //         parseInt(this.props.Login.settings[14]) : 5\r\n            // }\r\n        }\r\n    }\r\n    this.props.updateStore(updateInfo);\r\n    this.setState({selectedComponent});\r\n\r\n};\r\n  openChildModal = () => {\r\n    const addParam = {\r\n      screenName: \"IDS_METHOD\", operation: \"create\", primaryKeyName: \"nmethodvaliditycode\",\r\n      masterData: this.props.masterData, userInfo: this.props.userInfo\r\n     \r\n  }\r\n  this.props.getMethodValidityUTCDate(addParam);\r\n    //let selectedRecord={};\r\n    // const updateInfo = {\r\n    //   typeName: DEFAULT_RETURN,\r\n    //   data: { openChildModal: true,operation:\"create\" },\r\n    // };//,selectedRecord\r\n    // this.props.updateStore(updateInfo);\r\n  };\r\n    onApproveClick = (selectedDataItem, operation, primaryKeyName) => {\r\n      if (selectedDataItem.dataItem.ntransactionstatus === transactionStatus.DRAFT) {\r\n   // if (this.state.selectedComponent.ntransactionstatus === transactionStatus.DRAFT) {\r\n        const approveId = this.props.controlMap.has(\"ApproveMethodValidity\") && this.props.controlMap.get(\"ApproveMethodValidity\").ncontrolcode\r\n        let inputData = [];\r\n        inputData[\"userinfo\"] = this.props.userInfo;\r\n        //add               \r\n        let postParam = undefined;\r\n        inputData[\"methodvalidity\"] =selectedDataItem.dataItem;\r\n        postParam = { inputListName: \"MethodValidity\", selectedObject: \"selectedComponent\", primaryKeyField: \"nmethodvaliditycode\" };\r\n        const inputParam = {\r\n            classUrl: \"method\",\r\n            methodUrl: \"MethodValidity\",\r\n            inputData: inputData,\r\n            operation: \"approve\", postParam\r\n        }\r\n        let saveType;\r\n\r\n        const masterData = this.props.masterData;\r\n\r\n        const esignNeeded = showEsign(this.props.esignRights, this.props.userInfo.nformcode, approveId);\r\n        if (esignNeeded) {\r\n            const updateInfo = {\r\n                typeName: DEFAULT_RETURN,\r\n                data: {\r\n                    loadEsign: true, screenData: { inputParam, masterData }, screenName: \"IDS_METHOD\", openChildModal: true, operation: \"approve\",selectedRecord: {}\r\n                }\r\n            }\r\n            this.props.updateStore(updateInfo);\r\n            \r\n        }\r\n        else {\r\n            this.props.crudMaster(inputParam, masterData, \"openChildModal\",{});\r\n        }\r\n\r\n  //  }\r\n    // else {\r\n    //     toast.warn(this.props.intl.formatMessage({ id: \"IDS_SELECTDRAFTRECORDTOAPPROVE\" }));\r\n    // }\r\n      }\r\n      else {\r\n        toast.warn(this.props.intl.formatMessage({ id: \"IDS_NOTEDITDELETEMETHODVALIDITY\" }));\r\n    }\r\n\r\n}\r\n  deleteRecord = (deleteParam) => {\r\n    if (deleteParam.selectedRecord.ntransactionstatus === transactionStatus.DRAFT) {\r\n    const methodUrl = deleteParam.methodUrl;\r\n    const selected = deleteParam.selectedRecord;\r\n    let dataState = undefined;\r\n    if (this.props.screenName === \"IDS_SECTION\") {\r\n      dataState = this.state.methodValidityDataState;\r\n    }\r\n    const inputParam = {\r\n      inputData: {\r\n        [methodUrl.toLowerCase()]: selected,\r\n        userinfo: this.props.userInfo,\r\n      },\r\n      classUrl: \"method\",\r\n      operation: deleteParam.operation,\r\n      methodUrl: methodUrl,\r\n      screenName: \"IDS_METHOD\",\r\n      dataState,\r\n    };\r\n    const masterData = this.props.masterData;\r\n    if (\r\n      showEsign(\r\n        this.props.esignRights,\r\n        this.props.userInfo.nformcode,\r\n        deleteParam.ncontrolCode\r\n      )\r\n    ) {\r\n      const updateInfo = {\r\n        typeName: DEFAULT_RETURN,\r\n        data: {\r\n          loadEsign: true,\r\n          screenData: { inputParam, masterData },\r\n          openChildModal: true,\r\n          screenName: \"IDS_METHOD\",\r\n          operation: deleteParam.operation,\r\n          selectedRecord: {},\r\n        },\r\n      };\r\n      this.props.updateStore(updateInfo);\r\n    } else {\r\n      this.props.crudMaster(inputParam, masterData, \"openChildModal\", {});\r\n    }\r\n  }\r\n  else {\r\n    toast.warn(this.props.intl.formatMessage({ id: \"IDS_NOTEDITDELETEMETHODVALIDITY\" }));\r\n}\r\n  };\r\n\r\n  defaultRecord = (defaultParam, event) => {\r\n    const methodUrl = defaultParam.methodUrl;\r\n    let dataItem = defaultParam.selectedRecord;\r\n    // dataItem[\"ndefaultstatus\"] = transactionStatus.YES;\r\n    let dataState = undefined;\r\n    if (this.props.screenName === \"IDS_SECTION\") {\r\n      dataState = this.state.methodValidityDataState;\r\n    }\r\n    const inputParam = {\r\n      inputData: {\r\n        [methodUrl.toLowerCase()]: dataItem,\r\n        userinfo: this.props.userInfo,\r\n      },\r\n      classUrl: \"method\",\r\n      operation: \"setDefault\",\r\n      methodUrl: methodUrl,\r\n      dataState,\r\n    };\r\n    const masterData = this.props.masterData;\r\n    if (\r\n      showEsign(\r\n        this.props.esignRights,\r\n        this.props.userInfo.nformcode,\r\n        defaultParam.ncontrolCode\r\n      )\r\n    ) {\r\n      const updateInfo = {\r\n        typeName: DEFAULT_RETURN,\r\n        data: {\r\n          loadEsign: true,\r\n          screenData: { inputParam, masterData },\r\n          openChildModal: true,\r\n          screenName: \"Method\",\r\n          operation: defaultParam.operation,\r\n          selectedRecord: {},\r\n        },\r\n      };\r\n      this.props.updateStore(updateInfo);\r\n    } else {\r\n      this.props.crudMaster(inputParam, masterData, \"openChildModal\", {});\r\n    }\r\n  };\r\n  closeModal = () => {\r\n    let loadEsign = this.props.loadEsign;\r\n    let openChildModal = this.props.openChildModal;\r\n    let selectedRecord = this.props.selectedRecord;\r\n    let selectedId = this.props.selectedId;\r\n    if (this.props.loadEsign) {\r\n      if (\r\n        this.props.operation === \"delete\" ||\r\n        this.props.operation === \"approve\"  \r\n      ) {\r\n        loadEsign = false;\r\n        openChildModal = false;\r\n        selectedRecord = {};\r\n      } else {\r\n        loadEsign = false;\r\n        selectedRecord[\"agree\"] = 4;\r\n        selectedRecord[\"esignpassword\"] = \"\";\r\n        selectedRecord[\"esigncomments\"] = \"\";\r\n      }\r\n    } else {\r\n      openChildModal = false;\r\n      selectedRecord = {};\r\n      selectedId=null;\r\n    }\r\n    const updateInfo = {\r\n      typeName: DEFAULT_RETURN,\r\n      data: { openChildModal, loadEsign, selectedRecord,selectedId },\r\n    };\r\n    this.props.updateStore(updateInfo);\r\n  };\r\n\r\n  onComboChange = (comboData, fieldName, caseNo) => {\r\n    let selectedRecord = this.state.selectedRecord || {};\r\n    switch (caseNo) {\r\n      case 1:\r\n        if (fieldName === \"sparametername\") {\r\n          selectedRecord[fieldName] = comboData;\r\n          selectedRecord[\"sparametersynonym\"] = comboData.value;\r\n        } else {\r\n          selectedRecord[fieldName] = comboData;\r\n        }\r\n        this.setState({ selectedRecord });\r\n        break;\r\n\r\n      case 2:\r\n        const parameterData = this.props.parameterData;\r\n        let item = comboData[\"item\"];\r\n        let needUnit = true;\r\n        let needRoundingDigit = true;\r\n        let needCodedResult = true;\r\n        let needActualResult = true;\r\n        let npredefinedcode = 4;\r\n        if (item[\"nunitrequired\"] === 3) {\r\n          needUnit = false;\r\n          selectedRecord[\"nunitcode\"] = this.props.parameterData.defaultUnit;\r\n        } else {\r\n          selectedRecord[\"nunitcode\"] = \"\";\r\n        }\r\n        if (item[\"nroundingrequired\"] === 3) {\r\n          needRoundingDigit = false;\r\n        } else {\r\n          selectedRecord[\"nroundingdigits\"] = \"\";\r\n        }\r\n        if (item[\"npredefinedrequired\"] === 3) {\r\n          needCodedResult = false;\r\n          npredefinedcode = item[\"npredefinedrequired\"];\r\n        } else {\r\n          selectedRecord[\"spredefinedname\"] = \"\";\r\n        }\r\n        if (item[\"ngraderequired\"] === 3) {\r\n          needActualResult = false;\r\n          selectedRecord[\"ngradecode\"] = this.props.parameterData.defaultGrade;\r\n        } else {\r\n          selectedRecord[\"ngradecode\"] = \"\";\r\n        }\r\n        selectedRecord[fieldName] = comboData;\r\n        const parameterInfo = {\r\n          typeName: DEFAULT_RETURN,\r\n          data: {\r\n            selectedRecord,\r\n            parameterData: {\r\n              ...parameterData,\r\n              needUnit,\r\n              needRoundingDigit,\r\n              needCodedResult,\r\n              needActualResult,\r\n              npredefinedcode,\r\n            },\r\n          },\r\n        };\r\n        this.props.updateStore(parameterInfo);\r\n        break;\r\n\r\n      case 3:\r\n        selectedRecord[fieldName] = comboData;\r\n        this.props.formulaChangeFunction(\r\n          {\r\n            ntestcategorycode: comboData.value,\r\n            nFlag: 2,\r\n            userinfo: this.props.userInfo,\r\n          },\r\n          this.props.formulaData,\r\n          1,\r\n          selectedRecord,\r\n          \"/changeTestCatgoryInFormula\"\r\n        );\r\n        break;\r\n\r\n      case 4:\r\n        selectedRecord[fieldName] = comboData;\r\n        this.props.formulaChangeFunction(\r\n          {\r\n            ntestcode: comboData.value,\r\n            nFlag: 3,\r\n            userinfo: this.props.userInfo,\r\n          },\r\n          this.props.formulaData,\r\n          2,\r\n          selectedRecord,\r\n          \"/changeTestInFormula\"\r\n        );\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  onEsignInputOnChange = (event) => {\r\n    const selectedRecord = this.state.selectedRecord || {};\r\n    if (event.target.type === \"checkbox\") {\r\n      selectedRecord[event.target.name] = event.target.checked === true ? 3 : 4;\r\n    } else {\r\n      selectedRecord[event.target.name] = event.target.value;\r\n    }\r\n    this.setState({ selectedRecord });\r\n  };\r\n\r\n  onInputOnChange = (event, caseNo, optional) => {\r\n    const selectedRecord = this.state.selectedRecord || {};\r\n    switch (caseNo) {\r\n      case 1:\r\n        if (event.target.type === \"checkbox\") {\r\n          selectedRecord[event.target.name] =\r\n            event.target.checked === true\r\n              ? transactionStatus.YES\r\n              : transactionStatus.NO;\r\n        } else if (event.target.type === \"radio\") {\r\n          selectedRecord[event.target.name] = optional;\r\n          //  selectedRecord[\"sfilename\"]=\"\";\r\n        } else {\r\n          selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n        break;\r\n\r\n      case 4:\r\n        const inputValue = event.target.value;\r\n        if (/^-?\\d*?\\.?\\d*?$/.test(inputValue) || inputValue === \"\") {\r\n          selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n        break;\r\n\r\n      case 5:\r\n        if (\r\n          optional.ndynamicformulafieldcode === FORMULAFIELDTYPE.INTEGER &&\r\n          optional.sdescription.indexOf(\"P$\") === -1\r\n        ) {\r\n          const value = event.target.value.replace(/[^-^0-9]/g, \"\");\r\n          const dynamicField = this.state.dynamicField || [];\r\n          if (/^-?\\d*?$/.test(value)) {\r\n            if (!selectedRecord[\"formulainput\"]) {\r\n              selectedRecord[\"formulainput\"] = {};\r\n            }\r\n            selectedRecord[\"formulainput\"][event.target.name] = value;\r\n            dynamicField[event.target.name] = {\r\n              sparameter: optional.sdescription,\r\n              svalues: value,\r\n            };\r\n          } else if (value === \"\") {\r\n            if (!selectedRecord[\"formulainput\"]) {\r\n              selectedRecord[\"formulainput\"] = {};\r\n            }\r\n            selectedRecord[\"formulainput\"][event.target.name] = value;\r\n            dynamicField[event.target.name] = {\r\n              sparameter: optional.sdescription,\r\n              svalues: value,\r\n            };\r\n          }\r\n          this.setState({ dynamicField, selectedRecord });\r\n          break;\r\n        } else {\r\n          const value = event.target.value.replace(/[^-^0-9.]/g, \"\");\r\n          const dynamicField = this.state.dynamicField || [];\r\n          if (/^-?\\d*?\\.?\\d*?$/.test(value) || value !== \"\") {\r\n            if (!selectedRecord[\"formulainput\"]) {\r\n              selectedRecord[\"formulainput\"] = {};\r\n            }\r\n            selectedRecord[\"formulainput\"][event.target.name] = value;\r\n            dynamicField[event.target.name] = {\r\n              sparameter: optional.sdescription,\r\n              svalues: value,\r\n            };\r\n          }\r\n          this.setState({ dynamicField, selectedRecord });\r\n          break;\r\n        }\r\n\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n  onSaveClick = (saveType, formRef) => {\r\n    //add / edit\r\n    let inputData = [];\r\n    inputData[\"userinfo\"] = this.props.userInfo;\r\n    let postParam = undefined;\r\n    let editId = this.props.controlMap.has(\"AddMethodValidity\") && this.props.controlMap.get(\"AddMethodValidity\").ncontrolcode\r\n    // if (this.state.selectedRecord[\"ncommentsubtypecode\"].value === 3) {\r\n    //     if (this.state.selectedRecord[\"spredefinedname\"] === undefined || \r\n    //          this.state.selectedRecord[\"spredefinedname\"] === \"\") {\r\n    //         toast.info(\"Enter PreDefined Name\");\r\n    //         return;\r\n    //     }\r\n    // }\r\n  //   if (this.state.selectedRecord[\"dvalidityenddate\"] !== undefined && this.state.selectedRecord[\"dvaliditystartdate\"] !== undefined) {\r\n  //     if (this.state.selectedRecord[\"dvalidityenddate\"] < this.state.selectedRecord[\"dvaliditystartdate\"]) {\r\n  //         toast.info(this.props.intl.formatMessage({ id: \"IDS_ENDDATEGRATERTHANSTARTDATE\" }));\r\n  //         return;\r\n  //     }\r\n  // }\r\n  let obj= convertDateValuetoString(this.state.selectedRecord[\"dvaliditystartdate\"] ? this.state.selectedRecord[\"dvaliditystartdate\"]: new Date(),this.state.selectedRecord[\"dvalidityenddate\"]?this.state.selectedRecord[\"dvalidityenddate\"]:new Date(),this.props.userInfo);\r\n  this.state.selectedRecord[\"svaliditystartdate\"]=obj.fromDate;\r\n  this.state.selectedRecord[\"svalidityenddate\"]=obj.toDate;\r\n    if (this.props.operation === \"update\") {\r\n        // edit\r\n        postParam = { inputListName: \"methodvalidity\", selectedObject: \"MethodValidity\", primaryKeyField: \"nmethodvaliditycode\",\r\n        primaryKeyValue: this.state.selectedRecord[\"nmethodvaliditycode\"],\r\n         fetchUrl: \"method/getActiveMethodValidityById\", fecthInputObject: { userinfo: this.props.userInfo },\r\n         masterData: this.props.masterData \r\n      }\r\n        inputData[\"methodvalidity\"] = { \"nsitecode\": this.props.userInfo.nmastersitecode };\r\n        \r\n        inputData[\"methodvalidity\"][\"dvaliditystartdate\"] = this.state.selectedRecord[\"dvaliditystartdate\"] ? formatInputDate(this.state.selectedRecord[\"dvaliditystartdate\"]) : formatInputDate(new Date());\r\n        inputData[\"methodvalidity\"][\"dvalidityenddate\"] = this.state.selectedRecord[\"dvalidityenddate\"] ? this.state.selectedRecord[\"dvalidityenddate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"svaliditystartdate\"] = this.state.selectedRecord[\"svaliditystartdate\"] ? this.state.selectedRecord[\"svaliditystartdate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"svalidityenddate\"] = this.state.selectedRecord[\"svalidityenddate\"] ? this.state.selectedRecord[\"svalidityenddate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"nmethodcode\"] =this.props.selectedMethod.nmethodcode;\r\n        inputData[\"methodvalidity\"][\"nmethodvaliditycode\"] =this.state.selectedRecord[\"nmethodvaliditycode\"] ? this.state.selectedRecord[\"nmethodvaliditycode\"] : 0;\r\n        editId = this.props.controlMap.has(\"EditMethodValidity\") && this.props.controlMap.get(\"EditMethodValidity\").ncontrolcode\r\n    } else {\r\n        inputData[\"methodvalidity\"] = { \"nsitecode\": this.props.userInfo.nmastersitecode };\r\n        \r\n        inputData[\"methodvalidity\"][\"dvaliditystartdate\"] = this.state.selectedRecord[\"dvaliditystartdate\"] ? this.state.selectedRecord[\"dvaliditystartdate\"] :new Date();\r\n        inputData[\"methodvalidity\"][\"dvalidityenddate\"] = this.state.selectedRecord[\"dvalidityenddate\"] ? this.state.selectedRecord[\"dvalidityenddate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"svaliditystartdate\"] = this.state.selectedRecord[\"svaliditystartdate\"] ? this.state.selectedRecord[\"svaliditystartdate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"svalidityenddate\"] = this.state.selectedRecord[\"svalidityenddate\"] ? this.state.selectedRecord[\"svalidityenddate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"nmethodcode\"] =this.props.selectedMethod.nmethodcode;\r\n    }\r\n    \r\n        \r\n    const inputParam = {\r\n        classUrl: \"method\",\r\n        methodUrl: \"MethodValidity\",\r\n        displayName:\"IDS_METHOD\",\r\n        inputData: inputData,\r\n        operation: this.props.operation,\r\n        saveType, formRef, postParam, searchRef: this.searchRef\r\n    }\r\n    const masterData = this.props.masterData;\r\n    const esignNeeded  = showEsign(this.props.esignRights, this.props.userInfo.nformcode, editId)\r\n    if (esignNeeded) {\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: {\r\n                loadEsign: true, screenData: { inputParam, masterData }, saveType\r\n            }\r\n        }\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n    else {\r\n        \r\n        this.props.crudMaster(inputParam, masterData, \"openChildModal\");\r\n    }\r\n  };\r\n  validateEsign = () => {\r\n    const inputParam = {\r\n        inputData: {\r\n            \"userinfo\": {\r\n                ...this.props.userInfo,\r\n                sreason: this.state.selectedRecord[\"esigncomments\"],\r\n                nreasoncode:this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\r\n                spredefinedreason:this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label,\r\n           \r\n            },\r\n            password: this.state.selectedRecord[\"esignpassword\"]\r\n        },\r\n        screenData: this.props.screenData\r\n    }\r\n    this.props.validateEsignCredential(inputParam, \"openChildModal\");\r\n}\r\n  ConfirmDelete = (deleteParam, deleteID) => {\r\n    this.confirmMessage.confirm(\r\n      \"deleteMessage\",\r\n      this.props.intl.formatMessage({ id: \"IDS_DELETE\" }),\r\n      this.props.intl.formatMessage({ id: \"IDS_DEFAULTCONFIRMMSG\" }),\r\n      this.props.intl.formatMessage({ id: \"IDS_OK\" }),\r\n      this.props.intl.formatMessage({ id: \"IDS_CANCEL\" }),\r\n      () => this.deleteRecord(deleteParam)\r\n    );\r\n  };\r\n  componentDidUpdate(previousProps) {\r\n    if (this.props.selectedRecord !== previousProps.selectedRecord) {\r\n      this.setState({ selectedRecord: this.props.selectedRecord });\r\n    }\r\n\r\n    \r\n   \r\n    if (this.props.masterData !== previousProps.masterData) {\r\n      let { methodValidityDataState, selectedRecord } = this.state;\r\n      if (this.props.dataState === undefined) {\r\n        if (this.props.screenName === \"IDS_METHODVALIDITY\") {\r\n          methodValidityDataState = { skip: 0, take: 10 };\r\n        }\r\n      }\r\n      //this.props.masterData.MethodValidity\r\n      \r\n      this.setState({ methodValidityDataState, selectedRecord });\r\n    }\r\n    if (this.props.Login !== previousProps.Login) {\r\n      this.PrevoiusLoginData = previousProps;\r\n    }\r\n\r\n    // if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n    //     this.setState({ selectedRecord: this.props.Login.selectedRecord });\r\n    // }\r\n    // if (this.props.Login.userInfo.nformcode !== previousProps.Login.userInfo.nformcode) {\r\n    //     const userRoleControlRights = [];\r\n    //     if (this.props.Login.userRoleControlRights) {\r\n    //         this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode] && Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(item =>\r\n    //             userRoleControlRights.push(item.ncontrolcode))\r\n    //     }\r\n    //     const controlMap = getControlMap(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode)\r\n    //     this.setState({ userRoleControlRights, controlMap });\r\n    // }\r\n  }\r\n}\r\nexport default injectIntl(MethodValidityView);\r\n"]},"metadata":{},"sourceType":"module"}