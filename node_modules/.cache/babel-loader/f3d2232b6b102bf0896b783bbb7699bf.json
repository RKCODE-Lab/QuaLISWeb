{"ast":null,"code":"var _jsxFileName = \"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\branches\\\\SOURCE-513-PROD\\\\SOURCE-513-ALPD-5304\\\\QuaLISWeb\\\\src\\\\pages\\\\project\\\\ProjectMasterTab.jsx\";\nimport React from 'react';\nimport { Row, Col, Card } from 'react-bootstrap';\nimport { injectIntl } from 'react-intl'; //FormattedMessage,\n\nimport SlideOutModal from '../../components/slide-out-modal/SlideOutModal';\nimport { toast } from 'react-toastify';\nimport Esign from '../audittrail/Esign';\nimport { DEFAULT_RETURN } from '../../actions/LoginTypes';\nimport { showEsign, create_UUID, Lims_JSON_stringify, replaceBackSlash } from '../../components/CommonScript';\nimport ProjectMasterMemberTabs from './ProjectMasterMemberTabs';\nimport ProjectMasterFileTab from './ProjectMasterFileTab';\nimport { transactionStatus, attachmentType } from '../../components/Enumeration';\nimport CustomTabs from '../../components/custom-tabs/custom-tabs.component';\nimport AddProjectMember from \"../../pages/project/AddProjectMember\";\nimport AddProjectMasterFile from './AddProjectMasterFile';\nimport { formatInputDate } from \"../../components/CommonScript\";\nimport ProjectMasterHistory from \"../../pages/project/ProjectMasterHistory\";\nimport ProjectMasterQuotation from \"../../pages/project/ProjectMasterQuotation\";\nimport AddProjectQuotation from './AddProjectQuotation';\n\nclass ProjectMasterTab extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onTabChange = tabProps => {\n      const screenName = tabProps.screenName;\n      const updateInfo = {\n        typeName: DEFAULT_RETURN,\n        data: {\n          screenName\n        }\n      };\n      this.props.updateStore(updateInfo);\n    };\n\n    this.onComboChange = (comboData, fieldName) => {\n      const selectedRecord = this.state.selectedRecord || {};\n      selectedRecord[fieldName] = comboData;\n      this.setState({\n        selectedRecord\n      });\n    };\n\n    this.tabDetail = () => {\n      const addteammembersId = this.props.controlMap.has(\"AddTeammembers\") && this.props.controlMap.get(\"AddTeammembers\").ncontrolcode;\n      const deleteteammembersId = this.props.controlMap.has(\"DeleteTeammembers\") && this.props.controlMap.get(\"DeleteTeammembers\").ncontrolcode;\n      const projectmasterAddParam = {\n        screenName: \"IDS_MEMBERS\",\n        operation: \"create\",\n        primaryKeyField: \"nprojectmembercode\",\n        masterData: this.props.masterData,\n        userInfo: this.props.userInfo,\n        ncontrolCode: addteammembersId\n      };\n      const projectmasterDeleteParam = {\n        //    screenName: \"IDS_MEMBERS\", methodUrl: \"ProjectMember\", operation: \"delete\", ncontrolCode: deleteteammembersId \n        screenName: \"IDS_MEMBERS\",\n        operation: \"delete\",\n        primaryKeyField: \"nprojectmembercode\",\n        masterData: this.props.masterData,\n        userInfo: this.props.userInfo,\n        ncontrolCode: deleteteammembersId\n      };\n      const tabMap = new Map();\n      tabMap.set(\"IDS_MEMBERS\", /*#__PURE__*/React.createElement(ProjectMasterMemberTabs, {\n        userRoleControlRights: this.props.userRoleControlRights,\n        controlMap: this.props.controlMap,\n        inputParam: this.props.inputParam,\n        userInfo: this.props.userInfo,\n        addId: addteammembersId,\n        addParam: projectmasterAddParam,\n        comboDataService: this.props.getProjectmasterAddMemberService,\n        addTitleIDS: \"IDS_PROJECTMEMBER\",\n        addTitleDefaultMsg: 'ProjectMember',\n        primaryKeyField: \"nprojectmembercode\",\n        masterData: this.props.masterData,\n        primaryList: \"ProjectMember\",\n        dataResult: this.props.dataResult,\n        dataState: this.props.dataState,\n        dataStateChange: this.props.dataStateChange,\n        columnList: this.projectmemberColumnList,\n        methodUrl: this.props.methodUrl,\n        deleteRecord: this.props.deleteRecord,\n        deleteParam: projectmasterDeleteParam,\n        settings: this.props.settings // deleteParam={deleteteammembersId}\n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 35\n        }\n      }));\n      tabMap.set(\"IDS_FILE\", /*#__PURE__*/React.createElement(ProjectMasterFileTab, {\n        controlMap: this.props.controlMap,\n        userRoleControlRights: this.props.userRoleControlRights,\n        userInfo: this.props.userInfo,\n        inputParam: this.props.inputParam,\n        deleteRecord: this.deleteRecord,\n        projectmasterfile: this.props.masterData.projectmasterFile || [],\n        getAvailableData: this.props.getAvailableData,\n        addProjectMasterFile: this.props.addProjectMasterFile,\n        viewProjectMasterFile: this.viewProjectMasterFile,\n        defaultRecord: this.defaultRecord // screenName=\"ProjectMaster File\"\n        ,\n        screenName: \"IDS_FILE\",\n        settings: this.props.settings,\n        ntransactionstatus: this.props.ntransactionstatus,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 32\n        }\n      })); //ALPD-3566 Start\n\n      tabMap.set(\"IDS_QUOTATION\", /*#__PURE__*/React.createElement(ProjectMasterQuotation, {\n        controlMap: this.props.controlMap,\n        userRoleControlRights: this.props.userRoleControlRights,\n        projectQuotationdataResult: this.props.projectQuotationdataResult,\n        projectQuotationDataState: this.props.projectQuotationDataState,\n        projectQuotationDataStateChange: this.props.projectQuotationDataStateChange,\n        SelectedProjectMaster: this.props.masterData.SelectedProjectMaster,\n        userInfo: this.props.userInfo,\n        inputParam: this.props.inputParam,\n        deleteProjectQuotation: this.props.deleteProjectQuotation,\n        defaultRecord: this.defaultRecord,\n        getAvailableQuotation: this.props.getAvailableQuotation,\n        getActiveProjectQuotationById: this.props.getActiveProjectQuotationById,\n        screenName: \"IDS_QUOTATION\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 9\n        }\n      })); //ALPD-3566 End\n\n      tabMap.set(\"IDS_HISTORY\", /*#__PURE__*/React.createElement(ProjectMasterHistory, {\n        controlMap: this.props.controlMap,\n        userRoleControlRights: this.props.userRoleControlRights,\n        userInfo: this.props.userInfo,\n        inputParam: this.props.inputParam,\n        projectMasterdataResult: this.props.projectMasterdataResult,\n        projectMasterHistorydata: this.props.projectMasterHistorydata,\n        historydataStateChange: this.props.historydataStateChange,\n        dataState: this.props.dataState // screenName=\"ProjectMaster File\"\n        ,\n        screenName: \"IDS_HISTORY\",\n        settings: this.props.settings,\n        ntransactionstatus: this.props.ntransactionstatus,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 35\n        }\n      }));\n      return tabMap;\n    };\n\n    this.closeModal = () => {\n      let loadEsign = this.props.loadEsign;\n      let openChildModal = this.props.openChildModal;\n      let selectedRecord = this.props.selectedRecord; //    let selectedRecord = this.state.selectedRecord;\n\n      if (this.props.loadEsign) {\n        if (this.props.operation === \"delete\") {\n          loadEsign = false;\n          openChildModal = false;\n          selectedRecord = {};\n        } else {\n          loadEsign = false;\n          selectedRecord['esignpassword'] = '';\n          selectedRecord['esigncomments'] = '';\n          selectedRecord['esignreason'] = '';\n        }\n      } else {\n        openChildModal = false;\n        selectedRecord = {};\n      }\n\n      const updateInfo = {\n        typeName: DEFAULT_RETURN,\n        data: {\n          openChildModal,\n          loadEsign,\n          selectedRecord\n        }\n      };\n      this.props.updateStore(updateInfo);\n    };\n\n    this.viewProjectMasterFile = filedata => {\n      const inputParam = {\n        inputData: {\n          projectmasterfile: filedata,\n          userinfo: this.props.userInfo\n        },\n        classUrl: \"projectmaster\",\n        operation: \"view\",\n        methodUrl: \"AttachedProjectMasterFile\",\n        screenName: \"ProjectMaster File\"\n      };\n      this.props.viewAttachment(inputParam);\n    };\n\n    this.onSaveClick = (saveType, formRef) => {\n      let projectMasterData = [];\n      let inputParam = {};\n      projectMasterData[\"userinfo\"] = this.props.userInfo;\n      let clearSelectedRecordField = [];\n      let postParam = {\n        inputListName: \"ProjectMasterList\",\n        selectedObject: \"SelectedProjectMaster\",\n        primaryKeyField: \"nprojectmastercode\"\n      };\n\n      if (this.props.operation === \"update\" && this.props.screenName === \"IDS_ADDPROJECTMASTER\") {\n        postParam[\"primaryKeyValue\"] = this.props.masterData.SelectedProjectMaster.nprojectmastercode;\n        projectMasterData[\"projectMaster\"] = {\n          nprojectmastercode: this.props.masterData.SelectedProjectMaster.nprojectmastercode,\n          //     nprojecttypecode:this.state.selectedRecord.nprojecttypecode.value,\n          sprojecttitle: this.state.selectedRecord.sprojecttitle,\n          sprojectcode: this.state.selectedRecord.sprojectcode,\n          sprojectdescription: this.state.selectedRecord.sprojectdescription,\n          // drfwdate: formatInputDate(this.state.selectedRecord[\"drfwdate\"],false),\n          // dprojectstartdate: formatInputDate(this.state.selectedRecord[\"dprojectstartdate\"],false),\n          //     nstudydirectorcode:this.state.selectedRecord.nstudydirectorcode.value,\n          //     nteammembercode: this.state.selectedRecord.nteammembercode.value,\n          //     nperiodcode: this.state.selectedRecord.nperiodcode.value,\n          nprojectduration: this.state.selectedRecord.nprojectduration\n        };\n      } else if (this.props.operation === \"create\" && this.props.screenName === \"IDS_ADDPROJECTMASTER\") {\n        projectMasterData[\"projectMaster\"] = {\n          nsitecode: this.props.userInfo.nmastersitecode,\n          sprojecttitle: this.state.selectedRecord.sprojecttitle,\n          sprojectcode: this.state.selectedRecord.sprojectcode,\n          sprojectdescription: this.state.selectedRecord.sprojectdescription,\n          nprojectduration: parseInt(this.state.selectedRecord.nprojectduration)\n        };\n        /*     this.projectMasterFieldList.map((item) => {\r\n               return (projectMasterData[\"projectMaster\"][item] = this.state.selectedRecord[item] == \"\" || this.state.selectedRecord[item] == undefined ?\r\n               undefined :this.state.selectedRecord[item]);\r\n             }); */\n      } else if ((this.props.operation === \"create\" || this.props.operation === \"update\") && this.props.screenName === \"IDS_FILE\") {\n        inputParam = this.onSaveProjectMasterFile(saveType, formRef);\n        clearSelectedRecordField = [{\n          \"idsName\": \"IDS_FILENAME\",\n          \"dataField\": \"slinkfilename\",\n          \"width\": \"200px\",\n          \"controlType\": \"textbox\",\n          \"isClearField\": true\n        }, {\n          \"idsName\": \"IDS_DESCRIPTION\",\n          \"dataField\": \"sdescription\",\n          \"width\": \"200px\",\n          \"controlType\": \"textbox\",\n          \"isClearField\": true\n        }, {\n          \"idsName\": \"IDS_DESCRIPTION\",\n          \"dataField\": \"slinkdescription\",\n          \"width\": \"200px\",\n          \"controlType\": \"textbox\",\n          \"isClearField\": true\n        } //{ \"idsName\": \"IDS_DEFAULT\", \"dataField\": \"ndefaultstatus\", \"width\": \"100px\",\"isClearField\":true,\"preSetValue\":4},\n        ];\n      }\n\n      if ((this.props.operation === \"create\" || this.props.operation === \"update\") && this.props.screenName === \"IDS_ADDPROJECTMASTER\") {\n        projectMasterData[\"projectMaster\"][\"nprojecttypecode\"] = this.state.selectedRecord[\"nprojecttypecode\"] ? this.state.selectedRecord[\"nprojecttypecode\"].value : transactionStatus.NA;\n        projectMasterData[\"projectMaster\"][\"nstudydirectorcode\"] = this.state.selectedRecord[\"nstudydirectorcode\"] ? this.state.selectedRecord[\"nstudydirectorcode\"].value : transactionStatus.NA;\n        projectMasterData[\"projectMaster\"][\"nteammembercode\"] = this.state.selectedRecord[\"nteammembercode\"] ? this.state.selectedRecord[\"nteammembercode\"].value : transactionStatus.NA;\n        projectMasterData[\"projectMaster\"][\"nperiodcode\"] = this.state.selectedRecord[\"nperiodcode\"] ? this.state.selectedRecord[\"nperiodcode\"].value : transactionStatus.NA; // if (this.state.selectedRecord[\"drfwdate\"] || this.state.selectedRecord[\"dprojectstartdate\"]) {\n        //   if (this.props.Login.operation === \"create\") {\n\n        projectMasterData[\"projectMaster\"][\"drfwdate\"] = formatInputDate(this.state.selectedRecord[\"drfwdate\"], false);\n        projectMasterData[\"projectMaster\"][\"dprojectstartdate\"] = formatInputDate(this.state.selectedRecord[\"dprojectstartdate\"], false); //   }\n        //   else {\n        //     projectMasterData[\"projectMaster\"][\"drfwdate\"] = formatInputDate(this.state.selectedRecord[\"drfwdate\"],false);\n        //     projectMasterData[\"projectMaster\"][\"dprojectstartdate\"] = formatInputDate(this.state.selectedRecord[\"dprojectstartdate\"],false);\n        //   }\n        // }\n      }\n\n      if (this.props.operation === \"create\" && this.props.screenName === \"IDS_MEMBERS\") {\n        /*        projectMasterData[\"ProjectMember\"] = {};\r\n                  projectMasterData[\"ProjectMember\"][\"nusercode\"] = this.state.selectedRecord[\"nusercode\"][0] ? this.state.selectedRecord[\"nusercode\"][0].value\r\n                  : transactionStatus.NA;\r\n                  projectMasterData[\"ProjectMember\"][\"nprojectmastercode\"] =this.props.masterData.SelectedProjectMaster.nprojectmastercode; */\n        inputParam = this.onSaveProjectMasterMember(saveType, formRef);\n      }\n\n      if ((this.props.operation === \"create\" || this.props.operation === \"update\") && this.props.screenName === \"IDS_ADDPROJECTMASTER\") {\n        inputParam = {\n          classUrl: \"projectmaster\",\n          methodUrl: \"ProjectMaster\",\n          inputData: projectMasterData,\n          operation: this.props.operation,\n          saveType,\n          formRef,\n          postParam,\n          searchRef: this.searchRef,\n          isClearSearch: this.props.isClearSearch\n        };\n      }\n      /*else if ((this.props.operation === \"create\")  &&  (this.props.screenName === \"IDS_MEMBERS\")) {\r\n             inputParam = {\r\n         classUrl: \"projectmaster\",\r\n         methodUrl: \"ProjectMember\",\r\n         inputData: projectMasterData,\r\n         operation: this.props.operation,\r\n         saveType,\r\n         formRef,\r\n         postParam,\r\n         searchRef: this.searchRef,\r\n         isClearSearch: this.props.isClearSearch,\r\n       }\r\n      } */\n      //ALPD-3566 Start\n\n\n      if (this.props.screenName === \"IDS_QUOTATION\") {\n        inputParam = this.onSaveProjectQuotation(saveType, formRef, this.props.operation);\n        clearSelectedRecordField = [{\n          \"idsName\": \"IDS_REMARKS\",\n          \"dataField\": \"sremarks\",\n          \"width\": \"200px\",\n          \"controlType\": \"textbox\",\n          \"isClearField\": true\n        }, {\n          \"idsName\": \"IDS_DEFAULTSTATUS\",\n          \"dataField\": \"ndefaultstatus\",\n          \"width\": \"100px\",\n          \"isClearField\": true,\n          \"preSetValue\": 4\n        }];\n      }\n\n      const masterData = this.props.masterData;\n\n      if (showEsign(this.props.esignRights, this.props.userInfo.nformcode, this.props.ncontrolCode)) {\n        const updateInfo = {\n          typeName: DEFAULT_RETURN,\n          data: {\n            loadEsign: true,\n            screenData: {\n              inputParam,\n              masterData\n            },\n            saveType\n          }\n        };\n        this.props.updateStore(updateInfo);\n      } else {\n        if (this.props.operation === \"create\" && this.props.screenName === \"IDS_FILE\" || this.props.operation === \"create\" && this.props.screenName === \"IDS_QUOTATION\") {\n          this.props.crudMaster(inputParam, masterData, \"openChildModal\", \"\", \"\", clearSelectedRecordField);\n        } else {\n          this.props.crudMaster(inputParam, masterData, \"openChildModal\");\n        }\n      }\n    };\n\n    this.onSaveProjectMasterFile = (saveType, formRef) => {\n      const selectedRecord = this.props.selectedRecord;\n      const acceptedFiles = selectedRecord.sfilename;\n      const nattachmenttypecode = selectedRecord.nattachmenttypecode;\n      let isFileEdited = transactionStatus.NO;\n      let projectmasterFileArray = [];\n      let projectmasterFile = {\n        nprojectmastercode: this.props.masterData.SelectedProjectMaster.nprojectmastercode,\n        nprojecttypecode: this.props.masterData.SelectedProjectMaster.nprojecttypecode,\n        nprojectmasterfilecode: selectedRecord.nprojectmasterfilecode ? selectedRecord.nprojectmasterfilecode : 0,\n        nstatus: transactionStatus.ACTIVE,\n        nattachmenttypecode // ndefaultstatus: selectedRecord[nattachmenttypecode === attachmentType.LINK ? \"nlinkdefaultstatus\" : \"ndefaultstatus\"] ? selectedRecord[nattachmenttypecode === attachmentType.LINK ? \"nlinkdefaultstatus\" : \"ndefaultstatus\"] : 4\n\n      };\n      const formData = new FormData();\n\n      if (nattachmenttypecode === attachmentType.FTP) {\n        if (acceptedFiles && Array.isArray(acceptedFiles) && acceptedFiles.length > 0) {\n          acceptedFiles.forEach((file, index) => {\n            const tempData = Object.assign({}, projectmasterFile);\n            const splittedFileName = file.name.split('.');\n            const fileExtension = file.name.split('.')[splittedFileName.length - 1];\n            const ssystemfilename = selectedRecord.ssystemfilename ? selectedRecord.ssystemfilename.split('.') : \"\";\n            const filesystemfileext = selectedRecord.ssystemfilename ? file.name.split('.')[ssystemfilename.length - 1] : \"\";\n            const uniquefilename = nattachmenttypecode === attachmentType.FTP ? selectedRecord.nsupplierfilecode && selectedRecord.nsupplierfilecode > 0 && selectedRecord.ssystemfilename !== \"\" ? ssystemfilename[0] + '.' + filesystemfileext : create_UUID() + '.' + fileExtension : \"\";\n            tempData[\"sfilename\"] = Lims_JSON_stringify(file.name, false);\n            tempData[\"sdescription\"] = Lims_JSON_stringify(replaceBackSlash(selectedRecord.sdescription ? selectedRecord.sdescription.trim() : \"\"), false);\n            tempData[\"nlinkcode\"] = transactionStatus.NA;\n            tempData[\"ssystemfilename\"] = uniquefilename;\n            tempData[\"nfilesize\"] = file.size;\n            formData.append(\"uploadedFile\" + index, file);\n            formData.append(\"uniquefilename\" + index, uniquefilename);\n            projectmasterFileArray.push(tempData);\n          });\n          formData.append(\"filecount\", acceptedFiles.length);\n          isFileEdited = transactionStatus.YES;\n        } else {\n          projectmasterFile[\"sfilename\"] = Lims_JSON_stringify(selectedRecord.sfilename, false);\n          projectmasterFile[\"sdescription\"] = Lims_JSON_stringify(replaceBackSlash(selectedRecord.sdescription ? selectedRecord.sdescription.trim() : \"\"), false);\n          projectmasterFile[\"nlinkcode\"] = transactionStatus.NA;\n          projectmasterFile[\"ssystemfilename\"] = selectedRecord.ssystemfilename;\n          projectmasterFile[\"nfilesize\"] = selectedRecord.nfilesize;\n          projectmasterFileArray.push(projectmasterFile);\n        }\n      } else {\n        projectmasterFile[\"sfilename\"] = Lims_JSON_stringify(replaceBackSlash(selectedRecord.slinkfilename.trim()), false);\n        projectmasterFile[\"sdescription\"] = Lims_JSON_stringify(replaceBackSlash(selectedRecord.slinkdescription ? selectedRecord.slinkdescription.trim() : \"\"), false);\n        projectmasterFile[\"nlinkcode\"] = selectedRecord.nlinkcode.value ? selectedRecord.nlinkcode.value : -1;\n        projectmasterFile[\"ssystemfilename\"] = \"\";\n        projectmasterFile[\"nfilesize\"] = 0;\n        projectmasterFileArray.push(projectmasterFile);\n      }\n\n      formData.append(\"isFileEdited\", isFileEdited);\n      formData.append(\"projectmasterfile\", JSON.stringify(projectmasterFileArray)); // formData.append(\"userinfo\", JSON.stringify(this.props.userInfo));\n      //let selectedId = null;\n\n      let postParam = undefined;\n\n      if (this.props.operation === \"update\") {\n        // edit\n        postParam = {\n          inputListName: \"ProjectMaster\",\n          selectedObject: \"SelectedProjectMaster\",\n          primaryKeyField: \"nprojectmastercode\"\n        }; // selectedId = selectedRecord[\"nprojectmasterfilecode\"];\n      }\n\n      const inputParam = {\n        // inputData: { userinfo: this.props.userInfo },\n        inputData: {\n          \"userinfo\": { ...this.props.userInfo,\n            sformname: Lims_JSON_stringify(this.props.userInfo.sformname),\n            smodulename: Lims_JSON_stringify(this.props.userInfo.smodulename),\n            //ALPD-1826(while saving the file and link,audit trail is not captured the respective language)\n            slanguagename: Lims_JSON_stringify(this.props.userInfo.slanguagename)\n          }\n        },\n        formData: formData,\n        isFileupload: true,\n        operation: this.props.operation,\n        classUrl: \"projectmaster\",\n        saveType,\n        formRef,\n        methodUrl: \"ProjectMasterFile\",\n        postParam,\n        selectedRecord: { ...selectedRecord\n        }\n      };\n      return inputParam;\n    };\n\n    this.deleteRecord = projectmasterfileparam => {\n      if (this.props.masterData.SelectedProjectMaster.ntransactionstatus === transactionStatus.DRAFT) {\n        let inputParam = {}; // let inputData = {};\n        // if (this.props.screenName === 'ProjectMaster File') { \n\n        let selectedRecord = projectmasterfileparam.selectedRecord;\n        selectedRecord = { ...selectedRecord,\n          ntransactionstatus: this.props.masterData.SelectedProjectMaster.ntransactionstatus\n        }; // inputData[\"projectmasterfile\"]={\n        //     selectedRecord                    \n        //     };\n        //        if (this.props.screenName === 'IDS_FILE') {\n\n        inputParam = {\n          classUrl: \"projectmaster\",\n          methodUrl: projectmasterfileparam.methodUrl,\n          inputData: {\n            \"projectmasterfile\": selectedRecord,\n            \"userinfo\": this.props.userInfo\n          },\n          operation: projectmasterfileparam.operation,\n          //dataState: this.state.dataState,\n          //dataStateMaterial: this.state.dataStateMaterial\n          dataState: this.state.dataState\n        }; //          }\n\n        if (showEsign(this.props.esignRights, this.props.userInfo.nformcode, projectmasterfileparam.ncontrolCode)) {\n          const updateInfo = {\n            typeName: DEFAULT_RETURN,\n            data: {\n              loadEsign: true,\n              screenData: {\n                inputParam,\n                masterData: this.props.masterData\n              },\n              openChildModal: true,\n              screenName: projectmasterfileparam.screenName,\n              operation: projectmasterfileparam.operation\n            }\n          };\n          this.props.updateStore(updateInfo);\n        } else {\n          this.props.crudMaster(inputParam, this.props.masterData, \"openChildModal\");\n        }\n      } else {\n        toast.warn(this.props.intl.formatMessage({\n          id: \"IDS_SELECTDRAFTVERSION\"\n        }));\n      }\n    };\n\n    this.validateEsign = () => {\n      const inputParam = {\n        inputData: {\n          \"userinfo\": { ...this.props.userInfo,\n            sreason: this.props.selectedRecord[\"esigncomments\"],\n            nreasoncode: this.props.selectedRecord[\"esignreason\"] && this.props.selectedRecord[\"esignreason\"].value,\n            spredefinedreason: this.props.selectedRecord[\"esignreason\"] && this.props.selectedRecord[\"esignreason\"].label\n          },\n          password: this.props.selectedRecord[\"esignpassword\"]\n        },\n        screenData: this.props.screenData\n      };\n      this.props.validateEsignCredential(inputParam, \"openChildModal\");\n    };\n\n    const dataState = {\n      skip: 0,\n      take: this.props.settings ? parseInt(this.props.settings[14]) : 5\n    };\n    this.state = {\n      isOpen: false,\n      selectedRecord: {},\n      dataResult: [],\n      activeTab: 'ProjectMembers-tab',\n      dataState: dataState\n    };\n    this.projectmemberColumnList = [{\n      \"idsName\": \"IDS_LOGINID\",\n      \"dataField\": \"sloginid\",\n      \"width\": \"200px\"\n    }, {\n      \"idsName\": \"IDS_USER\",\n      \"dataField\": \"steammembername\",\n      \"width\": \"200px\"\n    }];\n  }\n\n  findMandatoryFields(screenName) {\n    let mandatoryFields = [];\n\n    if (screenName === 'IDS_FILE') {\n      if (this.props.selectedRecord.nattachmenttypecode === attachmentType.LINK) {\n        mandatoryFields = [{\n          \"idsName\": \"IDS_FILENAME\",\n          \"dataField\": \"slinkfilename\",\n          \"mandatory\": true,\n          \"mandatoryLabel\": \"IDS_CHOOSE\",\n          \"controlType\": \"file\"\n        }, {\n          \"idsName\": \"IDS_LINKNAME\",\n          \"dataField\": \"nlinkcode\",\n          \"mandatory\": true,\n          \"mandatoryLabel\": \"IDS_SELECT\",\n          \"controlType\": \"selectbox\"\n        }];\n      } else {\n        mandatoryFields = [{\n          \"idsName\": \"IDS_FILE\",\n          \"dataField\": \"sfilename\",\n          \"mandatory\": true,\n          \"mandatoryLabel\": \"IDS_CHOOSE\",\n          \"controlType\": \"file\"\n        }];\n      }\n\n      mandatoryFields.forEach(item => item.mandatory === true && mandatoryFields.push(item));\n      return mandatoryFields;\n    } else if (screenName === 'IDS_MEMBERS') {\n      mandatoryFields = [{\n        \"idsName\": \"IDS_USER\",\n        \"dataField\": \"nusercode\",\n        \"width\": \"200px\",\n        \"mandatory\": true,\n        \"mandatoryLabel\": \"IDS_SELECT\",\n        \"controlType\": \"selectbox\"\n      }];\n      mandatoryFields.forEach(item => item.mandatory === true && mandatoryFields.push(item));\n      return mandatoryFields;\n    } else if (screenName === 'IDS_QUOTATION') {\n      mandatoryFields = [{\n        \"idsName\": \"IDS_QUOTATION\",\n        \"dataField\": \"nquotationcode\",\n        \"width\": \"200px\",\n        \"mandatory\": true,\n        \"mandatoryLabel\": \"IDS_SELECT\",\n        \"controlType\": \"selectbox\"\n      }];\n      mandatoryFields.forEach(item => item.mandatory === true && mandatoryFields.push(item));\n      return mandatoryFields;\n    } else {\n      return [];\n    }\n  }\n\n  render() {\n    // const mandatoryFields = [];\n    // let mandatoryFields = [];\n    if (this.props.openChildModal) {\n      this.mandatoryFields = this.findMandatoryFields(this.props.screenName);\n    } // if (this.props.screenName === 'IDS_FILE') {\n    //     if (this.state.selectedRecord && this.state.selectedRecord.nattachmenttypecode === attachmentType.LINK) {\n    //         mandatoryFields = [\n    //             { \"idsName\": \"IDS_FILENAME\", \"dataField\": \"slinkfilename\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" },\n    //             { \"idsName\": \"IDS_LINKNAME\", \"dataField\": \"nlinkcode\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }\n    //         ];\n    //     } else {\n    //         mandatoryFields = [{ \"idsName\": \"IDS_FILE\", \"dataField\": \"sfilename\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" }];\n    //     }\n    // } else if (this.props.screenName === 'IDS_MEMBERS') {\n    //     mandatoryFields = [{ \"idsName\": \"IDS_USER\", \"dataField\": \"nusercode\", \"width\": \"200px\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }];\n    // }\n\n\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n      className: \"no-gutters\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"at-tabs\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(CustomTabs, {\n      tabDetail: this.tabDetail(),\n      onTabChange: this.onTabChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 29\n      }\n    })))), this.props.openChildModal && /*#__PURE__*/React.createElement(SlideOutModal, {\n      show: this.props.openChildModal,\n      closeModal: this.closeModal,\n      operation: this.props.operation,\n      inputParam: this.props.inputParam,\n      screenName: this.props.screenName,\n      showSaveContinue: this.props.screenName === \"IDS_FILE\" || this.props.screenName === \"IDS_QUOTATION\" ? true : false,\n      onSaveClick: this.onSaveClick,\n      updateStore: this.props.updateStore,\n      esign: this.props.loadEsign,\n      validateEsign: this.validateEsign,\n      selectedRecord: this.props.selectedRecord || {} // mandatoryFields={this.props.screenName === \"IDS_MEMBERS\" ? mandatoryFields : mandatoryFields || []}\n      ,\n      mandatoryFields: this.mandatoryFields || [],\n      addComponent: this.props.loadEsign ? /*#__PURE__*/React.createElement(Esign, {\n        operation: this.props.operation,\n        onInputOnChange: this.props.onInputOnChange,\n        inputParam: this.props.inputParam,\n        selectedRecord: this.props.selectedRecord || {},\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 29\n        }\n      }) : this.props.screenName === \"IDS_MEMBERS\" ? /*#__PURE__*/React.createElement(AddProjectMember, {\n        MembersList: this.props.MembersList // selectedRecord={this.state.selectedRecord || {}}\n        ,\n        selectedRecord: this.props.selectedRecord || {} //  onComboChange={this.onComboChange}\n        ,\n        onComboChange: this.props.onComboChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 33\n        }\n      }) : this.props.screenName === \"IDS_FILE\" ? /*#__PURE__*/React.createElement(AddProjectMasterFile, {\n        selectedRecord: this.props.selectedRecord || {},\n        onInputOnChange: this.props.onInputOnChange,\n        onDrop: this.props.onDropProjectMasterFile,\n        onDropAccepted: this.onDropAccepted,\n        deleteAttachment: this.props.deleteAttachment,\n        actionType: this.state.actionType // onComboChange={this.onComboChange}\n        ,\n        onComboChange: this.props.onComboChange,\n        linkMaster: this.props.linkMaster,\n        editFiles: this.props.editFiles,\n        maxSize: 20,\n        maxFiles: 1,\n        multiple: false,\n        label: this.props.intl.formatMessage({\n          id: \"IDS_FILENAME\"\n        }),\n        name: \"projectmasterfilename\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 37\n        }\n      }) : //ALPD-3566 Start\n      this.props.screenName === \"IDS_QUOTATION\" ? /*#__PURE__*/React.createElement(AddProjectQuotation, {\n        selectedRecord: this.props.selectedRecord || {},\n        ProjectQuotationList: this.props.ProjectQuotationList,\n        onComboChange: this.props.onComboChange,\n        isMulti: false,\n        onInputOnChange: this.props.onInputOnChange,\n        operation: this.props.operation || \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 37\n        }\n      }) : \"\" //ALPD-3566 End\n      ,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 21\n      }\n    }));\n  }\n\n  onSaveProjectQuotation(saveType, formRef, operation) {\n    let inputData = [];\n    inputData[\"userinfo\"] = this.props.userInfo;\n    inputData[\"ProjectQuotation\"] = {}; // let projectQuotationArray = []\n\n    if (operation === \"create\") {\n      // projectQuotationArray = this.props.selectedRecord.nquotationcode.map(item => {\n      let projectQuotationData = {};\n      projectQuotationData[\"nquotationcode\"] = this.props.selectedRecord && this.props.selectedRecord.nquotationcode && this.props.selectedRecord.nquotationcode.value;\n      projectQuotationData[\"nprojectmastercode\"] = this.props.masterData.SelectedProjectMaster.nprojectmastercode;\n      projectQuotationData['sremarks'] = this.props.selectedRecord && this.props.selectedRecord.sremarks ? this.props.selectedRecord.sremarks : \"\";\n      projectQuotationData['ndefaultstatus'] = this.props.selectedRecord && this.props.selectedRecord.ndefaultstatus ? this.props.selectedRecord.ndefaultstatus : transactionStatus.NO; //     return projectQuotationData;\n      //  });\n\n      inputData['ProjectQuotation'] = projectQuotationData;\n    } else {\n      inputData[\"ProjectQuotation\"][\"nquotationcode\"] = this.props.selectedRecord && this.props.selectedRecord.nquotationcode && this.props.selectedRecord.nquotationcode.value;\n      inputData[\"ProjectQuotation\"][\"nprojectmastercode\"] = this.props.masterData.SelectedProjectMaster.nprojectmastercode;\n      inputData[\"ProjectQuotation\"][\"sremarks\"] = this.props.selectedRecord && this.props.selectedRecord.sremarks ? this.props.selectedRecord.sremarks : \"\";\n      inputData[\"ProjectQuotation\"][\"ndefaultstatus\"] = this.props.selectedRecord && this.props.selectedRecord.ndefaultstatus ? this.props.selectedRecord.ndefaultstatus : transactionStatus.NO;\n      inputData[\"ProjectQuotation\"][\"nprojectquotationcode\"] = this.props.selectedRecord && this.props.selectedRecord.nprojectquotationcode;\n    }\n\n    const inputParam = {\n      classUrl: \"projectmaster\",\n      methodUrl: \"ProjectQuotation\",\n      inputData: inputData,\n      operation: operation,\n      saveType,\n      formRef,\n      selectedRecord: { ...this.props.selectedRecord\n      }\n    };\n    return inputParam;\n  } //ALPD-3566 End\n\n\n  onSaveProjectMasterMember(saveType, formRef) {\n    let inputData = [];\n    inputData[\"userinfo\"] = this.props.userInfo; // inputData[\"supplier\"] = this.props.masterData.SelectedSupplier;\n\n    inputData[\"ProjectMember\"] = {};\n    let projectmemberArray = [];\n    projectmemberArray = this.props.selectedRecord.nusercode.map(item => {\n      let projectMasterData = {};\n      projectMasterData[\"nusercode\"] = item.value;\n      projectMasterData[\"nprojectmastercode\"] = this.props.masterData.SelectedProjectMaster.nprojectmastercode;\n      return projectMasterData;\n    });\n    inputData['ProjectMember'] = projectmemberArray;\n    const inputParam = {\n      classUrl: \"projectmaster\",\n      methodUrl: \"ProjectMember\",\n      inputData: inputData,\n      operation: this.props.operation,\n      saveType,\n      formRef\n    };\n    return inputParam;\n  }\n\n}\n\nexport default injectIntl(ProjectMasterTab);","map":{"version":3,"sources":["E:/WorkingFolder/React_Postgres/ALPD/branches/SOURCE-513-PROD/SOURCE-513-ALPD-5304/QuaLISWeb/src/pages/project/ProjectMasterTab.jsx"],"names":["React","Row","Col","Card","injectIntl","SlideOutModal","toast","Esign","DEFAULT_RETURN","showEsign","create_UUID","Lims_JSON_stringify","replaceBackSlash","ProjectMasterMemberTabs","ProjectMasterFileTab","transactionStatus","attachmentType","CustomTabs","AddProjectMember","AddProjectMasterFile","formatInputDate","ProjectMasterHistory","ProjectMasterQuotation","AddProjectQuotation","ProjectMasterTab","Component","constructor","props","onTabChange","tabProps","screenName","updateInfo","typeName","data","updateStore","onComboChange","comboData","fieldName","selectedRecord","state","setState","tabDetail","addteammembersId","controlMap","has","get","ncontrolcode","deleteteammembersId","projectmasterAddParam","operation","primaryKeyField","masterData","userInfo","ncontrolCode","projectmasterDeleteParam","tabMap","Map","set","userRoleControlRights","inputParam","getProjectmasterAddMemberService","dataResult","dataState","dataStateChange","projectmemberColumnList","methodUrl","deleteRecord","settings","projectmasterFile","getAvailableData","addProjectMasterFile","viewProjectMasterFile","defaultRecord","ntransactionstatus","projectQuotationdataResult","projectQuotationDataState","projectQuotationDataStateChange","SelectedProjectMaster","deleteProjectQuotation","getAvailableQuotation","getActiveProjectQuotationById","projectMasterdataResult","projectMasterHistorydata","historydataStateChange","closeModal","loadEsign","openChildModal","filedata","inputData","projectmasterfile","userinfo","classUrl","viewAttachment","onSaveClick","saveType","formRef","projectMasterData","clearSelectedRecordField","postParam","inputListName","selectedObject","nprojectmastercode","sprojecttitle","sprojectcode","sprojectdescription","nprojectduration","nsitecode","nmastersitecode","parseInt","onSaveProjectMasterFile","value","NA","onSaveProjectMasterMember","searchRef","isClearSearch","onSaveProjectQuotation","esignRights","nformcode","screenData","crudMaster","acceptedFiles","sfilename","nattachmenttypecode","isFileEdited","NO","projectmasterFileArray","nprojecttypecode","nprojectmasterfilecode","nstatus","ACTIVE","formData","FormData","FTP","Array","isArray","length","forEach","file","index","tempData","Object","assign","splittedFileName","name","split","fileExtension","ssystemfilename","filesystemfileext","uniquefilename","nsupplierfilecode","sdescription","trim","size","append","push","YES","nfilesize","slinkfilename","slinkdescription","nlinkcode","JSON","stringify","undefined","sformname","smodulename","slanguagename","isFileupload","projectmasterfileparam","DRAFT","warn","intl","formatMessage","id","validateEsign","sreason","nreasoncode","spredefinedreason","label","password","validateEsignCredential","skip","take","isOpen","activeTab","findMandatoryFields","mandatoryFields","LINK","item","mandatory","render","onInputOnChange","MembersList","onDropProjectMasterFile","onDropAccepted","deleteAttachment","actionType","linkMaster","editFiles","ProjectQuotationList","projectQuotationData","nquotationcode","sremarks","ndefaultstatus","nprojectquotationcode","projectmemberArray","nusercode","map"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Row, Col, Card } from 'react-bootstrap';\r\nimport { injectIntl } from 'react-intl';  //FormattedMessage,\r\nimport SlideOutModal from '../../components/slide-out-modal/SlideOutModal';\r\nimport { toast } from 'react-toastify';\r\nimport Esign from '../audittrail/Esign';\r\nimport { DEFAULT_RETURN } from '../../actions/LoginTypes';\r\nimport { showEsign, create_UUID, Lims_JSON_stringify,replaceBackSlash } from '../../components/CommonScript';\r\nimport ProjectMasterMemberTabs from './ProjectMasterMemberTabs';\r\nimport ProjectMasterFileTab from './ProjectMasterFileTab';\r\nimport { transactionStatus, attachmentType } from '../../components/Enumeration';\r\nimport CustomTabs from '../../components/custom-tabs/custom-tabs.component';\r\nimport AddProjectMember from \"../../pages/project/AddProjectMember\";\r\nimport AddProjectMasterFile from './AddProjectMasterFile';\r\nimport { formatInputDate } from \"../../components/CommonScript\";\r\nimport ProjectMasterHistory from \"../../pages/project/ProjectMasterHistory\";\r\nimport ProjectMasterQuotation from \"../../pages/project/ProjectMasterQuotation\";\r\nimport AddProjectQuotation from './AddProjectQuotation';\r\n\r\nclass ProjectMasterTab extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        const dataState = {\r\n            skip: 0,\r\n            take: this.props.settings ? parseInt(this.props.settings[14]) : 5\r\n        };\r\n\r\n        this.state = {\r\n            isOpen: false, selectedRecord: {}, dataResult: [],\r\n            activeTab: 'ProjectMembers-tab',\r\n            dataState: dataState\r\n\r\n        };\r\n\r\n        this.projectmemberColumnList = [\r\n\r\n            { \"idsName\": \"IDS_LOGINID\", \"dataField\": \"sloginid\", \"width\": \"200px\" },\r\n            { \"idsName\": \"IDS_USER\", \"dataField\": \"steammembername\", \"width\": \"200px\" }\r\n\r\n        ]\r\n\r\n    }\r\n\r\n    findMandatoryFields(screenName) {\r\n        let mandatoryFields = [];\r\n        if (screenName === 'IDS_FILE') {\r\n\r\n            if (this.props.selectedRecord.nattachmenttypecode === attachmentType.LINK) {\r\n                mandatoryFields = [\r\n                    { \"idsName\": \"IDS_FILENAME\", \"dataField\": \"slinkfilename\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" },\r\n                    { \"idsName\": \"IDS_LINKNAME\", \"dataField\": \"nlinkcode\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }\r\n                ];\r\n            } else {\r\n\r\n                mandatoryFields = [{ \"idsName\": \"IDS_FILE\", \"dataField\": \"sfilename\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" }];\r\n\r\n            }\r\n            mandatoryFields.forEach(item => item.mandatory === true && mandatoryFields.push(item));\r\n            return mandatoryFields;\r\n        } else if (screenName === 'IDS_MEMBERS') {\r\n\r\n            mandatoryFields = [{ \"idsName\": \"IDS_USER\", \"dataField\": \"nusercode\", \"width\": \"200px\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }];\r\n\r\n            mandatoryFields.forEach(item => item.mandatory === true && mandatoryFields.push(item));\r\n            return mandatoryFields;\r\n        }else if (screenName === 'IDS_QUOTATION') {\r\n\r\n            mandatoryFields = [{ \"idsName\": \"IDS_QUOTATION\", \"dataField\": \"nquotationcode\", \"width\": \"200px\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }];\r\n\r\n            mandatoryFields.forEach(item => item.mandatory === true && mandatoryFields.push(item));\r\n            return mandatoryFields;\r\n        }\r\n        else {\r\n            return [];\r\n          }\r\n\r\n      }\r\n\r\n    render() {\r\n\r\n        // const mandatoryFields = [];\r\n        // let mandatoryFields = [];\r\n\r\n        if (this.props.openChildModal) {\r\n            this.mandatoryFields = this.findMandatoryFields(this.props.screenName)\r\n          }\r\n\r\n        // if (this.props.screenName === 'IDS_FILE') {\r\n\r\n        //     if (this.state.selectedRecord && this.state.selectedRecord.nattachmenttypecode === attachmentType.LINK) {\r\n        //         mandatoryFields = [\r\n        //             { \"idsName\": \"IDS_FILENAME\", \"dataField\": \"slinkfilename\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" },\r\n        //             { \"idsName\": \"IDS_LINKNAME\", \"dataField\": \"nlinkcode\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }\r\n        //         ];\r\n        //     } else {\r\n\r\n        //         mandatoryFields = [{ \"idsName\": \"IDS_FILE\", \"dataField\": \"sfilename\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" }];\r\n\r\n        //     }\r\n        // } else if (this.props.screenName === 'IDS_MEMBERS') {\r\n\r\n        //     mandatoryFields = [{ \"idsName\": \"IDS_USER\", \"dataField\": \"nusercode\", \"width\": \"200px\", \"mandatory\": true, \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }];\r\n        // }\r\n\r\n        return (\r\n            <>\r\n                <Row className=\"no-gutters\">\r\n                    <Col md={12}>\r\n                        <Card className=\"at-tabs\">\r\n                            <CustomTabs tabDetail={this.tabDetail()} onTabChange={this.onTabChange} />\r\n                        </Card>\r\n                    </Col>\r\n                </Row>\r\n\r\n                {this.props.openChildModal &&\r\n                    <SlideOutModal show={this.props.openChildModal} \r\n                        closeModal={this.closeModal}\r\n                        operation={this.props.operation}\r\n                        inputParam={this.props.inputParam}\r\n                        screenName={this.props.screenName}\r\n                        showSaveContinue={this.props.screenName === \"IDS_FILE\" || this.props.screenName === \"IDS_QUOTATION\"?true:false}\r\n                        onSaveClick={this.onSaveClick}\r\n                        updateStore={this.props.updateStore}\r\n                        esign={this.props.loadEsign}\r\n                        validateEsign={this.validateEsign}\r\n                        selectedRecord={this.props.selectedRecord || {}}\r\n                          // mandatoryFields={this.props.screenName === \"IDS_MEMBERS\" ? mandatoryFields : mandatoryFields || []}\r\n                        mandatoryFields={this.mandatoryFields|| []}\r\n                        addComponent={this.props.loadEsign ?\r\n                            <Esign operation={this.props.operation}\r\n                                onInputOnChange={this.props.onInputOnChange}\r\n                                inputParam={this.props.inputParam}\r\n                                selectedRecord={this.props.selectedRecord || {}}\r\n                            /> :\r\n                            this.props.screenName === \"IDS_MEMBERS\" ?\r\n                                <AddProjectMember\r\n                                    MembersList={this.props.MembersList}\r\n                                    // selectedRecord={this.state.selectedRecord || {}}\r\n                                    selectedRecord={this.props.selectedRecord || {}}\r\n                                    //  onComboChange={this.onComboChange}\r\n                                    onComboChange={this.props.onComboChange}\r\n\r\n                                /> :\r\n                                this.props.screenName === \"IDS_FILE\" ?\r\n                                    <AddProjectMasterFile\r\n                                        selectedRecord={this.props.selectedRecord || {}}\r\n                                        onInputOnChange={this.props.onInputOnChange}\r\n                                        onDrop={this.props.onDropProjectMasterFile}\r\n                                        onDropAccepted={this.onDropAccepted}\r\n                                        deleteAttachment={this.props.deleteAttachment}\r\n                                        actionType={this.state.actionType}\r\n                                        // onComboChange={this.onComboChange}\r\n                                        onComboChange={this.props.onComboChange}\r\n                                        linkMaster={this.props.linkMaster}\r\n                                        editFiles={this.props.editFiles}\r\n                                        maxSize={20}\r\n                                        maxFiles={1}\r\n                                        multiple={false}\r\n                                        label={this.props.intl.formatMessage({ id: \"IDS_FILENAME\" })}\r\n                                        name=\"projectmasterfilename\"\r\n                                    /> : \r\n                                    //ALPD-3566 Start\r\n                                    this.props.screenName === \"IDS_QUOTATION\" ?\r\n                                                        \r\n                                    <AddProjectQuotation\r\n                                    selectedRecord={this.props.selectedRecord || {}}\r\n                                    ProjectQuotationList={this.props.ProjectQuotationList}\r\n                                    onComboChange={this.props.onComboChange}\r\n                                    isMulti={false}\r\n                                    onInputOnChange={this.props.onInputOnChange}\r\n                                    operation={this.props.operation || \"\"}\r\n                                    />\r\n                                       :\"\"\r\n                                    //ALPD-3566 End\r\n                        }\r\n\r\n                    />\r\n                }\r\n            </>\r\n\r\n        )\r\n\r\n    }\r\n\r\n    onTabChange = (tabProps) => {\r\n        const screenName = tabProps.screenName;\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: { screenName }\r\n        }\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n\r\n\r\n    onComboChange = (comboData, fieldName) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n        selectedRecord[fieldName] = comboData;\r\n        this.setState({ selectedRecord });\r\n    }\r\n\r\n    tabDetail = () => {\r\n\r\n        const addteammembersId = this.props.controlMap.has(\"AddTeammembers\") && this.props.controlMap.get(\"AddTeammembers\").ncontrolcode;\r\n        const deleteteammembersId = this.props.controlMap.has(\"DeleteTeammembers\") && this.props.controlMap.get(\"DeleteTeammembers\").ncontrolcode;\r\n\r\n        const projectmasterAddParam = {\r\n            screenName: \"IDS_MEMBERS\", operation: \"create\", primaryKeyField: \"nprojectmembercode\",\r\n            masterData: this.props.masterData, userInfo: this.props.userInfo, ncontrolCode: addteammembersId\r\n        };\r\n\r\n        const projectmasterDeleteParam = {\r\n\r\n            //    screenName: \"IDS_MEMBERS\", methodUrl: \"ProjectMember\", operation: \"delete\", ncontrolCode: deleteteammembersId \r\n\r\n            screenName: \"IDS_MEMBERS\", operation: \"delete\", primaryKeyField: \"nprojectmembercode\",\r\n            masterData: this.props.masterData, userInfo: this.props.userInfo, ncontrolCode: deleteteammembersId\r\n        };\r\n\r\n\r\n\r\n        const tabMap = new Map();\r\n\r\n        tabMap.set(\"IDS_MEMBERS\", <ProjectMasterMemberTabs\r\n            userRoleControlRights={this.props.userRoleControlRights}\r\n            controlMap={this.props.controlMap}\r\n            inputParam={this.props.inputParam}\r\n            userInfo={this.props.userInfo}\r\n            addId={addteammembersId}\r\n            addParam={projectmasterAddParam}\r\n            comboDataService={this.props.getProjectmasterAddMemberService}\r\n            addTitleIDS={\"IDS_PROJECTMEMBER\"}\r\n            addTitleDefaultMsg={'ProjectMember'}\r\n            primaryKeyField={\"nprojectmembercode\"}\r\n            masterData={this.props.masterData}\r\n            primaryList={\"ProjectMember\"}\r\n            dataResult={this.props.dataResult}\r\n            dataState={this.props.dataState}\r\n            dataStateChange={this.props.dataStateChange}\r\n            columnList={this.projectmemberColumnList}\r\n            methodUrl={this.props.methodUrl}\r\n            deleteRecord={this.props.deleteRecord}\r\n            deleteParam={projectmasterDeleteParam}\r\n            settings={this.props.settings}\r\n        // deleteParam={deleteteammembersId}\r\n        />)\r\n\r\n\r\n        tabMap.set(\"IDS_FILE\", <ProjectMasterFileTab\r\n            controlMap={this.props.controlMap}\r\n            userRoleControlRights={this.props.userRoleControlRights}\r\n            userInfo={this.props.userInfo}\r\n            inputParam={this.props.inputParam}\r\n            deleteRecord={this.deleteRecord}\r\n            projectmasterfile={this.props.masterData.projectmasterFile || []}\r\n            getAvailableData={this.props.getAvailableData}\r\n            addProjectMasterFile={this.props.addProjectMasterFile}\r\n            viewProjectMasterFile={this.viewProjectMasterFile}\r\n            defaultRecord={this.defaultRecord}\r\n            // screenName=\"ProjectMaster File\"\r\n            screenName=\"IDS_FILE\"\r\n            settings={this.props.settings}\r\n            ntransactionstatus={this.props.ntransactionstatus}\r\n        />);\r\n        //ALPD-3566 Start\r\n        tabMap.set(\"IDS_QUOTATION\",\r\n        <ProjectMasterQuotation\r\n        controlMap={this.props.controlMap}\r\n        userRoleControlRights={this.props.userRoleControlRights}\r\n        projectQuotationdataResult={this.props.projectQuotationdataResult}\r\n        projectQuotationDataState={this.props.projectQuotationDataState}\r\n        projectQuotationDataStateChange={this.props.projectQuotationDataStateChange}\r\n        SelectedProjectMaster={this.props.masterData.SelectedProjectMaster}\r\n        userInfo={this.props.userInfo}\r\n        inputParam={this.props.inputParam}\r\n        deleteProjectQuotation={this.props.deleteProjectQuotation}\r\n        defaultRecord={this.defaultRecord}\r\n        getAvailableQuotation={this.props.getAvailableQuotation}\r\n        getActiveProjectQuotationById={this.props.getActiveProjectQuotationById}\r\n        screenName=\"IDS_QUOTATION\"\r\n    />\r\n);\r\n        //ALPD-3566 End\r\n        tabMap.set(\"IDS_HISTORY\", <ProjectMasterHistory\r\n        controlMap={this.props.controlMap}\r\n        userRoleControlRights={this.props.userRoleControlRights}\r\n        userInfo={this.props.userInfo}\r\n        inputParam={this.props.inputParam}\r\n        projectMasterdataResult={this.props.projectMasterdataResult}\r\n        projectMasterHistorydata={this.props.projectMasterHistorydata}\r\n        historydataStateChange={this.props.historydataStateChange}\r\n        dataState={this.props.dataState}\r\n\r\n        // screenName=\"ProjectMaster File\"\r\n        screenName=\"IDS_HISTORY\"\r\n        settings={this.props.settings}\r\n        ntransactionstatus={this.props.ntransactionstatus}\r\n        />);\r\n       \r\n        \r\n        return tabMap;\r\n    }\r\n\r\n\r\n    closeModal = () => {\r\n        let loadEsign = this.props.loadEsign;\r\n        let openChildModal = this.props.openChildModal;\r\n        let selectedRecord = this.props.selectedRecord;\r\n        //    let selectedRecord = this.state.selectedRecord;\r\n        if (this.props.loadEsign) {\r\n            if (this.props.operation === \"delete\") {\r\n                loadEsign = false;\r\n                openChildModal = false;\r\n                selectedRecord = {};\r\n            }\r\n            else {\r\n                loadEsign = false;\r\n                selectedRecord['esignpassword'] = '';\r\n                selectedRecord['esigncomments'] = '';\r\n                selectedRecord['esignreason'] = '';\r\n            }\r\n        }\r\n        else {\r\n            openChildModal = false;\r\n            selectedRecord = {};\r\n        }\r\n\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: { openChildModal, loadEsign, selectedRecord }\r\n        }\r\n        this.props.updateStore(updateInfo);\r\n\r\n    }\r\n\r\n\r\n    viewProjectMasterFile = (filedata) => {\r\n        const inputParam = {\r\n            inputData: {\r\n                projectmasterfile: filedata,\r\n                userinfo: this.props.userInfo\r\n            },\r\n            classUrl: \"projectmaster\",\r\n            operation: \"view\",\r\n            methodUrl: \"AttachedProjectMasterFile\",\r\n            screenName: \"ProjectMaster File\"\r\n        }\r\n        this.props.viewAttachment(inputParam);\r\n    }\r\n\r\n\r\n\r\n\r\n    onSaveClick = (saveType, formRef) => {\r\n\r\n        let projectMasterData = [];\r\n        let inputParam = {};\r\n        projectMasterData[\"userinfo\"] = this.props.userInfo;\r\n        let clearSelectedRecordField=[];\r\n        let postParam = {\r\n            inputListName: \"ProjectMasterList\",\r\n            selectedObject: \"SelectedProjectMaster\",\r\n            primaryKeyField: \"nprojectmastercode\",\r\n        };\r\n\r\n        if ((this.props.operation === \"update\") && (this.props.screenName === \"IDS_ADDPROJECTMASTER\")) {\r\n\r\n            postParam[\"primaryKeyValue\"] =\r\n                this.props.masterData.SelectedProjectMaster.nprojectmastercode;\r\n\r\n            projectMasterData[\"projectMaster\"] = {\r\n                nprojectmastercode: this.props.masterData.SelectedProjectMaster.nprojectmastercode,\r\n                //     nprojecttypecode:this.state.selectedRecord.nprojecttypecode.value,\r\n                sprojecttitle: this.state.selectedRecord.sprojecttitle,\r\n                sprojectcode: this.state.selectedRecord.sprojectcode,\r\n                sprojectdescription: this.state.selectedRecord.sprojectdescription,\r\n                // drfwdate: formatInputDate(this.state.selectedRecord[\"drfwdate\"],false),\r\n                // dprojectstartdate: formatInputDate(this.state.selectedRecord[\"dprojectstartdate\"],false),\r\n                //     nstudydirectorcode:this.state.selectedRecord.nstudydirectorcode.value,\r\n                //     nteammembercode: this.state.selectedRecord.nteammembercode.value,\r\n                //     nperiodcode: this.state.selectedRecord.nperiodcode.value,\r\n                nprojectduration: this.state.selectedRecord.nprojectduration,\r\n\r\n            };\r\n\r\n        } else if ((this.props.operation === \"create\") && (this.props.screenName === \"IDS_ADDPROJECTMASTER\")) {\r\n\r\n            projectMasterData[\"projectMaster\"] = {\r\n\r\n                nsitecode: this.props.userInfo.nmastersitecode,\r\n                sprojecttitle: this.state.selectedRecord.sprojecttitle,\r\n                sprojectcode: this.state.selectedRecord.sprojectcode,\r\n                sprojectdescription: this.state.selectedRecord.sprojectdescription,\r\n                nprojectduration: parseInt(this.state.selectedRecord.nprojectduration)\r\n            };\r\n\r\n            /*     this.projectMasterFieldList.map((item) => {\r\n                   return (projectMasterData[\"projectMaster\"][item] = this.state.selectedRecord[item] == \"\" || this.state.selectedRecord[item] == undefined ?\r\n                   undefined :this.state.selectedRecord[item]);\r\n                 }); */\r\n\r\n        } else if (((this.props.operation === \"create\") || (this.props.operation === \"update\")) && (this.props.screenName === \"IDS_FILE\")) {\r\n\r\n            inputParam = this.onSaveProjectMasterFile(saveType, formRef);\r\n\r\n            clearSelectedRecordField =[\r\n                { \"idsName\": \"IDS_FILENAME\", \"dataField\": \"slinkfilename\", \"width\": \"200px\" ,\"controlType\": \"textbox\",\"isClearField\":true},\r\n                { \"idsName\": \"IDS_DESCRIPTION\", \"dataField\": \"sdescription\", \"width\": \"200px\",\"controlType\": \"textbox\",\"isClearField\":true },\r\n                { \"idsName\": \"IDS_DESCRIPTION\", \"dataField\": \"slinkdescription\", \"width\": \"200px\",\"controlType\": \"textbox\",\"isClearField\":true },\r\n                \r\n                \r\n                //{ \"idsName\": \"IDS_DEFAULT\", \"dataField\": \"ndefaultstatus\", \"width\": \"100px\",\"isClearField\":true,\"preSetValue\":4},\r\n                \r\n            ]\r\n        }\r\n\r\n        if (((this.props.operation === \"create\") || (this.props.operation === \"update\")) && (this.props.screenName === \"IDS_ADDPROJECTMASTER\")) {\r\n\r\n            projectMasterData[\"projectMaster\"][\"nprojecttypecode\"] = this.state.selectedRecord[\"nprojecttypecode\"] ? this.state.selectedRecord[\"nprojecttypecode\"].value\r\n                : transactionStatus.NA;\r\n\r\n            projectMasterData[\"projectMaster\"][\"nstudydirectorcode\"] = this.state.selectedRecord[\"nstudydirectorcode\"] ? this.state.selectedRecord[\"nstudydirectorcode\"].value\r\n                : transactionStatus.NA;\r\n\r\n            projectMasterData[\"projectMaster\"][\"nteammembercode\"] = this.state.selectedRecord[\"nteammembercode\"] ? this.state.selectedRecord[\"nteammembercode\"].value\r\n                : transactionStatus.NA;\r\n\r\n            projectMasterData[\"projectMaster\"][\"nperiodcode\"] = this.state.selectedRecord[\"nperiodcode\"] ? this.state.selectedRecord[\"nperiodcode\"].value\r\n                : transactionStatus.NA;\r\n\r\n\r\n            // if (this.state.selectedRecord[\"drfwdate\"] || this.state.selectedRecord[\"dprojectstartdate\"]) {\r\n            //   if (this.props.Login.operation === \"create\") {\r\n\r\n            projectMasterData[\"projectMaster\"][\"drfwdate\"] = formatInputDate(this.state.selectedRecord[\"drfwdate\"], false);\r\n            projectMasterData[\"projectMaster\"][\"dprojectstartdate\"] = formatInputDate(this.state.selectedRecord[\"dprojectstartdate\"], false);\r\n\r\n            //   }\r\n            //   else {\r\n\r\n            //     projectMasterData[\"projectMaster\"][\"drfwdate\"] = formatInputDate(this.state.selectedRecord[\"drfwdate\"],false);\r\n            //     projectMasterData[\"projectMaster\"][\"dprojectstartdate\"] = formatInputDate(this.state.selectedRecord[\"dprojectstartdate\"],false);\r\n\r\n            //   }\r\n            // }\r\n        }\r\n\r\n        if ((this.props.operation === \"create\") && (this.props.screenName === \"IDS_MEMBERS\")) {\r\n\r\n            /*        projectMasterData[\"ProjectMember\"] = {};\r\n                      projectMasterData[\"ProjectMember\"][\"nusercode\"] = this.state.selectedRecord[\"nusercode\"][0] ? this.state.selectedRecord[\"nusercode\"][0].value\r\n                      : transactionStatus.NA;\r\n                      projectMasterData[\"ProjectMember\"][\"nprojectmastercode\"] =this.props.masterData.SelectedProjectMaster.nprojectmastercode; */\r\n\r\n            inputParam = this.onSaveProjectMasterMember(saveType, formRef);\r\n        }\r\n\r\n        if (((this.props.operation === \"create\") || (this.props.operation === \"update\")) && (this.props.screenName === \"IDS_ADDPROJECTMASTER\")) {\r\n\r\n            inputParam = {\r\n                classUrl: \"projectmaster\",\r\n                methodUrl: \"ProjectMaster\",\r\n                inputData: projectMasterData,\r\n                operation: this.props.operation,\r\n                saveType,\r\n                formRef,\r\n                postParam,\r\n                searchRef: this.searchRef,\r\n                isClearSearch: this.props.isClearSearch,\r\n            };\r\n        }/*else if ((this.props.operation === \"create\")  &&  (this.props.screenName === \"IDS_MEMBERS\")) {\r\n    \r\n          inputParam = {\r\n            classUrl: \"projectmaster\",\r\n            methodUrl: \"ProjectMember\",\r\n            inputData: projectMasterData,\r\n            operation: this.props.operation,\r\n            saveType,\r\n            formRef,\r\n            postParam,\r\n            searchRef: this.searchRef,\r\n            isClearSearch: this.props.isClearSearch,\r\n          }\r\n        } */\r\n        //ALPD-3566 Start\r\n        if (this.props.screenName === \"IDS_QUOTATION\") {\r\n            inputParam = this.onSaveProjectQuotation(saveType, formRef,this.props.operation);\r\n\r\n            clearSelectedRecordField =[\r\n                { \"idsName\": \"IDS_REMARKS\", \"dataField\": \"sremarks\", \"width\": \"200px\" ,\"controlType\": \"textbox\",\"isClearField\":true},\r\n                { \"idsName\": \"IDS_DEFAULTSTATUS\", \"dataField\": \"ndefaultstatus\", \"width\": \"100px\",\"isClearField\":true,\"preSetValue\":4},\r\n                \r\n            ]\r\n        }\r\n\r\n        const masterData = this.props.masterData;\r\n\r\n        if (showEsign(this.props.esignRights, this.props.userInfo.nformcode, this.props.ncontrolCode)) {\r\n            const updateInfo = {\r\n                typeName: DEFAULT_RETURN,\r\n                data: {\r\n                    loadEsign: true,\r\n                    screenData: { inputParam, masterData },\r\n                    saveType,\r\n                },\r\n            };\r\n            this.props.updateStore(updateInfo);\r\n        } else {\r\n            if((this.props.operation === \"create\" && this.props.screenName === \"IDS_FILE\") || \r\n            (this.props.operation === \"create\" && this.props.screenName === \"IDS_QUOTATION\"))\r\n            {\r\n                this.props.crudMaster(inputParam, masterData, \"openChildModal\",\"\",\"\",clearSelectedRecordField);\r\n            }\r\n            else\r\n            {\r\n               this.props.crudMaster(inputParam, masterData, \"openChildModal\");\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    onSaveProjectMasterFile = (saveType, formRef) => {\r\n        const selectedRecord = this.props.selectedRecord;\r\n        const acceptedFiles = selectedRecord.sfilename;\r\n        const nattachmenttypecode = selectedRecord.nattachmenttypecode;\r\n        let isFileEdited = transactionStatus.NO;\r\n        let projectmasterFileArray = [];\r\n        let projectmasterFile = {\r\n            nprojectmastercode: this.props.masterData.SelectedProjectMaster.nprojectmastercode,\r\n            nprojecttypecode: this.props.masterData.SelectedProjectMaster.nprojecttypecode,\r\n            nprojectmasterfilecode: selectedRecord.nprojectmasterfilecode ? selectedRecord.nprojectmasterfilecode : 0,\r\n            nstatus: transactionStatus.ACTIVE,\r\n            nattachmenttypecode,\r\n            // ndefaultstatus: selectedRecord[nattachmenttypecode === attachmentType.LINK ? \"nlinkdefaultstatus\" : \"ndefaultstatus\"] ? selectedRecord[nattachmenttypecode === attachmentType.LINK ? \"nlinkdefaultstatus\" : \"ndefaultstatus\"] : 4\r\n        };\r\n        const formData = new FormData();\r\n        if (nattachmenttypecode === attachmentType.FTP) {\r\n            if (acceptedFiles && Array.isArray(acceptedFiles) && acceptedFiles.length > 0) {\r\n                acceptedFiles.forEach((file, index) => {\r\n                    const tempData = Object.assign({}, projectmasterFile);\r\n                    const splittedFileName = file.name.split('.');\r\n                    const fileExtension = file.name.split('.')[splittedFileName.length - 1];\r\n                    const ssystemfilename = selectedRecord.ssystemfilename ? selectedRecord.ssystemfilename.split('.') : \"\";\r\n                    const filesystemfileext = selectedRecord.ssystemfilename ? file.name.split('.')[ssystemfilename.length - 1] : \"\";\r\n                    const uniquefilename = nattachmenttypecode === attachmentType.FTP ? selectedRecord.nsupplierfilecode && selectedRecord.nsupplierfilecode > 0\r\n                        && selectedRecord.ssystemfilename !== \"\" ? ssystemfilename[0] + '.' + filesystemfileext : create_UUID() + '.' + fileExtension : \"\";\r\n                    tempData[\"sfilename\"] = Lims_JSON_stringify(file.name, false);\r\n                    tempData[\"sdescription\"] = Lims_JSON_stringify(replaceBackSlash(selectedRecord.sdescription ? selectedRecord.sdescription.trim() : \"\"), false);\r\n                    tempData[\"nlinkcode\"] = transactionStatus.NA;\r\n                    tempData[\"ssystemfilename\"] = uniquefilename;\r\n                    tempData[\"nfilesize\"] = file.size;\r\n                    formData.append(\"uploadedFile\" + index, file);\r\n                    formData.append(\"uniquefilename\" + index, uniquefilename);\r\n                    projectmasterFileArray.push(tempData);\r\n                });\r\n                formData.append(\"filecount\", acceptedFiles.length);\r\n                isFileEdited = transactionStatus.YES;\r\n            } else {\r\n                projectmasterFile[\"sfilename\"] = Lims_JSON_stringify(selectedRecord.sfilename, false);\r\n                projectmasterFile[\"sdescription\"] = Lims_JSON_stringify(replaceBackSlash(selectedRecord.sdescription ? selectedRecord.sdescription.trim() : \"\"), false);\r\n                projectmasterFile[\"nlinkcode\"] = transactionStatus.NA;\r\n                projectmasterFile[\"ssystemfilename\"] = selectedRecord.ssystemfilename;\r\n                projectmasterFile[\"nfilesize\"] = selectedRecord.nfilesize;\r\n                projectmasterFileArray.push(projectmasterFile);\r\n            }\r\n        } else {\r\n            projectmasterFile[\"sfilename\"] = Lims_JSON_stringify(replaceBackSlash(selectedRecord.slinkfilename.trim()), false);\r\n            projectmasterFile[\"sdescription\"] = Lims_JSON_stringify(replaceBackSlash(selectedRecord.slinkdescription ? selectedRecord.slinkdescription.trim() : \"\"), false);\r\n            projectmasterFile[\"nlinkcode\"] = selectedRecord.nlinkcode.value ? selectedRecord.nlinkcode.value : -1;\r\n            projectmasterFile[\"ssystemfilename\"] = \"\";\r\n            projectmasterFile[\"nfilesize\"] = 0;\r\n            projectmasterFileArray.push(projectmasterFile);\r\n        }\r\n        formData.append(\"isFileEdited\", isFileEdited);\r\n        formData.append(\"projectmasterfile\", JSON.stringify(projectmasterFileArray));\r\n        // formData.append(\"userinfo\", JSON.stringify(this.props.userInfo));\r\n\r\n        //let selectedId = null;\r\n        let postParam = undefined;\r\n        if (this.props.operation === \"update\") {\r\n            // edit\r\n            postParam = { inputListName: \"ProjectMaster\", selectedObject: \"SelectedProjectMaster\", primaryKeyField: \"nprojectmastercode\" };\r\n           // selectedId = selectedRecord[\"nprojectmasterfilecode\"];\r\n        }\r\n        const inputParam = {\r\n            // inputData: { userinfo: this.props.userInfo },\r\n            inputData: {\r\n                \"userinfo\": {\r\n                    ...this.props.userInfo,\r\n                    sformname: Lims_JSON_stringify(this.props.userInfo.sformname),\r\n                    smodulename: Lims_JSON_stringify(this.props.userInfo.smodulename),\r\n                         //ALPD-1826(while saving the file and link,audit trail is not captured the respective language)\r\n                        slanguagename: Lims_JSON_stringify(this.props.userInfo.slanguagename)\r\n                }\r\n            },\r\n            formData: formData,\r\n            isFileupload: true,\r\n            operation: this.props.operation,\r\n            classUrl: \"projectmaster\",\r\n            saveType, formRef, methodUrl: \"ProjectMasterFile\", postParam,\r\n            selectedRecord: { ...selectedRecord }\r\n        }\r\n        return inputParam;\r\n    }\r\n\r\n\r\n\r\n    onSaveProjectQuotation(saveType, formRef, operation) {\r\n        let inputData = [];\r\n        inputData[\"userinfo\"] = this.props.userInfo;\r\n        inputData[\"ProjectQuotation\"] = {};\r\n\r\n       // let projectQuotationArray = []\r\n        if (operation === \"create\"){\r\n           // projectQuotationArray = this.props.selectedRecord.nquotationcode.map(item => {\r\n                let projectQuotationData = {};\r\n\r\n            projectQuotationData[\"nquotationcode\"] = this.props.selectedRecord && this.props.selectedRecord.nquotationcode && this.props.selectedRecord.nquotationcode.value;\r\n                projectQuotationData[\"nprojectmastercode\"] = this.props.masterData.SelectedProjectMaster.nprojectmastercode;\r\n                projectQuotationData['sremarks'] = this.props.selectedRecord && this.props.selectedRecord.sremarks ? this.props.selectedRecord.sremarks : \"\";\r\n                projectQuotationData['ndefaultstatus'] = this.props.selectedRecord && this.props.selectedRecord.ndefaultstatus ? this.props.selectedRecord.ndefaultstatus : transactionStatus.NO;\r\n\r\n\r\n           //     return projectQuotationData;\r\n          //  });\r\n        inputData['ProjectQuotation'] = projectQuotationData;\r\n    }\r\n    else{\r\n            inputData[\"ProjectQuotation\"][\"nquotationcode\"] = this.props.selectedRecord && this.props.selectedRecord.nquotationcode && this.props.selectedRecord.nquotationcode.value;\r\n    inputData[\"ProjectQuotation\"][\"nprojectmastercode\"]=this.props.masterData.SelectedProjectMaster.nprojectmastercode;\r\n    inputData[\"ProjectQuotation\"][\"sremarks\"]=this.props.selectedRecord && this.props.selectedRecord.sremarks ? this.props.selectedRecord.sremarks : \"\";\r\n    inputData[\"ProjectQuotation\"][\"ndefaultstatus\"]=this.props.selectedRecord && this.props.selectedRecord.ndefaultstatus ? this.props.selectedRecord.ndefaultstatus : transactionStatus.NO;\r\n    inputData[\"ProjectQuotation\"][\"nprojectquotationcode\"]=this.props.selectedRecord && this.props.selectedRecord.nprojectquotationcode;\r\n    }\r\n\r\n        const inputParam = {\r\n            classUrl: \"projectmaster\",\r\n            methodUrl: \"ProjectQuotation\",\r\n            inputData: inputData,\r\n            operation: operation, saveType, formRef,\r\n            selectedRecord: { ...this.props.selectedRecord }\r\n        }\r\n        return inputParam;\r\n    }\r\n//ALPD-3566 End\r\n    onSaveProjectMasterMember(saveType, formRef) {\r\n        let inputData = [];\r\n        inputData[\"userinfo\"] = this.props.userInfo;\r\n        // inputData[\"supplier\"] = this.props.masterData.SelectedSupplier;\r\n        inputData[\"ProjectMember\"] = {};\r\n\r\n\r\n        let projectmemberArray = []\r\n        projectmemberArray = this.props.selectedRecord.nusercode.map(item => {\r\n            let projectMasterData = {}\r\n\r\n            projectMasterData[\"nusercode\"] = item.value\r\n            projectMasterData[\"nprojectmastercode\"] = this.props.masterData.SelectedProjectMaster.nprojectmastercode;\r\n\r\n\r\n            return projectMasterData;\r\n        });\r\n        inputData['ProjectMember'] = projectmemberArray;\r\n\r\n        const inputParam = {\r\n            classUrl: \"projectmaster\",\r\n            methodUrl: \"ProjectMember\",\r\n            inputData: inputData,\r\n            operation: this.props.operation, saveType, formRef\r\n        }\r\n        return inputParam;\r\n    }\r\n\r\n    deleteRecord = (projectmasterfileparam) => {\r\n\r\n        if (this.props.masterData.SelectedProjectMaster.ntransactionstatus === transactionStatus.DRAFT) {\r\n\r\n            let inputParam = {};\r\n           // let inputData = {};\r\n            // if (this.props.screenName === 'ProjectMaster File') { \r\n            let selectedRecord = projectmasterfileparam.selectedRecord\r\n\r\n            selectedRecord = { ...selectedRecord, ntransactionstatus: this.props.masterData.SelectedProjectMaster.ntransactionstatus }\r\n\r\n            // inputData[\"projectmasterfile\"]={\r\n            //     selectedRecord                    \r\n            //     };\r\n\r\n            //        if (this.props.screenName === 'IDS_FILE') {\r\n            inputParam = {\r\n                classUrl: \"projectmaster\",\r\n                methodUrl: projectmasterfileparam.methodUrl,\r\n                inputData: {\r\n\r\n                    \"projectmasterfile\": selectedRecord,\r\n                    \"userinfo\": this.props.userInfo\r\n                },\r\n\r\n                operation: projectmasterfileparam.operation,\r\n                //dataState: this.state.dataState,\r\n                //dataStateMaterial: this.state.dataStateMaterial\r\n                dataState: this.state.dataState\r\n            }\r\n            //          }\r\n            if (showEsign(this.props.esignRights, this.props.userInfo.nformcode, projectmasterfileparam.ncontrolCode)) {\r\n                const updateInfo = {\r\n                    typeName: DEFAULT_RETURN,\r\n                    data: {\r\n                        loadEsign: true, screenData: { inputParam, masterData: this.props.masterData },\r\n                        openChildModal: true, screenName: projectmasterfileparam.screenName, operation: projectmasterfileparam.operation\r\n                    }\r\n                }\r\n                this.props.updateStore(updateInfo);\r\n            }\r\n            else {\r\n                this.props.crudMaster(inputParam, this.props.masterData, \"openChildModal\");\r\n            }\r\n\r\n        }\r\n        else {\r\n\r\n            toast.warn(this.props.intl.formatMessage({ id: \"IDS_SELECTDRAFTVERSION\" }));\r\n        }\r\n    }\r\n   \r\n    /*   deleteAttachment = (event, file, fieldName) => {\r\n           let selectedRecord = this.state.selectedRecord || {};\r\n           selectedRecord[fieldName] = deleteAttachmentDropZone(selectedRecord[fieldName], file)\r\n   \r\n           this.setState({\r\n               selectedRecord, actionType: \"delete\" //fileToDelete:file.name \r\n           });\r\n       } */\r\n\r\n    validateEsign = () => {\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": {\r\n                    ...this.props.userInfo,\r\n                    sreason: this.props.selectedRecord[\"esigncomments\"],\r\n                    nreasoncode: this.props.selectedRecord[\"esignreason\"] && this.props.selectedRecord[\"esignreason\"].value,\r\n                    spredefinedreason: this.props.selectedRecord[\"esignreason\"] && this.props.selectedRecord[\"esignreason\"].label,\r\n\r\n                },\r\n                password: this.props.selectedRecord[\"esignpassword\"]\r\n            },\r\n            screenData: this.props.screenData\r\n        }\r\n        this.props.validateEsignCredential(inputParam, \"openChildModal\");\r\n    }\r\n}\r\n\r\n\r\nexport default injectIntl(ProjectMasterTab);\r\n\r\n"]},"metadata":{},"sourceType":"module"}