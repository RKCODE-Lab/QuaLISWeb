{"ast":null,"code":"import rsapi from '../rsapi';\nimport { DEFAULT_RETURN } from './LoginTypes';\nimport { constructOptionList, sortData } from '../components/CommonScript';\nimport { toast } from 'react-toastify';\nimport { initRequest } from './LoginAction';\nimport { intl } from '../components/App';\nimport { ApprovalSubType } from '../components/Enumeration';\nexport function getUserMappingFilterChange(inputParamData, oldState) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"usermapping/getUserMapping\", inputParamData).then(response => {\n      const RegistrationTypeListMap = constructOptionList(response.data.RegistrationType || [], \"nregtypecode\", \"sregtypename\", 'ascending', 'nregtypecode', false);\n      const RegistrationSubTypeListMap = constructOptionList(response.data.RegistrationSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\n      const templateVersionOptionListMap = constructOptionList(response.data.TreeVersion || [], \"ntreeversiontempcode\", \"sversiondescription\", 'decending', 'ntreeversiontempcode', false);\n      const RegistrationTypeList = response.data.RegistrationType ? RegistrationTypeListMap.get(\"OptionList\") : oldState.RegistrationTypeList;\n      const RegistrationSubTypeList = response.data.RegistrationSubType ? RegistrationSubTypeListMap.get(\"OptionList\") : oldState.RegistrationSubTypeList;\n      const templateVersionOptionList = response.data.TreeVersion ? templateVersionOptionListMap.get(\"OptionList\") : oldState.templateVersionOptionList;\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData: {\n            Approvalsubtype: oldState.Approvalsubtype,\n            RegistrationTypeList,\n            RegistrationSubTypeList,\n            templateVersionOptionList,\n            approvalSubTypeValue: oldState.approvalSubTypeValue,\n            RegistrationType: response.data.RegistrationType ? response.data.RegistrationType : oldState.RegistrationType,\n            registrationTypeValue: response.data.RegistrationType ? response.data.RegistrationType.length > 0 ? {\n              value: response.data.RegistrationType[0].nregtypecode,\n              label: response.data.RegistrationType[0].sregtypename\n            } : oldState.registrationTypeValue : oldState.registrationTypeValue,\n            RegistrationSubType: response.data.RegistrationSubType ? response.data.RegistrationSubType : oldState.RegistrationSubType,\n            registrationSubTypeValue: response.data.RegistrationSubType ? response.data.RegistrationSubType.length > 0 ? {\n              value: response.data.RegistrationSubType[0].nregsubtypecode,\n              label: response.data.RegistrationSubType[0].sregsubtypename\n            } : oldState.registrationSubTypeValue : oldState.registrationSubTypeValue,\n            TreeVersion: response.data.TreeVersion ? response.data.TreeVersion : oldState.TreeVersion,\n            templateVersionValue: response.data.TreeVersion ? response.data.TreeVersion.length > 0 ? {\n              value: response.data.TreeVersion[0].ntreeversiontempcode,\n              label: response.data.TreeVersion[0].sversiondescription\n            } : {} : oldState.templateVersionValue,\n            Site: response.data.Site ? sortData(response.data.Site) : [],\n            selectedSite: response.data.selectedSite,\n            UserRole: response.data.UserRole ? sortData(response.data.UserRole) : [],\n            ...sortData(response.data)\n          },\n          loading: false,\n          dataState: undefined\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getUserMappingBySite(site, nversioncode, userInfo, masterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"usermapping/getUserMappingBySite\", {\n      nsitecode: site.nsitecode,\n      nversioncode: nversioncode ? nversioncode : -1,\n      userinfo: userInfo\n    }).then(response => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData: { ...masterData,\n            selectedSite: site,\n            // UserRole: sortData(response.data.UserRole),\n            ...sortData(response.data)\n          },\n          loading: false\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getChildUsers(user, role, siteCode, nversionCode, userInfo, masterData, dataState, userRoles) {\n  return function (dispatch) {\n    if (role.schildnode > 0) {\n      dispatch(initRequest(true));\n      rsapi.post(\"usermapping/getChildUserMapping\", {\n        nparusermappingcode: user.nusermappingcode,\n        nuserrolecode: role.nuserrolecode,\n        nsitecode: siteCode,\n        nversioncode: nversionCode,\n        levelno: -1,\n        userinfo: userInfo,\n        loading: false\n      }).then(response => {\n        let datastate = { ...dataState\n        };\n        userRoles.map(userRole => {\n          if (userRole.nlevelno <= role.nlevelno) {\n            if (dataState[userRole.nuserrolecode]) {\n              datastate[userRole.nuserrolecode] = dataState[userRole.nuserrolecode];\n            } else {\n              datastate[userRole.nuserrolecode] = {\n                skip: 0,\n                take: 10\n              };\n            }\n          }\n\n          return null;\n        });\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            masterData: { ...masterData,\n              [`selectedUser_${role.nuserrolecode}`]: user,\n              ...sortData(response.data)\n            },\n            loading: false,\n            dataState: datastate\n          }\n        });\n      }).catch(error => {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n\n        if (error.response.status === 500) {\n          toast.error(error.message);\n        } else {\n          toast.warn(error.response.data);\n        }\n      });\n    }\n  };\n}\nexport function openUserMappingModal(role, siteCode, selectedUser, versionCode, userInfo, masterData, parentRoleName) {\n  return function (dispatch) {\n    if (role.nlevelno === 1 ? true : selectedUser ? Object.keys(selectedUser).length > 0 ? true : false : false) {\n      dispatch(initRequest(true));\n      rsapi.post(\"usermapping/getAvailableUsers\", {\n        nuserrolecode: role.nuserrolecode,\n        nsitecode: siteCode,\n        nparusermappingcode: role.nlevelno === 1 ? -2 : selectedUser.nusermappingcode,\n        nversioncode: versionCode,\n        userinfo: userInfo\n      }).then(response => {\n        const AvailableUsersMap = constructOptionList(response.data.AvailableUsers || [], \"id\", \"name\", undefined, undefined, true);\n        const AvailableUsers = AvailableUsersMap.get(\"OptionList\");\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            openModal: true,\n            graphView: false,\n            operation: 'create',\n            loading: false,\n            AvailableUsers,\n            parentRole: role.nparentrolecode,\n            childRole: role.nuserrolecode,\n            childRoleName: role.suserrolename,\n            nlevelno: role.nlevelno,\n            selectedRecord: {},\n            ...masterData\n          }\n        });\n      }).catch(error => {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n\n        if (error.response.status === 500) {\n          toast.error(error.message);\n        } else {\n          toast.warn(error.response.data);\n        }\n      });\n    } else {\n      toast.warn(intl.formatMessage({\n        id: \"IDS_SELECT\"\n      }) + ' ' + parentRoleName);\n    }\n  };\n} // export function filterUserColumn(filterValue, masterData, userInfo,role,siteCode,nversionCode) {\n//     return function(dispatch){\n//         let nusermappingcode = 0;   \n//         let searchedData = undefined;\n//         if (filterValue === \"\"){\n//             nusermappingcode = masterData[role.nuserrolecode][0].nusermappingcode;\n//         } \n//         else{\n//             searchedData = searchData(filterValue, masterData[role.nuserrolecode]);\n//             if (searchedData.length > 0){\n//                 nusermappingcode = searchedData[0].nusermappingcode; \n//             }\n//         }\n//         if (nusermappingcode !== 0){\n//             dispatch(initRequest(true));\n//             rsapi.post(\"usermapping/getChildUserMapping\",{\n//                                                             nparusermappingcode:nusermappingcode,\n//                                                             nuserrolecode:role.nuserrolecode,\n//                                                             nsitecode:siteCode,\n//                                                             nversioncode:nversionCode,\n//                                                             levelno:-1,\n//                                                             userinfo:userInfo,\n//                                                             loading:false\n//                                                         }\n//                     )\n//             .then(response=>{  \n//                 masterData={\n//                     ...masterData,\n//                     [`selectedUser_${role.nuserrolecode}`]:searchedData?searchedData[0]:masterData[role.nuserrolecode][0],\n//                     ...sortData(response.data),\n//                     [`searchedData_${role.nuserrolecode}`] : searchedData\n//                 }              \n//                 dispatch({type: DEFAULT_RETURN, payload:{masterData,   loading:false}});\n//             })\n//             .catch(error=>{\n//                 dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\n//                 if (error.response.status === 500) {\n//                     toast.error(error.message);\n//                 }\n//                 else {\n//                     toast.warn(error.response.data);\n//                 }\n//             })\n//         }else{\n//             masterData[\"checklistversion\"] = [];\n//             masterData[\"selectedversion\"] = [];\n//             masterData[\"checklistversionqb\"] = [];\n//             masterData[\"selectedchecklist\"] =[];\n//             masterData[\"searchedData\"] = [];\n//             dispatch({type: DEFAULT_RETURN, payload:{masterData,   loading:false}});\n//         }\n//     }\n// }\n\nexport function getUserMappingGraphView(site, nversioncode, userinfo, selectedUser, selectedRole) {\n  return function (dispatch) {\n    if (site && site.nsitecode) {\n      let inputData = {\n        nsitecode: site.nsitecode,\n        nversioncode: nversioncode ? nversioncode : -1,\n        userinfo\n      };\n\n      if (selectedUser) {\n        inputData['nusermappingcode'] = selectedUser.nusermappingcode;\n      } //let files=fs.readdirSync(fileViewURL+\"/SharedFolder\")\n\n\n      dispatch(initRequest(true));\n      rsapi.post(\"usermapping/getUserMappingTree\", inputData).then(response => {\n        let selectedRecord = {};\n        let hideFilters = false;\n        let selectedTreeParent = undefined;\n\n        if (selectedUser) {\n          selectedTreeParent = response.data.userTree && response.data.userTree.length > 0 ? response.data.userTree.find(x => x.nusermappingcode = selectedUser.nusermappingcode) : {};\n          hideFilters = true;\n        }\n\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false,\n            userTree: response.data.userTree,\n            openModal: true,\n            graphView: true,\n            operation: \"view\",\n            selectedTreeParent,\n            selectedRecord,\n            hideFilters,\n            files: response.data.folderFiles\n          }\n        });\n      }).catch(error => {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n\n        if (error.response.status === 500) {\n          toast.error(error.message);\n        } else {\n          toast.warn(error.response.data);\n        }\n      });\n    } else {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false,\n          multilingualError: \"IDS_SELECTSITE\"\n        }\n      });\n    }\n  };\n}\nexport function getCopyUserMapping(nsubtypecode, nregsubtypecode, userInfo, masterData, ncontrolcode) {\n  return function (dispatch) {\n    if (nsubtypecode === ApprovalSubType.TESTRESULTAPPROVAL) {\n      dispatch(initRequest(true));\n      rsapi.post('usermapping/getUserMappingCopy', {\n        nsubtypecode: nsubtypecode,\n        nregsubtypecode,\n        nsitecode: userInfo.nmastersitecode,\n        userinfo: userInfo\n      }).then(response => {\n        if (response.data.CopyRegType.length === 0) {\n          dispatch({\n            type: DEFAULT_RETURN,\n            payload: {\n              loading: false,\n              loadEsign: false,\n              openModal: false\n            }\n          });\n          return toast.warn(intl.formatMessage({\n            id: \"IDS_NOREGISTRATIONTOCOPY\"\n          }));\n        }\n\n        let selectedRecord = {};\n        const RegistrationTypeListMap = constructOptionList(response.data.CopyRegType || [], \"nregtypecode\", \"sregtypename\", 'ascending', 'nregtypecode', false);\n        const RegistrationSubTypeListMap = constructOptionList(response.data.CopyRegSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\n        let optCopyRegType = RegistrationTypeListMap.get(\"OptionList\");\n        let optCopyRegSubType = RegistrationSubTypeListMap.get(\"OptionList\");\n        selectedRecord['regtype'] = response.data.CopyRegType.length > 0 ? {\n          value: response.data.CopyRegType[0].nregtypecode,\n          label: response.data.CopyRegType[0].sregtypename\n        } : [];\n        selectedRecord['regsubtype'] = response.data.CopyRegSubType ? response.data.CopyRegSubType.length > 0 ? {\n          value: response.data.CopyRegSubType[0].nregsubtypecode,\n          label: response.data.CopyRegSubType[0].sregsubtypename\n        } : [] : [];\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            operation: \"copy\",\n            openModal: true,\n            optCopyRegSubType,\n            optCopyRegType,\n            selectedRecord,\n            masterData,\n            ncontrolcode,\n            loading: false\n          }\n        });\n      }).catch(error => {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n\n        if (error.response.status === 500) {\n          toast.error(error.message);\n        } else {\n          toast.warn(error.response.data);\n        }\n      });\n    }\n  };\n}\nexport function getCopyUserMappingSubType(comboData, nregsubtypecode, selectedRecord, userInfo, masterData, optCopyRegType) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post('usermapping/getCopyRegSubType', {\n      nregtypecode: comboData.value,\n      nregsubtypecode,\n      nsitecode: userInfo.nmastersitecode,\n      userinfo: userInfo\n    }).then(response => {\n      const RegistrationSubTypeListMap = constructOptionList(response.data.CopyRegSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\n      let optCopyRegSubType = RegistrationSubTypeListMap.get(\"OptionList\");\n      selectedRecord['regsubtype'] = response.data.CopyRegSubType.length > 0 ? {\n        value: response.data.CopyRegSubType[0].nregsubtypecode,\n        label: response.data.CopyRegSubType[0].sregsubtypename\n      } : [];\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          operation: \"copy\",\n          openModal: true,\n          loading: false,\n          optCopyRegType,\n          optCopyRegSubType,\n          selectedRecord,\n          masterData\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}","map":{"version":3,"sources":["D:/Postgres_workingFolder/QuaLISWeb/src/actions/UserMappingAction.js"],"names":["rsapi","DEFAULT_RETURN","constructOptionList","sortData","toast","initRequest","intl","ApprovalSubType","getUserMappingFilterChange","inputParamData","oldState","dispatch","post","then","response","RegistrationTypeListMap","data","RegistrationType","RegistrationSubTypeListMap","RegistrationSubType","templateVersionOptionListMap","TreeVersion","RegistrationTypeList","get","RegistrationSubTypeList","templateVersionOptionList","type","payload","masterData","Approvalsubtype","approvalSubTypeValue","registrationTypeValue","length","value","nregtypecode","label","sregtypename","registrationSubTypeValue","nregsubtypecode","sregsubtypename","templateVersionValue","ntreeversiontempcode","sversiondescription","Site","selectedSite","UserRole","loading","dataState","undefined","catch","error","status","message","warn","getUserMappingBySite","site","nversioncode","userInfo","nsitecode","userinfo","getChildUsers","user","role","siteCode","nversionCode","userRoles","schildnode","nparusermappingcode","nusermappingcode","nuserrolecode","levelno","datastate","map","userRole","nlevelno","skip","take","openUserMappingModal","selectedUser","versionCode","parentRoleName","Object","keys","AvailableUsersMap","AvailableUsers","openModal","graphView","operation","parentRole","nparentrolecode","childRole","childRoleName","suserrolename","selectedRecord","formatMessage","id","getUserMappingGraphView","selectedRole","inputData","hideFilters","selectedTreeParent","userTree","find","x","files","folderFiles","multilingualError","getCopyUserMapping","nsubtypecode","ncontrolcode","TESTRESULTAPPROVAL","nmastersitecode","CopyRegType","loadEsign","CopyRegSubType","optCopyRegType","optCopyRegSubType","getCopyUserMappingSubType","comboData"],"mappings":"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","sourcesContent":["import rsapi from '../rsapi';\r\nimport { DEFAULT_RETURN } from './LoginTypes';\r\nimport { constructOptionList, sortData } from '../components/CommonScript'\r\nimport { toast } from 'react-toastify';\r\nimport { initRequest } from './LoginAction';\r\nimport { intl } from '../components/App';\r\nimport { ApprovalSubType } from '../components/Enumeration';\r\n\r\nexport function getUserMappingFilterChange(inputParamData, oldState) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"usermapping/getUserMapping\", inputParamData)\r\n            .then(response => {\r\n                const RegistrationTypeListMap = constructOptionList(response.data.RegistrationType || [], \"nregtypecode\", \"sregtypename\", 'ascending', 'nregtypecode', false);\r\n                const RegistrationSubTypeListMap = constructOptionList(response.data.RegistrationSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\r\n                const templateVersionOptionListMap = constructOptionList(response.data.TreeVersion || [], \"ntreeversiontempcode\", \"sversiondescription\", 'decending', 'ntreeversiontempcode', false);\r\n                const RegistrationTypeList = response.data.RegistrationType ? RegistrationTypeListMap.get(\"OptionList\") : oldState.RegistrationTypeList;\r\n                const RegistrationSubTypeList = response.data.RegistrationSubType ? RegistrationSubTypeListMap.get(\"OptionList\") : oldState.RegistrationSubTypeList;\r\n                const templateVersionOptionList = response.data.TreeVersion ? templateVersionOptionListMap.get(\"OptionList\") : oldState.templateVersionOptionList;\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData: {\r\n                            Approvalsubtype: oldState.Approvalsubtype,\r\n                            RegistrationTypeList, RegistrationSubTypeList, templateVersionOptionList,\r\n                            approvalSubTypeValue: oldState.approvalSubTypeValue,\r\n\r\n                            RegistrationType: response.data.RegistrationType ?\r\n                                response.data.RegistrationType\r\n                                : oldState.RegistrationType,\r\n\r\n                            registrationTypeValue: response.data.RegistrationType ?\r\n                                response.data.RegistrationType.length > 0 ?\r\n                                    {\r\n                                        value: response.data.RegistrationType[0].nregtypecode,\r\n                                        label: response.data.RegistrationType[0].sregtypename\r\n                                    }\r\n                                    : oldState.registrationTypeValue\r\n                                : oldState.registrationTypeValue,\r\n\r\n                            RegistrationSubType: response.data.RegistrationSubType ?\r\n                                response.data.RegistrationSubType\r\n                                : oldState.RegistrationSubType,\r\n\r\n                            registrationSubTypeValue: response.data.RegistrationSubType ?\r\n                                response.data.RegistrationSubType.length > 0 ?\r\n                                    {\r\n                                        value: response.data.RegistrationSubType[0].nregsubtypecode,\r\n                                        label: response.data.RegistrationSubType[0].sregsubtypename\r\n                                    }\r\n                                    : oldState.registrationSubTypeValue\r\n                                : oldState.registrationSubTypeValue,\r\n\r\n                            TreeVersion: response.data.TreeVersion ?\r\n                                response.data.TreeVersion\r\n                                : oldState.TreeVersion,\r\n\r\n                            templateVersionValue: response.data.TreeVersion ?\r\n                                response.data.TreeVersion.length > 0 ?\r\n                                    {\r\n                                        value: response.data.TreeVersion[0].ntreeversiontempcode,\r\n                                        label: response.data.TreeVersion[0].sversiondescription\r\n                                    }\r\n                                    : {}\r\n                                : oldState.templateVersionValue,\r\n                            Site: response.data.Site ? sortData(response.data.Site) : [],\r\n                            selectedSite: response.data.selectedSite,\r\n                            UserRole: response.data.UserRole ? sortData(response.data.UserRole) : [],\r\n                            ...sortData(response.data)\r\n                        }, loading: false,\r\n                        dataState:undefined\r\n\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\nexport function getUserMappingBySite(site, nversioncode, userInfo, masterData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"usermapping/getUserMappingBySite\", { nsitecode: site.nsitecode, nversioncode: nversioncode ? nversioncode : -1, userinfo: userInfo })\r\n            .then(response => {\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData: {\r\n                            ...masterData,\r\n                            selectedSite: site,\r\n                            // UserRole: sortData(response.data.UserRole),\r\n                            ...sortData(response.data)\r\n                        }, loading: false\r\n\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n\r\n}\r\nexport function getChildUsers(user, role, siteCode, nversionCode, userInfo, masterData, dataState, userRoles) {\r\n\r\n    return function (dispatch) {\r\n        if (role.schildnode > 0) {\r\n            dispatch(initRequest(true));\r\n            rsapi.post(\"usermapping/getChildUserMapping\",\r\n                {\r\n                    nparusermappingcode: user.nusermappingcode,\r\n                    nuserrolecode: role.nuserrolecode,\r\n                    nsitecode: siteCode,\r\n                    nversioncode: nversionCode,\r\n                    levelno: -1,\r\n                    userinfo: userInfo,\r\n                    loading: false\r\n                }\r\n            )\r\n                .then(response => {\r\n                    let datastate = { ...dataState }\r\n                    userRoles.map(userRole => {\r\n                        if (userRole.nlevelno <= role.nlevelno) {\r\n                            if (dataState[userRole.nuserrolecode]) {\r\n                                datastate[userRole.nuserrolecode] = dataState[userRole.nuserrolecode]\r\n                            } else {\r\n                                datastate[userRole.nuserrolecode] = { skip: 0, take: 10 }\r\n                            }\r\n                        }\r\n                        return null;\r\n                    })\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            masterData: {\r\n                                ...masterData,\r\n                                [`selectedUser_${role.nuserrolecode}`]: user,\r\n                                ...sortData(response.data)\r\n                            }, loading: false, dataState: datastate\r\n\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        }\r\n    }\r\n}\r\n\r\nexport function openUserMappingModal(role, siteCode, selectedUser, versionCode, userInfo, masterData, parentRoleName) {\r\n    return function (dispatch) {\r\n        if (role.nlevelno === 1 ? true : selectedUser ? Object.keys(selectedUser).length > 0 ? true : false : false) {\r\n            dispatch(initRequest(true));\r\n            rsapi.post(\"usermapping/getAvailableUsers\",\r\n                {\r\n                    nuserrolecode: role.nuserrolecode,\r\n                    nsitecode: siteCode,\r\n                    nparusermappingcode: role.nlevelno === 1 ? -2 : selectedUser.nusermappingcode,\r\n                    nversioncode: versionCode,\r\n                    userinfo: userInfo,\r\n                }\r\n            )\r\n                .then(response => {\r\n                    const AvailableUsersMap = constructOptionList(response.data.AvailableUsers || [], \"id\", \"name\", undefined, undefined, true);\r\n                    const AvailableUsers = AvailableUsersMap.get(\"OptionList\");\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            openModal: true,\r\n                            graphView: false,\r\n                            operation: 'create',\r\n                            loading: false,\r\n                            AvailableUsers,\r\n                            parentRole: role.nparentrolecode,\r\n                            childRole: role.nuserrolecode,\r\n                            childRoleName: role.suserrolename,\r\n                            nlevelno: role.nlevelno,\r\n                            selectedRecord: {},\r\n                            ...masterData\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        } else {\r\n            toast.warn(intl.formatMessage({ id: \"IDS_SELECT\" })+' '+parentRoleName);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n// export function filterUserColumn(filterValue, masterData, userInfo,role,siteCode,nversionCode) {\r\n//     return function(dispatch){\r\n//         let nusermappingcode = 0;   \r\n//         let searchedData = undefined;\r\n//         if (filterValue === \"\"){\r\n//             nusermappingcode = masterData[role.nuserrolecode][0].nusermappingcode;\r\n//         } \r\n//         else{\r\n\r\n//             searchedData = searchData(filterValue, masterData[role.nuserrolecode]);\r\n\r\n//             if (searchedData.length > 0){\r\n//                 nusermappingcode = searchedData[0].nusermappingcode; \r\n//             }\r\n\r\n//         }\r\n//         if (nusermappingcode !== 0){\r\n\r\n//             dispatch(initRequest(true));\r\n//             rsapi.post(\"usermapping/getChildUserMapping\",{\r\n//                                                             nparusermappingcode:nusermappingcode,\r\n//                                                             nuserrolecode:role.nuserrolecode,\r\n//                                                             nsitecode:siteCode,\r\n//                                                             nversioncode:nversionCode,\r\n//                                                             levelno:-1,\r\n//                                                             userinfo:userInfo,\r\n//                                                             loading:false\r\n//                                                         }\r\n//                     )\r\n//             .then(response=>{  \r\n//                 masterData={\r\n//                     ...masterData,\r\n//                     [`selectedUser_${role.nuserrolecode}`]:searchedData?searchedData[0]:masterData[role.nuserrolecode][0],\r\n//                     ...sortData(response.data),\r\n//                     [`searchedData_${role.nuserrolecode}`] : searchedData\r\n//                 }              \r\n\r\n\r\n//                 dispatch({type: DEFAULT_RETURN, payload:{masterData,   loading:false}});\r\n//             })\r\n//             .catch(error=>{\r\n//                 dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\r\n//                 if (error.response.status === 500) {\r\n//                     toast.error(error.message);\r\n//                 }\r\n//                 else {\r\n//                     toast.warn(error.response.data);\r\n//                 }\r\n//             })\r\n\r\n//         }else{\r\n//             masterData[\"checklistversion\"] = [];\r\n//             masterData[\"selectedversion\"] = [];\r\n//             masterData[\"checklistversionqb\"] = [];\r\n//             masterData[\"selectedchecklist\"] =[];\r\n//             masterData[\"searchedData\"] = [];\r\n//             dispatch({type: DEFAULT_RETURN, payload:{masterData,   loading:false}});\r\n\r\n//         }\r\n//     }\r\n// }\r\nexport function getUserMappingGraphView(site, nversioncode, userinfo, selectedUser, selectedRole) {\r\n\r\n    return function (dispatch) {\r\n        if ( site  && site.nsitecode) {\r\n            let inputData = { nsitecode: site.nsitecode, nversioncode: nversioncode ? nversioncode : -1, userinfo };\r\n            if (selectedUser) {\r\n                inputData['nusermappingcode'] = selectedUser.nusermappingcode\r\n            }\r\n\r\n            //let files=fs.readdirSync(fileViewURL+\"/SharedFolder\")\r\n            dispatch(initRequest(true));\r\n            rsapi.post(\"usermapping/getUserMappingTree\", inputData)\r\n                .then(response => {\r\n                    let selectedRecord = {};\r\n                    let hideFilters = false;\r\n                    let selectedTreeParent = undefined;\r\n                    if (selectedUser) {\r\n                        selectedTreeParent = response.data.userTree && response.data.userTree.length > 0 ? response.data.userTree.find(x => x.nusermappingcode = selectedUser.nusermappingcode) : {}\r\n                        hideFilters = true;\r\n                    }\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            loading: false,\r\n                            userTree: response.data.userTree,\r\n                            openModal: true,\r\n                            graphView: true,\r\n                            operation: \"view\",\r\n                            selectedTreeParent,\r\n                            selectedRecord,\r\n                            hideFilters,\r\n                            files: response.data.folderFiles\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        } else {\r\n            dispatch({ type: DEFAULT_RETURN, payload: { loading: false ,multilingualError:\"IDS_SELECTSITE\"} })\r\n        }\r\n    }\r\n}\r\nexport function getCopyUserMapping(nsubtypecode, nregsubtypecode, userInfo, masterData, ncontrolcode) {\r\n    return function (dispatch) {\r\n        if (nsubtypecode === ApprovalSubType.TESTRESULTAPPROVAL) {\r\n            dispatch(initRequest(true));\r\n            rsapi.post('usermapping/getUserMappingCopy', { nsubtypecode: nsubtypecode, nregsubtypecode, nsitecode: userInfo.nmastersitecode, userinfo: userInfo })\r\n                .then(response => {\r\n                    if(response.data.CopyRegType.length === 0)\r\n                    {\r\n                        dispatch({\r\n                        type: DEFAULT_RETURN,\r\n                        payload: {\r\n                            loading: false,\r\n                            loadEsign: false,\r\n                            openModal: false\r\n                        }\r\n                    });\r\n                        return  toast.warn(intl.formatMessage({ id: \"IDS_NOREGISTRATIONTOCOPY\" }));\r\n                    }\r\n\r\n                    let selectedRecord = {};\r\n                    const RegistrationTypeListMap = constructOptionList(response.data.CopyRegType || [], \"nregtypecode\", \"sregtypename\", 'ascending', 'nregtypecode', false);\r\n                    const RegistrationSubTypeListMap = constructOptionList(response.data.CopyRegSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\r\n                    let optCopyRegType = RegistrationTypeListMap.get(\"OptionList\");\r\n                    let optCopyRegSubType = RegistrationSubTypeListMap.get(\"OptionList\");\r\n                    selectedRecord['regtype'] = response.data.CopyRegType.length > 0 ? { value: response.data.CopyRegType[0].nregtypecode, label: response.data.CopyRegType[0].sregtypename } : []\r\n                    selectedRecord['regsubtype'] = response.data.CopyRegSubType ? response.data.CopyRegSubType.length > 0 ? { value: response.data.CopyRegSubType[0].nregsubtypecode, label: response.data.CopyRegSubType[0].sregsubtypename } : [] : []\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            operation: \"copy\", openModal: true,\r\n                            optCopyRegSubType,\r\n                            optCopyRegType,\r\n                            selectedRecord,\r\n                            masterData, ncontrolcode, loading: false\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        }\r\n    }\r\n\r\n}\r\nexport function getCopyUserMappingSubType(comboData, nregsubtypecode, selectedRecord, userInfo, masterData, optCopyRegType) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post('usermapping/getCopyRegSubType', { nregtypecode: comboData.value, nregsubtypecode, nsitecode: userInfo.nmastersitecode, userinfo: userInfo  })\r\n            .then(response => {\r\n                const RegistrationSubTypeListMap = constructOptionList(response.data.CopyRegSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\r\n                let optCopyRegSubType = RegistrationSubTypeListMap.get(\"OptionList\");\r\n                selectedRecord['regsubtype'] = response.data.CopyRegSubType.length > 0 ? { value: response.data.CopyRegSubType[0].nregsubtypecode, label: response.data.CopyRegSubType[0].sregsubtypename } : []\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        operation: \"copy\", openModal: true, loading: false,\r\n                        optCopyRegType,\r\n                        optCopyRegSubType,\r\n                        selectedRecord,\r\n                        masterData\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}