{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { ButtonGroup, Toolbar, ToolbarSeparator } from '@progress/kendo-react-buttons';\nimport { EditorState, Plugin, PluginKey, EditorView, Schema, baseKeymap, keymap, history, dropCursor, gapCursor, getMark, spacesFix, tableEditing } from '@progress/kendo-editor-common';\nimport { marks, nodes } from './config/schema';\nimport { defaultStyle, tablesStyles, rtlStyles } from './config/defaultStyles';\nimport { EditorToolsSettings } from './config/toolsSettings';\nimport { EditorDialogs } from './dialogs/main';\nimport { EditorUtils } from './utils';\nimport { updateEditorValue } from './utils/controlled-value';\nvar link = EditorToolsSettings.link,\n    bold = EditorToolsSettings.bold,\n    italic = EditorToolsSettings.italic,\n    underline = EditorToolsSettings.underline;\nimport { firefox } from './utils/browser-detection';\nimport * as licensing from '@progress/kendo-licensing';\nimport { packageMetadata } from './package-metadata';\n/**\n * Represents the [KendoReact Editor component]({% slug overview_editor %}).\n *\n * @example\n * ```jsx\n * class App extends React.Component {\n *    render() {\n *       return (\n *           <Editor\n *               defaultContent=\"<p>Hello World</p>\"\n *               tools={[\n *                  [ EditorTools.Bold, EditorTools.Italic ]\n *               ]}\n *           />\n *       );\n *    }\n * }\n * ReactDOM.render(<App />, document.querySelector('my-app'));\n * ```\n */\n\nvar Editor =\n/** @class */\nfunction (_super) {\n  __extends(Editor, _super);\n\n  function Editor(props) {\n    var _this = _super.call(this, props) || this;\n    /**\n     * @hidden\n     */\n\n\n    _this.state = {\n      view: undefined,\n      linkDialog: false\n    };\n    _this.trOnChange = null;\n    _this.htmlOnChange = null;\n    /**\n     * @hidden\n     */\n\n    _this.focus = function () {\n      if (_this.state.view) {\n        _this.state.view.focus();\n      }\n    };\n\n    _this.renderDialog = function (Component, settings, stateFlag) {\n      return _this.state[stateFlag] && React.createElement(Component, {\n        view: _this.state.view,\n        settings: settings,\n        dir: _this.props.dir,\n        onClose: function () {\n          var _a;\n\n          return _this.setState((_a = {}, _a[stateFlag] = false, _a));\n        }\n      });\n    };\n\n    _this.renderTool = function (Tool, index) {\n      var tool = React.createElement(Tool, {\n        view: _this.state.view,\n        dir: _this.props.dir,\n        key: index\n      });\n      return tool.type === ToolbarSeparator ? React.createElement(Tool, {\n        key: index\n      }) : tool;\n    };\n\n    _this.updateTools = function (view, _prevViewState) {\n      _this.setState({\n        view: view\n      });\n    };\n\n    _this.onPasteHtml = function (html) {\n      if (_this.props.onPasteHtml) {\n        var newHtml = _this.props.onPasteHtml.call(undefined, {\n          target: _this,\n          pastedHtml: html,\n          nativeEvent: _this.pasteEvent\n        });\n\n        _this.pasteEvent = undefined;\n\n        if (typeof newHtml === 'string') {\n          return newHtml;\n        }\n      }\n\n      return html;\n    };\n\n    _this.dispatchTransaction = function (transaction) {\n      var docChanged = transaction.docChanged;\n\n      if (_this.props.onChange && docChanged) {\n        _this.trOnChange = transaction;\n        var doc_1 = transaction.doc,\n            schema_1 = transaction.doc.type.schema;\n        var target_1 = _this;\n\n        _this.props.onChange.call(undefined, {\n          target: target_1,\n          value: doc_1,\n\n          get html() {\n            target_1.htmlOnChange = EditorUtils.getHtml({\n              doc: doc_1,\n              schema: schema_1\n            });\n            return target_1.htmlOnChange;\n          },\n\n          transaction: transaction,\n          schema: schema_1\n        });\n      }\n\n      if (_this.view && (_this.props.value === undefined || !docChanged)) {\n        _this.view.updateState(_this.view.state.apply(transaction));\n      }\n    };\n\n    _this.onFocus = function (_view, nativeEvent) {\n      if (_this.props.onFocus) {\n        _this.props.onFocus.call(undefined, {\n          target: _this,\n          nativeEvent: nativeEvent\n        });\n      }\n\n      return false;\n    };\n\n    _this.onBlur = function (_view, nativeEvent) {\n      if (_this.props.onBlur) {\n        _this.props.onBlur.call(undefined, {\n          target: _this,\n          nativeEvent: nativeEvent\n        });\n      }\n\n      return false;\n    };\n\n    _this.onPaste = function (_view, nativeEvent) {\n      if (_this.props.onPasteHtml) {\n        _this.pasteEvent = nativeEvent;\n      }\n\n      return false;\n    };\n\n    if (typeof licensing !== 'undefined') {\n      licensing.validatePackage(packageMetadata);\n    } else {\n      var message = \"License activation failed for \" + packageMetadata.name + \"\\n\";\n      message += 'The @progress/kendo-licensing script is not loaded.\\n';\n      message += \"See \" + packageMetadata.licensingDocsUrl + \" for more information.\\n\";\n      console.warn(message);\n    }\n\n    return _this;\n  }\n\n  Object.defineProperty(Editor.prototype, \"value\", {\n    /**\n     * The value of the Editor.\n     */\n    get: function () {\n      if (this.trOnChange !== null) {\n        return this.trOnChange.doc;\n      } else if (this.props.value !== undefined) {\n        return this.props.value;\n      } else if (this.view) {\n        return this.view.state.doc;\n      }\n\n      return this.props.defaultContent || '';\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Editor.prototype, \"element\", {\n    /**\n     * Returns the DOM element of the Editor.\n     */\n    get: function () {\n      return this._element;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Editor.prototype, \"contentElement\", {\n    /**\n     * Returns the content-editable DOM element of the Editor.\n     */\n    get: function () {\n      return this._contentElement;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Editor.prototype, \"view\", {\n    /**\n     * Returns the `view` object of the Editor.\n     */\n    get: function () {\n      return this.state.view;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * @hidden\n   */\n\n  Editor.prototype.componentDidMount = function () {\n    if (!this.iframe || !firefox) {\n      this.initialize();\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  Editor.prototype.componentDidUpdate = function (prevProps) {\n    var value = this.props.value;\n    var view = this.view;\n\n    if (value === undefined || !view) {\n      return;\n    }\n\n    updateEditorValue(view, value, prevProps.value, this.trOnChange, this.htmlOnChange);\n    this.trOnChange = null;\n    this.htmlOnChange = null;\n  };\n  /**\n   * @hidden\n   */\n\n\n  Editor.prototype.componentWillUnmount = function () {\n    if (this.state.view) {\n      this.state.view.destroy();\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  Editor.prototype.render = function () {\n    var _this = this;\n\n    var _a = this.props,\n        _b = _a.tools,\n        tools = _b === void 0 ? [] : _b,\n        _c = _a.defaultEditMode,\n        defaultEditMode = _c === void 0 ? 'iframe' : _c,\n        style = _a.style,\n        className = _a.className;\n    var contentStyle = this.props.contentStyle;\n\n    if (contentStyle === undefined && (style || {}).height === undefined) {\n      contentStyle = {\n        height: '300px'\n      };\n    }\n\n    var buttons = tools.map(function (item, index) {\n      return Array.isArray(item) ? React.createElement(ButtonGroup, {\n        key: index\n      }, item.map(_this.renderTool, index)) : _this.renderTool(item, index);\n    });\n    return React.createElement(\"div\", {\n      ref: function (e) {\n        return _this._element = e;\n      },\n      className: 'k-widget k-editor' + (className ? \" \" + className : ''),\n      dir: this.props.dir,\n      style: style\n    }, buttons.length > 0 && React.createElement(Toolbar, {\n      keyboardNavigation: this.props.keyboardNavigation\n    }, buttons), defaultEditMode === 'iframe' ? React.createElement(\"div\", {\n      className: \"k-editor-content\"\n    }, React.createElement(\"iframe\", {\n      onLoad: firefox ? function () {\n        _this.initialize();\n      } : undefined,\n      ref: function (e) {\n        return _this.iframe = e;\n      },\n      frameBorder: \"0\",\n      style: contentStyle,\n      className: \"k-iframe\"\n    })) : React.createElement(\"div\", {\n      style: contentStyle,\n      className: \"k-editor-content\"\n    }, React.createElement(\"div\", {\n      ref: function (e) {\n        return _this._contentElement = e;\n      },\n      suppressContentEditableWarning: true\n    })), this.renderDialog(EditorDialogs.InsertLinkDialog, link, 'linkDialog'));\n  };\n\n  Editor.prototype.initialize = function () {\n    var _this = this;\n\n    var iframeWindow = this.iframe && this.iframe.contentWindow;\n\n    if (iframeWindow) {\n      var iframeDocument_1 = iframeWindow.document;\n      [defaultStyle, tablesStyles, this.props.dir === 'rtl' ? rtlStyles : undefined].forEach(function (styles) {\n        if (styles) {\n          var style = iframeDocument_1.createElement('style');\n          style.appendChild(iframeDocument_1.createTextNode(styles));\n          iframeDocument_1.head.appendChild(style);\n        }\n      });\n      var meta = iframeDocument_1.createElement('meta');\n      meta.setAttribute('charset', 'utf-8');\n      iframeDocument_1.head.appendChild(meta); // The content has to be wrapped because the `dropCursor` plugin raises a `body.offsetParent is null` error.\n\n      this._contentElement = iframeDocument_1.createElement('div');\n      iframeDocument_1.body.appendChild(this._contentElement);\n\n      this._contentElement.classList.add('k-content');\n    }\n\n    var dom = this._contentElement;\n\n    if (!dom) {\n      return;\n    }\n\n    var target = this;\n    var plugins = [// https://prosemirror.net/docs/ref/#state.PluginSpec\n    new Plugin({\n      view: function () {\n        return {\n          update: _this.updateTools\n        };\n      },\n      key: new PluginKey('toolbar-tools-update-plugin')\n    }), new Plugin({\n      filterTransaction: function (transaction, state) {\n        return (_this.props.onExecute && _this.props.onExecute.call(undefined, {\n          target: target,\n          transaction: transaction,\n          state: state\n        })) !== false;\n      },\n      key: new PluginKey('onExecute-event-plugin')\n    }), spacesFix(), history(), dropCursor(), gapCursor(), tableEditing()];\n\n    var shortcuts = __assign({}, EditorUtils.getShortcuts({\n      types: {\n        listItem: 'list_item',\n        hardBreak: 'hard_break'\n      },\n      toolsSettings: {\n        bold: bold,\n        italic: italic,\n        underline: underline\n      }\n    }), {\n      'Mod-k': function () {\n        var _a = _this.state,\n            linkDialog = _a.linkDialog,\n            editorView = _a.view;\n\n        if (editorView) {\n          var editorState = editorView.state;\n          var collapsed = editorState.selection.empty;\n          var linkMark = getMark(editorState, editorState.schema.marks[link.mark]);\n          var disabled = collapsed && !linkMark;\n\n          if (!linkDialog && !disabled) {\n            _this.setState({\n              linkDialog: true\n            });\n          }\n        }\n\n        return !linkDialog;\n      }\n    });\n\n    var _a = this.props,\n        _b = _a.defaultContent,\n        defaultContent = _b === void 0 ? '' : _b,\n        value = _a.value,\n        onMount = _a.onMount;\n    var doc = value && typeof value !== 'string' ? value : EditorUtils.createDocument(new Schema({\n      nodes: nodes,\n      marks: marks\n    }), value || defaultContent);\n    var viewProps = {\n      state: EditorState.create({\n        plugins: plugins.concat([keymap(shortcuts), keymap(baseKeymap)]),\n        doc: doc\n      }),\n      transformPastedHTML: this.onPasteHtml,\n      dispatchTransaction: this.dispatchTransaction,\n      handleDOMEvents: {\n        focus: this.onFocus,\n        blur: this.onBlur,\n        paste: this.onPaste\n      }\n    };\n    var view = onMount && onMount.call(undefined, {\n      plugins: plugins,\n      shortcuts: shortcuts,\n      target: target,\n      viewProps: viewProps,\n      dom: dom\n    }) || new EditorView({\n      mount: dom\n    }, viewProps);\n    this.setState({\n      view: view\n    });\n  };\n  /**\n   * @hidden\n   */\n\n\n  Editor.propTypes = {\n    defaultContent: PropTypes.string,\n    value: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n    defaultEditMode: PropTypes.oneOf(['iframe', 'div']),\n    contentStyle: PropTypes.object,\n    dir: PropTypes.string,\n    className: PropTypes.string,\n    style: PropTypes.object,\n    tools: PropTypes.arrayOf(PropTypes.any),\n    keyboardNavigation: PropTypes.bool,\n    onMount: PropTypes.func,\n    onFocus: PropTypes.func,\n    onBlur: PropTypes.func,\n    onChange: PropTypes.func,\n    onPasteHtml: PropTypes.func,\n    onExecute: PropTypes.func\n  };\n  return Editor;\n}(React.Component);\n\nexport default Editor;","map":{"version":3,"sources":["../../src/Editor.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { ButtonGroup, Toolbar, ToolbarSeparator } from '@progress/kendo-react-buttons';\nimport { EditorState, Plugin, PluginKey, EditorView, Schema, baseKeymap, keymap, history, dropCursor, gapCursor, getMark, spacesFix, tableEditing } from '@progress/kendo-editor-common';\nimport { marks, nodes } from './config/schema';\nimport { defaultStyle, tablesStyles, rtlStyles } from './config/defaultStyles';\nimport { EditorToolsSettings } from './config/toolsSettings';\nimport { EditorDialogs } from './dialogs/main';\nimport { EditorUtils } from './utils';\nimport { updateEditorValue } from './utils/controlled-value';\nvar link = EditorToolsSettings.link, bold = EditorToolsSettings.bold, italic = EditorToolsSettings.italic, underline = EditorToolsSettings.underline;\nimport { firefox } from './utils/browser-detection';\nimport * as licensing from '@progress/kendo-licensing';\nimport { packageMetadata } from './package-metadata';\n/**\n * Represents the [KendoReact Editor component]({% slug overview_editor %}).\n *\n * @example\n * ```jsx\n * class App extends React.Component {\n *    render() {\n *       return (\n *           <Editor\n *               defaultContent=\"<p>Hello World</p>\"\n *               tools={[\n *                  [ EditorTools.Bold, EditorTools.Italic ]\n *               ]}\n *           />\n *       );\n *    }\n * }\n * ReactDOM.render(<App />, document.querySelector('my-app'));\n * ```\n */\nvar Editor = /** @class */ (function (_super) {\n    __extends(Editor, _super);\n    function Editor(props) {\n        var _this = _super.call(this, props) || this;\n        /**\n         * @hidden\n         */\n        _this.state = {\n            view: undefined,\n            linkDialog: false\n        };\n        _this.trOnChange = null;\n        _this.htmlOnChange = null;\n        /**\n         * @hidden\n         */\n        _this.focus = function () {\n            if (_this.state.view) {\n                _this.state.view.focus();\n            }\n        };\n        _this.renderDialog = function (Component, settings, stateFlag) {\n            return _this.state[stateFlag] && (React.createElement(Component, { view: _this.state.view, settings: settings, dir: _this.props.dir, onClose: function () {\n                    var _a;\n                    return _this.setState((_a = {}, _a[stateFlag] = false, _a));\n                } }));\n        };\n        _this.renderTool = function (Tool, index) {\n            var tool = (React.createElement(Tool, { view: _this.state.view, dir: _this.props.dir, key: index }));\n            return tool.type === ToolbarSeparator ? React.createElement(Tool, { key: index }) : tool;\n        };\n        _this.updateTools = function (view, _prevViewState) {\n            _this.setState({ view: view });\n        };\n        _this.onPasteHtml = function (html) {\n            if (_this.props.onPasteHtml) {\n                var newHtml = _this.props.onPasteHtml.call(undefined, {\n                    target: _this,\n                    pastedHtml: html,\n                    nativeEvent: _this.pasteEvent\n                });\n                _this.pasteEvent = undefined;\n                if (typeof newHtml === 'string') {\n                    return newHtml;\n                }\n            }\n            return html;\n        };\n        _this.dispatchTransaction = function (transaction) {\n            var docChanged = transaction.docChanged;\n            if (_this.props.onChange && docChanged) {\n                _this.trOnChange = transaction;\n                var doc_1 = transaction.doc, schema_1 = transaction.doc.type.schema;\n                var target_1 = _this;\n                _this.props.onChange.call(undefined, {\n                    target: target_1,\n                    value: doc_1,\n                    get html() {\n                        target_1.htmlOnChange = EditorUtils.getHtml({ doc: doc_1, schema: schema_1 });\n                        return target_1.htmlOnChange;\n                    },\n                    transaction: transaction,\n                    schema: schema_1\n                });\n            }\n            if (_this.view && (_this.props.value === undefined || !docChanged)) {\n                _this.view.updateState(_this.view.state.apply(transaction));\n            }\n        };\n        _this.onFocus = function (_view, nativeEvent) {\n            if (_this.props.onFocus) {\n                _this.props.onFocus.call(undefined, { target: _this, nativeEvent: nativeEvent });\n            }\n            return false;\n        };\n        _this.onBlur = function (_view, nativeEvent) {\n            if (_this.props.onBlur) {\n                _this.props.onBlur.call(undefined, { target: _this, nativeEvent: nativeEvent });\n            }\n            return false;\n        };\n        _this.onPaste = function (_view, nativeEvent) {\n            if (_this.props.onPasteHtml) {\n                _this.pasteEvent = nativeEvent;\n            }\n            return false;\n        };\n        if (typeof licensing !== 'undefined') {\n            licensing.validatePackage(packageMetadata);\n        }\n        else {\n            var message = \"License activation failed for \" + packageMetadata.name + \"\\n\";\n            message += 'The @progress/kendo-licensing script is not loaded.\\n';\n            message += \"See \" + packageMetadata.licensingDocsUrl + \" for more information.\\n\";\n            console.warn(message);\n        }\n        return _this;\n    }\n    Object.defineProperty(Editor.prototype, \"value\", {\n        /**\n         * The value of the Editor.\n         */\n        get: function () {\n            if (this.trOnChange !== null) {\n                return this.trOnChange.doc;\n            }\n            else if (this.props.value !== undefined) {\n                return this.props.value;\n            }\n            else if (this.view) {\n                return this.view.state.doc;\n            }\n            return this.props.defaultContent || '';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"element\", {\n        /**\n         * Returns the DOM element of the Editor.\n         */\n        get: function () {\n            return this._element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"contentElement\", {\n        /**\n         * Returns the content-editable DOM element of the Editor.\n         */\n        get: function () {\n            return this._contentElement;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"view\", {\n        /**\n         * Returns the `view` object of the Editor.\n         */\n        get: function () {\n            return this.state.view;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @hidden\n     */\n    Editor.prototype.componentDidMount = function () {\n        if (!this.iframe || !firefox) {\n            this.initialize();\n        }\n    };\n    /**\n     * @hidden\n     */\n    Editor.prototype.componentDidUpdate = function (prevProps) {\n        var value = this.props.value;\n        var view = this.view;\n        if (value === undefined || !view) {\n            return;\n        }\n        updateEditorValue(view, value, prevProps.value, this.trOnChange, this.htmlOnChange);\n        this.trOnChange = null;\n        this.htmlOnChange = null;\n    };\n    /**\n     * @hidden\n     */\n    Editor.prototype.componentWillUnmount = function () {\n        if (this.state.view) {\n            this.state.view.destroy();\n        }\n    };\n    /**\n     * @hidden\n     */\n    Editor.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, _b = _a.tools, tools = _b === void 0 ? [] : _b, _c = _a.defaultEditMode, defaultEditMode = _c === void 0 ? 'iframe' : _c, style = _a.style, className = _a.className;\n        var contentStyle = this.props.contentStyle;\n        if (contentStyle === undefined && (style || {}).height === undefined) {\n            contentStyle = { height: '300px' };\n        }\n        var buttons = tools.map(function (item, index) {\n            return Array.isArray(item) ?\n                React.createElement(ButtonGroup, { key: index }, item.map(_this.renderTool, index)) :\n                _this.renderTool(item, index);\n        });\n        return (React.createElement(\"div\", { ref: function (e) { return _this._element = e; }, className: 'k-widget k-editor' + (className ? \" \" + className : ''), dir: this.props.dir, style: style },\n            buttons.length > 0 && (React.createElement(Toolbar, { keyboardNavigation: this.props.keyboardNavigation }, buttons)),\n            defaultEditMode === 'iframe' ?\n                (React.createElement(\"div\", { className: \"k-editor-content\" },\n                    React.createElement(\"iframe\", { onLoad: firefox ? function () {\n                            _this.initialize();\n                        } : undefined, ref: function (e) { return _this.iframe = e; }, frameBorder: \"0\", style: contentStyle, className: \"k-iframe\" }))) :\n                (React.createElement(\"div\", { style: contentStyle, className: \"k-editor-content\" },\n                    React.createElement(\"div\", { ref: function (e) { return _this._contentElement = e; }, suppressContentEditableWarning: true }))),\n            this.renderDialog(EditorDialogs.InsertLinkDialog, link, 'linkDialog')));\n    };\n    Editor.prototype.initialize = function () {\n        var _this = this;\n        var iframeWindow = this.iframe && this.iframe.contentWindow;\n        if (iframeWindow) {\n            var iframeDocument_1 = iframeWindow.document;\n            [defaultStyle, tablesStyles, this.props.dir === 'rtl' ? rtlStyles : undefined].forEach(function (styles) {\n                if (styles) {\n                    var style = iframeDocument_1.createElement('style');\n                    style.appendChild(iframeDocument_1.createTextNode(styles));\n                    iframeDocument_1.head.appendChild(style);\n                }\n            });\n            var meta = iframeDocument_1.createElement('meta');\n            meta.setAttribute('charset', 'utf-8');\n            iframeDocument_1.head.appendChild(meta);\n            // The content has to be wrapped because the `dropCursor` plugin raises a `body.offsetParent is null` error.\n            this._contentElement = iframeDocument_1.createElement('div');\n            iframeDocument_1.body.appendChild(this._contentElement);\n            this._contentElement.classList.add('k-content');\n        }\n        var dom = this._contentElement;\n        if (!dom) {\n            return;\n        }\n        var target = this;\n        var plugins = [\n            // https://prosemirror.net/docs/ref/#state.PluginSpec\n            new Plugin({\n                view: function () { return ({ update: _this.updateTools }); },\n                key: new PluginKey('toolbar-tools-update-plugin')\n            }),\n            new Plugin({\n                filterTransaction: function (transaction, state) {\n                    return (_this.props.onExecute &&\n                        _this.props.onExecute.call(undefined, { target: target, transaction: transaction, state: state })) !== false;\n                },\n                key: new PluginKey('onExecute-event-plugin')\n            }),\n            spacesFix(),\n            history(),\n            dropCursor(),\n            gapCursor(),\n            tableEditing()\n        ];\n        var shortcuts = __assign({}, EditorUtils.getShortcuts({\n            types: { listItem: 'list_item', hardBreak: 'hard_break' },\n            toolsSettings: { bold: bold, italic: italic, underline: underline }\n        }), { 'Mod-k': function () {\n                var _a = _this.state, linkDialog = _a.linkDialog, editorView = _a.view;\n                if (editorView) {\n                    var editorState = editorView.state;\n                    var collapsed = editorState.selection.empty;\n                    var linkMark = getMark(editorState, editorState.schema.marks[link.mark]);\n                    var disabled = collapsed && !linkMark;\n                    if (!linkDialog && !disabled) {\n                        _this.setState({ linkDialog: true });\n                    }\n                }\n                return !linkDialog;\n            } });\n        var _a = this.props, _b = _a.defaultContent, defaultContent = _b === void 0 ? '' : _b, value = _a.value, onMount = _a.onMount;\n        var doc = (value && typeof value !== 'string') ? value :\n            EditorUtils.createDocument(new Schema({ nodes: nodes, marks: marks }), (value || defaultContent));\n        var viewProps = {\n            state: EditorState.create({\n                plugins: plugins.concat([keymap(shortcuts), keymap(baseKeymap)]),\n                doc: doc\n            }),\n            transformPastedHTML: this.onPasteHtml,\n            dispatchTransaction: this.dispatchTransaction,\n            handleDOMEvents: {\n                focus: this.onFocus,\n                blur: this.onBlur,\n                paste: this.onPaste\n            }\n        };\n        var view = (onMount && onMount.call(undefined, { plugins: plugins, shortcuts: shortcuts, target: target, viewProps: viewProps, dom: dom })) ||\n            new EditorView({ mount: dom }, viewProps);\n        this.setState({\n            view: view\n        });\n    };\n    /**\n     * @hidden\n     */\n    Editor.propTypes = {\n        defaultContent: PropTypes.string,\n        value: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n        defaultEditMode: PropTypes.oneOf(['iframe', 'div']),\n        contentStyle: PropTypes.object,\n        dir: PropTypes.string,\n        className: PropTypes.string,\n        style: PropTypes.object,\n        tools: PropTypes.arrayOf(PropTypes.any),\n        keyboardNavigation: PropTypes.bool,\n        onMount: PropTypes.func,\n        onFocus: PropTypes.func,\n        onBlur: PropTypes.func,\n        onChange: PropTypes.func,\n        onPasteHtml: PropTypes.func,\n        onExecute: PropTypes.func\n    };\n    return Editor;\n}(React.Component));\nexport default Editor;\n//# sourceMappingURL=Editor.js.map"]},"metadata":{},"sourceType":"module"}