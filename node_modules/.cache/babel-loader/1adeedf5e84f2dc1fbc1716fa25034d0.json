{"ast":null,"code":"import _objectSpread from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _defineProperty from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{toast}from\"react-toastify\";import{injectIntl}from\"react-intl\";import rsapi from\"../../rsapi\";import{process}from\"@progress/kendo-data-query\";import{Row}from\"react-bootstrap\";import\"../../assets/styles/lims-global-theme.css\";import SlideOutModal from\"../../components/slide-out-modal/SlideOutModal\";import{DEFAULT_RETURN}from\"../../actions/LoginTypes\";import{showEsign,getControlMap,create_UUID,onDropAttachFileList,convertDateValuetoString,deleteAttachmentDropZone,formatInputDate,rearrangeDateFormat}from\"../../components/CommonScript\";import Esign from\"../audittrail/Esign\";import AddMethodValidity from\"./AddMethodValidity\";//import ValidateFormula from './ValidateFormula';\nimport{parameterType,transactionStatus,operators,attachmentType,FORMULAFIELDTYPE}from\"../../components/Enumeration\";import CustomTab from\"../../components/custom-tabs/custom-tabs.component\";import MethodValidityTab from\"./MethodValidityTab\";import ConfirmMessage from\"../../components/confirm-alert/confirm-message.component\";import{ChartLegendTitle}from\"@progress/kendo-react-charts\";import{rearrangeDateFormatDateOnly}from'./../../components/CommonScript';var MethodValidityView=/*#__PURE__*/function(_Component){_inherits(MethodValidityView,_Component);var _super=_createSuper(MethodValidityView);function MethodValidityView(props){var _this;_classCallCheck(this,MethodValidityView);_this=_super.call(this,props);_this.handleDateChange=function(dateName,dateValue,sdatename){var selectedRecord=_this.state.selectedRecord;// if(dateName === \"dvaliditystartdate\")\n// {\n//   selectedRecord[\"dvalidityenddate\"] = dateValue;  \n// }\nselectedRecord[dateName]=dateValue;selectedRecord[sdatename]=dateValue;_this.setState({selectedRecord:selectedRecord});};_this.onTabChange=function(tabProps){var screenName=tabProps.screenName;var updateInfo={typeName:DEFAULT_RETURN,data:{screenName:screenName}};_this.props.updateStore(updateInfo);};_this.tabDetail=function(){var tabMap=new Map();for(var i=0;i<_this.props.masterData[\"MethodValidity\"].length;i++){_this.props.masterData[\"MethodValidity\"][i].svaliditystartdate=rearrangeDateFormatDateOnly(_this.props.userInfo,_this.props.masterData[\"MethodValidity\"][i].svaliditystartdate);_this.props.masterData[\"MethodValidity\"][i].svalidityenddate=rearrangeDateFormatDateOnly(_this.props.userInfo,_this.props.masterData[\"MethodValidity\"][i].svalidityenddate);}tabMap.set(\"IDS_METHODVALIDITY\",/*#__PURE__*/React.createElement(MethodValidityTab,{controlMap:_this.props.controlMap,userRoleControlRights:_this.props.userRoleControlRights,operation:_this.props.operation,dataResult:process(_this.props.masterData[\"MethodValidity\"],_this.state.methodvalidityDataState),dataState:_this.state.methodvalidityDataState,dataStateChange:function dataStateChange(event){return _this.setState({methodvalidityDataState:event.dataState});},selectedMethod:_this.props.masterData.SelectedMethod,fetchMethodValidityById:_this.props.fetchMethodValidityById,editParam:_this.props.editParam,userInfo:_this.props.userInfo,inputParam:_this.props.inputParam,selectedComponent:_this.state.selectedComponent,handleComponentRowClick:_this.handleComponentRowClick,formatMessage:_this.props.intl.formatMessage,deleteRecord:_this.deleteRecord,onApproveClick:_this.onApproveClick,openChildModal:_this.openChildModal,defaultRecord:_this.defaultRecord,selectedId:_this.props.selectedId,getAvailableValidityData:_this.props.getAvailableValidityData,MethodValidity:_this.props.masterData.MethodValidity||[],screenName:\"IDS_METHODVALIDITY\",approveParam:_this.props.approveParam}));return tabMap;};_this.handleComponentRowClick=function(event){var selectedComponent=event.dataItem;// let SelectedTest = this.props.Login.Test && this.props.Login.Test[selectedComponent.slno] ? this.props.Login.Test[selectedComponent.slno] : [];\nvar updateInfo={typeName:DEFAULT_RETURN,data:{operation:\"\"// SelectedTest, selectedComponent,\n// testDataState: {\n//     skip: 0, take: this.props.Login.settings ?\n//         parseInt(this.props.Login.settings[14]) : 5\n// }\n}};_this.props.updateStore(updateInfo);_this.setState({selectedComponent:selectedComponent});};_this.openChildModal=function(){if(_this.props.selectedMethod.nneedvalidity===transactionStatus.YES){var addParam={screenName:\"IDS_METHOD\",operation:\"create\",primaryKeyName:\"nmethodvaliditycode\",masterData:_this.props.masterData,userInfo:_this.props.userInfo};_this.props.getMethodValidityUTCDate(addParam);}else{toast.warn(_this.props.intl.formatMessage({id:\"IDS_ENABLEMETHODVALIDITY\"}));}//let selectedRecord={};\n// const updateInfo = {\n//   typeName: DEFAULT_RETURN,\n//   data: { openChildModal: true,operation:\"create\" },\n// };//,selectedRecord\n// this.props.updateStore(updateInfo);\n};_this.onApproveClick=function(selectedDataItem,operation,primaryKeyName){if(selectedDataItem.dataItem.ntransactionstatus===transactionStatus.DRAFT){// if (this.state.selectedComponent.ntransactionstatus === transactionStatus.DRAFT) {\nvar approveId=_this.props.controlMap.has(\"ApproveMethodValidity\")&&_this.props.controlMap.get(\"ApproveMethodValidity\").ncontrolcode;var inputData=[];inputData[\"userinfo\"]=_this.props.userInfo;//add               \nvar postParam=undefined;inputData[\"methodvalidity\"]=selectedDataItem.dataItem;postParam={inputListName:\"methodvalidity\",selectedObject:\"MethodValidity\",primaryKeyField:\"nmethodvaliditycode\",primaryKeyValue:_this.state.selectedRecord[\"nmethodvaliditycode\"],fetchUrl:\"method/getActiveMethodValidityById\",fecthInputObject:{userinfo:_this.props.userInfo},masterData:_this.props.masterData};var inputParam={classUrl:\"method\",methodUrl:\"MethodValidity\",inputData:inputData,operation:\"approve\",postParam:postParam};var saveType;var masterData=_this.props.masterData;var esignNeeded=showEsign(_this.props.esignRights,_this.props.userInfo.nformcode,approveId);if(esignNeeded){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:masterData},screenName:\"IDS_METHOD\",openChildModal:true,operation:\"approve\",selectedRecord:{}}};_this.props.updateStore(updateInfo);}else{_this.props.crudMaster(inputParam,masterData,\"openChildModal\",{});}//  }\n// else {\n//     toast.warn(this.props.intl.formatMessage({ id: \"IDS_SELECTDRAFTRECORDTOAPPROVE\" }));\n// }\n}else{toast.warn(_this.props.intl.formatMessage({id:\"IDS_NOTEDITDELETEMETHODVALIDITY\"}));}};_this.deleteRecord=function(deleteParam){if(deleteParam.selectedRecord.ntransactionstatus===transactionStatus.DRAFT){var _inputData;var methodUrl=deleteParam.methodUrl;var selected=deleteParam.selectedRecord;var dataState=undefined;if(_this.props.screenName===\"IDS_SECTION\"){dataState=_this.state.methodValidityDataState;}var inputParam={inputData:(_inputData={},_defineProperty(_inputData,methodUrl.toLowerCase(),selected),_defineProperty(_inputData,\"userinfo\",_this.props.userInfo),_inputData),classUrl:\"method\",operation:deleteParam.operation,methodUrl:methodUrl,screenName:\"IDS_METHOD\",dataState:dataState};var masterData=_this.props.masterData;if(showEsign(_this.props.esignRights,_this.props.userInfo.nformcode,deleteParam.ncontrolCode)){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:masterData},openChildModal:true,screenName:\"IDS_METHOD\",operation:deleteParam.operation,selectedRecord:{}}};_this.props.updateStore(updateInfo);}else{_this.props.crudMaster(inputParam,masterData,\"openChildModal\",{});}}else{toast.warn(_this.props.intl.formatMessage({id:\"IDS_NOTEDITDELETEMETHODVALIDITY\"}));}};_this.defaultRecord=function(defaultParam,event){var _inputData2;var methodUrl=defaultParam.methodUrl;var dataItem=defaultParam.selectedRecord;// dataItem[\"ndefaultstatus\"] = transactionStatus.YES;\nvar dataState=undefined;if(_this.props.screenName===\"IDS_SECTION\"){dataState=_this.state.methodValidityDataState;}var inputParam={inputData:(_inputData2={},_defineProperty(_inputData2,methodUrl.toLowerCase(),dataItem),_defineProperty(_inputData2,\"userinfo\",_this.props.userInfo),_inputData2),classUrl:\"method\",operation:\"setDefault\",methodUrl:methodUrl,dataState:dataState};var masterData=_this.props.masterData;if(showEsign(_this.props.esignRights,_this.props.userInfo.nformcode,defaultParam.ncontrolCode)){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:masterData},openChildModal:true,screenName:\"Method\",operation:defaultParam.operation,selectedRecord:{}}};_this.props.updateStore(updateInfo);}else{_this.props.crudMaster(inputParam,masterData,\"openChildModal\",{});}};_this.closeModal=function(){var loadEsign=_this.props.loadEsign;var openChildModal=_this.props.openChildModal;var selectedRecord=_this.props.selectedRecord;var selectedId=_this.props.selectedId;if(_this.props.loadEsign){if(_this.props.operation===\"delete\"||_this.props.operation===\"approve\"){loadEsign=false;openChildModal=false;selectedRecord={};}else{loadEsign=false;selectedRecord[\"agree\"]=4;selectedRecord[\"esignpassword\"]=\"\";selectedRecord[\"esigncomments\"]=\"\";selectedRecord['esignreason']=\"\";}}else{openChildModal=false;selectedRecord={};selectedId=null;}var updateInfo={typeName:DEFAULT_RETURN,data:{openChildModal:openChildModal,loadEsign:loadEsign,selectedRecord:selectedRecord,selectedId:selectedId}};_this.props.updateStore(updateInfo);};_this.onComboChange=function(comboData,fieldName,caseNo){var selectedRecord=_this.state.selectedRecord||{};switch(caseNo){case 1:var _selectedRecord=_this.state.selectedRecord||{};_selectedRecord[fieldName]=comboData;;_this.setState({selectedRecord:_selectedRecord});// if (fieldName === \"sparametername\") {\n//   selectedRecord[fieldName] = comboData;\n//   selectedRecord[\"sparametersynonym\"] = comboData.value;\n// } else {\n//   selectedRecord[fieldName] = comboData;\n// }\n// this.setState({ selectedRecord });\nbreak;case 2:var parameterData=_this.props.parameterData;var item=comboData[\"item\"];var needUnit=true;var needRoundingDigit=true;var needCodedResult=true;var needActualResult=true;var npredefinedcode=4;if(item[\"nunitrequired\"]===3){needUnit=false;_selectedRecord[\"nunitcode\"]=_this.props.parameterData.defaultUnit;}else{_selectedRecord[\"nunitcode\"]=\"\";}if(item[\"nroundingrequired\"]===3){needRoundingDigit=false;}else{_selectedRecord[\"nroundingdigits\"]=\"\";}if(item[\"npredefinedrequired\"]===3){needCodedResult=false;npredefinedcode=item[\"npredefinedrequired\"];}else{_selectedRecord[\"spredefinedname\"]=\"\";}if(item[\"ngraderequired\"]===3){needActualResult=false;_selectedRecord[\"ngradecode\"]=_this.props.parameterData.defaultGrade;}else{_selectedRecord[\"ngradecode\"]=\"\";}_selectedRecord[fieldName]=comboData;var parameterInfo={typeName:DEFAULT_RETURN,data:{selectedRecord:_selectedRecord,parameterData:_objectSpread(_objectSpread({},parameterData),{},{needUnit:needUnit,needRoundingDigit:needRoundingDigit,needCodedResult:needCodedResult,needActualResult:needActualResult,npredefinedcode:npredefinedcode})}};_this.props.updateStore(parameterInfo);break;case 3:_selectedRecord[fieldName]=comboData;_this.props.formulaChangeFunction({ntestcategorycode:comboData.value,nFlag:2,userinfo:_this.props.userInfo},_this.props.formulaData,1,_selectedRecord,\"/changeTestCatgoryInFormula\");break;case 4:_selectedRecord[fieldName]=comboData;_this.props.formulaChangeFunction({ntestcode:comboData.value,nFlag:3,userinfo:_this.props.userInfo},_this.props.formulaData,2,_selectedRecord,\"/changeTestInFormula\");break;default:break;}};_this.onEsignInputOnChange=function(event){var selectedRecord=_this.state.selectedRecord||{};if(event.target.type===\"checkbox\"){selectedRecord[event.target.name]=event.target.checked===true?3:4;}else{selectedRecord[event.target.name]=event.target.value;}_this.setState({selectedRecord:selectedRecord});};_this.onInputOnChange=function(event,caseNo,optional){var selectedRecord=_this.state.selectedRecord||{};switch(caseNo){case 1:if(event.target.type===\"checkbox\"){selectedRecord[event.target.name]=event.target.checked===true?transactionStatus.YES:transactionStatus.NO;}else if(event.target.type===\"radio\"){selectedRecord[event.target.name]=optional;//  selectedRecord[\"sfilename\"]=\"\";\n}else{selectedRecord[event.target.name]=event.target.value;}_this.setState({selectedRecord:selectedRecord});break;case 4:var inputValue=event.target.value;if(/^-?\\d*?\\.?\\d*?$/.test(inputValue)||inputValue===\"\"){selectedRecord[event.target.name]=event.target.value;}_this.setState({selectedRecord:selectedRecord});break;case 5:if(optional.ndynamicformulafieldcode===FORMULAFIELDTYPE.INTEGER&&optional.sdescription.indexOf(\"P$\")===-1){var value=event.target.value.replace(/[^-^0-9]/g,\"\");var dynamicField=_this.state.dynamicField||[];if(/^-?\\d*?$/.test(value)){if(!selectedRecord[\"formulainput\"]){selectedRecord[\"formulainput\"]={};}selectedRecord[\"formulainput\"][event.target.name]=value;dynamicField[event.target.name]={sparameter:optional.sdescription,svalues:value};}else if(value===\"\"){if(!selectedRecord[\"formulainput\"]){selectedRecord[\"formulainput\"]={};}selectedRecord[\"formulainput\"][event.target.name]=value;dynamicField[event.target.name]={sparameter:optional.sdescription,svalues:value};}_this.setState({dynamicField:dynamicField,selectedRecord:selectedRecord});break;}else{var _value=event.target.value.replace(/[^-^0-9.]/g,\"\");var _dynamicField=_this.state.dynamicField||[];if(/^-?\\d*?\\.?\\d*?$/.test(_value)||_value!==\"\"){if(!selectedRecord[\"formulainput\"]){selectedRecord[\"formulainput\"]={};}selectedRecord[\"formulainput\"][event.target.name]=_value;_dynamicField[event.target.name]={sparameter:optional.sdescription,svalues:_value};}_this.setState({dynamicField:_dynamicField,selectedRecord:selectedRecord});break;}default:break;}};_this.onSaveClick=function(saveType,formRef){//add / edit\nvar inputData=[];inputData[\"userinfo\"]=_this.props.userInfo;var postParam=undefined;var editId=_this.props.controlMap.has(\"AddMethodValidity\")&&_this.props.controlMap.get(\"AddMethodValidity\").ncontrolcode;// if (this.state.selectedRecord[\"ncommentsubtypecode\"].value === 3) {\n//     if (this.state.selectedRecord[\"spredefinedname\"] === undefined || \n//          this.state.selectedRecord[\"spredefinedname\"] === \"\") {\n//         toast.info(\"Enter PreDefined Name\");\n//         return;\n//     }\n// }\n//   if (this.state.selectedRecord[\"dvalidityenddate\"] !== undefined && this.state.selectedRecord[\"dvaliditystartdate\"] !== undefined) {\n//     if (this.state.selectedRecord[\"dvalidityenddate\"] < this.state.selectedRecord[\"dvaliditystartdate\"]) {\n//         toast.info(this.props.intl.formatMessage({ id: \"IDS_ENDDATEGRATERTHANSTARTDATE\" }));\n//         return;\n//     }\n// }\nvar obj=convertDateValuetoString(_this.state.selectedRecord[\"dvaliditystartdate\"]?_this.state.selectedRecord[\"dvaliditystartdate\"]:new Date(),_this.state.selectedRecord[\"dvalidityenddate\"]?_this.state.selectedRecord[\"dvalidityenddate\"]:new Date(),_this.props.userInfo);_this.state.selectedRecord[\"svaliditystartdate\"]=obj.fromDate;_this.state.selectedRecord[\"svalidityenddate\"]=obj.toDate;if(_this.props.operation===\"update\"){// edit\npostParam={inputListName:\"methodvalidity\",selectedObject:\"MethodValidity\",primaryKeyField:\"nmethodvaliditycode\",primaryKeyValue:_this.state.selectedRecord[\"nmethodvaliditycode\"],fetchUrl:\"method/getActiveMethodValidityById\",fecthInputObject:{userinfo:_this.props.userInfo},masterData:_this.props.masterData};inputData[\"methodvalidity\"]={\"nsitecode\":_this.props.userInfo.nmastersitecode};inputData[\"methodvalidity\"][\"dvaliditystartdate\"]=_this.state.selectedRecord[\"dvaliditystartdate\"]?formatInputDate(_this.state.selectedRecord[\"dvaliditystartdate\"]):formatInputDate(new Date());inputData[\"methodvalidity\"][\"dvalidityenddate\"]=_this.state.selectedRecord[\"dvalidityenddate\"]?_this.state.selectedRecord[\"dvalidityenddate\"]:new Date();inputData[\"methodvalidity\"][\"svaliditystartdate\"]=_this.state.selectedRecord[\"svaliditystartdate\"]?_this.state.selectedRecord[\"svaliditystartdate\"]:new Date();inputData[\"methodvalidity\"][\"svalidityenddate\"]=_this.state.selectedRecord[\"svalidityenddate\"]?_this.state.selectedRecord[\"svalidityenddate\"]:new Date();inputData[\"methodvalidity\"][\"nmethodcode\"]=_this.props.selectedMethod.nmethodcode;inputData[\"methodvalidity\"][\"nmethodvaliditycode\"]=_this.state.selectedRecord[\"nmethodvaliditycode\"]?_this.state.selectedRecord[\"nmethodvaliditycode\"]:0;editId=_this.props.controlMap.has(\"EditMethodValidity\")&&_this.props.controlMap.get(\"EditMethodValidity\").ncontrolcode;}else{inputData[\"methodvalidity\"]={\"nsitecode\":_this.props.userInfo.nmastersitecode};inputData[\"methodvalidity\"][\"dvaliditystartdate\"]=_this.state.selectedRecord[\"dvaliditystartdate\"]?_this.state.selectedRecord[\"dvaliditystartdate\"]:new Date();inputData[\"methodvalidity\"][\"dvalidityenddate\"]=_this.state.selectedRecord[\"dvalidityenddate\"]?_this.state.selectedRecord[\"dvalidityenddate\"]:new Date();inputData[\"methodvalidity\"][\"svaliditystartdate\"]=_this.state.selectedRecord[\"svaliditystartdate\"]?_this.state.selectedRecord[\"svaliditystartdate\"]:new Date();inputData[\"methodvalidity\"][\"svalidityenddate\"]=_this.state.selectedRecord[\"svalidityenddate\"]?_this.state.selectedRecord[\"svalidityenddate\"]:new Date();inputData[\"methodvalidity\"][\"nmethodcode\"]=_this.props.selectedMethod.nmethodcode;}inputData[\"methodvalidity\"][\"ntzvaliditystartdatetimezone\"]=_this.state.selectedRecord[\"ntzvaliditystartdatetimezone\"]?_this.state.selectedRecord[\"ntzvaliditystartdatetimezone\"].value||_this.props.userInfo.ntimezonecode:_this.props.userInfo.ntimezonecode;inputData[\"methodvalidity\"][\"ntzvalidityenddatetimezone\"]=_this.state.selectedRecord[\"ntzvalidityenddatetimezone\"]?_this.state.selectedRecord[\"ntzvalidityenddatetimezone\"].value||_this.props.userInfo.ntimezonecode:_this.props.userInfo.ntimezonecode;var inputParam={classUrl:\"method\",methodUrl:\"MethodValidity\",displayName:\"IDS_METHOD\",inputData:inputData,operation:_this.props.operation,saveType:saveType,formRef:formRef,postParam:postParam,searchRef:_this.searchRef};var masterData=_this.props.masterData;var esignNeeded=showEsign(_this.props.esignRights,_this.props.userInfo.nformcode,editId);if(esignNeeded){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:masterData},saveType:saveType}};_this.props.updateStore(updateInfo);}else{_this.props.crudMaster(inputParam,masterData,\"openChildModal\");}};_this.validateEsign=function(){var inputParam={inputData:{\"userinfo\":_objectSpread(_objectSpread({},_this.props.userInfo),{},{sreason:_this.state.selectedRecord[\"esigncomments\"],nreasoncode:_this.state.selectedRecord[\"esignreason\"]&&_this.state.selectedRecord[\"esignreason\"].value,spredefinedreason:_this.state.selectedRecord[\"esignreason\"]&&_this.state.selectedRecord[\"esignreason\"].label}),password:_this.state.selectedRecord[\"esignpassword\"]},screenData:_this.props.screenData};_this.props.validateEsignCredential(inputParam,\"openChildModal\");};_this.ConfirmDelete=function(deleteParam,deleteID){_this.confirmMessage.confirm(\"deleteMessage\",_this.props.intl.formatMessage({id:\"IDS_DELETE\"}),_this.props.intl.formatMessage({id:\"IDS_DEFAULTCONFIRMMSG\"}),_this.props.intl.formatMessage({id:\"IDS_OK\"}),_this.props.intl.formatMessage({id:\"IDS_CANCEL\"}),function(){return _this.deleteRecord(deleteParam);});};_this.state={selectedRecord:{},fieldFlag:true,operatorFlag:false,functionFlag:true,methodvalidityDataState:{skip:0,take:_this.props.settings?parseInt(_this.props.settings[14]):5},methodDataState:{skip:0,take:_this.props.settings?parseInt(_this.props.settings[14]):5},selectedComponent:\"\"};_this.confirmMessage=new ConfirmMessage();return _this;}_createClass(MethodValidityView,[{key:\"render\",value:function render(){var SelectedMethod=this.props.masterData.SelectedMethod;var mandatoryFields=[{idsName:\"IDS_VALIDITYSTARTDATE\",dataField:\"dvaliditystartdate\",mandatoryLabel:\"IDS_SELECT\",controlType:\"selectbox\"},{idsName:\"IDS_VALIDITYENDDATE\",dataField:\"dvalidityenddate\",mandatoryLabel:\"IDS_SELECT\",controlType:\"selectbox\"}];return/*#__PURE__*/React.createElement(React.Fragment,null,SelectedMethod&&/*#__PURE__*/React.createElement(CustomTab,{tabDetail:this.tabDetail(),onTabChange:this.onTabChange}),this.props.openChildModal&&/*#__PURE__*/React.createElement(SlideOutModal,{show:this.props.openChildModal,closeModal:this.closeModal,operation:this.props.operation,inputParam:this.props.inputParam,screenName:\"IDS_METHODVALIDITY\",onSaveClick:this.onSaveClick,esign:this.props.loadEsign,validateEsign:this.validateEsign,selectedRecord:this.state.selectedRecord||{},mandatoryFields:this.mandatoryFields,addComponent:this.props.loadEsign?/*#__PURE__*/React.createElement(Esign,{operation:this.props.operation,onInputOnChange:this.onEsignInputOnChange,inputParam:this.props.inputParam,selectedRecord:this.state.selectedRecord||{}}):/*#__PURE__*/React.createElement(AddMethodValidity,{selectedRecord:this.state.selectedRecord||{},methodvalidity:this.props.MethodValidity,handleDateChange:this.handleDateChange,userInfo:this.props.userInfo})}));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(previousProps){if(this.props.selectedRecord!==previousProps.selectedRecord){this.setState({selectedRecord:this.props.selectedRecord});}if(this.props.masterData!==previousProps.masterData){var _this$state=this.state,methodValidityDataState=_this$state.methodValidityDataState,selectedRecord=_this$state.selectedRecord;if(this.props.dataState===undefined){if(this.props.screenName===\"IDS_METHODVALIDITY\"){methodValidityDataState={skip:0,take:10};}}//this.props.masterData.MethodValidity\nthis.setState({methodValidityDataState:methodValidityDataState,selectedRecord:selectedRecord});}if(this.props.Login!==previousProps.Login){this.PrevoiusLoginData=previousProps;}// if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\n//     this.setState({ selectedRecord: this.props.Login.selectedRecord });\n// }\n// if (this.props.Login.userInfo.nformcode !== previousProps.Login.userInfo.nformcode) {\n//     const userRoleControlRights = [];\n//     if (this.props.Login.userRoleControlRights) {\n//         this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode] && Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(item =>\n//             userRoleControlRights.push(item.ncontrolcode))\n//     }\n//     const controlMap = getControlMap(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode)\n//     this.setState({ userRoleControlRights, controlMap });\n// }\n}}]);return MethodValidityView;}(Component);export default injectIntl(MethodValidityView);","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/pages/testmanagement/MethodValidityView.jsx"],"names":["React","Component","toast","injectIntl","rsapi","process","Row","SlideOutModal","DEFAULT_RETURN","showEsign","getControlMap","create_UUID","onDropAttachFileList","convertDateValuetoString","deleteAttachmentDropZone","formatInputDate","rearrangeDateFormat","Esign","AddMethodValidity","parameterType","transactionStatus","operators","attachmentType","FORMULAFIELDTYPE","CustomTab","MethodValidityTab","ConfirmMessage","ChartLegendTitle","rearrangeDateFormatDateOnly","MethodValidityView","props","handleDateChange","dateName","dateValue","sdatename","selectedRecord","state","setState","onTabChange","tabProps","screenName","updateInfo","typeName","data","updateStore","tabDetail","tabMap","Map","i","masterData","length","svaliditystartdate","userInfo","svalidityenddate","set","controlMap","userRoleControlRights","operation","methodvalidityDataState","event","dataState","SelectedMethod","fetchMethodValidityById","editParam","inputParam","selectedComponent","handleComponentRowClick","intl","formatMessage","deleteRecord","onApproveClick","openChildModal","defaultRecord","selectedId","getAvailableValidityData","MethodValidity","approveParam","dataItem","selectedMethod","nneedvalidity","YES","addParam","primaryKeyName","getMethodValidityUTCDate","warn","id","selectedDataItem","ntransactionstatus","DRAFT","approveId","has","get","ncontrolcode","inputData","postParam","undefined","inputListName","selectedObject","primaryKeyField","primaryKeyValue","fetchUrl","fecthInputObject","userinfo","classUrl","methodUrl","saveType","esignNeeded","esignRights","nformcode","loadEsign","screenData","crudMaster","deleteParam","selected","methodValidityDataState","toLowerCase","ncontrolCode","defaultParam","closeModal","onComboChange","comboData","fieldName","caseNo","parameterData","item","needUnit","needRoundingDigit","needCodedResult","needActualResult","npredefinedcode","defaultUnit","defaultGrade","parameterInfo","formulaChangeFunction","ntestcategorycode","value","nFlag","formulaData","ntestcode","onEsignInputOnChange","target","type","name","checked","onInputOnChange","optional","NO","inputValue","test","ndynamicformulafieldcode","INTEGER","sdescription","indexOf","replace","dynamicField","sparameter","svalues","onSaveClick","formRef","editId","obj","Date","fromDate","toDate","nmastersitecode","nmethodcode","ntimezonecode","displayName","searchRef","validateEsign","sreason","nreasoncode","spredefinedreason","label","password","validateEsignCredential","ConfirmDelete","deleteID","confirmMessage","confirm","fieldFlag","operatorFlag","functionFlag","skip","take","settings","parseInt","methodDataState","mandatoryFields","idsName","dataField","mandatoryLabel","controlType","previousProps","Login","PrevoiusLoginData"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport { injectIntl } from \"react-intl\";\r\nimport rsapi from \"../../rsapi\";\r\nimport { process } from \"@progress/kendo-data-query\";\r\nimport { Row } from \"react-bootstrap\";\r\nimport \"../../assets/styles/lims-global-theme.css\";\r\nimport SlideOutModal from \"../../components/slide-out-modal/SlideOutModal\";\r\nimport { DEFAULT_RETURN } from \"../../actions/LoginTypes\";\r\nimport {\r\n  showEsign,\r\n  getControlMap,\r\n  create_UUID,\r\n  onDropAttachFileList,\r\n  convertDateValuetoString,\r\n  deleteAttachmentDropZone,\r\n  formatInputDate,\r\n  rearrangeDateFormat,\r\n} from \"../../components/CommonScript\";\r\nimport Esign from \"../audittrail/Esign\";\r\nimport AddMethodValidity from \"./AddMethodValidity\";\r\n//import ValidateFormula from './ValidateFormula';\r\nimport {\r\n  parameterType,\r\n  transactionStatus,\r\n  operators,\r\n  attachmentType,\r\n  FORMULAFIELDTYPE,\r\n} from \"../../components/Enumeration\";\r\nimport CustomTab from \"../../components/custom-tabs/custom-tabs.component\";\r\nimport MethodValidityTab from \"./MethodValidityTab\";\r\nimport ConfirmMessage from \"../../components/confirm-alert/confirm-message.component\";\r\nimport { ChartLegendTitle } from \"@progress/kendo-react-charts\";\r\nimport { rearrangeDateFormatDateOnly } from './../../components/CommonScript';\r\n\r\nclass MethodValidityView extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      selectedRecord: {},\r\n      fieldFlag: true,\r\n      operatorFlag: false,\r\n      functionFlag: true,\r\n      methodvalidityDataState: { skip: 0, take: this.props.settings ? parseInt(this.props.settings[14]) : 5},\r\n      methodDataState: { skip: 0, take: this.props.settings ? parseInt(this.props.settings[14]) : 5 },\r\n      selectedComponent:\"\"\r\n    };\r\n    this.confirmMessage = new ConfirmMessage();\r\n  }\r\n\r\n  render() {\r\n    const { SelectedMethod } = this.props.masterData;\r\n    \r\n    const mandatoryFields = [\r\n      {\r\n        idsName: \"IDS_VALIDITYSTARTDATE\",\r\n        dataField: \"dvaliditystartdate\",\r\n        mandatoryLabel: \"IDS_SELECT\",\r\n        controlType: \"selectbox\",\r\n      },\r\n      {\r\n        idsName: \"IDS_VALIDITYENDDATE\",\r\n        dataField: \"dvalidityenddate\",\r\n        mandatoryLabel: \"IDS_SELECT\",\r\n        controlType: \"selectbox\",\r\n      },\r\n    ];\r\n    return (\r\n      <>\r\n        {SelectedMethod && (\r\n          <CustomTab\r\n            tabDetail={this.tabDetail()}\r\n            onTabChange={this.onTabChange}\r\n          />\r\n        )}\r\n\r\n        {this.props.openChildModal && (\r\n          <SlideOutModal\r\n            show={this.props.openChildModal}\r\n            closeModal={this.closeModal}\r\n            operation={this.props.operation}\r\n            inputParam={this.props.inputParam}\r\n            screenName={\"IDS_METHODVALIDITY\"}\r\n            onSaveClick={this.onSaveClick}\r\n            esign={this.props.loadEsign}\r\n            validateEsign={this.validateEsign}\r\n            selectedRecord={this.state.selectedRecord || {}}\r\n            mandatoryFields={this.mandatoryFields}\r\n            addComponent={\r\n              this.props.loadEsign ? (\r\n                <Esign\r\n                  operation={this.props.operation}\r\n                  onInputOnChange={this.onEsignInputOnChange}\r\n                  inputParam={this.props.inputParam}\r\n                  selectedRecord={this.state.selectedRecord || {}}\r\n                />\r\n              ) : (\r\n                <AddMethodValidity\r\n                  selectedRecord={this.state.selectedRecord || {}}\r\n                  methodvalidity={this.props.MethodValidity}\r\n                  handleDateChange={this.handleDateChange}\r\n                  userInfo={this.props.userInfo}\r\n                />\r\n              )\r\n            }\r\n          />\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n  handleDateChange = (dateName, dateValue, sdatename) => {\r\n    const { selectedRecord } = this.state;\r\n    // if(dateName === \"dvaliditystartdate\")\r\n    // {\r\n    //   selectedRecord[\"dvalidityenddate\"] = dateValue;  \r\n    // }\r\n    selectedRecord[dateName] = dateValue;\r\n    selectedRecord[sdatename] = dateValue;\r\n    this.setState({ selectedRecord });\r\n  };\r\n  onTabChange = (tabProps) => {\r\n    const screenName = tabProps.screenName;\r\n    const updateInfo = {\r\n      typeName: DEFAULT_RETURN,\r\n      data: { screenName },\r\n    };\r\n    this.props.updateStore(updateInfo);\r\n  };\r\n  tabDetail = () => {\r\n    const tabMap = new Map();\r\n\r\n    for(let i=0;i<this.props.masterData[\"MethodValidity\"].length;i++)\r\n    {\r\n      this.props.masterData[\"MethodValidity\"][i].svaliditystartdate=rearrangeDateFormatDateOnly(this.props.userInfo,this.props.masterData[\"MethodValidity\"][i].svaliditystartdate);\r\n      this.props.masterData[\"MethodValidity\"][i].svalidityenddate=rearrangeDateFormatDateOnly(this.props.userInfo,this.props.masterData[\"MethodValidity\"][i].svalidityenddate);\r\n    }\r\n\r\n    tabMap.set(\r\n      \"IDS_METHODVALIDITY\",\r\n      <MethodValidityTab\r\n        controlMap={this.props.controlMap}\r\n        userRoleControlRights={this.props.userRoleControlRights}\r\n        operation = {this.props.operation}\r\n        dataResult={process(\r\n          this.props.masterData[\"MethodValidity\"],\r\n          this.state.methodvalidityDataState )}\r\n        dataState={this.state.methodvalidityDataState }\r\n        dataStateChange={(event) =>\r\n          this.setState({ methodvalidityDataState: event.dataState })\r\n        }\r\n        selectedMethod={this.props.masterData.SelectedMethod}\r\n        fetchMethodValidityById={this.props.fetchMethodValidityById}\r\n        editParam={this.props.editParam}\r\n        userInfo={this.props.userInfo}\r\n        inputParam={this.props.inputParam}\r\n        selectedComponent={this.state.selectedComponent}\r\n        handleComponentRowClick={this.handleComponentRowClick}\r\n        formatMessage={this.props.intl.formatMessage}\r\n        deleteRecord={this.deleteRecord}\r\n        onApproveClick={this.onApproveClick}\r\n        openChildModal={this.openChildModal}\r\n        defaultRecord={this.defaultRecord}\r\n        selectedId={this.props.selectedId}\r\n        getAvailableValidityData={this.props.getAvailableValidityData}\r\n        MethodValidity={this.props.masterData.MethodValidity || []}\r\n        screenName=\"IDS_METHODVALIDITY\"\r\n        approveParam={this.props.approveParam}\r\n      />\r\n    );\r\n\r\n    return tabMap;\r\n  };\r\n  handleComponentRowClick = (event) => {\r\n    let selectedComponent = event.dataItem;\r\n    // let SelectedTest = this.props.Login.Test && this.props.Login.Test[selectedComponent.slno] ? this.props.Login.Test[selectedComponent.slno] : [];\r\n    const updateInfo = {\r\n        typeName: DEFAULT_RETURN,\r\n        data: {\r\n          operation:\"\"\r\n            // SelectedTest, selectedComponent,\r\n            // testDataState: {\r\n            //     skip: 0, take: this.props.Login.settings ?\r\n            //         parseInt(this.props.Login.settings[14]) : 5\r\n            // }\r\n        }\r\n    }\r\n    this.props.updateStore(updateInfo);\r\n    this.setState({selectedComponent});\r\n\r\n};\r\n  openChildModal = () => {\r\n    if(this.props.selectedMethod.nneedvalidity===transactionStatus.YES)\r\n    {\r\n    const addParam = {\r\n      screenName: \"IDS_METHOD\", operation: \"create\", primaryKeyName: \"nmethodvaliditycode\",\r\n      masterData: this.props.masterData, userInfo: this.props.userInfo\r\n     \r\n  }\r\n  this.props.getMethodValidityUTCDate(addParam);\r\n}\r\nelse\r\n{\r\n  toast.warn(this.props.intl.formatMessage({ id: \"IDS_ENABLEMETHODVALIDITY\" }));\r\n}\r\n    //let selectedRecord={};\r\n    // const updateInfo = {\r\n    //   typeName: DEFAULT_RETURN,\r\n    //   data: { openChildModal: true,operation:\"create\" },\r\n    // };//,selectedRecord\r\n    // this.props.updateStore(updateInfo);\r\n  };\r\n    onApproveClick = (selectedDataItem, operation, primaryKeyName) => {\r\n      if (selectedDataItem.dataItem.ntransactionstatus === transactionStatus.DRAFT) {\r\n   // if (this.state.selectedComponent.ntransactionstatus === transactionStatus.DRAFT) {\r\n        const approveId = this.props.controlMap.has(\"ApproveMethodValidity\") && this.props.controlMap.get(\"ApproveMethodValidity\").ncontrolcode\r\n        let inputData = [];\r\n        inputData[\"userinfo\"] = this.props.userInfo;\r\n        //add               \r\n        let postParam = undefined;\r\n        inputData[\"methodvalidity\"] =selectedDataItem.dataItem;\r\n        postParam = { inputListName: \"methodvalidity\", selectedObject: \"MethodValidity\", primaryKeyField: \"nmethodvaliditycode\",\r\n        primaryKeyValue: this.state.selectedRecord[\"nmethodvaliditycode\"],\r\n         fetchUrl: \"method/getActiveMethodValidityById\", fecthInputObject: { userinfo: this.props.userInfo },\r\n         masterData: this.props.masterData \r\n      }\r\n        const inputParam = {\r\n            classUrl: \"method\",\r\n            methodUrl: \"MethodValidity\",\r\n            inputData: inputData,\r\n            operation: \"approve\", postParam\r\n        }\r\n        let saveType;\r\n\r\n        const masterData = this.props.masterData;\r\n\r\n        const esignNeeded = showEsign(this.props.esignRights, this.props.userInfo.nformcode, approveId);\r\n        if (esignNeeded) {\r\n            const updateInfo = {\r\n                typeName: DEFAULT_RETURN,\r\n                data: {\r\n                    loadEsign: true, screenData: { inputParam, masterData }, screenName: \"IDS_METHOD\", openChildModal: true, operation: \"approve\",selectedRecord: {}\r\n                }\r\n            }\r\n            this.props.updateStore(updateInfo);\r\n            \r\n        }\r\n        else {\r\n            this.props.crudMaster(inputParam, masterData, \"openChildModal\",{});\r\n        }\r\n\r\n  //  }\r\n    // else {\r\n    //     toast.warn(this.props.intl.formatMessage({ id: \"IDS_SELECTDRAFTRECORDTOAPPROVE\" }));\r\n    // }\r\n      }\r\n      else {\r\n        toast.warn(this.props.intl.formatMessage({ id: \"IDS_NOTEDITDELETEMETHODVALIDITY\" }));\r\n    }\r\n\r\n}\r\n  deleteRecord = (deleteParam) => {\r\n    if (deleteParam.selectedRecord.ntransactionstatus === transactionStatus.DRAFT) {\r\n    const methodUrl = deleteParam.methodUrl;\r\n    const selected = deleteParam.selectedRecord;\r\n    let dataState = undefined;\r\n    if (this.props.screenName === \"IDS_SECTION\") {\r\n      dataState = this.state.methodValidityDataState;\r\n    }\r\n    const inputParam = {\r\n      inputData: {\r\n        [methodUrl.toLowerCase()]: selected,\r\n        userinfo: this.props.userInfo,\r\n      },\r\n      classUrl: \"method\",\r\n      operation: deleteParam.operation,\r\n      methodUrl: methodUrl,\r\n      screenName: \"IDS_METHOD\",\r\n      dataState,\r\n    };\r\n    const masterData = this.props.masterData;\r\n    if (\r\n      showEsign(\r\n        this.props.esignRights,\r\n        this.props.userInfo.nformcode,\r\n        deleteParam.ncontrolCode\r\n      )\r\n    ) {\r\n      const updateInfo = {\r\n        typeName: DEFAULT_RETURN,\r\n        data: {\r\n          loadEsign: true,\r\n          screenData: { inputParam, masterData },\r\n          openChildModal: true,\r\n          screenName: \"IDS_METHOD\",\r\n          operation: deleteParam.operation,\r\n          selectedRecord: {},\r\n        },\r\n      };\r\n      this.props.updateStore(updateInfo);\r\n    } else {\r\n      this.props.crudMaster(inputParam, masterData, \"openChildModal\", {});\r\n    }\r\n  }\r\n  else {\r\n    toast.warn(this.props.intl.formatMessage({ id: \"IDS_NOTEDITDELETEMETHODVALIDITY\" }));\r\n}\r\n  };\r\n\r\n  defaultRecord = (defaultParam, event) => {\r\n    const methodUrl = defaultParam.methodUrl;\r\n    let dataItem = defaultParam.selectedRecord;\r\n    // dataItem[\"ndefaultstatus\"] = transactionStatus.YES;\r\n    let dataState = undefined;\r\n    if (this.props.screenName === \"IDS_SECTION\") {\r\n      dataState = this.state.methodValidityDataState;\r\n    }\r\n    const inputParam = {\r\n      inputData: {\r\n        [methodUrl.toLowerCase()]: dataItem,\r\n        userinfo: this.props.userInfo,\r\n      },\r\n      classUrl: \"method\",\r\n      operation: \"setDefault\",\r\n      methodUrl: methodUrl,\r\n      dataState,\r\n    };\r\n    const masterData = this.props.masterData;\r\n    if (\r\n      showEsign(\r\n        this.props.esignRights,\r\n        this.props.userInfo.nformcode,\r\n        defaultParam.ncontrolCode\r\n      )\r\n    ) {\r\n      const updateInfo = {\r\n        typeName: DEFAULT_RETURN,\r\n        data: {\r\n          loadEsign: true,\r\n          screenData: { inputParam, masterData },\r\n          openChildModal: true,\r\n          screenName: \"Method\",\r\n          operation: defaultParam.operation,\r\n          selectedRecord: {},\r\n        },\r\n      };\r\n      this.props.updateStore(updateInfo);\r\n    } else {\r\n      this.props.crudMaster(inputParam, masterData, \"openChildModal\", {});\r\n    }\r\n  };\r\n  closeModal = () => {\r\n    let loadEsign = this.props.loadEsign;\r\n    let openChildModal = this.props.openChildModal;\r\n    let selectedRecord = this.props.selectedRecord;\r\n    let selectedId = this.props.selectedId;\r\n    if (this.props.loadEsign) {\r\n      if (\r\n        this.props.operation === \"delete\" ||\r\n        this.props.operation === \"approve\"  \r\n      ) {\r\n        loadEsign = false;\r\n        openChildModal = false;\r\n        selectedRecord = {};\r\n      } else {\r\n        loadEsign = false;\r\n        selectedRecord[\"agree\"] = 4;\r\n        selectedRecord[\"esignpassword\"] = \"\";\r\n        selectedRecord[\"esigncomments\"] = \"\";\r\n        selectedRecord['esignreason']=\"\"\r\n      }\r\n    } else {\r\n      openChildModal = false;\r\n      selectedRecord = {};\r\n      selectedId=null;\r\n    }\r\n    const updateInfo = {\r\n      typeName: DEFAULT_RETURN,\r\n      data: { openChildModal, loadEsign, selectedRecord,selectedId },\r\n    };\r\n    this.props.updateStore(updateInfo);\r\n  };\r\n\r\n  onComboChange = (comboData, fieldName, caseNo) => {\r\n    let selectedRecord = this.state.selectedRecord || {};\r\n    switch (caseNo) {\r\n      case 1:\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n        selectedRecord[fieldName] = comboData;;   \r\n     \r\n        this.setState({selectedRecord}); \r\n        // if (fieldName === \"sparametername\") {\r\n        //   selectedRecord[fieldName] = comboData;\r\n        //   selectedRecord[\"sparametersynonym\"] = comboData.value;\r\n        // } else {\r\n        //   selectedRecord[fieldName] = comboData;\r\n        // }\r\n        // this.setState({ selectedRecord });\r\n        break;\r\n\r\n      case 2:\r\n        const parameterData = this.props.parameterData;\r\n        let item = comboData[\"item\"];\r\n        let needUnit = true;\r\n        let needRoundingDigit = true;\r\n        let needCodedResult = true;\r\n        let needActualResult = true;\r\n        let npredefinedcode = 4;\r\n        if (item[\"nunitrequired\"] === 3) {\r\n          needUnit = false;\r\n          selectedRecord[\"nunitcode\"] = this.props.parameterData.defaultUnit;\r\n        } else {\r\n          selectedRecord[\"nunitcode\"] = \"\";\r\n        }\r\n        if (item[\"nroundingrequired\"] === 3) {\r\n          needRoundingDigit = false;\r\n        } else {\r\n          selectedRecord[\"nroundingdigits\"] = \"\";\r\n        }\r\n        if (item[\"npredefinedrequired\"] === 3) {\r\n          needCodedResult = false;\r\n          npredefinedcode = item[\"npredefinedrequired\"];\r\n        } else {\r\n          selectedRecord[\"spredefinedname\"] = \"\";\r\n        }\r\n        if (item[\"ngraderequired\"] === 3) {\r\n          needActualResult = false;\r\n          selectedRecord[\"ngradecode\"] = this.props.parameterData.defaultGrade;\r\n        } else {\r\n          selectedRecord[\"ngradecode\"] = \"\";\r\n        }\r\n        selectedRecord[fieldName] = comboData;\r\n        const parameterInfo = {\r\n          typeName: DEFAULT_RETURN,\r\n          data: {\r\n            selectedRecord,\r\n            parameterData: {\r\n              ...parameterData,\r\n              needUnit,\r\n              needRoundingDigit,\r\n              needCodedResult,\r\n              needActualResult,\r\n              npredefinedcode,\r\n            },\r\n          },\r\n        };\r\n        this.props.updateStore(parameterInfo);\r\n        break;\r\n\r\n      case 3:\r\n        selectedRecord[fieldName] = comboData;\r\n        this.props.formulaChangeFunction(\r\n          {\r\n            ntestcategorycode: comboData.value,\r\n            nFlag: 2,\r\n            userinfo: this.props.userInfo,\r\n          },\r\n          this.props.formulaData,\r\n          1,\r\n          selectedRecord,\r\n          \"/changeTestCatgoryInFormula\"\r\n        );\r\n        break;\r\n\r\n      case 4:\r\n        selectedRecord[fieldName] = comboData;\r\n        this.props.formulaChangeFunction(\r\n          {\r\n            ntestcode: comboData.value,\r\n            nFlag: 3,\r\n            userinfo: this.props.userInfo,\r\n          },\r\n          this.props.formulaData,\r\n          2,\r\n          selectedRecord,\r\n          \"/changeTestInFormula\"\r\n        );\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  onEsignInputOnChange = (event) => {\r\n    const selectedRecord = this.state.selectedRecord || {};\r\n    if (event.target.type === \"checkbox\") {\r\n      selectedRecord[event.target.name] = event.target.checked === true ? 3 : 4;\r\n    } else {\r\n      selectedRecord[event.target.name] = event.target.value;\r\n    }\r\n    this.setState({ selectedRecord });\r\n  };\r\n\r\n  onInputOnChange = (event, caseNo, optional) => {\r\n    const selectedRecord = this.state.selectedRecord || {};\r\n    switch (caseNo) {\r\n      case 1:\r\n        if (event.target.type === \"checkbox\") {\r\n          selectedRecord[event.target.name] =\r\n            event.target.checked === true\r\n              ? transactionStatus.YES\r\n              : transactionStatus.NO;\r\n        } else if (event.target.type === \"radio\") {\r\n          selectedRecord[event.target.name] = optional;\r\n          //  selectedRecord[\"sfilename\"]=\"\";\r\n        } else {\r\n          selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n        break;\r\n\r\n      case 4:\r\n        const inputValue = event.target.value;\r\n        if (/^-?\\d*?\\.?\\d*?$/.test(inputValue) || inputValue === \"\") {\r\n          selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n        break;\r\n\r\n      case 5:\r\n        if (\r\n          optional.ndynamicformulafieldcode === FORMULAFIELDTYPE.INTEGER &&\r\n          optional.sdescription.indexOf(\"P$\") === -1\r\n        ) {\r\n          const value = event.target.value.replace(/[^-^0-9]/g, \"\");\r\n          const dynamicField = this.state.dynamicField || [];\r\n          if (/^-?\\d*?$/.test(value)) {\r\n            if (!selectedRecord[\"formulainput\"]) {\r\n              selectedRecord[\"formulainput\"] = {};\r\n            }\r\n            selectedRecord[\"formulainput\"][event.target.name] = value;\r\n            dynamicField[event.target.name] = {\r\n              sparameter: optional.sdescription,\r\n              svalues: value,\r\n            };\r\n          } else if (value === \"\") {\r\n            if (!selectedRecord[\"formulainput\"]) {\r\n              selectedRecord[\"formulainput\"] = {};\r\n            }\r\n            selectedRecord[\"formulainput\"][event.target.name] = value;\r\n            dynamicField[event.target.name] = {\r\n              sparameter: optional.sdescription,\r\n              svalues: value,\r\n            };\r\n          }\r\n          this.setState({ dynamicField, selectedRecord });\r\n          break;\r\n        } else {\r\n          const value = event.target.value.replace(/[^-^0-9.]/g, \"\");\r\n          const dynamicField = this.state.dynamicField || [];\r\n          if (/^-?\\d*?\\.?\\d*?$/.test(value) || value !== \"\") {\r\n            if (!selectedRecord[\"formulainput\"]) {\r\n              selectedRecord[\"formulainput\"] = {};\r\n            }\r\n            selectedRecord[\"formulainput\"][event.target.name] = value;\r\n            dynamicField[event.target.name] = {\r\n              sparameter: optional.sdescription,\r\n              svalues: value,\r\n            };\r\n          }\r\n          this.setState({ dynamicField, selectedRecord });\r\n          break;\r\n        }\r\n\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n  onSaveClick = (saveType, formRef) => {\r\n    //add / edit\r\n    let inputData = [];\r\n    inputData[\"userinfo\"] = this.props.userInfo;\r\n    let postParam = undefined;\r\n    let editId = this.props.controlMap.has(\"AddMethodValidity\") && this.props.controlMap.get(\"AddMethodValidity\").ncontrolcode\r\n    // if (this.state.selectedRecord[\"ncommentsubtypecode\"].value === 3) {\r\n    //     if (this.state.selectedRecord[\"spredefinedname\"] === undefined || \r\n    //          this.state.selectedRecord[\"spredefinedname\"] === \"\") {\r\n    //         toast.info(\"Enter PreDefined Name\");\r\n    //         return;\r\n    //     }\r\n    // }\r\n  //   if (this.state.selectedRecord[\"dvalidityenddate\"] !== undefined && this.state.selectedRecord[\"dvaliditystartdate\"] !== undefined) {\r\n  //     if (this.state.selectedRecord[\"dvalidityenddate\"] < this.state.selectedRecord[\"dvaliditystartdate\"]) {\r\n  //         toast.info(this.props.intl.formatMessage({ id: \"IDS_ENDDATEGRATERTHANSTARTDATE\" }));\r\n  //         return;\r\n  //     }\r\n  // }\r\n  let obj= convertDateValuetoString(this.state.selectedRecord[\"dvaliditystartdate\"] ? this.state.selectedRecord[\"dvaliditystartdate\"]: new Date(),this.state.selectedRecord[\"dvalidityenddate\"]?this.state.selectedRecord[\"dvalidityenddate\"]:new Date(),this.props.userInfo);\r\n  this.state.selectedRecord[\"svaliditystartdate\"]=obj.fromDate;\r\n  this.state.selectedRecord[\"svalidityenddate\"]=obj.toDate;\r\n    if (this.props.operation === \"update\") {\r\n        // edit\r\n        postParam = { inputListName: \"methodvalidity\", selectedObject: \"MethodValidity\", primaryKeyField: \"nmethodvaliditycode\",\r\n        primaryKeyValue: this.state.selectedRecord[\"nmethodvaliditycode\"],\r\n         fetchUrl: \"method/getActiveMethodValidityById\", fecthInputObject: { userinfo: this.props.userInfo },\r\n         masterData: this.props.masterData \r\n      }\r\n        inputData[\"methodvalidity\"] = { \"nsitecode\": this.props.userInfo.nmastersitecode };\r\n        \r\n        inputData[\"methodvalidity\"][\"dvaliditystartdate\"] = this.state.selectedRecord[\"dvaliditystartdate\"] ? formatInputDate(this.state.selectedRecord[\"dvaliditystartdate\"]) : formatInputDate(new Date());\r\n        inputData[\"methodvalidity\"][\"dvalidityenddate\"] = this.state.selectedRecord[\"dvalidityenddate\"] ? this.state.selectedRecord[\"dvalidityenddate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"svaliditystartdate\"] = this.state.selectedRecord[\"svaliditystartdate\"] ? this.state.selectedRecord[\"svaliditystartdate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"svalidityenddate\"] = this.state.selectedRecord[\"svalidityenddate\"] ? this.state.selectedRecord[\"svalidityenddate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"nmethodcode\"] =this.props.selectedMethod.nmethodcode;\r\n        inputData[\"methodvalidity\"][\"nmethodvaliditycode\"] =this.state.selectedRecord[\"nmethodvaliditycode\"] ? this.state.selectedRecord[\"nmethodvaliditycode\"] : 0;\r\n        editId = this.props.controlMap.has(\"EditMethodValidity\") && this.props.controlMap.get(\"EditMethodValidity\").ncontrolcode\r\n    } else {\r\n        inputData[\"methodvalidity\"] = { \"nsitecode\": this.props.userInfo.nmastersitecode };\r\n        \r\n        inputData[\"methodvalidity\"][\"dvaliditystartdate\"] = this.state.selectedRecord[\"dvaliditystartdate\"] ? this.state.selectedRecord[\"dvaliditystartdate\"] :new Date();\r\n        inputData[\"methodvalidity\"][\"dvalidityenddate\"] = this.state.selectedRecord[\"dvalidityenddate\"] ? this.state.selectedRecord[\"dvalidityenddate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"svaliditystartdate\"] = this.state.selectedRecord[\"svaliditystartdate\"] ? this.state.selectedRecord[\"svaliditystartdate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"svalidityenddate\"] = this.state.selectedRecord[\"svalidityenddate\"] ? this.state.selectedRecord[\"svalidityenddate\"] : new Date();\r\n        inputData[\"methodvalidity\"][\"nmethodcode\"] =this.props.selectedMethod.nmethodcode;\r\n    }\r\n    inputData[\"methodvalidity\"][\"ntzvaliditystartdatetimezone\"] = this.state.selectedRecord[\r\n      \"ntzvaliditystartdatetimezone\"\r\n    ]\r\n      ? this.state.selectedRecord[\"ntzvaliditystartdatetimezone\"].value ||\r\n      this.props.userInfo.ntimezonecode\r\n      : this.props.userInfo.ntimezonecode;\r\n  inputData[\"methodvalidity\"][\"ntzvalidityenddatetimezone\"] = this.state.selectedRecord[\r\n          \"ntzvalidityenddatetimezone\"\r\n        ]\r\n          ? this.state.selectedRecord[\"ntzvalidityenddatetimezone\"].value ||\r\n          this.props.userInfo.ntimezonecode\r\n          : this.props.userInfo.ntimezonecode;\r\n        \r\n    const inputParam = {\r\n        classUrl: \"method\",\r\n        methodUrl: \"MethodValidity\",\r\n        displayName:\"IDS_METHOD\",\r\n        inputData: inputData,\r\n        operation: this.props.operation,\r\n        saveType, formRef, postParam, searchRef: this.searchRef\r\n    }\r\n    const masterData = this.props.masterData;\r\n    const esignNeeded  = showEsign(this.props.esignRights, this.props.userInfo.nformcode, editId)\r\n    if (esignNeeded) {\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: {\r\n                loadEsign: true, screenData: { inputParam, masterData }, saveType\r\n            }\r\n        }\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n    else {\r\n        \r\n        this.props.crudMaster(inputParam, masterData, \"openChildModal\");\r\n    }\r\n  };\r\n  validateEsign = () => {\r\n    const inputParam = {\r\n        inputData: {\r\n            \"userinfo\": {\r\n                ...this.props.userInfo,\r\n                sreason: this.state.selectedRecord[\"esigncomments\"],\r\n                nreasoncode:this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\r\n                spredefinedreason:this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label,\r\n           \r\n            },\r\n            password: this.state.selectedRecord[\"esignpassword\"]\r\n        },\r\n        screenData: this.props.screenData\r\n    }\r\n    this.props.validateEsignCredential(inputParam, \"openChildModal\");\r\n}\r\n  ConfirmDelete = (deleteParam, deleteID) => {\r\n    this.confirmMessage.confirm(\r\n      \"deleteMessage\",\r\n      this.props.intl.formatMessage({ id: \"IDS_DELETE\" }),\r\n      this.props.intl.formatMessage({ id: \"IDS_DEFAULTCONFIRMMSG\" }),\r\n      this.props.intl.formatMessage({ id: \"IDS_OK\" }),\r\n      this.props.intl.formatMessage({ id: \"IDS_CANCEL\" }),\r\n      () => this.deleteRecord(deleteParam)\r\n    );\r\n  };\r\n  componentDidUpdate(previousProps) {\r\n    if (this.props.selectedRecord !== previousProps.selectedRecord) {\r\n      this.setState({ selectedRecord: this.props.selectedRecord });\r\n    }\r\n\r\n    \r\n   \r\n    if (this.props.masterData !== previousProps.masterData) {\r\n      let { methodValidityDataState, selectedRecord } = this.state;\r\n      if (this.props.dataState === undefined) {\r\n        if (this.props.screenName === \"IDS_METHODVALIDITY\") {\r\n          methodValidityDataState = { skip: 0, take: 10 };\r\n        }\r\n      }\r\n      //this.props.masterData.MethodValidity\r\n      \r\n      this.setState({ methodValidityDataState, selectedRecord });\r\n    }\r\n    if (this.props.Login !== previousProps.Login) {\r\n      this.PrevoiusLoginData = previousProps;\r\n    }\r\n\r\n    // if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n    //     this.setState({ selectedRecord: this.props.Login.selectedRecord });\r\n    // }\r\n    // if (this.props.Login.userInfo.nformcode !== previousProps.Login.userInfo.nformcode) {\r\n    //     const userRoleControlRights = [];\r\n    //     if (this.props.Login.userRoleControlRights) {\r\n    //         this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode] && Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(item =>\r\n    //             userRoleControlRights.push(item.ncontrolcode))\r\n    //     }\r\n    //     const controlMap = getControlMap(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode)\r\n    //     this.setState({ userRoleControlRights, controlMap });\r\n    // }\r\n  }\r\n}\r\nexport default injectIntl(MethodValidityView);\r\n"]},"metadata":{},"sourceType":"module"}