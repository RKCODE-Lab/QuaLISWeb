{"ast":null,"code":"import _defineProperty from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\SOURCE-512\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import rsapi from\"../rsapi\";import{toast}from\"react-toastify\";import{DEFAULT_RETURN}from\"./LoginTypes\";import Axios from\"axios\";import{initRequest,updateStore}from\"./LoginAction\";import{transactionStatus}from\"../components/Enumeration\";import{constructOptionList,showEsign}from\"../components/CommonScript\";import{crudMaster}from'./ServiceAction';import{intl}from\"../components/App\";export function getCommentsCombo(inputParam){return function(dispatch){if(inputParam.masterList&&inputParam.masterList.length>0){dispatch(initRequest(true));var urlArray=[rsapi.post(\"/sampletestcomments/getSampleTestComments\",{userinfo:inputParam.userInfo})];urlArray.push(rsapi.post(\"/comments/getCommentSubType\",{userinfo:inputParam.userInfo,ncommentsubtypecode:inputParam.editRow&&inputParam.editRow.jsondata&&inputParam.editRow.jsondata.ncommentsubtypecode&&inputParam.editRow.jsondata.ncommentsubtypecode.value}));// if(inputParam.isSampleTestComment&&inputParam.isSampleTestComment===true) \n// {\n//  urlArray.push(\n//      rsapi.post(\"/comments/getSampleTestCommentsListById\", {\n//          ncommentsubtypecode:inputParam.ncommentsubtypecode,\n//          userinfo: inputParam.userInfo\n//      }))\n// }     \nif(inputParam.operation===\"update\"){urlArray.push(rsapi.post(\"/comments/getEdit\".concat(inputParam.methodUrl),{userinfo:inputParam.userInfo,selectedrecord:inputParam.editRow}));}Axios.all(urlArray).then(function(response){var _payload;var predefcomments;var sampleTestComments=response[0].data;var CommentSubType=response[1].data['CommentSubType'];var isAbbrevationneeded;var selectedId=null;var selectedRecord={};var defaultLink=sampleTestComments.filter(function(item){return item.ndefaultstatus===transactionStatus.YES;});var sampleTestCommentsMap=constructOptionList(sampleTestComments||[],\"nsampletestcommentcode\",\"ssampletestcommentname\",undefined,undefined,true);var CommentSubTypesMap=constructOptionList(CommentSubType||[],\"ncommentsubtypecode\",\"scommentsubtype\",undefined,undefined,false);sampleTestComments=sampleTestCommentsMap.get(\"OptionList\");CommentSubType=CommentSubTypesMap.get(\"OptionList\");// ALPD-4948 Commented because NA value for comment sub type and predefined comments not showing. Instead of showing '-' in jsondata\n// if(inputParam.isSampleTestComment&&inputParam.isSampleTestComment===true)\n// {\npredefcomments=response[1].data['SampleTestComments'];var predefcommentssMap=constructOptionList(predefcomments||[],\"nsampletestcommentscode\",\"spredefinedname\",undefined,undefined,false);predefcomments=predefcommentssMap.get(\"OptionList\");if(CommentSubType[0].value===3){isAbbrevationneeded=true;}selectedRecord=_objectSpread(_objectSpread({},inputParam.selectedRecord),{},{ncommentsubtypecode:CommentSubType[0],nsampletestcommentscode:predefcomments[0]&&predefcomments[0],spredefinedname:predefcomments[0]&&predefcomments[0].label,scomments:predefcomments[0]&&predefcomments[0].item.sdescription});// } \nvar editObject={};if(inputParam.operation===\"update\"){editObject=response[2].data;var nsamplecommentscode={};nsamplecommentscode={\"label\":editObject.ssampletestcommentname,\"value\":editObject.nsamplecommentscode};selectedRecord=_objectSpread(_objectSpread({},editObject),{},{nsamplecommentscode:nsamplecommentscode,scomments:editObject.jsondata.scomments,scommentsubtype:editObject.jsondata.scommentsubtype&&editObject.jsondata.scommentsubtype,spredefinedname:editObject.jsondata.spredefinedname&&editObject.jsondata.spredefinedname,// scomments: editObject.jsondata.sdescription&&editObject.jsondata.sdescription, \nncommentsubtypecode:editObject.jsondata.ncommentsubtypecode&&editObject.jsondata.ncommentsubtypecode,nsampletestcommentscode:editObject.jsondata.nsampletestcommentscode&&editObject.jsondata.nsampletestcommentscode});selectedId=inputParam.screenName===\"IDS_TESTCOMMENTS\"?inputParam.editRow.ntestcommentcode:inputParam.screenName===\"IDS_SUBSAMPLECOMMENTS\"?inputParam.editRow.nsamplecommentcode:inputParam.screenName===\"IDS_SAMPLECOMMENTS\"?inputParam.editRow.nregcommentcode:null;}else{selectedRecord=_objectSpread(_objectSpread({},selectedRecord),{},{nsamplecommentscode:defaultLink.length>0?{\"label\":defaultLink[0].ssampletestcommentname,\"value\":defaultLink[0].nsampletestcommentcode}:\"\"});}dispatch({type:DEFAULT_RETURN,payload:(_payload={},_defineProperty(_payload,inputParam.modalName,true),_defineProperty(_payload,\"operation\",inputParam.operation),_defineProperty(_payload,\"screenName\",inputParam.screenName),_defineProperty(_payload,\"ncontrolCode\",inputParam.ncontrolCode),_defineProperty(_payload,\"selectedRecord\",selectedRecord),_defineProperty(_payload,\"loading\",false),_defineProperty(_payload,\"sampleTestComments\",sampleTestComments),_defineProperty(_payload,\"predefcomments\",predefcomments),_defineProperty(_payload,\"CommentSubType\",CommentSubType),_defineProperty(_payload,\"isAbbrevationneeded\",isAbbrevationneeded),_defineProperty(_payload,\"modalType\",'comment'),_defineProperty(_payload,\"modalName\",[inputParam.modalName]),_defineProperty(_payload,\"editObject\",editObject),_defineProperty(_payload,\"selectedId\",selectedId),_payload)});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});}else{toast.warn(intl.formatMessage({id:inputParam.masterAlertStatus}));}};}export function deleteComment(deleteParam){return function(dispatch){var _inputData;var methodUrl=deleteParam.methodUrl;var selected=deleteParam.selectedRecord;var Map={};Map[\"sprimarykey\"]=deleteParam.screenName===\"IDS_SAMPLECOMMENTS\"?\"nregcommentcode\":deleteParam.screenName===\"IDS_SUBSAMPLECOMMENTS\"?\"nsamplecommentcode\":\"ntestcommentcode\";Map[\"nprimarykey\"]=deleteParam.screenName===\"IDS_SAMPLECOMMENTS\"?selected.nregcommentcode:deleteParam.screenName===\"IDS_SUBSAMPLECOMMENTS\"?selected.nsamplecommentcode:selected.ntestcommentcode;var inputParam={inputData:(_inputData={},_defineProperty(_inputData,methodUrl.toLowerCase(),_defineProperty({},Map.sprimarykey,Map.nprimarykey)),_defineProperty(_inputData,\"npreregno\",deleteParam.npreregno),_defineProperty(_inputData,\"ntransactiontestcode\",deleteParam.ntransactiontestcode),_defineProperty(_inputData,\"ntransactionsamplecode\",deleteParam.ntransactionsamplecode),_defineProperty(_inputData,\"userinfo\",deleteParam.userInfo),_inputData),classUrl:\"comments\",operation:'delete',methodUrl:methodUrl,screenName:deleteParam.screenName};var masterData=deleteParam.masterData;if(showEsign(deleteParam.esignRights,deleteParam.userInfo.nformcode,deleteParam.ncontrolCode)){// dispatch({\n//     type: DEFAULT_RETURN,\n//     payload: {\n//         loadEsign: true,\n//         screenData: { inputParam, masterData },\n//         openCommentModal: true,\n//         screenName: deleteParam.screenName,\n//         operation: 'delete',\n//         selectedRecord: {}\n//     }\n// });\nvar updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:masterData},openCommentModal:true,screenName:deleteParam.screenName,operation:'delete',selectedRecord:{},selectedId:null}};dispatch(updateStore(updateInfo));}else{dispatch(crudMaster(inputParam,masterData,\"openCommentModal\",{}));}};}export function getSampleTestComments(selectedRecord,userInfo){return function(dispatch){dispatch(initRequest(true));rsapi.post(\"/comments/getSampleTestCommentsListById\",{userinfo:userInfo,ncommentsubtypecode:selectedRecord['ncommentsubtypecode'].value}).then(function(response){var predefcomments;var isAbbrevationneeded;predefcomments=response.data['SampleTestComments'];var predefcommentssMap=constructOptionList(predefcomments||[],\"nsampletestcommentscode\",\"spredefinedname\",undefined,undefined,false);if(selectedRecord['ncommentsubtypecode'].value===3){// const predefcommentssMap  = constructOptionList(predefcomments || [], \"nsampletestcommentscode\",\"spredefinedname\" , undefined, undefined, false);\nisAbbrevationneeded=true;predefcomments=predefcommentssMap.get(\"OptionList\");selectedRecord=_objectSpread(_objectSpread({},selectedRecord),{},{nsampletestcommentscode:predefcomments[0]&&predefcomments[0],scomments:predefcomments[0]&&predefcomments[0].item&&predefcomments[0].item.sdescription});}else{// selectedRecord['nsampletestcommentscode']&&delete selectedRecord['nsampletestcommentscode']\n// ALPD-4948    Modified code by Vishakh for showing commentsubtype field as 'NA' instead of showing '-'\nvar SampleTestComments=predefcommentssMap.get(\"OptionList\");selectedRecord['nsampletestcommentscode']=SampleTestComments&&SampleTestComments.length&&SampleTestComments[0];selectedRecord=_objectSpread(_objectSpread({},selectedRecord),{},{scomments:predefcomments[0]&&predefcomments[0].sdescription});}dispatch({type:DEFAULT_RETURN,payload:{selectedRecord:selectedRecord,predefcomments:predefcomments,isAbbrevationneeded:isAbbrevationneeded,loading:false}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});};}export function getSampleTestCommentsDesc(selectedRecord,userInfo){return function(dispatch){dispatch(initRequest(true));rsapi.post(\"/comments/getSampleTestCommentsDescById\",{userinfo:userInfo,ncommentsubtypecode:selectedRecord['ncommentsubtypecode'].value,spredefinedname:selectedRecord['nsampletestcommentscode'].label}).then(function(response){var predefcomments;predefcomments=response.data['SampleTestComments'];selectedRecord=_objectSpread(_objectSpread({},selectedRecord),{},{scomments:predefcomments[0]&&predefcomments[0].sdescription});dispatch({type:DEFAULT_RETURN,payload:{selectedRecord:selectedRecord,loading:false}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});};}","map":{"version":3,"sources":["E:/WorkingFolder/React_Postgres/ALPD/branches/SOURCE-513-PROD/SOURCE-513-ALPD-5500/QuaLISWeb/src/actions/CommentsAction.js"],"names":["rsapi","toast","DEFAULT_RETURN","Axios","initRequest","updateStore","transactionStatus","constructOptionList","showEsign","crudMaster","intl","getCommentsCombo","inputParam","dispatch","masterList","length","urlArray","post","userinfo","userInfo","push","ncommentsubtypecode","editRow","jsondata","value","operation","concat","methodUrl","selectedrecord","all","then","response","predefcomments","sampleTestComments","data","CommentSubType","isAbbrevationneeded","selectedId","selectedRecord","defaultLink","filter","item","ndefaultstatus","YES","sampleTestCommentsMap","undefined","CommentSubTypesMap","get","predefcommentssMap","nsampletestcommentscode","spredefinedname","label","scomments","sdescription","editObject","nsamplecommentscode","ssampletestcommentname","scommentsubtype","screenName","ntestcommentcode","nsamplecommentcode","nregcommentcode","nsampletestcommentcode","type","payload","modalName","ncontrolCode","catch","error","loading","status","message","warn","formatMessage","id","masterAlertStatus","deleteComment","deleteParam","selected","Map","inputData","toLowerCase","sprimarykey","nprimarykey","npreregno","ntransactiontestcode","ntransactionsamplecode","classUrl","masterData","esignRights","nformcode","updateInfo","typeName","loadEsign","screenData","openCommentModal","getSampleTestComments","SampleTestComments","getSampleTestCommentsDesc"],"mappings":"qXAAA,MAAOA,CAAAA,KAAP,KAAkB,UAAlB,CACA,OAASC,KAAT,KAAsB,gBAAtB,CACA,OAASC,cAAT,KAA+B,cAA/B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,eAAzC,CACA,OAASC,iBAAT,KAAkC,2BAAlC,CACA,OAASC,mBAAT,CAA8BC,SAA9B,KAA+C,4BAA/C,CACA,OAASC,UAAT,KAA2B,iBAA3B,CACA,OAASC,IAAT,KAAqB,mBAArB,CAEA,MAAO,SAASC,CAAAA,gBAAT,CAA0BC,UAA1B,CAAsC,CACzC,MAAO,UAACC,QAAD,CAAc,CACjB,GAAID,UAAU,CAACE,UAAX,EAAyBF,UAAU,CAACE,UAAX,CAAsBC,MAAtB,CAA+B,CAA5D,CAA+D,CAC3DF,QAAQ,CAACT,WAAW,CAAC,IAAD,CAAZ,CAAR,CACA,GAAIY,CAAAA,QAAQ,CAAG,CAAChB,KAAK,CAACiB,IAAN,CAAW,2CAAX,CAAwD,CAAEC,QAAQ,CAAEN,UAAU,CAACO,QAAvB,CAAxD,CAAD,CAAf,CACAH,QAAQ,CAACI,IAAT,CACIpB,KAAK,CAACiB,IAAN,CAAW,6BAAX,CAA0C,CACtCC,QAAQ,CAAEN,UAAU,CAACO,QADiB,CACPE,mBAAmB,CAAET,UAAU,CAACU,OAAX,EAAsBV,UAAU,CAACU,OAAX,CAAmBC,QAAzC,EAAqDX,UAAU,CAACU,OAAX,CAAmBC,QAAnB,CAA4BF,mBAAjF,EAAwGT,UAAU,CAACU,OAAX,CAAmBC,QAAnB,CAA4BF,mBAA5B,CAAgDG,KADtK,CAA1C,CADJ,EAII;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACJ,GAAIZ,UAAU,CAACa,SAAX,GAAyB,QAA7B,CAAuC,CACnCT,QAAQ,CAACI,IAAT,CAAcpB,KAAK,CAACiB,IAAN,CAAW,oBAAoBS,MAApB,CAA2Bd,UAAU,CAACe,SAAtC,CAAX,CAA6D,CAAET,QAAQ,CAAEN,UAAU,CAACO,QAAvB,CAAiCS,cAAc,CAAEhB,UAAU,CAACU,OAA5D,CAA7D,CAAd,EACH,CACDnB,KAAK,CAAC0B,GAAN,CAAUb,QAAV,EACKc,IADL,CACU,SAAAC,QAAQ,CAAI,cACd,GAAIC,CAAAA,cAAJ,CACA,GAAIC,CAAAA,kBAAkB,CAAGF,QAAQ,CAAC,CAAD,CAAR,CAAYG,IAArC,CACA,GAAIC,CAAAA,cAAc,CAAGJ,QAAQ,CAAC,CAAD,CAAR,CAAYG,IAAZ,CAAiB,gBAAjB,CAArB,CACA,GAAIE,CAAAA,mBAAJ,CACA,GAAIC,CAAAA,UAAU,CAAG,IAAjB,CAEA,GAAIC,CAAAA,cAAc,CAAG,EAArB,CACA,GAAMC,CAAAA,WAAW,CAAGN,kBAAkB,CAACO,MAAnB,CAA0B,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAACC,cAAL,GAAwBpC,iBAAiB,CAACqC,GAA9C,EAA9B,CAApB,CACA,GAAMC,CAAAA,qBAAqB,CAAIrC,mBAAmB,CAAC0B,kBAAkB,EAAI,EAAvB,CAA2B,wBAA3B,CAAoD,wBAApD,CAA+EY,SAA/E,CAA0FA,SAA1F,CAAqG,IAArG,CAAlD,CACA,GAAMC,CAAAA,kBAAkB,CAAIvC,mBAAmB,CAAC4B,cAAc,EAAI,EAAnB,CAAuB,qBAAvB,CAA6C,iBAA7C,CAAiEU,SAAjE,CAA4EA,SAA5E,CAAuF,KAAvF,CAA/C,CACAZ,kBAAkB,CAAGW,qBAAqB,CAACG,GAAtB,CAA0B,YAA1B,CAArB,CACAZ,cAAc,CAAGW,kBAAkB,CAACC,GAAnB,CAAuB,YAAvB,CAAjB,CACA;AACA;AACA;AACKf,cAAc,CAAGD,QAAQ,CAAC,CAAD,CAAR,CAAYG,IAAZ,CAAiB,oBAAjB,CAAjB,CAED,GAAMc,CAAAA,kBAAkB,CAAIzC,mBAAmB,CAACyB,cAAc,EAAI,EAAnB,CAAuB,yBAAvB,CAAiD,iBAAjD,CAAqEa,SAArE,CAAgFA,SAAhF,CAA2F,KAA3F,CAA/C,CAEAb,cAAc,CAAGgB,kBAAkB,CAACD,GAAnB,CAAuB,YAAvB,CAAjB,CACA,GAAGZ,cAAc,CAAC,CAAD,CAAd,CAAkBX,KAAlB,GAA0B,CAA7B,CACA,CACIY,mBAAmB,CAAC,IAApB,CACH,CAEDE,cAAc,gCAAK1B,UAAU,CAAC0B,cAAhB,MAA+BjB,mBAAmB,CAACc,cAAc,CAAC,CAAD,CAAjE,CACVc,uBAAuB,CAACjB,cAAc,CAAC,CAAD,CAAd,EAAmBA,cAAc,CAAC,CAAD,CAD/C,CACmDkB,eAAe,CAAClB,cAAc,CAAC,CAAD,CAAd,EAAmBA,cAAc,CAAC,CAAD,CAAd,CAAkBmB,KADxG,CAETC,SAAS,CAACpB,cAAc,CAAC,CAAD,CAAd,EAAmBA,cAAc,CAAC,CAAD,CAAd,CAAkBS,IAAlB,CAAuBY,YAF3C,EAAd,CAGJ;AAGA,GAAIC,CAAAA,UAAU,CAAG,EAAjB,CACA,GAAI1C,UAAU,CAACa,SAAX,GAAyB,QAA7B,CAAuC,CACnC6B,UAAU,CAAIvB,QAAQ,CAAC,CAAD,CAAR,CAAYG,IAA1B,CACA,GAAIqB,CAAAA,mBAAmB,CAAG,EAA1B,CACAA,mBAAmB,CAAG,CAAE,QAASD,UAAU,CAACE,sBAAtB,CAA8C,QAASF,UAAU,CAACC,mBAAlE,CAAtB,CACAjB,cAAc,gCACPgB,UADO,MACKC,mBAAmB,CAAnBA,mBADL,CACyBH,SAAS,CAAEE,UAAU,CAAC/B,QAAX,CAAoB6B,SADxD,CAEVK,eAAe,CAACH,UAAU,CAAC/B,QAAX,CAAoBkC,eAApB,EAAqCH,UAAU,CAAC/B,QAAX,CAAoBkC,eAF/D,CAGVP,eAAe,CAACI,UAAU,CAAC/B,QAAX,CAAoB2B,eAApB,EAAqCI,UAAU,CAAC/B,QAAX,CAAoB2B,eAH/D,CAIX;AACE7B,mBAAmB,CAACiC,UAAU,CAAC/B,QAAX,CAAoBF,mBAApB,EAAyCiC,UAAU,CAAC/B,QAAX,CAAoBF,mBALxE,CAMT4B,uBAAuB,CAACK,UAAU,CAAC/B,QAAX,CAAoB0B,uBAApB,EAA6CK,UAAU,CAAC/B,QAAX,CAAoB0B,uBANhF,EAAd,CAQAZ,UAAU,CAAGzB,UAAU,CAAC8C,UAAX,GAA0B,kBAA1B,CAA+C9C,UAAU,CAACU,OAAX,CAAmBqC,gBAAlE,CAAqF/C,UAAU,CAAC8C,UAAX,GAA0B,uBAA1B,CAAoD9C,UAAU,CAACU,OAAX,CAAmBsC,kBAAvE,CAA4FhD,UAAU,CAAC8C,UAAX,GAA0B,oBAA1B,CAAiD9C,UAAU,CAACU,OAAX,CAAmBuC,eAApE,CAAsF,IAApR,CACH,CAbD,IAaO,CACHvB,cAAc,gCAAOA,cAAP,MACViB,mBAAmB,CAAEhB,WAAW,CAACxB,MAAZ,CAAqB,CAArB,CAAyB,CAAE,QAASwB,WAAW,CAAC,CAAD,CAAX,CAAeiB,sBAA1B,CAAkD,QAASjB,WAAW,CAAC,CAAD,CAAX,CAAeuB,sBAA1E,CAAzB,CAA8H,EADzI,EAAd,CAIH,CACDjD,QAAQ,CAAC,CACLkD,IAAI,CAAE7D,cADD,CAEL8D,OAAO,uCACFpD,UAAU,CAACqD,SADT,CACqB,IADrB,uCAEQrD,UAAU,CAACa,SAFnB,wCAGSb,UAAU,CAAC8C,UAHpB,0CAIW9C,UAAU,CAACsD,YAJtB,4CAKH5B,cALG,qCAKsB,KALtB,gDAMHL,kBANG,4CAOHD,cAPG,4CAQHG,cARG,iDASHC,mBATG,uCAUQ,SAVR,uCAWQ,CAACxB,UAAU,CAACqD,SAAZ,CAXR,wCAYHX,UAZG,wCAaHjB,UAbG,WAFF,CAAD,CAAR,CAmBH,CAxEL,EAyEK8B,KAzEL,CAyEW,SAAAC,KAAK,CAAI,CACZvD,QAAQ,CAAC,CAAEkD,IAAI,CAAE7D,cAAR,CAAwB8D,OAAO,CAAE,CAAEK,OAAO,CAAE,KAAX,CAAjC,CAAD,CAAR,CACA,GAAID,KAAK,CAACrC,QAAN,CAAeuC,MAAf,GAA0B,GAA9B,CAAmC,CAC/BrE,KAAK,CAACmE,KAAN,CAAYA,KAAK,CAACG,OAAlB,EACH,CAFD,IAEO,CACHtE,KAAK,CAACuE,IAAN,CAAWJ,KAAK,CAACrC,QAAN,CAAeG,IAA1B,EACH,CACJ,CAhFL,EAiFH,CAnGD,IAmGO,CACHjC,KAAK,CAACuE,IAAN,CAAW9D,IAAI,CAAC+D,aAAL,CAAmB,CAAEC,EAAE,CAAE9D,UAAU,CAAC+D,iBAAjB,CAAnB,CAAX,EACH,CAEJ,CAxGD,CAyGH,CAED,MAAO,SAASC,CAAAA,aAAT,CAAuBC,WAAvB,CAAoC,CACvC,MAAO,UAAChE,QAAD,CAAc,gBACjB,GAAMc,CAAAA,SAAS,CAAGkD,WAAW,CAAClD,SAA9B,CACA,GAAMmD,CAAAA,QAAQ,CAAGD,WAAW,CAACvC,cAA7B,CACR,GAAMyC,CAAAA,GAAG,CAAC,EAAV,CACAA,GAAG,CAAC,aAAD,CAAH,CAAmBF,WAAW,CAACnB,UAAZ,GAAyB,oBAAzB,CACnB,iBADmB,CACDmB,WAAW,CAACnB,UAAZ,GAAyB,uBAAzB,CAAiD,oBAAjD,CAAsE,kBADxF,CAEAqB,GAAG,CAAC,aAAD,CAAH,CAAmBF,WAAW,CAACnB,UAAZ,GAAyB,oBAAzB,CAA8CoB,QAAQ,CAACjB,eAAvD,CAAuEgB,WAAW,CAACnB,UAAZ,GAAyB,uBAAzB,CAC1FoB,QAAQ,CAAClB,kBADiF,CAC9DkB,QAAQ,CAACnB,gBADrC,CAIQ,GAAM/C,CAAAA,UAAU,CAAG,CACfoE,SAAS,2CACJrD,SAAS,CAACsD,WAAV,EADI,oBACwBF,GAAG,CAACG,WAD5B,CACyCH,GAAG,CAACI,WAD7C,0CAEMN,WAAW,CAACO,SAFlB,oDAGiBP,WAAW,CAACQ,oBAH7B,sDAImBR,WAAW,CAACS,sBAJ/B,wCAKKT,WAAW,CAAC1D,QALjB,aADM,CAQfoE,QAAQ,CAAE,UARK,CASf9D,SAAS,CAAE,QATI,CAUfE,SAAS,CAAEA,SAVI,CAWf+B,UAAU,CAAEmB,WAAW,CAACnB,UAXT,CAAnB,CAaA,GAAM8B,CAAAA,UAAU,CAAGX,WAAW,CAACW,UAA/B,CACA,GAAIhF,SAAS,CAACqE,WAAW,CAACY,WAAb,CAA0BZ,WAAW,CAAC1D,QAAZ,CAAqBuE,SAA/C,CAA0Db,WAAW,CAACX,YAAtE,CAAb,CAAkG,CAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAMyB,CAAAA,UAAU,CAAG,CACfC,QAAQ,CAAE1F,cADK,CAEfgC,IAAI,CAAE,CACF2D,SAAS,CAAE,IADT,CAEFC,UAAU,CAAE,CAAElF,UAAU,CAAVA,UAAF,CAAc4E,UAAU,CAAVA,UAAd,CAFV,CAGFO,gBAAgB,CAAE,IAHhB,CAIFrC,UAAU,CAAEmB,WAAW,CAACnB,UAJtB,CAKFjC,SAAS,CAAE,QALT,CAMFa,cAAc,CAAE,EANd,CAOFD,UAAU,CAAE,IAPV,CAFS,CAAnB,CAWAxB,QAAQ,CAACR,WAAW,CAACsF,UAAD,CAAZ,CAAR,CACH,CAxBD,IAwBO,CACH9E,QAAQ,CAACJ,UAAU,CAACG,UAAD,CAAa4E,UAAb,CAAyB,kBAAzB,CAA6C,EAA7C,CAAX,CAAR,CACH,CACJ,CAnDD,CAoDH,CACD,MAAO,SAASQ,CAAAA,qBAAT,CAA+B1D,cAA/B,CAA+CnB,QAA/C,CAAyD,CAC5D,MAAO,UAAUN,QAAV,CAAoB,CACvBA,QAAQ,CAACT,WAAW,CAAC,IAAD,CAAZ,CAAR,CACAJ,KAAK,CAACiB,IAAN,CAAW,yCAAX,CACI,CACIC,QAAQ,CAACC,QADb,CAEIE,mBAAmB,CAACiB,cAAc,CAAC,qBAAD,CAAd,CAAsCd,KAF9D,CADJ,EAKKM,IALL,CAKU,SAAAC,QAAQ,CAAI,CACd,GAAIC,CAAAA,cAAJ,CACA,GAAII,CAAAA,mBAAJ,CACAJ,cAAc,CAAGD,QAAQ,CAACG,IAAT,CAAc,oBAAd,CAAjB,CACA,GAAMc,CAAAA,kBAAkB,CAAIzC,mBAAmB,CAACyB,cAAc,EAAI,EAAnB,CAAuB,yBAAvB,CAAiD,iBAAjD,CAAqEa,SAArE,CAAgFA,SAAhF,CAA2F,KAA3F,CAA/C,CACA,GAAGP,cAAc,CAAC,qBAAD,CAAd,CAAsCd,KAAtC,GAA8C,CAAjD,CACA,CACI;AACAY,mBAAmB,CAAC,IAApB,CACAJ,cAAc,CAAGgB,kBAAkB,CAACD,GAAnB,CAAuB,YAAvB,CAAjB,CACAT,cAAc,gCAAMA,cAAN,MACVW,uBAAuB,CAACjB,cAAc,CAAC,CAAD,CAAd,EAAmBA,cAAc,CAAC,CAAD,CAD/C,CACmDoB,SAAS,CAACpB,cAAc,CAAC,CAAD,CAAd,EAAmBA,cAAc,CAAC,CAAD,CAAd,CAAkBS,IAArC,EAA6CT,cAAc,CAAC,CAAD,CAAd,CAAkBS,IAAlB,CAAuBY,YADjI,EAAd,CAEH,CAPD,IAOK,CACD;AACA;AACA,GAAM4C,CAAAA,kBAAkB,CAAGjD,kBAAkB,CAACD,GAAnB,CAAuB,YAAvB,CAA3B,CACAT,cAAc,CAAC,yBAAD,CAAd,CAA4C2D,kBAAkB,EAAIA,kBAAkB,CAAClF,MAAzC,EAAmDkF,kBAAkB,CAAC,CAAD,CAAjH,CACA3D,cAAc,gCAAMA,cAAN,MAAqBc,SAAS,CAACpB,cAAc,CAAC,CAAD,CAAd,EAAmBA,cAAc,CAAC,CAAD,CAAd,CAAkBqB,YAApE,EAAd,CACH,CAEDxC,QAAQ,CAAC,CACLkD,IAAI,CAAE7D,cADD,CAEL8D,OAAO,CAAE,CACL1B,cAAc,CAAdA,cADK,CAELN,cAAc,CAAdA,cAFK,CAGLI,mBAAmB,CAAnBA,mBAHK,CAILiC,OAAO,CAAE,KAJJ,CAFJ,CAAD,CAAR,CAUH,CAnCL,EAoCKF,KApCL,CAoCW,SAAAC,KAAK,CAAI,CACZvD,QAAQ,CAAC,CACLkD,IAAI,CAAE7D,cADD,CAEL8D,OAAO,CAAE,CACLK,OAAO,CAAE,KADJ,CAFJ,CAAD,CAAR,CAMA,GAAID,KAAK,CAACrC,QAAN,CAAeuC,MAAf,GAA0B,GAA9B,CAAmC,CAC/BrE,KAAK,CAACmE,KAAN,CAAYA,KAAK,CAACG,OAAlB,EACH,CAFD,IAEO,CACHtE,KAAK,CAACuE,IAAN,CAAWJ,KAAK,CAACrC,QAAN,CAAeG,IAA1B,EACH,CACJ,CAhDL,EAiDH,CAnDD,CAoDH,CAGD,MAAO,SAASgE,CAAAA,yBAAT,CAAmC5D,cAAnC,CAAmDnB,QAAnD,CAA6D,CAChE,MAAO,UAAUN,QAAV,CAAoB,CACvBA,QAAQ,CAACT,WAAW,CAAC,IAAD,CAAZ,CAAR,CACAJ,KAAK,CAACiB,IAAN,CAAW,yCAAX,CACI,CACIC,QAAQ,CAACC,QADb,CAEIE,mBAAmB,CAACiB,cAAc,CAAC,qBAAD,CAAd,CAAsCd,KAF9D,CAGI0B,eAAe,CAACZ,cAAc,CAAC,yBAAD,CAAd,CAA0Ca,KAH9D,CADJ,EAMKrB,IANL,CAMU,SAAAC,QAAQ,CAAI,CACd,GAAIC,CAAAA,cAAJ,CACAA,cAAc,CAAGD,QAAQ,CAACG,IAAT,CAAc,oBAAd,CAAjB,CACAI,cAAc,gCAAMA,cAAN,MAAqBc,SAAS,CAACpB,cAAc,CAAC,CAAD,CAAd,EAAmBA,cAAc,CAAC,CAAD,CAAd,CAAkBqB,YAApE,EAAd,CAEAxC,QAAQ,CAAC,CACLkD,IAAI,CAAE7D,cADD,CAEL8D,OAAO,CAAE,CACL1B,cAAc,CAAdA,cADK,CAEL+B,OAAO,CAAE,KAFJ,CAFJ,CAAD,CAAR,CAQH,CAnBL,EAoBKF,KApBL,CAoBW,SAAAC,KAAK,CAAI,CACZvD,QAAQ,CAAC,CACLkD,IAAI,CAAE7D,cADD,CAEL8D,OAAO,CAAE,CACLK,OAAO,CAAE,KADJ,CAFJ,CAAD,CAAR,CAMA,GAAID,KAAK,CAACrC,QAAN,CAAeuC,MAAf,GAA0B,GAA9B,CAAmC,CAC/BrE,KAAK,CAACmE,KAAN,CAAYA,KAAK,CAACG,OAAlB,EACH,CAFD,IAEO,CACHtE,KAAK,CAACuE,IAAN,CAAWJ,KAAK,CAACrC,QAAN,CAAeG,IAA1B,EACH,CACJ,CAhCL,EAiCH,CAnCD,CAoCH","sourcesContent":["import rsapi from \"../rsapi\";\r\nimport { toast } from \"react-toastify\";\r\nimport { DEFAULT_RETURN } from \"./LoginTypes\";\r\nimport Axios from \"axios\";\r\nimport { initRequest, updateStore } from \"./LoginAction\";\r\nimport { transactionStatus } from \"../components/Enumeration\";\r\nimport { constructOptionList, showEsign } from \"../components/CommonScript\";\r\nimport { crudMaster } from './ServiceAction'\r\nimport { intl } from \"../components/App\";\r\n\r\nexport function getCommentsCombo(inputParam) {\r\n    return (dispatch) => {\r\n        if (inputParam.masterList && inputParam.masterList.length > 0) {\r\n            dispatch(initRequest(true));\r\n            let urlArray = [rsapi.post(\"/sampletestcomments/getSampleTestComments\", { userinfo: inputParam.userInfo })];\r\n            urlArray.push(\r\n                rsapi.post(\"/comments/getCommentSubType\", {\r\n                    userinfo: inputParam.userInfo, ncommentsubtypecode: inputParam.editRow && inputParam.editRow.jsondata && inputParam.editRow.jsondata.ncommentsubtypecode && inputParam.editRow.jsondata.ncommentsubtypecode.value\r\n                })) \r\n                // if(inputParam.isSampleTestComment&&inputParam.isSampleTestComment===true) \r\n                // {\r\n                //  urlArray.push(\r\n                //      rsapi.post(\"/comments/getSampleTestCommentsListById\", {\r\n                //          ncommentsubtypecode:inputParam.ncommentsubtypecode,\r\n                //          userinfo: inputParam.userInfo\r\n                //      }))\r\n                // }     \r\n            if (inputParam.operation === \"update\") {\r\n                urlArray.push(rsapi.post(\"/comments/getEdit\".concat(inputParam.methodUrl), { userinfo: inputParam.userInfo, selectedrecord: inputParam.editRow }))\r\n            }\r\n            Axios.all(urlArray)\r\n                .then(response => {\r\n                    let predefcomments;\r\n                    let sampleTestComments = response[0].data;\r\n                    let CommentSubType = response[1].data['CommentSubType']; \r\n                    let isAbbrevationneeded;\r\n                    let selectedId = null;\r\n\r\n                    let selectedRecord = {};\r\n                    const defaultLink = sampleTestComments.filter(item => item.ndefaultstatus === transactionStatus.YES);\r\n                    const sampleTestCommentsMap  = constructOptionList(sampleTestComments || [], \"nsampletestcommentcode\",\"ssampletestcommentname\" , undefined, undefined, true);\r\n                    const CommentSubTypesMap  = constructOptionList(CommentSubType || [], \"ncommentsubtypecode\",\"scommentsubtype\" , undefined, undefined, false);\r\n                    sampleTestComments = sampleTestCommentsMap.get(\"OptionList\");\r\n                    CommentSubType = CommentSubTypesMap.get(\"OptionList\");\r\n                    // ALPD-4948 Commented because NA value for comment sub type and predefined comments not showing. Instead of showing '-' in jsondata\r\n                    // if(inputParam.isSampleTestComment&&inputParam.isSampleTestComment===true)\r\n                    // {\r\n                         predefcomments = response[1].data['SampleTestComments']; \r\n\r\n                        const predefcommentssMap  = constructOptionList(predefcomments || [], \"nsampletestcommentscode\",\"spredefinedname\" , undefined, undefined, false);\r\n                    \r\n                        predefcomments = predefcommentssMap.get(\"OptionList\"); \r\n                        if(CommentSubType[0].value===3)\r\n                        {\r\n                            isAbbrevationneeded=true\r\n                        }\r\n\r\n                        selectedRecord={...inputParam.selectedRecord,ncommentsubtypecode:CommentSubType[0],\r\n                            nsampletestcommentscode:predefcomments[0]&&predefcomments[0],spredefinedname:predefcomments[0]&&predefcomments[0].label\r\n                            ,scomments:predefcomments[0]&&predefcomments[0].item.sdescription} \r\n                    // } \r\n               \r\n\r\n                    let editObject = {};\r\n                    if (inputParam.operation === \"update\") {\r\n                        editObject =  response[2].data;\r\n                        let nsamplecommentscode = {};\r\n                        nsamplecommentscode = { \"label\": editObject.ssampletestcommentname, \"value\": editObject.nsamplecommentscode }\r\n                        selectedRecord = {\r\n                            ...editObject, nsamplecommentscode,scomments :editObject.jsondata.scomments,  \r\n                            scommentsubtype:editObject.jsondata.scommentsubtype&&editObject.jsondata.scommentsubtype ,\r\n                            spredefinedname:editObject.jsondata.spredefinedname&&editObject.jsondata.spredefinedname ,\r\n                           // scomments: editObject.jsondata.sdescription&&editObject.jsondata.sdescription, \r\n                             ncommentsubtypecode:editObject.jsondata.ncommentsubtypecode&&editObject.jsondata.ncommentsubtypecode,\r\n                             nsampletestcommentscode:editObject.jsondata.nsampletestcommentscode&&editObject.jsondata.nsampletestcommentscode\r\n                        };\r\n                        selectedId = inputParam.screenName === \"IDS_TESTCOMMENTS\" ? inputParam.editRow.ntestcommentcode : inputParam.screenName === \"IDS_SUBSAMPLECOMMENTS\" ? inputParam.editRow.nsamplecommentcode : inputParam.screenName === \"IDS_SAMPLECOMMENTS\" ? inputParam.editRow.nregcommentcode : null;\r\n                    } else {\r\n                        selectedRecord = {...selectedRecord,\r\n                            nsamplecommentscode: defaultLink.length > 0 ? { \"label\": defaultLink[0].ssampletestcommentname, \"value\": defaultLink[0].nsampletestcommentcode } : \"\",\r\n\r\n                        };\r\n                    }\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN,\r\n                        payload: {\r\n                            [inputParam.modalName]: true,\r\n                            operation: inputParam.operation,\r\n                            screenName: inputParam.screenName,\r\n                            ncontrolCode: inputParam.ncontrolCode,\r\n                            selectedRecord, loading: false,\r\n                            sampleTestComments,\r\n                            predefcomments,\r\n                            CommentSubType,\r\n                            isAbbrevationneeded,\r\n                            modalType: 'comment',\r\n                            modalName: [inputParam.modalName],\r\n                            editObject,\r\n                            selectedId\r\n                          //  isSampleTestComment:inputParam.isSampleTestComment\r\n                        }\r\n                    });\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } });\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    } else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                });\r\n        } else {\r\n            toast.warn(intl.formatMessage({ id: inputParam.masterAlertStatus }));\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport function deleteComment(deleteParam) {\r\n    return (dispatch) => {\r\n        const methodUrl = deleteParam.methodUrl;\r\n        const selected = deleteParam.selectedRecord;\r\nconst Map={}\r\nMap[\"sprimarykey\"]=deleteParam.screenName===\"IDS_SAMPLECOMMENTS\"?\r\n\"nregcommentcode\":deleteParam.screenName===\"IDS_SUBSAMPLECOMMENTS\"?\"nsamplecommentcode\":\"ntestcommentcode\";\r\nMap[\"nprimarykey\"]=deleteParam.screenName===\"IDS_SAMPLECOMMENTS\"?selected.nregcommentcode:deleteParam.screenName===\"IDS_SUBSAMPLECOMMENTS\"?\r\nselected.nsamplecommentcode:selected.ntestcommentcode;\r\n\r\n\r\n        const inputParam = {\r\n            inputData: {\r\n                [methodUrl.toLowerCase()]: {[Map.sprimarykey]:Map.nprimarykey},\r\n                npreregno: deleteParam.npreregno,\r\n                ntransactiontestcode: deleteParam.ntransactiontestcode,\r\n                ntransactionsamplecode: deleteParam.ntransactionsamplecode,\r\n                userinfo: deleteParam.userInfo\r\n            },\r\n            classUrl: \"comments\",\r\n            operation: 'delete',\r\n            methodUrl: methodUrl,\r\n            screenName: deleteParam.screenName\r\n        }\r\n        const masterData = deleteParam.masterData;\r\n        if (showEsign(deleteParam.esignRights, deleteParam.userInfo.nformcode, deleteParam.ncontrolCode)) {\r\n            // dispatch({\r\n            //     type: DEFAULT_RETURN,\r\n            //     payload: {\r\n            //         loadEsign: true,\r\n            //         screenData: { inputParam, masterData },\r\n            //         openCommentModal: true,\r\n            //         screenName: deleteParam.screenName,\r\n            //         operation: 'delete',\r\n            //         selectedRecord: {}\r\n            //     }\r\n            // });\r\n            const updateInfo = {\r\n                typeName: DEFAULT_RETURN,\r\n                data: {   \r\n                    loadEsign: true,\r\n                    screenData: { inputParam, masterData },\r\n                    openCommentModal: true,\r\n                    screenName: deleteParam.screenName,\r\n                    operation: 'delete',\r\n                    selectedRecord: {},\r\n                    selectedId: null}\r\n            }\r\n            dispatch(updateStore(updateInfo));\r\n        } else {\r\n            dispatch(crudMaster(inputParam, masterData, \"openCommentModal\", {}));\r\n        }\r\n    }\r\n}\r\nexport function getSampleTestComments(selectedRecord, userInfo) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"/comments/getSampleTestCommentsListById\",\r\n            {\r\n                userinfo:userInfo,\r\n                ncommentsubtypecode:selectedRecord['ncommentsubtypecode'].value\r\n            })\r\n            .then(response => { \r\n                let predefcomments;\r\n                let isAbbrevationneeded;\r\n                predefcomments = response.data['SampleTestComments']; \r\n                const predefcommentssMap  = constructOptionList(predefcomments || [], \"nsampletestcommentscode\",\"spredefinedname\" , undefined, undefined, false);\r\n                if(selectedRecord['ncommentsubtypecode'].value===3)\r\n                { \r\n                    // const predefcommentssMap  = constructOptionList(predefcomments || [], \"nsampletestcommentscode\",\"spredefinedname\" , undefined, undefined, false);\r\n                    isAbbrevationneeded=true\r\n                    predefcomments = predefcommentssMap.get(\"OptionList\"); \r\n                    selectedRecord={ ...selectedRecord,\r\n                        nsampletestcommentscode:predefcomments[0]&&predefcomments[0],scomments:predefcomments[0]&&predefcomments[0].item && predefcomments[0].item.sdescription}\r\n                }else{\r\n                    // selectedRecord['nsampletestcommentscode']&&delete selectedRecord['nsampletestcommentscode']\r\n                    // ALPD-4948    Modified code by Vishakh for showing commentsubtype field as 'NA' instead of showing '-'\r\n                    const SampleTestComments = predefcommentssMap.get(\"OptionList\"); \r\n                    selectedRecord['nsampletestcommentscode'] = SampleTestComments && SampleTestComments.length && SampleTestComments[0]\r\n                    selectedRecord={ ...selectedRecord,scomments:predefcomments[0]&&predefcomments[0].sdescription}\r\n                } \r\n              \r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: { \r\n                        selectedRecord,\r\n                        predefcomments,\r\n                        isAbbrevationneeded,\r\n                        loading: false\r\n\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        loading: false\r\n                    }\r\n                })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            });\r\n    }\r\n}\r\n\r\n\r\nexport function getSampleTestCommentsDesc(selectedRecord, userInfo) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"/comments/getSampleTestCommentsDescById\",\r\n            {\r\n                userinfo:userInfo,\r\n                ncommentsubtypecode:selectedRecord['ncommentsubtypecode'].value,\r\n                spredefinedname:selectedRecord['nsampletestcommentscode'].label\r\n            })\r\n            .then(response => { \r\n                let predefcomments;\r\n                predefcomments = response.data['SampleTestComments']; \r\n                selectedRecord={ ...selectedRecord,scomments:predefcomments[0]&&predefcomments[0].sdescription}\r\n              \r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: { \r\n                        selectedRecord,\r\n                        loading: false\r\n\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        loading: false\r\n                    }\r\n                })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            });\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}