{"ast":null,"code":"import Axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { intl } from '../components/App';\nimport { constructOptionList } from '../components/CommonScript';\nimport { attachmentType, transactionStatus } from '../components/Enumeration';\nimport rsapi from '../rsapi';\nimport { initRequest } from './LoginAction';\nimport { DEFAULT_RETURN } from './LoginTypes';\nexport function getSubContractorComboService(testdetail, userInfo) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    return rsapi.post(\"subcontracttestdetail/getSubcontractorBytest\", {\n      ntestcode: testdetail.ntestcode,\n      nsubcontractortestdetailcode: testdetail.nsubcontractortestdetailcode,\n      userinfo: userInfo\n    }).then(response => {\n      let selectedRecord = {};\n      selectedRecord[\"subcontractortestdetail\"] = testdetail;\n      const subContracorMap = constructOptionList(response.data['TestSubContract'] || [], \"nsuppliercode\", \"ssubcontractor\", undefined, undefined, true);\n      const subContracorMapList = subContracorMap.get(\"OptionList\"); //sortData(masterData);\n\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          selectedRecord,\n          subContracorMapList,\n          operation: \"sendsubcontractor\",\n          modalName: undefined,\n          openModal: true,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function updateSubContractSamplesdetails(inputData, masterData, modalName) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    return rsapi.post(\"subcontracttestdetail/updateSentSubContractTestdetails\", {\n      subcontractortestdetail: inputData.inputData['subcontractortestdetail'],\n      userinfo: inputData.inputData[\"userinfo\"]\n    }).then(response => {\n      masterData = { ...masterData,\n        ...response.data\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          operation: \"sendsubcontractor\",\n          openModal: false,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function updateReceiveSTTSubContractTest(inputData, userInfo, masterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    return rsapi.post(\"subcontracttestdetail/updateReceiveSTTSubContractTest\", {\n      subcontractortestdetail: inputData,\n      userinfo: userInfo\n    }).then(response => {\n      masterData = { ...masterData,\n        ...response.data\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          operation: \"ReceiveSTTSubContractor\",\n          openModal: false,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function updateReceiveResultSubContractTest(inputData, userInfo, masterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    return rsapi.post(\"subcontracttestdetail/updateReceiveResultSubContractTest\", {\n      subcontractortestdetail: inputData,\n      userinfo: userInfo\n    }).then(response => {\n      masterData = { ...masterData,\n        ...response.data\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          operation: \"ReceiveSTTSubContractor\",\n          openModal: false,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport const addFile = (inputParam, userInfo) => {\n  return dispatch => {\n    dispatch(initRequest(true));\n    let urlArray = [rsapi.post(\"/linkmaster/getLinkMaster\", {\n      userinfo: userInfo\n    })];\n\n    if (inputParam.operation === \"update\") {\n      urlArray.push(rsapi.post(\"/supplier/editSupplierFile\", {\n        userinfo: userInfo,\n        supplierfile: inputParam\n      }));\n    }\n\n    Axios.all(urlArray).then(response => {\n      const linkMap = constructOptionList(response[0].data.LinkMaster, \"nlinkcode\", \"slinkname\", false, false, true);\n      const linkmaster = linkMap.get(\"OptionList\");\n      let selectedRecord = {};\n      const defaultLink = linkmaster.filter(items => items.item.ndefaultlink === transactionStatus.YES);\n      let disabled = false;\n      let editObject = {};\n\n      if (inputParam.operation === \"update\") {\n        editObject = response[1].data;\n        let nlinkcode = {};\n        let link = {};\n\n        if (editObject.nattachmenttypecode === attachmentType.LINK) {\n          nlinkcode = {\n            \"label\": editObject.slinkname,\n            \"value\": editObject.nlinkcode\n          };\n          link = {\n            slinkfilename: editObject.sfilename,\n            slinkdescription: editObject.sdescription,\n            nlinkdefaultstatus: editObject.ndefaultstatus,\n            sfilesize: '',\n            nfilesize: 0,\n            ndefaultstatus: 4,\n            sfilename: ''\n          };\n        } else {\n          nlinkcode = defaultLink.length > 0 ? defaultLink[0] : \"\"; //{\"label\": defaultLink[0].slinkname, \"value\": defaultLink[0].nlinkcode}:\"\"\n\n          link = {\n            slinkfilename: '',\n            slinkdescription: '',\n            nlinkdefaultstatus: 4,\n            sfilesize: editObject.sfilesize,\n            nfilesize: editObject.nfilesize,\n            ndefaultstatus: editObject.ndefaultstatus,\n            sfilename: editObject.sfilename,\n            sdescription: editObject.sdescription,\n            //ALPD-855 Fix\n            ssystemfilename: editObject.ssystemfilename\n          };\n        }\n\n        selectedRecord = { ...link,\n          subcontractortestdetail: inputParam,\n          nattachmenttypecode: editObject.nattachmenttypecode,\n          // sdescription:editObject.sdescription,    //ALPD-855 Fix\n          nlinkcode // disabled: true\n\n        };\n      } else {\n        selectedRecord = {\n          nattachmenttypecode: response[0].data.AttachmentType.length > 0 ? response[0].data.AttachmentType[0].nattachmenttypecode : attachmentType.FTP,\n          nlinkcode: defaultLink.length > 0 ? defaultLink[0] : \"\",\n          disabled,\n          subcontractortestdetail: inputParam\n        };\n      }\n\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          openModal: true,\n          operation: \"fileattachment\",\n          screenName: inputParam.screenName,\n          ncontrolCode: inputParam.ncontrolCode,\n          selectedRecord,\n          loading: false,\n          linkMaster: linkmaster,\n          showSaveContinue: false,\n          editFiles: editObject.nattachmenttypecode === attachmentType.FTP ? editObject : {}\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n};\nexport function saveSubcontractorTestFile(inputParam, masterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    const formData = inputParam.formData;\n    return rsapi.post(inputParam.classUrl + \"/\" + inputParam.methodUrl, formData).then(response => {\n      let selectedRecord = {}; //selectedRecord[\"subcontractortestdetail\"] = testdetail;\n\n      masterData = { ...response.data\n      }; //sortData(masterData);\n\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          selectedRecord,\n          operation: \"fileattachment\",\n          modalName: undefined,\n          openModal: false,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}","map":{"version":3,"sources":["E:/WorkingFolder/React_Postgres/ALPD/branches/SOURCE-513-PROD/SOURCE-513-ALPD-5304/QuaLISWeb/src/actions/SubContractSamplesAction.js"],"names":["Axios","toast","intl","constructOptionList","attachmentType","transactionStatus","rsapi","initRequest","DEFAULT_RETURN","getSubContractorComboService","testdetail","userInfo","dispatch","post","ntestcode","nsubcontractortestdetailcode","userinfo","then","response","selectedRecord","subContracorMap","data","undefined","subContracorMapList","get","type","payload","operation","modalName","openModal","loading","catch","error","status","message","warn","updateSubContractSamplesdetails","inputData","masterData","subcontractortestdetail","updateReceiveSTTSubContractTest","updateReceiveResultSubContractTest","addFile","inputParam","urlArray","push","supplierfile","all","linkMap","LinkMaster","linkmaster","defaultLink","filter","items","item","ndefaultlink","YES","disabled","editObject","nlinkcode","link","nattachmenttypecode","LINK","slinkname","slinkfilename","sfilename","slinkdescription","sdescription","nlinkdefaultstatus","ndefaultstatus","sfilesize","nfilesize","length","ssystemfilename","AttachmentType","FTP","screenName","ncontrolCode","linkMaster","showSaveContinue","editFiles","saveSubcontractorTestFile","formData","classUrl","methodUrl"],"mappings":"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","sourcesContent":["import Axios from 'axios';\r\nimport {\r\n    toast\r\n} from 'react-toastify';\r\nimport { intl } from '../components/App';\r\nimport {\r\n    constructOptionList\r\n} from '../components/CommonScript';\r\nimport { attachmentType, transactionStatus } from '../components/Enumeration';\r\nimport rsapi from '../rsapi';\r\nimport { initRequest } from './LoginAction';\r\nimport {\r\n    DEFAULT_RETURN\r\n} from './LoginTypes';\r\n\r\nexport function getSubContractorComboService (testdetail, userInfo) {\r\n    return function (dispatch) {   \r\n    dispatch(initRequest(true));\r\n    return rsapi.post(\"subcontracttestdetail/getSubcontractorBytest\", {ntestcode:testdetail.ntestcode,\r\n        nsubcontractortestdetailcode:testdetail.nsubcontractortestdetailcode,userinfo:userInfo})\r\n   .then(response=>{  \r\n    let selectedRecord = {}   \r\n    selectedRecord[\"subcontractortestdetail\"] = testdetail;\r\n\r\n        const subContracorMap = constructOptionList(response.data['TestSubContract'] || [], \"nsuppliercode\",\r\n            \"ssubcontractor\", undefined, undefined, true);\r\n        const subContracorMapList = subContracorMap.get(\"OptionList\");\r\n\r\n        //sortData(masterData);\r\n        dispatch({type: DEFAULT_RETURN, payload:\r\n            {\r\n            selectedRecord,\r\n            subContracorMapList,\r\n            operation:\"sendsubcontractor\", \r\n            modalName:undefined,\r\n            openModal:true, \r\n            loading:false\r\n        }});   \r\n   })\r\n   .catch(error=>{\r\n        dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\r\n       if (error.response.status === 500){\r\n           toast.error(error.message);\r\n       } \r\n       else{               \r\n           toast.warn(error.response.data);\r\n       }  \r\n  \r\n   })\r\n}}\r\n\r\nexport function updateSubContractSamplesdetails (inputData, masterData,modalName) {\r\n\r\n    return function (dispatch) {   \r\n        dispatch(initRequest(true));\r\n        return rsapi.post(\"subcontracttestdetail/updateSentSubContractTestdetails\",\r\n             {subcontractortestdetail:inputData.inputData['subcontractortestdetail'],userinfo:inputData.inputData[\"userinfo\"]})\r\n       .then(response=>{     \r\n        masterData = {...masterData,...response.data}\r\n\r\n          \r\n            dispatch({type: DEFAULT_RETURN, payload:\r\n                {\r\n                masterData,\r\n                operation:\"sendsubcontractor\", \r\n                openModal:false, \r\n                loading:false\r\n            }});   \r\n       })\r\n       .catch(error=>{\r\n            dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\r\n           if (error.response.status === 500){\r\n               toast.error(error.message);\r\n           } \r\n           else{               \r\n               toast.warn(error.response.data);\r\n           }  \r\n      \r\n       })\r\n    }\r\n\r\n}\r\n\r\nexport function updateReceiveSTTSubContractTest (inputData,userInfo,masterData) {\r\n\r\n    return function (dispatch) {   \r\n        dispatch(initRequest(true));\r\n        return rsapi.post(\"subcontracttestdetail/updateReceiveSTTSubContractTest\",\r\n             {subcontractortestdetail:inputData,userinfo:userInfo,})\r\n       .then(response=>{ \r\n\r\n        masterData = {...masterData,...response.data}\r\n\r\n          \r\n            dispatch({type: DEFAULT_RETURN, payload:\r\n                {\r\n                masterData,\r\n                operation:\"ReceiveSTTSubContractor\", \r\n                openModal:false, \r\n                loading:false\r\n            }});   \r\n       })\r\n       .catch(error=>{\r\n            dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\r\n           if (error.response.status === 500){\r\n               toast.error(error.message);\r\n           } \r\n           else{               \r\n               toast.warn(error.response.data);\r\n           }  \r\n      \r\n       })\r\n    }\r\n}\r\n\r\nexport function updateReceiveResultSubContractTest(inputData,userInfo,masterData) {\r\n\r\n    return function (dispatch) {   \r\n        dispatch(initRequest(true));\r\n        return rsapi.post(\"subcontracttestdetail/updateReceiveResultSubContractTest\",\r\n             {subcontractortestdetail:inputData,userinfo:userInfo,})\r\n       .then(response=>{ \r\n\r\n        masterData = {...masterData,...response.data}\r\n\r\n          \r\n            dispatch({type: DEFAULT_RETURN, payload:\r\n                {\r\n                masterData,\r\n                operation:\"ReceiveSTTSubContractor\", \r\n                openModal:false, \r\n                loading:false\r\n            }});   \r\n       })\r\n       .catch(error=>{\r\n            dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\r\n           if (error.response.status === 500){\r\n               toast.error(error.message);\r\n           } \r\n           else{               \r\n               toast.warn(error.response.data);\r\n           }  \r\n      \r\n       })\r\n    }\r\n\r\n}\r\n\r\nexport const addFile = (inputParam,userInfo) => {\r\n    return (dispatch) => {\r\n        dispatch(initRequest(true));\r\n        let urlArray = [rsapi.post(\"/linkmaster/getLinkMaster\", {\r\n            userinfo: userInfo\r\n        })];\r\n        if (inputParam.operation === \"update\") {\r\n            urlArray.push(rsapi.post(\"/supplier/editSupplierFile\", {\r\n                userinfo: userInfo,\r\n                supplierfile: inputParam\r\n            }))\r\n        }\r\n        Axios.all(urlArray)\r\n            .then(response => {\r\n            \r\n                const linkMap = constructOptionList(response[0].data.LinkMaster, \"nlinkcode\", \"slinkname\", false, false, true);\r\n                const linkmaster = linkMap.get(\"OptionList\");\r\n                let selectedRecord = {};\r\n                \r\n                const defaultLink = linkmaster.filter(items => items.item.ndefaultlink === transactionStatus.YES);\r\n                let disabled = false;\r\n                let editObject = {};\r\n                if (inputParam.operation === \"update\") {            \r\n                    editObject = response[1].data;\r\n                    let nlinkcode = {};\r\n                    let link = {};\r\n                    if (editObject.nattachmenttypecode === attachmentType.LINK) {\r\n                        nlinkcode = {\r\n                            \"label\": editObject.slinkname,\r\n                            \"value\": editObject.nlinkcode\r\n                        }\r\n\r\n                        link = {\r\n                            slinkfilename: editObject.sfilename,\r\n                            slinkdescription: editObject.sdescription,\r\n                            nlinkdefaultstatus: editObject.ndefaultstatus,\r\n                            sfilesize: '',\r\n                            nfilesize: 0,\r\n                            ndefaultstatus: 4,\r\n                            sfilename: '',\r\n                        }\r\n\r\n                    } else {\r\n                        nlinkcode = defaultLink.length > 0 ? defaultLink[0] : \"\" //{\"label\": defaultLink[0].slinkname, \"value\": defaultLink[0].nlinkcode}:\"\"\r\n                        link = {\r\n                            slinkfilename: '',\r\n                            slinkdescription: '',\r\n                            nlinkdefaultstatus: 4,\r\n                            sfilesize: editObject.sfilesize,\r\n                            nfilesize: editObject.nfilesize,\r\n                            ndefaultstatus: editObject.ndefaultstatus,\r\n                            sfilename: editObject.sfilename,\r\n                            sdescription:editObject.sdescription,    //ALPD-855 Fix\r\n                            ssystemfilename: editObject.ssystemfilename\r\n                        }\r\n                    }\r\n                    selectedRecord = {\r\n                        ...link,\r\n                        subcontractortestdetail : inputParam,\r\n                        nattachmenttypecode: editObject.nattachmenttypecode,\r\n                        // sdescription:editObject.sdescription,    //ALPD-855 Fix\r\n                        nlinkcode,\r\n                        // disabled: true\r\n                    };\r\n                } else {\r\n                    selectedRecord = {\r\n                        nattachmenttypecode: response[0].data.AttachmentType.length > 0 ?\r\n                            response[0].data.AttachmentType[0].nattachmenttypecode : attachmentType.FTP,\r\n                        nlinkcode: defaultLink.length > 0 ? defaultLink[0] : \"\",\r\n                        disabled,\r\n                        subcontractortestdetail : inputParam\r\n                    };\r\n                }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        openModal: true,\r\n                        operation: \"fileattachment\",\r\n                        screenName: inputParam.screenName,\r\n                        ncontrolCode: inputParam.ncontrolCode,\r\n                        selectedRecord,\r\n                        loading: false,\r\n                        linkMaster: linkmaster,\r\n                        showSaveContinue: false,\r\n                        editFiles: editObject.nattachmenttypecode === attachmentType.FTP ? editObject : {}\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        loading: false\r\n                    }\r\n                });\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            });\r\n       \r\n    }\r\n\r\n}\r\n\r\nexport function saveSubcontractorTestFile (inputParam,masterData) {\r\n    return function (dispatch) {   \r\n    dispatch(initRequest(true));\r\n    const formData = inputParam.formData;\r\n    return rsapi.post(inputParam.classUrl+\"/\"+inputParam.methodUrl, formData)\r\n   .then(response=>{  \r\n    let selectedRecord = {}   \r\n    //selectedRecord[\"subcontractortestdetail\"] = testdetail;\r\n    masterData = {...response.data}\r\n\r\n        //sortData(masterData);\r\n        dispatch({type: DEFAULT_RETURN, payload:\r\n            {\r\n            masterData,\r\n            selectedRecord,\r\n            operation:\"fileattachment\", \r\n            modalName:undefined,\r\n            openModal:false, \r\n            loading:false\r\n        }});   \r\n   })\r\n   .catch(error=>{\r\n        dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\r\n       if (error.response.status === 500){\r\n           toast.error(error.message);\r\n       } \r\n       else{               \r\n           toast.warn(error.response.data);\r\n       }  \r\n  \r\n   })\r\n}}"]},"metadata":{},"sourceType":"module"}