{"ast":null,"code":"import _objectSpread from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _defineProperty from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\Postgres_workingFolder\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{connect}from'react-redux';import{injectIntl}from'react-intl';import{Row,Col}from'react-bootstrap';import{toast}from'react-toastify';import{process}from'@progress/kendo-data-query';import DataGrid from'../../../components/data-grid/data-grid.component';import AddTemplate from'./AddTemplate';import Esign from'../../audittrail/Esign';import SlideOutModal from'../../../components/slide-out-modal/SlideOutModal';import{ListWrapper}from'../../../components/client-group.styles';import{callService,crudMaster,fetchEmailTemplateById,validateEsignCredential,openEmailTemplateModal,updateStore,comboChangeEmailTag}from'../../../actions';import{transactionStatus}from'../../../components/Enumeration';import{constructOptionList,getControlMap,showEsign}from'../../../components/CommonScript';import{DEFAULT_RETURN}from'../../../actions/LoginTypes';// import './Drag.css';\nimport{EditorUtils,ProseMirror}from'@progress/kendo-react-editor';var mapStateToProps=function mapStateToProps(state){return{Login:state.Login};};var EmailTemplate=/*#__PURE__*/function(_React$Component){_inherits(EmailTemplate,_React$Component);var _super=_createSuper(EmailTemplate);function EmailTemplate(props){var _this;_classCallCheck(this,EmailTemplate);_this=_super.call(this,props);_this.dataStateChange=function(event){_this.setState({dataResult:process(_this.props.Login.masterData,event.dataState),dataState:event.dataState});};_this.closeModal=function(){var loadEsign=_this.props.Login.loadEsign;var openModal=_this.props.Login.openModal;var selectedRecord=_this.props.Login.selectedRecord;if(_this.props.Login.loadEsign){if(_this.props.Login.operation===\"delete\"){loadEsign=false;openModal=false;}else{loadEsign=false;}}else{openModal=false;selectedRecord={};}var updateInfo={typeName:DEFAULT_RETURN,data:{openModal:openModal,loadEsign:loadEsign,selectedRecord:selectedRecord,selectedId:null}};_this.props.updateStore(updateInfo);};_this.onkendoChange=function(event){_this.setState({value:event.html});};_this.onInputOnChange=function(event){var selectedRecord=_this.state.selectedRecord||{};if(event.target.type==='checkbox'){selectedRecord[event.target.name]=event.target.checked===true?transactionStatus.YES:transactionStatus.NO;}else{selectedRecord[event.target.name]=event.target.value;}_this.setState({selectedRecord:selectedRecord});};_this.onComboChange=function(comboData,fieldName){if(comboData!==null){var selectedRecord=_this.state.selectedRecord||{};selectedRecord[fieldName]=comboData;selectedRecord[\"stemplatebody\"]=\"\";var _Map={};_Map[\"userinfo\"]=_this.props.Login.userInfo;_Map[\"nemailtagcode\"]=comboData.value;// this.setState({ selectedRecord, value: \"\" });\n_this.props.comboChangeEmailTag(_Map,_this.props.Login.masterData,selectedRecord,_this.state.value);}};_this.deleteRecord=function(inputData){var _inputData;var inputParam={classUrl:_this.props.Login.inputParam.classUrl,methodUrl:_this.props.Login.inputParam.methodUrl,inputData:(_inputData={},_defineProperty(_inputData,_this.props.Login.inputParam.methodUrl.toLowerCase(),inputData.selectedRecord),_defineProperty(_inputData,\"userinfo\",_this.props.Login.userInfo),_inputData),operation:inputData.operation,displayName:_this.props.Login.inputParam.displayName,dataState:_this.state.dataState};var esignNeeded=showEsign(_this.props.Login.userRoleControlRights,_this.props.Login.userInfo.nformcode,inputData.ncontrolCode);if(esignNeeded){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:_this.props.Login.masterData},openModal:true,screenName:_this.props.intl.formatMessage({id:_this.props.Login.inputParam.displayName}),operation:_this.props.Login.operation}};_this.props.updateStore(updateInfo);}else{_this.props.crudMaster(inputParam,_this.props.Login.masterData,\"openModal\");}};_this.reloadData=function(){var inputParam={inputData:{\"userinfo\":_this.props.Login.userInfo},classUrl:_this.props.Login.inputParam.classUrl,methodUrl:_this.props.Login.inputParam.methodUrl,userInfo:_this.props.Login.userInfo,displayName:_this.props.Login.inputParam.displayName};_this.props.callService(inputParam);};_this.onSaveClick=function(saveType,formRef){var inputData=[];inputData[\"userinfo\"]=_this.props.Login.userInfo;var postParam=undefined;var selectedRecord=JSON.parse(JSON.stringify(_this.state.selectedRecord));if(_this.props.Login.operation===\"update\"){// edit\npostParam={inputListName:\"emailtemplate\",selectedObject:\"selectedEmailTemplate\",primaryKeyField:\"nemailtemplatecode\"};inputData[\"emailtemplate\"]=selectedRecord;_this.fieldList.map(function(item){return inputData[\"emailtemplate\"][item]=selectedRecord[item]?selectedRecord[item]:\"\";});}else{inputData[\"emailtemplate\"]={\"nsitecode\":_this.props.Login.userInfo.nmastersitecode};_this.fieldList.map(function(item){return inputData[\"emailtemplate\"][item]=selectedRecord[item]?selectedRecord[item]:\"\";});}inputData[\"emailtemplate\"][\"nemailtagcode\"]=selectedRecord[\"nemailtagcode\"]?selectedRecord[\"nemailtagcode\"].value:-1;//  inputData[\"emailtemplate\"][\"ninterfacetype\"] = this.state.selectedRecord[\"ninterfacetype\"] ? this.state.selectedRecord[\"ninterfacetype\"].value : -1;\ninputData[\"emailtemplate\"][\"nstatus\"]=selectedRecord[\"nstatus\"];inputData[\"emailtemplate\"][\"stemplatebody\"]=_this.state.value?_this.state.value:\"\";inputData[\"emailtemplate\"][\"nregtypecode\"]=selectedRecord[\"nregtypecode\"]?selectedRecord[\"nregtypecode\"]:-1;inputData[\"emailtemplate\"][\"nregsubtypecode\"]=selectedRecord[\"nregtypecode\"]?selectedRecord[\"nregtypecode\"]:-1;var inputParam={classUrl:_this.props.Login.inputParam.classUrl,methodUrl:_this.props.Login.inputParam.methodUrl,displayName:_this.props.Login.inputParam.displayName?_this.props.Login.inputParam.displayName:'',inputData:inputData,operation:_this.props.Login.operation,saveType:saveType,formRef:formRef,postParam:postParam,searchRef:_this.searchRef};var masterData=_this.props.Login.masterData;if(showEsign(_this.props.Login.userRoleControlRights,_this.props.Login.userInfo.nformcode,_this.props.Login.ncontrolcode)){var updateInfo={typeName:DEFAULT_RETURN,data:{loadEsign:true,screenData:{inputParam:inputParam,masterData:masterData},saveType:saveType}};_this.props.updateStore(updateInfo);}else{_this.props.crudMaster(inputParam,masterData,\"openModal\");}// this.props.crudMaster(inputParam, this.props.Login.masterData,\"openModal\");\n};_this.validateEsign=function(){var inputParam={inputData:{\"userinfo\":_objectSpread(_objectSpread({},_this.props.Login.userInfo),{},{sreason:_this.state.selectedRecord[\"esigncomments\"]}),password:_this.state.selectedRecord[\"esignpassword\"]},screenData:_this.props.Login.screenData};_this.props.validateEsignCredential(inputParam,\"openModal\");};_this.formRef=React.createRef();_this.closeModal=_this.closeModal.bind(_assertThisInitialized(_this));_this.extractedColumnList=[];_this.fieldList=[];var dataState={skip:0,take:_this.props.Login.settings?parseInt(_this.props.Login.settings[14]):5};_this.state={data:[],masterStatus:\"\",error:\"\",Tag:[],selectedRecord:{},dataResult:[],dataState:dataState,isOpen:false,userRoleControlRights:[],controlMap:new Map(),emailParam:[],content:{},value:EditorUtils.createDocument(new ProseMirror.Schema({nodes:EditorUtils.nodes,marks:EditorUtils.marks}))};return _this;}_createClass(EmailTemplate,[{key:\"render\",value:function render(){var _this2=this;var primaryKeyField=\"\";if(this.props.Login.inputParam!==undefined){this.extractedColumnList=[{\"controlType\":\"textbox\",\"idsName\":\"IDS_TEMPLATENAME\",\"dataField\":\"stemplatename\",\"width\":\"200px\"},{\"controlType\":\"textbox\",\"idsName\":\"IDS_SUBJECT\",\"dataField\":\"ssubject\",\"width\":\"200px\"},//{ \"controlType\": \"textarea\", \"idsName\": \"IDS_TEMPLATEBODY\", \"dataField\": \"stemplatebody\", \"width\": \"200px\" },\n{\"controlType\":\"selectbox\",\"idsName\":\"IDS_EMAILTAG\",\"dataField\":\"stagname\",\"width\":\"200px\"}];this.detailedFieldList=[{\"idsName\":\"IDS_TEMPLATEBODY\",\"dataField\":\"stemplatebody\",\"width\":\"300px\",\"isHTML\":true,\"columnSize\":\"12\"}];primaryKeyField=\"nemailtemplatecode\";this.fieldList=[\"stemplatename\",\"ssubject\",\"stemplatebody\"];}var mandatoryFields=[{\"mandatory\":true,\"idsName\":\"IDS_TEMPLATENAME\",\"dataField\":\"stemplatename\",\"mandatoryLabel\":\"IDS_ENTER\",\"controlType\":\"textbox\"},{\"mandatory\":true,\"idsName\":\"IDS_SUBJECT\",\"dataField\":\"ssubject\",\"mandatoryLabel\":\"IDS_ENTER\",\"controlType\":\"textbox\"},{\"mandatory\":true,\"idsName\":\"IDS_EMAILTAG\",\"dataField\":\"nemailtagcode\",\"mandatoryLabel\":\"IDS_SELECT\",\"controlType\":\"selectbox\"}];var addId=this.props.Login.inputParam&&this.state.controlMap.has(\"Add\".concat(this.props.Login.inputParam.methodUrl))&&this.state.controlMap.get(\"Add\".concat(this.props.Login.inputParam.methodUrl)).ncontrolcode;var editID=this.props.Login.inputParam&&this.state.controlMap.has(\"Edit\".concat(this.props.Login.inputParam.methodUrl))&&this.state.controlMap.get(\"Edit\".concat(this.props.Login.inputParam.methodUrl)).ncontrolcode;var editParam={screenName:this.props.Login.inputParam&&this.props.Login.inputParam.displayName&&this.props.intl.formatMessage({id:this.props.Login.inputParam.displayName}),primaryKeyField:\"nemailtemplatecode\",operation:\"update\",inputParam:this.props.Login.inputParam,userInfo:this.props.Login.userInfo,ncontrolCode:editID};var deleteParam={operation:\"delete\"};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(ListWrapper,{className:\"client-list-content\"},this.state.data?/*#__PURE__*/React.createElement(DataGrid,{primaryKeyField:primaryKeyField,data:this.state.data,dataResult:this.state.dataResult,dataState:this.state.dataState,dataStateChange:this.dataStateChange,extractedColumnList:this.extractedColumnList,detailedFieldList:this.detailedFieldList,expandField:\"expanded\",formatMessage:this.props.intl.formatMessage,controlMap:this.state.controlMap,userRoleControlRights:this.state.userRoleControlRights,inputParam:this.props.Login.inputParam,userInfo:this.props.Login.userInfo,fetchRecord:this.props.fetchEmailTemplateById,deleteRecord:this.deleteRecord,reloadData:this.reloadData,editParam:editParam,deleteParam:deleteParam,addRecord:function addRecord(){return _this2.props.openEmailTemplateModal(\"IDS_MAILTEMPLATE\",\"create\",\"nemailtemplatecode\",_this2.props.Login.masterData,_this2.props.Login.userInfo,addId);},isComponent:true,pageable:true,isActionRequired:true,isToolBarRequired:true,scrollable:\"scrollable\",hasDynamicColSize:true,selectedId:this.props.Login.selectedId}):\"\"))),this.props.Login.openModal&&/*#__PURE__*/React.createElement(SlideOutModal,{show:this.props.Login.openModal,closeModal:this.closeModal,operation:this.props.Login.operation,inputParam:this.props.Login.inputParam,screenName:this.props.Login.screenName,onSaveClick:this.onSaveClick,esign:this.props.Login.loadEsign,selectedRecord:this.state.selectedRecord||{},mandatoryFields:mandatoryFields,validateEsign:this.validateEsign,masterStatus:this.props.Login.masterStatus,updateStore:this.props.updateStore,addComponent:this.props.Login.loadEsign?/*#__PURE__*/React.createElement(Esign,{operation:this.props.Login.operation,formatMessage:this.props.intl.formatMessage,onInputOnChange:this.onInputOnChange,inputParam:this.props.Login.inputParam,selectedRecord:this.state.selectedRecord||{}}):/*#__PURE__*/React.createElement(AddTemplate,{selectedRecord:this.state.selectedRecord||{},onInputOnChange:this.onInputOnChange,onComboChange:this.onComboChange,Tag:this.state.Tag||[],EmailTagParameter:this.props.Login.EmailTagParameter||[],onkendoChange:this.onkendoChange,value:this.state.value})}));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(previousProps){if(this.props.Login.masterData!==previousProps.Login.masterData){if(this.props.Login.userInfo.nformcode!==previousProps.Login.userInfo.nformcode){var userRoleControlRights=[];if(this.props.Login.userRoleControlRights){this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]&&Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(function(item){return userRoleControlRights.push(item.ncontrolcode);});}var controlMap=getControlMap(this.props.Login.userRoleControlRights,this.props.Login.userInfo.nformcode);this.setState({userRoleControlRights:userRoleControlRights,controlMap:controlMap,data:this.props.Login.masterData,dataResult:process(this.props.Login.masterData,this.state.dataState)});}else{var dataState=this.state.dataState;if(this.props.Login.dataState===undefined){dataState={skip:0,take:this.props.Login.settings?parseInt(this.props.Login.settings[14]):5};}this.setState({data:this.props.Login.masterData,isOpen:false,dataState:dataState,dataResult:process(this.props.Login.masterData,dataState)});}}else if(this.props.Login.value!==previousProps.Login.value){this.setState({value:this.props.Login.selectedRecord[\"stemplatebody\"]?this.props.Login.selectedRecord[\"stemplatebody\"]:\"\",selectedRecord:this.props.Login.selectedRecord});}else if(this.props.Login.selectedRecord!==previousProps.Login.selectedRecord){this.setState({selectedRecord:this.props.Login.selectedRecord,value:this.props.Login.selectedRecord[\"stemplatebody\"]?this.props.Login.selectedRecord[\"stemplatebody\"]:\"\"});}if(this.props.Login.Tag!==previousProps.Login.Tag){var Tag=constructOptionList(this.props.Login.Tag||[],\"nemailtagcode\",\"stagname\",undefined,undefined,undefined);var TagList=Tag.get(\"OptionList\");this.setState({Tag:TagList});}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){var updateInfo={typeName:DEFAULT_RETURN,data:{masterData:[],inputParam:undefined,operation:null,modalName:undefined}};this.props.updateStore(updateInfo);}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){if(props.Login.masterStatus!==\"\"&&props.Login.masterStatus!==state.masterStatus){toast.warn(props.Login.masterStatus);props.Login.masterStatus=\"\";}if(props.Login.error!==state.error){toast.error(props.Login.error);props.Login.error=\"\";}return null;}}]);return EmailTemplate;}(React.Component);export default connect(mapStateToProps,{callService:callService,crudMaster:crudMaster,fetchEmailTemplateById:fetchEmailTemplateById,validateEsignCredential:validateEsignCredential,openEmailTemplateModal:openEmailTemplateModal,updateStore:updateStore,comboChangeEmailTag:comboChangeEmailTag})(injectIntl(EmailTemplate));","map":{"version":3,"sources":["D:/Postgres_workingFolder/QuaLISWeb/src/pages/mail/emailtemplate/EmailTemplate.jsx"],"names":["React","connect","injectIntl","Row","Col","toast","process","DataGrid","AddTemplate","Esign","SlideOutModal","ListWrapper","callService","crudMaster","fetchEmailTemplateById","validateEsignCredential","openEmailTemplateModal","updateStore","comboChangeEmailTag","transactionStatus","constructOptionList","getControlMap","showEsign","DEFAULT_RETURN","EditorUtils","ProseMirror","mapStateToProps","state","Login","EmailTemplate","props","dataStateChange","event","setState","dataResult","masterData","dataState","closeModal","loadEsign","openModal","selectedRecord","operation","updateInfo","typeName","data","selectedId","onkendoChange","value","html","onInputOnChange","target","type","name","checked","YES","NO","onComboChange","comboData","fieldName","Map","userInfo","deleteRecord","inputData","inputParam","classUrl","methodUrl","toLowerCase","displayName","esignNeeded","userRoleControlRights","nformcode","ncontrolCode","screenData","screenName","intl","formatMessage","id","reloadData","onSaveClick","saveType","formRef","postParam","undefined","JSON","parse","stringify","inputListName","selectedObject","primaryKeyField","fieldList","map","item","nmastersitecode","searchRef","ncontrolcode","validateEsign","sreason","password","createRef","bind","extractedColumnList","skip","take","settings","parseInt","masterStatus","error","Tag","isOpen","controlMap","emailParam","content","createDocument","Schema","nodes","marks","detailedFieldList","mandatoryFields","addId","has","concat","get","editID","editParam","deleteParam","EmailTagParameter","previousProps","Object","values","push","TagList","modalName","warn","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { injectIntl } from 'react-intl';\r\nimport { Row, Col } from 'react-bootstrap';\r\nimport { toast } from 'react-toastify';\r\nimport { process } from '@progress/kendo-data-query';\r\nimport DataGrid from '../../../components/data-grid/data-grid.component';\r\nimport AddTemplate from './AddTemplate';\r\nimport Esign from '../../audittrail/Esign';\r\nimport SlideOutModal from '../../../components/slide-out-modal/SlideOutModal';\r\nimport { ListWrapper } from '../../../components/client-group.styles';\r\nimport { callService, crudMaster, fetchEmailTemplateById, validateEsignCredential, openEmailTemplateModal, updateStore, comboChangeEmailTag } from '../../../actions';\r\nimport { transactionStatus } from '../../../components/Enumeration';\r\nimport { constructOptionList, getControlMap, showEsign } from '../../../components/CommonScript';\r\nimport { DEFAULT_RETURN } from '../../../actions/LoginTypes';\r\n// import './Drag.css';\r\n\r\nimport { EditorUtils, ProseMirror } from '@progress/kendo-react-editor';\r\n\r\n\r\nconst mapStateToProps = state => {\r\n    return ({ Login: state.Login })\r\n}\r\n\r\nclass EmailTemplate extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.formRef = React.createRef();\r\n        this.closeModal = this.closeModal.bind(this);\r\n        this.extractedColumnList = [];\r\n        this.fieldList = [];\r\n\r\n\r\n        const dataState = {\r\n            skip: 0,\r\n            take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5,\r\n        };\r\n        this.state = {\r\n            data: [], masterStatus: \"\", error: \"\", Tag: [], selectedRecord: {\r\n\r\n            },\r\n            dataResult: [],\r\n            dataState: dataState,\r\n            isOpen: false,\r\n            userRoleControlRights: [],\r\n            controlMap: new Map(),\r\n            emailParam: [],\r\n            content: {},\r\n            value: EditorUtils.createDocument(\r\n                new ProseMirror.Schema({ nodes: EditorUtils.nodes, marks: EditorUtils.marks })\r\n            )\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n\r\n        if (props.Login.masterStatus !== \"\" && props.Login.masterStatus !== state.masterStatus) {\r\n            toast.warn(props.Login.masterStatus);\r\n            props.Login.masterStatus = \"\";\r\n        }\r\n\r\n        if (props.Login.error !== state.error) {\r\n            toast.error(props.Login.error)\r\n            props.Login.error = \"\";\r\n        }\r\n        return null;\r\n    }\r\n\r\n    dataStateChange = (event) => {\r\n        this.setState({\r\n            dataResult: process(this.props.Login.masterData, event.dataState),\r\n            dataState: event.dataState\r\n        });\r\n    }\r\n\r\n\r\n    closeModal = () => {\r\n        let loadEsign = this.props.Login.loadEsign;\r\n        let openModal = this.props.Login.openModal;\r\n        let selectedRecord = this.props.Login.selectedRecord;\r\n        if (this.props.Login.loadEsign) {\r\n            if (this.props.Login.operation === \"delete\") {\r\n                loadEsign = false;\r\n                openModal = false;\r\n            } else {\r\n                loadEsign = false;\r\n            }\r\n        } else {\r\n            openModal = false;\r\n            selectedRecord = {};\r\n        }\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: { openModal, loadEsign, selectedRecord,selectedId:null }\r\n        }\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        let primaryKeyField = \"\";\r\n\r\n        if (this.props.Login.inputParam !== undefined) {\r\n\r\n            this.extractedColumnList = [\r\n                { \"controlType\": \"textbox\", \"idsName\": \"IDS_TEMPLATENAME\", \"dataField\": \"stemplatename\", \"width\": \"200px\" },\r\n                { \"controlType\": \"textbox\", \"idsName\": \"IDS_SUBJECT\", \"dataField\": \"ssubject\", \"width\": \"200px\" },\r\n                //{ \"controlType\": \"textarea\", \"idsName\": \"IDS_TEMPLATEBODY\", \"dataField\": \"stemplatebody\", \"width\": \"200px\" },\r\n                { \"controlType\": \"selectbox\", \"idsName\": \"IDS_EMAILTAG\", \"dataField\": \"stagname\", \"width\": \"200px\" }\r\n            ]\r\n            this.detailedFieldList = [\r\n                                        { \"idsName\": \"IDS_TEMPLATEBODY\", \"dataField\": \"stemplatebody\", \"width\": \"300px\", \"isHTML\": true,\"columnSize\":\"12\" }\r\n                                    ];\r\n            primaryKeyField = \"nemailtemplatecode\";\r\n            this.fieldList = [\"stemplatename\", \"ssubject\", \"stemplatebody\"];\r\n        }\r\n\r\n        const mandatoryFields = [{ \"mandatory\": true, \"idsName\": \"IDS_TEMPLATENAME\", \"dataField\": \"stemplatename\", \"mandatoryLabel\":\"IDS_ENTER\", \"controlType\": \"textbox\" },\r\n                                { \"mandatory\": true, \"idsName\": \"IDS_SUBJECT\", \"dataField\": \"ssubject\", \"mandatoryLabel\":\"IDS_ENTER\", \"controlType\": \"textbox\" },\r\n                                { \"mandatory\": true, \"idsName\": \"IDS_EMAILTAG\", \"dataField\": \"nemailtagcode\" , \"mandatoryLabel\":\"IDS_SELECT\", \"controlType\": \"selectbox\"}\r\n                            ];\r\n\r\n\r\n        const addId = this.props.Login.inputParam && this.state.controlMap.has(\"Add\".concat(this.props.Login.inputParam.methodUrl))\r\n            && this.state.controlMap.get(\"Add\".concat(this.props.Login.inputParam.methodUrl)).ncontrolcode;\r\n\r\n        const editID = this.props.Login.inputParam && this.state.controlMap.has(\"Edit\".concat(this.props.Login.inputParam.methodUrl))\r\n            && this.state.controlMap.get(\"Edit\".concat(this.props.Login.inputParam.methodUrl)).ncontrolcode;\r\n\r\n        const editParam = {\r\n            screenName: this.props.Login.inputParam && this.props.Login.inputParam.displayName && this.props.intl.formatMessage({ id: this.props.Login.inputParam.displayName }), primaryKeyField: \"nemailtemplatecode\", operation: \"update\",\r\n            inputParam: this.props.Login.inputParam, userInfo: this.props.Login.userInfo, ncontrolCode: editID\r\n        };\r\n        const deleteParam = { operation: \"delete\" };\r\n        return (\r\n            <>\r\n                <Row>\r\n                    <Col>\r\n                        <ListWrapper className=\"client-list-content\">\r\n\r\n                            {this.state.data ?\r\n                                <DataGrid\r\n                                    primaryKeyField={primaryKeyField}\r\n                                    data={this.state.data}\r\n                                    dataResult={this.state.dataResult}\r\n                                    dataState={this.state.dataState}\r\n                                    dataStateChange={this.dataStateChange}\r\n                                    extractedColumnList={this.extractedColumnList}\r\n                                    detailedFieldList={this.detailedFieldList}\r\n                                    expandField=\"expanded\"\r\n                                    formatMessage={this.props.intl.formatMessage}\r\n                                    controlMap={this.state.controlMap}\r\n                                    userRoleControlRights={this.state.userRoleControlRights}\r\n                                    inputParam={this.props.Login.inputParam}\r\n                                    userInfo={this.props.Login.userInfo}\r\n                                    fetchRecord={this.props.fetchEmailTemplateById}\r\n                                    deleteRecord={this.deleteRecord}\r\n                                    reloadData={this.reloadData}\r\n                                    editParam={editParam}\r\n                                    deleteParam={deleteParam}\r\n                                    addRecord={() => this.props.openEmailTemplateModal(\"IDS_MAILTEMPLATE\", \"create\", \"nemailtemplatecode\", this.props.Login.masterData, this.props.Login.userInfo, addId)}\r\n                                    isComponent={true}\r\n                                    pageable={true}\r\n                                    isActionRequired={true}\r\n                                    isToolBarRequired={true}\r\n                                    scrollable={\"scrollable\"}\r\n                                    hasDynamicColSize={true}\r\n                                    selectedId={this.props.Login.selectedId}\r\n\r\n                                />\r\n                                : \"\"}\r\n                        </ListWrapper>\r\n                    </Col>\r\n                </Row>\r\n                {this.props.Login.openModal &&\r\n                    <SlideOutModal\r\n                        show={this.props.Login.openModal}\r\n                        closeModal={this.closeModal}\r\n                        operation={this.props.Login.operation}\r\n                        inputParam={this.props.Login.inputParam}\r\n                        screenName={this.props.Login.screenName}\r\n                        onSaveClick={this.onSaveClick}\r\n                        esign={this.props.Login.loadEsign}\r\n                        selectedRecord={this.state.selectedRecord || {}}\r\n                        mandatoryFields={mandatoryFields}\r\n                        validateEsign={this.validateEsign}\r\n                        masterStatus={this.props.Login.masterStatus}\r\n                        updateStore={this.props.updateStore}\r\n                        addComponent={this.props.Login.loadEsign ?\r\n                            <Esign\r\n                                operation={this.props.Login.operation}\r\n                                formatMessage={this.props.intl.formatMessage}\r\n                                onInputOnChange={this.onInputOnChange}\r\n                                inputParam={this.props.Login.inputParam}\r\n                                selectedRecord={this.state.selectedRecord || {}}\r\n                            />\r\n                            : <AddTemplate\r\n                                selectedRecord={this.state.selectedRecord || {}}\r\n                                onInputOnChange={this.onInputOnChange}\r\n                                onComboChange={this.onComboChange}\r\n                                Tag={this.state.Tag || []}\r\n                                EmailTagParameter={this.props.Login.EmailTagParameter || []}\r\n                                onkendoChange={this.onkendoChange}\r\n                                value={this.state.value}\r\n\r\n                            />\r\n                        }\r\n                    />\r\n                }\r\n            </>\r\n        );\r\n    }\r\n\r\n    componentDidUpdate(previousProps) {\r\n        if (this.props.Login.masterData !== previousProps.Login.masterData) {\r\n            if (this.props.Login.userInfo.nformcode !== previousProps.Login.userInfo.nformcode) {\r\n                const userRoleControlRights = [];\r\n                if (this.props.Login.userRoleControlRights) {\r\n                    this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode] && Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(item =>\r\n                        userRoleControlRights.push(item.ncontrolcode))\r\n                }\r\n                const controlMap = getControlMap(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode)\r\n                this.setState({\r\n                    userRoleControlRights, controlMap, data: this.props.Login.masterData,\r\n                    dataResult: process(this.props.Login.masterData, this.state.dataState),\r\n                });\r\n            }\r\n            else {\r\n\r\n                let { dataState } = this.state;\r\n                if (this.props.Login.dataState === undefined) {\r\n                    dataState = { skip: 0, take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5 }\r\n                }\r\n\r\n                this.setState({\r\n                    data: this.props.Login.masterData,\r\n                    isOpen: false,  dataState,\r\n                    dataResult: process(this.props.Login.masterData, dataState)\r\n\r\n                });\r\n            }\r\n        } else if (this.props.Login.value !== previousProps.Login.value) {\r\n            this.setState({\r\n                value: this.props.Login.selectedRecord[\"stemplatebody\"] ? this.props.Login.selectedRecord[\"stemplatebody\"] : \"\",\r\n                selectedRecord: this.props.Login.selectedRecord\r\n            });\r\n        }\r\n\r\n\r\n        else if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n            this.setState({\r\n                selectedRecord: this.props.Login.selectedRecord, value:\r\n                    this.props.Login.selectedRecord[\"stemplatebody\"] ? this.props.Login.selectedRecord[\"stemplatebody\"] : \"\"\r\n            });\r\n        }\r\n\r\n        if (this.props.Login.Tag !== previousProps.Login.Tag) {\r\n\r\n            const Tag = constructOptionList(this.props.Login.Tag || [], \"nemailtagcode\",\r\n                \"stagname\", undefined, undefined, undefined);\r\n            const TagList = Tag.get(\"OptionList\");\r\n\r\n            this.setState({\r\n                Tag: TagList\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    onkendoChange = (event) => {\r\n        this.setState({ value: event.html });\r\n    }\r\n\r\n    onInputOnChange = (event) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n        if (event.target.type === 'checkbox') {\r\n            selectedRecord[event.target.name] = event.target.checked === true ? transactionStatus.YES : transactionStatus.NO;\r\n        }\r\n        else {\r\n            selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n    }\r\n\r\n    onComboChange = (comboData, fieldName) => {\r\n        if (comboData !== null) {\r\n            const selectedRecord = this.state.selectedRecord || {};\r\n            selectedRecord[fieldName] = comboData;\r\n            selectedRecord[\"stemplatebody\"] = \"\";\r\n            let Map = {};\r\n            Map[\"userinfo\"] = this.props.Login.userInfo;\r\n            Map[\"nemailtagcode\"] = comboData.value;\r\n            // this.setState({ selectedRecord, value: \"\" });\r\n            this.props.comboChangeEmailTag(Map, this.props.Login.masterData, selectedRecord, this.state.value);\r\n        }\r\n    }\r\n\r\n    deleteRecord = (inputData) => {\r\n        const inputParam = {\r\n            classUrl: this.props.Login.inputParam.classUrl,\r\n            methodUrl: this.props.Login.inputParam.methodUrl,\r\n\r\n            inputData: {\r\n                [this.props.Login.inputParam.methodUrl.toLowerCase()]: inputData.selectedRecord,\r\n                \"userinfo\": this.props.Login.userInfo\r\n            },\r\n            operation: inputData.operation,\r\n            displayName: this.props.Login.inputParam.displayName,\r\n            dataState: this.state.dataState\r\n        }\r\n        const esignNeeded = showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, inputData.ncontrolCode);\r\n        if (esignNeeded) {\r\n            const updateInfo = {\r\n                typeName: DEFAULT_RETURN,\r\n                data: {\r\n                    loadEsign: true, screenData: { inputParam, masterData: this.props.Login.masterData },\r\n                    openModal: true, screenName: this.props.intl.formatMessage({ id: this.props.Login.inputParam.displayName }),\r\n                    operation: this.props.Login.operation\r\n                }\r\n            }\r\n            this.props.updateStore(updateInfo);\r\n        }\r\n        else {\r\n            this.props.crudMaster(inputParam, this.props.Login.masterData, \"openModal\");\r\n        }\r\n    }\r\n\r\n    reloadData = () => {\r\n        const inputParam = {\r\n            inputData: { \"userinfo\": this.props.Login.userInfo },\r\n            classUrl: this.props.Login.inputParam.classUrl,\r\n            methodUrl: this.props.Login.inputParam.methodUrl,\r\n            userInfo: this.props.Login.userInfo,\r\n            displayName: this.props.Login.inputParam.displayName\r\n        };\r\n        this.props.callService(inputParam);\r\n    }\r\n\r\n    onSaveClick = (saveType, formRef) => {\r\n        let inputData = [];\r\n        inputData[\"userinfo\"] = this.props.Login.userInfo;\r\n        let postParam = undefined;\r\n        const selectedRecord = JSON.parse(JSON.stringify(this.state.selectedRecord));\r\n        if (this.props.Login.operation === \"update\") {\r\n            // edit\r\n            postParam = { inputListName: \"emailtemplate\", selectedObject: \"selectedEmailTemplate\", primaryKeyField: \"nemailtemplatecode\" }\r\n            inputData[\"emailtemplate\"] = selectedRecord;\r\n            this.fieldList.map(item => {\r\n                return inputData[\"emailtemplate\"][item] = selectedRecord[item] ? selectedRecord[item] : \"\";\r\n            })\r\n        } else {\r\n            inputData[\"emailtemplate\"] = { \"nsitecode\": this.props.Login.userInfo.nmastersitecode };\r\n            this.fieldList.map(item => {\r\n                return inputData[\"emailtemplate\"][item] = selectedRecord[item] ? selectedRecord[item] : \"\";\r\n            });\r\n        }\r\n        inputData[\"emailtemplate\"][\"nemailtagcode\"] = selectedRecord[\"nemailtagcode\"] ? selectedRecord[\"nemailtagcode\"].value : -1;\r\n        //  inputData[\"emailtemplate\"][\"ninterfacetype\"] = this.state.selectedRecord[\"ninterfacetype\"] ? this.state.selectedRecord[\"ninterfacetype\"].value : -1;\r\n        inputData[\"emailtemplate\"][\"nstatus\"] = selectedRecord[\"nstatus\"];\r\n        inputData[\"emailtemplate\"][\"stemplatebody\"] = this.state.value ? this.state.value : \"\";\r\n        inputData[\"emailtemplate\"][\"nregtypecode\"] = selectedRecord[\"nregtypecode\"] ? selectedRecord[\"nregtypecode\"] : -1;\r\n        inputData[\"emailtemplate\"][\"nregsubtypecode\"] = selectedRecord[\"nregtypecode\"] ? selectedRecord[\"nregtypecode\"] : -1;\r\n        \r\n        const inputParam = {\r\n            classUrl: this.props.Login.inputParam.classUrl,\r\n            methodUrl: this.props.Login.inputParam.methodUrl,\r\n   \r\n            displayName: this.props.Login.inputParam.displayName ? this.props.Login.inputParam.displayName : '',\r\n            inputData: inputData,\r\n            operation: this.props.Login.operation,\r\n            saveType, formRef, postParam, searchRef: this.searchRef\r\n        }\r\n        \r\n        const masterData = this.props.Login.masterData;\r\n        if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolcode)) {\r\n\r\n            const updateInfo = {\r\n                typeName: DEFAULT_RETURN,\r\n                data: {\r\n                    loadEsign: true, screenData: { inputParam, masterData }, saveType\r\n                }\r\n            }\r\n            this.props.updateStore(updateInfo);\r\n        }\r\n        else {\r\n\r\n            this.props.crudMaster(inputParam, masterData, \"openModal\");\r\n        }\r\n        // this.props.crudMaster(inputParam, this.props.Login.masterData,\"openModal\");\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: {\r\n                masterData: [], inputParam: undefined, operation: null, modalName: undefined\r\n            }\r\n        }\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n\r\n    validateEsign = () => {\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": {\r\n                    ...this.props.Login.userInfo,\r\n                    sreason: this.state.selectedRecord[\"esigncomments\"]\r\n                },\r\n                password: this.state.selectedRecord[\"esignpassword\"]\r\n            },\r\n            screenData: this.props.Login.screenData\r\n        }\r\n        this.props.validateEsignCredential(inputParam, \"openModal\");\r\n    }\r\n\r\n}\r\nexport default connect(mapStateToProps, { callService, crudMaster, fetchEmailTemplateById, validateEsignCredential, openEmailTemplateModal, updateStore, comboChangeEmailTag })(injectIntl(EmailTemplate));"]},"metadata":{},"sourceType":"module"}