{"ast":null,"code":"import rsapi from '../rsapi';\nimport { DEFAULT_RETURN } from './LoginTypes';\nimport { toast } from 'react-toastify';\nimport { initRequest } from './LoginAction';\nimport { sortData, constructjsonOptionList, constructOptionList, parentChildComboLoad } from '../components/CommonScript';\nimport { getValidComponent, replaceChildFromChildren } from '../components/droparea/helpers';\nimport { ReactComponents } from '../components/Enumeration';\nimport Axios from 'axios';\nimport { getTreeByProduct } from '.';\nexport function getReactInputFields(userinfo, operation, respObj) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    const listURL = [];\n    listURL[0] = rsapi.post(\"dynamicpreregdesign/getReactComponents\", {\n      userinfo\n    });\n    listURL[1] = rsapi.post(\"dynamicpreregdesign/getReactInputFields\", {\n      userinfo\n    });\n    Axios.all(listURL).then(response => {\n      respObj = respObj ? { ...respObj\n      } : {};\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          ReactInputFields: getJsonValue(response[1].data),\n          ReactComponents: getJsonValue(response[0].data.components),\n          ReactTables: constructOptionList(response[0].data.tables, 'stablename', 'displayname').get(\"OptionList\"),\n          selectedFieldRecord: {},\n          openModal: false,\n          loading: false,\n          openPortal: true,\n          operation,\n          ...respObj\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function selectRegistrationTemplate(template, masterData, userinfo) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"dynamicpreregdesign/getRegistrationTemplateById\", {\n      nreactregtemplatecode: template.nreactregtemplatecode,\n      userinfo\n    }).then(response => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData: { ...masterData,\n            selectedTemplate: response.data\n          },\n          loading: false\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getRegistrationTemplate(selectedSampleType, masterData, userinfo) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"dynamicpreregdesign/getDynamicPreRegDesign\", {\n      nsampletypecode: selectedSampleType.value,\n      userinfo\n    }).then(response => {\n      masterData = { ...masterData,\n        ...response.data\n      };\n      sortData(masterData);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          realSampleType: [{\n            \"label\": \"IDS_SAMPLETYPE\",\n            \"value\": selectedSampleType.label,\n            \"item\": selectedSampleType\n          }],\n          loading: false\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getEditRegTemplate(masterData, userinfo, editId) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"dynamicpreregdesign/getRegistrationTemplateById\", {\n      nreactregtemplatecode: masterData.selectedTemplate.nreactregtemplatecode,\n      userinfo\n    }).then(response => {\n      let jsonData = JSON.parse(response.data.jsondata.value);\n      sortData(masterData);\n      const respObj = {\n        masterData,\n        ncontrolcode: editId,\n        openPortal: true,\n        loading: false,\n        openModal: false,\n        design: jsonData,\n        selectedRecord: {\n          templateName: response.data.sregtemplatename\n        }\n      }; // dispatch({\n      //     type: DEFAULT_RETURN,\n      //     payload: {\n      //         masterData,\n      //         ncontrolcode: editId,\n      //         // openPortal: true,\n      //         // loading: false,\n      //         design: jsonData,\n      //         selectedRecord: { templateName: response.data.sregtemplatename }\n      //     }\n      // })\n\n      dispatch(getReactInputFields(userinfo, \"update\", respObj));\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getJsonValue(PGjsonData) {\n  if (Array.isArray(PGjsonData)) {\n    let JSONData = [];\n    PGjsonData.map(data => {\n      JSONData.push(JSON.parse(data.jsondata.value));\n    });\n    return JSONData;\n  } else {\n    return JSON.parse(PGjsonData.value);\n  }\n}\nexport function getTableColumns(design, selectedFieldRecord, stablename, userinfo, path, columnInfo, componentData, updateComponents) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"dynamicpreregdesign/getTableColumns\", {\n      stablename,\n      userinfo\n    }).then(response => {\n      columnInfo = columnInfo || {};\n      const staicColumns = response.data.jstaticcolumns ? getJsonValue(response.data.jstaticcolumns) : [];\n      const dynamicColumns = response.data.jdynamiccolumns ? getJsonValue(response.data.jdynamiccolumns) : [];\n      const multilingualColumns = response.data.jmultilingualcolumn ? getJsonValue(response.data.jmultilingualcolumn) : [];\n      const numericColumns = response.data.jnumericcolumns ? getJsonValue(response.data.jnumericcolumns) : [];\n      const primaryKeyName = response.data.sprimarykeyname;\n      columnInfo = { ...columnInfo,\n        [stablename]: {\n          staicColumns,\n          dynamicColumns,\n          multilingualColumns,\n          numericColumns,\n          primaryKeyName\n        }\n      };\n      let defaultColumn;\n      let comboData = [];\n      staicColumns.map(item => {\n        comboData.push({\n          label: item.displayname[userinfo.slanguagetypecode],\n          value: item.columnname,\n          item\n        });\n\n        if (item.default) {\n          defaultColumn = {\n            label: item.displayname[userinfo.slanguagetypecode],\n            value: item.columnname,\n            item\n          };\n        }\n      });\n      dynamicColumns.map(item => {\n        comboData.push({\n          label: item.displayname[userinfo.slanguagetypecode],\n          value: item.columnname,\n          item\n        });\n\n        if (item.default) {\n          defaultColumn = {\n            label: item.displayname[userinfo.slanguagetypecode],\n            value: item.columnname,\n            item\n          };\n        }\n      });\n      multilingualColumns.map(item => {\n        comboData.push({\n          label: item.displayname[userinfo.slanguagetypecode],\n          value: item.columnname,\n          item\n        });\n\n        if (item.default) {\n          defaultColumn = {\n            label: item.displayname[userinfo.slanguagetypecode],\n            value: item.columnname,\n            item\n          };\n        }\n      });\n\n      if (updateComponents) {\n        componentData = componentData || {};\n        selectedFieldRecord = { ...selectedFieldRecord,\n          column: defaultColumn,\n          displaymember: defaultColumn.value,\n          valuemember: primaryKeyName\n        };\n        design = replaceChildFromChildren(design, path, selectedFieldRecord);\n\n        if (selectedFieldRecord.componentcode !== ReactComponents.COMBO) {\n          let validComponents = getValidComponent(selectedFieldRecord, componentData.components, columnInfo);\n          componentData = { ...componentData,\n            validComponents\n          };\n        }\n      } else if (componentData === undefined) {\n        componentData = componentData || {};\n        selectedFieldRecord = { ...selectedFieldRecord,\n          column: defaultColumn,\n          displaymember: defaultColumn.value,\n          valuemember: primaryKeyName\n        };\n        design = replaceChildFromChildren(design, path, selectedFieldRecord);\n\n        if (selectedFieldRecord.componentcode !== ReactComponents.COMBO) {\n          let validComponents = getValidComponent(selectedFieldRecord, componentData.components, columnInfo);\n          componentData = { ...componentData,\n            validComponents\n          };\n        }\n      } else {\n        let validComponents = getValidComponent(selectedFieldRecord, componentData.components, columnInfo);\n        componentData = { ...componentData,\n          validComponents\n        };\n      }\n\n      columnInfo = { ...columnInfo,\n        [stablename]: { ...columnInfo[stablename],\n          tableColumn: comboData\n        }\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false,\n          design,\n          selectedFieldRecord,\n          tableColumn: comboData,\n          columnInfo,\n          primaryKeyName,\n          ...componentData\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getPreviewTemplate(masterData, userinfo, editId, columnList, selectedRecord, childColumnList, comboComponents, withoutCombocomponent, openPortal, openModal, mapOfFilterRegData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    const timeZoneService = rsapi.post(\"timezone/getTimeZone\");\n    const actualService = rsapi.post(\"dynamicpreregdesign/getComboValues\", {\n      parentcolumnlist: columnList,\n      childcolumnlist: childColumnList,\n      userinfo\n    });\n    Axios.all([timeZoneService, actualService]).then(response => {\n      const timeZoneMap = constructOptionList(response[0].data || [], \"ntimezonecode\", \"stimezoneid\", undefined, undefined, true);\n      const timeZoneList = timeZoneMap.get(\"OptionList\");\n      const defaultTimeZone = {\n        label: userinfo.stimezoneid,\n        value: userinfo.ntimezonecode\n      };\n      const newcomboData = parentChildComboLoad(columnList, response[1].data, selectedRecord, childColumnList, withoutCombocomponent);\n      sortData(masterData);\n      const ProductCategory = comboComponents.filter(x => x.name === 'Product Category');\n\n      if (ProductCategory.length > 0) {\n        const nproductcatcode = newcomboData.selectedRecord[ProductCategory[0].label] && newcomboData.selectedRecord[ProductCategory[0].label].value;\n        const ncategorybasedFlow = newcomboData.selectedRecord[ProductCategory[0].label] && newcomboData.selectedRecord[ProductCategory[0].label]['item']['ncategorybasedflow'];\n\n        if (ncategorybasedFlow !== undefined) {\n          if (ncategorybasedFlow === 3) {} else {\n            const Product = comboComponents.filter(x => x.name === 'Product');\n\n            if (Product.length > 0) {\n              const nproductcode = newcomboData.selectedRecord[Product[0].label] && newcomboData.selectedRecord[Product[0].label].value;\n              if (nproductcode !== undefined) mapOfFilterRegData['nproductcode'] = nproductcode;\n              mapOfFilterRegData['nproductcatcode'] = nproductcatcode;\n              const inputParam = {\n                timeZoneList,\n                defaultTimeZone,\n                masterData,\n                ncontrolcode: editId,\n                openModal,\n                comboComponents,\n                withoutCombocomponent,\n                openPortal\n              };\n              dispatch(getTreeByProduct(mapOfFilterRegData, newcomboData.selectedRecord, newcomboData.comboData, inputParam));\n            }\n          }\n        } else {\n          dispatch({\n            type: DEFAULT_RETURN,\n            payload: {\n              timeZoneList,\n              defaultTimeZone,\n              masterData,\n              ncontrolcode: editId,\n              openModal,\n              loading: false,\n              comboData: newcomboData.comboData,\n              selectedRecord: newcomboData.selectedRecord,\n              comboComponents,\n              withoutCombocomponent,\n              openPortal\n            }\n          });\n        }\n      } else {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            timeZoneList,\n            defaultTimeZone,\n            masterData,\n            ncontrolcode: editId,\n            openModal,\n            loading: false,\n            comboData: newcomboData.comboData,\n            selectedRecord: newcomboData.selectedRecord,\n            comboComponents,\n            withoutCombocomponent,\n            openPortal\n          }\n        });\n      }\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getChildValues(inputParem, userinfo, selectedRecord, comboData, parentcolumnlist, childcolumnlist, withoutCombocomponent, parentListWithReadonly, productCategory, product, mapOfRegFilterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post('dynamicpreregdesign/getChildValues', {\n      child: inputParem.child,\n      parentdata: inputParem.item,\n      parentsource: inputParem.source,\n      [inputParem.primarykeyField]: inputParem.value,\n      valuemember: inputParem.primarykeyField,\n      childcolumnlist,\n      userinfo,\n      parentcolumnlist\n    }).then(response => {\n      let returnObj = { ...comboData,\n        ...response.data\n      };\n      returnObj = parentChildComboLoad(parentListWithReadonly, returnObj, selectedRecord, childcolumnlist, withoutCombocomponent, inputParem.item);\n      selectedRecord = { ...selectedRecord,\n        ...returnObj.selectedRecord\n      };\n\n      if (productCategory) {\n        const nproductcatcode = selectedRecord['Product Category'] && selectedRecord['Product Category'].value;\n      } else if (product) {\n        dispatch(getTreeByProduct(mapOfRegFilterData, selectedRecord, { ...returnObj.comboData\n        }));\n      } else {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false,\n            comboData: { ...returnObj.comboData\n            },\n            selectedRecord\n          }\n        });\n      }\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}","map":{"version":3,"sources":["D:/Postgres_workingFolder/QuaLISWeb/src/actions/DynamicPreRegDesignAction.js"],"names":["rsapi","DEFAULT_RETURN","toast","initRequest","sortData","constructjsonOptionList","constructOptionList","parentChildComboLoad","getValidComponent","replaceChildFromChildren","ReactComponents","Axios","getTreeByProduct","getReactInputFields","userinfo","operation","respObj","dispatch","listURL","post","all","then","response","type","payload","ReactInputFields","getJsonValue","data","components","ReactTables","tables","get","selectedFieldRecord","openModal","loading","openPortal","catch","error","status","message","warn","selectRegistrationTemplate","template","masterData","nreactregtemplatecode","selectedTemplate","getRegistrationTemplate","selectedSampleType","nsampletypecode","value","realSampleType","label","getEditRegTemplate","editId","jsonData","JSON","parse","jsondata","ncontrolcode","design","selectedRecord","templateName","sregtemplatename","PGjsonData","Array","isArray","JSONData","map","push","getTableColumns","stablename","path","columnInfo","componentData","updateComponents","staicColumns","jstaticcolumns","dynamicColumns","jdynamiccolumns","multilingualColumns","jmultilingualcolumn","numericColumns","jnumericcolumns","primaryKeyName","sprimarykeyname","defaultColumn","comboData","item","displayname","slanguagetypecode","columnname","default","column","displaymember","valuemember","componentcode","COMBO","validComponents","undefined","tableColumn","getPreviewTemplate","columnList","childColumnList","comboComponents","withoutCombocomponent","mapOfFilterRegData","timeZoneService","actualService","parentcolumnlist","childcolumnlist","timeZoneMap","timeZoneList","defaultTimeZone","stimezoneid","ntimezonecode","newcomboData","ProductCategory","filter","x","name","length","nproductcatcode","ncategorybasedFlow","Product","nproductcode","inputParam","getChildValues","inputParem","parentListWithReadonly","productCategory","product","mapOfRegFilterData","child","parentdata","parentsource","source","primarykeyField","returnObj"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,UAAlB;AACA,SAASC,cAAT,QAA+B,cAA/B;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,WAAT,QAA4B,eAA5B;AACA,SAASC,QAAT,EAAmBC,uBAAnB,EAA4CC,mBAA5C,EAAiEC,oBAAjE,QAA6F,4BAA7F;AACA,SAASC,iBAAT,EAA4BC,wBAA5B,QAA4D,gCAA5D;AACA,SAASC,eAAT,QAAgC,2BAAhC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,gBAAT,QAAiC,GAAjC;AAEA,OAAO,SAASC,mBAAT,CAA6BC,QAA7B,EAAuCC,SAAvC,EAAkDC,OAAlD,EAA2D;AAE9D,SAAO,UAAUC,QAAV,EAAoB;AACvBA,IAAAA,QAAQ,CAACd,WAAW,CAAC,IAAD,CAAZ,CAAR;AACA,UAAMe,OAAO,GAAG,EAAhB;AACAA,IAAAA,OAAO,CAAC,CAAD,CAAP,GAAalB,KAAK,CAACmB,IAAN,CAAW,wCAAX,EAAqD;AAAEL,MAAAA;AAAF,KAArD,CAAb;AACAI,IAAAA,OAAO,CAAC,CAAD,CAAP,GAAalB,KAAK,CAACmB,IAAN,CAAW,yCAAX,EAAsD;AAAEL,MAAAA;AAAF,KAAtD,CAAb;AACAH,IAAAA,KAAK,CAACS,GAAN,CAAUF,OAAV,EACKG,IADL,CACUC,QAAQ,IAAI;AACdN,MAAAA,OAAO,GAAGA,OAAO,GAAG,EAAE,GAAGA;AAAL,OAAH,GAAoB,EAArC;AACAC,MAAAA,QAAQ,CAAC;AACLM,QAAAA,IAAI,EAAEtB,cADD;AAELuB,QAAAA,OAAO,EAAE;AACLC,UAAAA,gBAAgB,EAAEC,YAAY,CAACJ,QAAQ,CAAC,CAAD,CAAR,CAAYK,IAAb,CADzB;AAELjB,UAAAA,eAAe,EAAEgB,YAAY,CAACJ,QAAQ,CAAC,CAAD,CAAR,CAAYK,IAAZ,CAAiBC,UAAlB,CAFxB;AAGLC,UAAAA,WAAW,EAAEvB,mBAAmB,CAACgB,QAAQ,CAAC,CAAD,CAAR,CAAYK,IAAZ,CAAiBG,MAAlB,EAA0B,YAA1B,EAAwC,aAAxC,CAAnB,CAA0EC,GAA1E,CAA8E,YAA9E,CAHR;AAILC,UAAAA,mBAAmB,EAAE,EAJhB;AAKLC,UAAAA,SAAS,EAAE,KALN;AAMLC,UAAAA,OAAO,EAAE,KANJ;AAOLC,UAAAA,UAAU,EAAE,IAPP;AAQLpB,UAAAA,SARK;AASL,aAAGC;AATE;AAFJ,OAAD,CAAR;AAcH,KAjBL,EAkBKoB,KAlBL,CAkBWC,KAAK,IAAI;AACZpB,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEtB,cAAR;AAAwBuB,QAAAA,OAAO,EAAE;AAAEU,UAAAA,OAAO,EAAE;AAAX;AAAjC,OAAD,CAAR;;AACA,UAAIG,KAAK,CAACf,QAAN,CAAegB,MAAf,KAA0B,GAA9B,EAAmC;AAC/BpC,QAAAA,KAAK,CAACmC,KAAN,CAAYA,KAAK,CAACE,OAAlB;AACH,OAFD,MAEO;AACHrC,QAAAA,KAAK,CAACsC,IAAN,CAAWH,KAAK,CAACf,QAAN,CAAeK,IAA1B;AACH;AACJ,KAzBL;AA0BH,GA/BD;AAgCH;AACD,OAAO,SAASc,0BAAT,CAAoCC,QAApC,EAA8CC,UAA9C,EAA0D7B,QAA1D,EAAoE;AACvE,SAAO,UAAUG,QAAV,EAAoB;AACvBA,IAAAA,QAAQ,CAACd,WAAW,CAAC,IAAD,CAAZ,CAAR;AACAH,IAAAA,KAAK,CAACmB,IAAN,CAAW,iDAAX,EAA8D;AAC1DyB,MAAAA,qBAAqB,EAAEF,QAAQ,CAACE,qBAD0B;AAE1D9B,MAAAA;AAF0D,KAA9D,EAIKO,IAJL,CAIUC,QAAQ,IAAI;AAEdL,MAAAA,QAAQ,CAAC;AACLM,QAAAA,IAAI,EAAEtB,cADD;AAELuB,QAAAA,OAAO,EAAE;AAAEmB,UAAAA,UAAU,EAAE,EAAE,GAAGA,UAAL;AAAiBE,YAAAA,gBAAgB,EAAEvB,QAAQ,CAACK;AAA5C,WAAd;AAAkEO,UAAAA,OAAO,EAAE;AAA3E;AAFJ,OAAD,CAAR;AAIH,KAVL,EAWKE,KAXL,CAWWC,KAAK,IAAI;AACZpB,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEtB,cAAR;AAAwBuB,QAAAA,OAAO,EAAE;AAAEU,UAAAA,OAAO,EAAE;AAAX;AAAjC,OAAD,CAAR;;AACA,UAAIG,KAAK,CAACf,QAAN,CAAegB,MAAf,KAA0B,GAA9B,EAAmC;AAC/BpC,QAAAA,KAAK,CAACmC,KAAN,CAAYA,KAAK,CAACE,OAAlB;AACH,OAFD,MAEO;AACHrC,QAAAA,KAAK,CAACsC,IAAN,CAAWH,KAAK,CAACf,QAAN,CAAeK,IAA1B;AACH;AACJ,KAlBL;AAmBH,GArBD;AAsBH;AACD,OAAO,SAASmB,uBAAT,CAAiCC,kBAAjC,EAAqDJ,UAArD,EAAiE7B,QAAjE,EAA2E;AAC9E,SAAO,UAAUG,QAAV,EAAoB;AACvBA,IAAAA,QAAQ,CAACd,WAAW,CAAC,IAAD,CAAZ,CAAR;AACAH,IAAAA,KAAK,CAACmB,IAAN,CAAW,4CAAX,EAAyD;AACrD6B,MAAAA,eAAe,EAAED,kBAAkB,CAACE,KADiB;AAErDnC,MAAAA;AAFqD,KAAzD,EAIKO,IAJL,CAIUC,QAAQ,IAAI;AACdqB,MAAAA,UAAU,GAAG,EAAE,GAAGA,UAAL;AAAiB,WAAGrB,QAAQ,CAACK;AAA7B,OAAb;AACAvB,MAAAA,QAAQ,CAACuC,UAAD,CAAR;AACA1B,MAAAA,QAAQ,CAAC;AACLM,QAAAA,IAAI,EAAEtB,cADD;AAELuB,QAAAA,OAAO,EAAE;AACLmB,UAAAA,UADK;AAELO,UAAAA,cAAc,EAAE,CAAC;AACb,qBAAS,gBADI;AAEb,qBAASH,kBAAkB,CAACI,KAFf;AAGb,oBAAQJ;AAHK,WAAD,CAFX;AAOLb,UAAAA,OAAO,EAAE;AAPJ;AAFJ,OAAD,CAAR;AAYH,KAnBL,EAoBKE,KApBL,CAoBWC,KAAK,IAAI;AACZpB,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEtB,cAAR;AAAwBuB,QAAAA,OAAO,EAAE;AAAEU,UAAAA,OAAO,EAAE;AAAX;AAAjC,OAAD,CAAR;;AACA,UAAIG,KAAK,CAACf,QAAN,CAAegB,MAAf,KAA0B,GAA9B,EAAmC;AAC/BpC,QAAAA,KAAK,CAACmC,KAAN,CAAYA,KAAK,CAACE,OAAlB;AACH,OAFD,MAEO;AACHrC,QAAAA,KAAK,CAACsC,IAAN,CAAWH,KAAK,CAACf,QAAN,CAAeK,IAA1B;AACH;AACJ,KA3BL;AA4BH,GA9BD;AA+BH;AACD,OAAO,SAASyB,kBAAT,CAA4BT,UAA5B,EAAwC7B,QAAxC,EAAkDuC,MAAlD,EAA0D;AAC7D,SAAO,UAAUpC,QAAV,EAAoB;AACvBA,IAAAA,QAAQ,CAACd,WAAW,CAAC,IAAD,CAAZ,CAAR;AACAH,IAAAA,KAAK,CAACmB,IAAN,CAAW,iDAAX,EAA8D;AAC1DyB,MAAAA,qBAAqB,EAAED,UAAU,CAACE,gBAAX,CAA4BD,qBADO;AAE1D9B,MAAAA;AAF0D,KAA9D,EAIKO,IAJL,CAIUC,QAAQ,IAAI;AACd,UAAIgC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWlC,QAAQ,CAACK,IAAT,CAAc8B,QAAd,CAAuBR,KAAlC,CAAf;AACA7C,MAAAA,QAAQ,CAACuC,UAAD,CAAR;AAEA,YAAM3B,OAAO,GAAG;AACZ2B,QAAAA,UADY;AAEZe,QAAAA,YAAY,EAAEL,MAFF;AAGZlB,QAAAA,UAAU,EAAE,IAHA;AAIZD,QAAAA,OAAO,EAAE,KAJG;AAKZD,QAAAA,SAAS,EAAE,KALC;AAMZ0B,QAAAA,MAAM,EAAEL,QANI;AAOZM,QAAAA,cAAc,EAAE;AAAEC,UAAAA,YAAY,EAAEvC,QAAQ,CAACK,IAAT,CAAcmC;AAA9B;AAPJ,OAAhB,CAJc,CAad;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA7C,MAAAA,QAAQ,CAACJ,mBAAmB,CAACC,QAAD,EAAW,QAAX,EAAqBE,OAArB,CAApB,CAAR;AACH,KA7BL,EA8BKoB,KA9BL,CA8BWC,KAAK,IAAI;AACZpB,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEtB,cAAR;AAAwBuB,QAAAA,OAAO,EAAE;AAAEU,UAAAA,OAAO,EAAE;AAAX;AAAjC,OAAD,CAAR;;AACA,UAAIG,KAAK,CAACf,QAAN,CAAegB,MAAf,KAA0B,GAA9B,EAAmC;AAC/BpC,QAAAA,KAAK,CAACmC,KAAN,CAAYA,KAAK,CAACE,OAAlB;AACH,OAFD,MAEO;AACHrC,QAAAA,KAAK,CAACsC,IAAN,CAAWH,KAAK,CAACf,QAAN,CAAeK,IAA1B;AACH;AACJ,KArCL;AAsCH,GAxCD;AAyCH;AAED,OAAO,SAASD,YAAT,CAAsBqC,UAAtB,EAAkC;AAErC,MAAIC,KAAK,CAACC,OAAN,CAAcF,UAAd,CAAJ,EAA+B;AAC3B,QAAIG,QAAQ,GAAG,EAAf;AACAH,IAAAA,UAAU,CAACI,GAAX,CAAexC,IAAI,IAAI;AACnBuC,MAAAA,QAAQ,CAACE,IAAT,CAAcb,IAAI,CAACC,KAAL,CAAW7B,IAAI,CAAC8B,QAAL,CAAcR,KAAzB,CAAd;AACH,KAFD;AAGA,WAAOiB,QAAP;AACH,GAND,MAMO;AACH,WAAOX,IAAI,CAACC,KAAL,CAAWO,UAAU,CAACd,KAAtB,CAAP;AACH;AAEJ;AACD,OAAO,SAASoB,eAAT,CAAyBV,MAAzB,EAAiC3B,mBAAjC,EAAsDsC,UAAtD,EAAkExD,QAAlE,EAA4EyD,IAA5E,EAAkFC,UAAlF,EAA8FC,aAA9F,EAA6GC,gBAA7G,EAA+H;AAClI,SAAO,UAAUzD,QAAV,EAAoB;AACvBA,IAAAA,QAAQ,CAACd,WAAW,CAAC,IAAD,CAAZ,CAAR;AACAH,IAAAA,KAAK,CAACmB,IAAN,CAAW,qCAAX,EAAkD;AAAEmD,MAAAA,UAAF;AAAcxD,MAAAA;AAAd,KAAlD,EACKO,IADL,CACUC,QAAQ,IAAI;AACdkD,MAAAA,UAAU,GAAGA,UAAU,IAAI,EAA3B;AACA,YAAMG,YAAY,GAAGrD,QAAQ,CAACK,IAAT,CAAciD,cAAd,GAA+BlD,YAAY,CAACJ,QAAQ,CAACK,IAAT,CAAciD,cAAf,CAA3C,GAA4E,EAAjG;AACA,YAAMC,cAAc,GAAGvD,QAAQ,CAACK,IAAT,CAAcmD,eAAd,GAAgCpD,YAAY,CAACJ,QAAQ,CAACK,IAAT,CAAcmD,eAAf,CAA5C,GAA8E,EAArG;AACA,YAAMC,mBAAmB,GAAGzD,QAAQ,CAACK,IAAT,CAAcqD,mBAAd,GAAoCtD,YAAY,CAACJ,QAAQ,CAACK,IAAT,CAAcqD,mBAAf,CAAhD,GAAsF,EAAlH;AACA,YAAMC,cAAc,GAAG3D,QAAQ,CAACK,IAAT,CAAcuD,eAAd,GAAgCxD,YAAY,CAACJ,QAAQ,CAACK,IAAT,CAAcuD,eAAf,CAA5C,GAA8E,EAArG;AACA,YAAMC,cAAc,GAAG7D,QAAQ,CAACK,IAAT,CAAcyD,eAArC;AACAZ,MAAAA,UAAU,GAAG,EACT,GAAGA,UADM;AAET,SAACF,UAAD,GAAc;AACVK,UAAAA,YADU;AAEVE,UAAAA,cAFU;AAGVE,UAAAA,mBAHU;AAIVE,UAAAA,cAJU;AAKVE,UAAAA;AALU;AAFL,OAAb;AAUA,UAAIE,aAAJ;AACA,UAAIC,SAAS,GAAG,EAAhB;AACAX,MAAAA,YAAY,CAACR,GAAb,CAAiBoB,IAAI,IAAI;AACrBD,QAAAA,SAAS,CAAClB,IAAV,CAAe;AACXjB,UAAAA,KAAK,EAAEoC,IAAI,CAACC,WAAL,CAAiB1E,QAAQ,CAAC2E,iBAA1B,CADI;AAEXxC,UAAAA,KAAK,EAAEsC,IAAI,CAACG,UAFD;AAGXH,UAAAA;AAHW,SAAf;;AAKA,YAAIA,IAAI,CAACI,OAAT,EAAkB;AACdN,UAAAA,aAAa,GAAG;AACZlC,YAAAA,KAAK,EAAEoC,IAAI,CAACC,WAAL,CAAiB1E,QAAQ,CAAC2E,iBAA1B,CADK;AAEZxC,YAAAA,KAAK,EAAEsC,IAAI,CAACG,UAFA;AAGZH,YAAAA;AAHY,WAAhB;AAKH;AACJ,OAbD;AAcAV,MAAAA,cAAc,CAACV,GAAf,CAAmBoB,IAAI,IAAI;AACvBD,QAAAA,SAAS,CAAClB,IAAV,CAAe;AACXjB,UAAAA,KAAK,EAAEoC,IAAI,CAACC,WAAL,CAAiB1E,QAAQ,CAAC2E,iBAA1B,CADI;AAEXxC,UAAAA,KAAK,EAAEsC,IAAI,CAACG,UAFD;AAGXH,UAAAA;AAHW,SAAf;;AAKA,YAAIA,IAAI,CAACI,OAAT,EAAkB;AACdN,UAAAA,aAAa,GAAG;AACZlC,YAAAA,KAAK,EAAEoC,IAAI,CAACC,WAAL,CAAiB1E,QAAQ,CAAC2E,iBAA1B,CADK;AAEZxC,YAAAA,KAAK,EAAEsC,IAAI,CAACG,UAFA;AAGZH,YAAAA;AAHY,WAAhB;AAKH;AACJ,OAbD;AAcAR,MAAAA,mBAAmB,CAACZ,GAApB,CAAwBoB,IAAI,IAAI;AAC5BD,QAAAA,SAAS,CAAClB,IAAV,CAAe;AACXjB,UAAAA,KAAK,EAAEoC,IAAI,CAACC,WAAL,CAAiB1E,QAAQ,CAAC2E,iBAA1B,CADI;AAEXxC,UAAAA,KAAK,EAAEsC,IAAI,CAACG,UAFD;AAGXH,UAAAA;AAHW,SAAf;;AAKA,YAAIA,IAAI,CAACI,OAAT,EAAkB;AACdN,UAAAA,aAAa,GAAG;AACZlC,YAAAA,KAAK,EAAEoC,IAAI,CAACC,WAAL,CAAiB1E,QAAQ,CAAC2E,iBAA1B,CADK;AAEZxC,YAAAA,KAAK,EAAEsC,IAAI,CAACG,UAFA;AAGZH,YAAAA;AAHY,WAAhB;AAKH;AACJ,OAbD;;AAcA,UAAIb,gBAAJ,EAAsB;AAClBD,QAAAA,aAAa,GAAGA,aAAa,IAAI,EAAjC;AACAzC,QAAAA,mBAAmB,GAAG,EAAE,GAAGA,mBAAL;AAA0B4D,UAAAA,MAAM,EAAEP,aAAlC;AAAiDQ,UAAAA,aAAa,EAAER,aAAa,CAACpC,KAA9E;AAAqF6C,UAAAA,WAAW,EAAEX;AAAlG,SAAtB;AACAxB,QAAAA,MAAM,GAAGlD,wBAAwB,CAACkD,MAAD,EAASY,IAAT,EAAevC,mBAAf,CAAjC;;AACA,YAAIA,mBAAmB,CAAC+D,aAApB,KAAsCrF,eAAe,CAACsF,KAA1D,EAAiE;AAC7D,cAAIC,eAAe,GAAGzF,iBAAiB,CAACwB,mBAAD,EAAsByC,aAAa,CAAC7C,UAApC,EAAgD4C,UAAhD,CAAvC;AACAC,UAAAA,aAAa,GAAG,EAAE,GAAGA,aAAL;AAAoBwB,YAAAA;AAApB,WAAhB;AACH;AACJ,OARD,MAQO,IAAIxB,aAAa,KAAKyB,SAAtB,EAAiC;AACpCzB,QAAAA,aAAa,GAAGA,aAAa,IAAI,EAAjC;AACAzC,QAAAA,mBAAmB,GAAG,EAAE,GAAGA,mBAAL;AAA0B4D,UAAAA,MAAM,EAAEP,aAAlC;AAAiDQ,UAAAA,aAAa,EAAER,aAAa,CAACpC,KAA9E;AAAqF6C,UAAAA,WAAW,EAAEX;AAAlG,SAAtB;AACAxB,QAAAA,MAAM,GAAGlD,wBAAwB,CAACkD,MAAD,EAASY,IAAT,EAAevC,mBAAf,CAAjC;;AACA,YAAIA,mBAAmB,CAAC+D,aAApB,KAAsCrF,eAAe,CAACsF,KAA1D,EAAiE;AAC7D,cAAIC,eAAe,GAAGzF,iBAAiB,CAACwB,mBAAD,EAAsByC,aAAa,CAAC7C,UAApC,EAAgD4C,UAAhD,CAAvC;AACAC,UAAAA,aAAa,GAAG,EAAE,GAAGA,aAAL;AAAoBwB,YAAAA;AAApB,WAAhB;AACH;AACJ,OARM,MAQA;AACH,YAAIA,eAAe,GAAGzF,iBAAiB,CAACwB,mBAAD,EAAsByC,aAAa,CAAC7C,UAApC,EAAgD4C,UAAhD,CAAvC;AACAC,QAAAA,aAAa,GAAG,EAAE,GAAGA,aAAL;AAAoBwB,UAAAA;AAApB,SAAhB;AACH;;AACDzB,MAAAA,UAAU,GAAG,EACT,GAAGA,UADM;AAET,SAACF,UAAD,GAAc,EAAE,GAAGE,UAAU,CAACF,UAAD,CAAf;AAA6B6B,UAAAA,WAAW,EAAEb;AAA1C;AAFL,OAAb;AAIArE,MAAAA,QAAQ,CAAC;AACLM,QAAAA,IAAI,EAAEtB,cADD;AAELuB,QAAAA,OAAO,EAAE;AACLU,UAAAA,OAAO,EAAE,KADJ;AAELyB,UAAAA,MAFK;AAGL3B,UAAAA,mBAHK;AAILmE,UAAAA,WAAW,EAAEb,SAJR;AAKLd,UAAAA,UALK;AAMLW,UAAAA,cANK;AAOL,aAAGV;AAPE;AAFJ,OAAD,CAAR;AAYH,KAlGL,EAmGKrC,KAnGL,CAmGWC,KAAK,IAAI;AACZpB,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEtB,cAAR;AAAwBuB,QAAAA,OAAO,EAAE;AAAEU,UAAAA,OAAO,EAAE;AAAX;AAAjC,OAAD,CAAR;;AACA,UAAIG,KAAK,CAACf,QAAN,CAAegB,MAAf,KAA0B,GAA9B,EAAmC;AAC/BpC,QAAAA,KAAK,CAACmC,KAAN,CAAYA,KAAK,CAACE,OAAlB;AACH,OAFD,MAEO;AACHrC,QAAAA,KAAK,CAACsC,IAAN,CAAWH,KAAK,CAACf,QAAN,CAAeK,IAA1B;AACH;AACJ,KA1GL;AA2GH,GA7GD;AA8GH;AAED,OAAO,SAASyE,kBAAT,CAA4BzD,UAA5B,EAAwC7B,QAAxC,EACHuC,MADG,EACKgD,UADL,EACiBzC,cADjB,EACiC0C,eADjC,EACkDC,eADlD,EACmEC,qBADnE,EAEHrE,UAFG,EAESF,SAFT,EAEoBwE,kBAFpB,EAEwC;AAC3C,SAAO,UAAUxF,QAAV,EAAoB;AACvBA,IAAAA,QAAQ,CAACd,WAAW,CAAC,IAAD,CAAZ,CAAR;AACA,UAAMuG,eAAe,GAAG1G,KAAK,CAACmB,IAAN,CAAW,sBAAX,CAAxB;AACA,UAAMwF,aAAa,GAAG3G,KAAK,CAACmB,IAAN,CAAW,oCAAX,EAAiD;AACnEyF,MAAAA,gBAAgB,EAAEP,UADiD;AAEnEQ,MAAAA,eAAe,EAAEP,eAFkD;AAGnExF,MAAAA;AAHmE,KAAjD,CAAtB;AAKAH,IAAAA,KAAK,CAACS,GAAN,CAAU,CAACsF,eAAD,EAAkBC,aAAlB,CAAV,EACKtF,IADL,CACUC,QAAQ,IAAI;AACd,YAAMwF,WAAW,GAAGxG,mBAAmB,CAACgB,QAAQ,CAAC,CAAD,CAAR,CAAYK,IAAZ,IAAoB,EAArB,EAAyB,eAAzB,EAA0C,aAA1C,EAAyDuE,SAAzD,EAAoEA,SAApE,EAA+E,IAA/E,CAAvC;AACA,YAAMa,YAAY,GAAGD,WAAW,CAAC/E,GAAZ,CAAgB,YAAhB,CAArB;AACA,YAAMiF,eAAe,GAAG;AAAE7D,QAAAA,KAAK,EAAErC,QAAQ,CAACmG,WAAlB;AAA+BhE,QAAAA,KAAK,EAAEnC,QAAQ,CAACoG;AAA/C,OAAxB;AACA,YAAMC,YAAY,GAAG5G,oBAAoB,CAAC8F,UAAD,EAAa/E,QAAQ,CAAC,CAAD,CAAR,CAAYK,IAAzB,EAA+BiC,cAA/B,EAA+C0C,eAA/C,EAAgEE,qBAAhE,CAAzC;AACApG,MAAAA,QAAQ,CAACuC,UAAD,CAAR;AAEA,YAAMyE,eAAe,GAAGb,eAAe,CAACc,MAAhB,CAAuBC,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAW,kBAAvC,CAAxB;;AACA,UAAIH,eAAe,CAACI,MAAhB,GAAyB,CAA7B,EAAgC;AAC5B,cAAMC,eAAe,GAAGN,YAAY,CAACvD,cAAb,CAA4BwD,eAAe,CAAC,CAAD,CAAf,CAAmBjE,KAA/C,KACpBgE,YAAY,CAACvD,cAAb,CAA4BwD,eAAe,CAAC,CAAD,CAAf,CAAmBjE,KAA/C,EAAsDF,KAD1D;AAEA,cAAMyE,kBAAkB,GAAGP,YAAY,CAACvD,cAAb,CAA4BwD,eAAe,CAAC,CAAD,CAAf,CAAmBjE,KAA/C,KACpBgE,YAAY,CAACvD,cAAb,CAA4BwD,eAAe,CAAC,CAAD,CAAf,CAAmBjE,KAA/C,EAAsD,MAAtD,EAA8D,oBAA9D,CADP;;AAEA,YAAIuE,kBAAkB,KAAKxB,SAA3B,EAAsC;AAClC,cAAIwB,kBAAkB,KAAK,CAA3B,EAA8B,CAE7B,CAFD,MAGK;AACD,kBAAMC,OAAO,GAAGpB,eAAe,CAACc,MAAhB,CAAuBC,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAW,SAAvC,CAAhB;;AACA,gBAAII,OAAO,CAACH,MAAR,GAAiB,CAArB,EAAwB;AACpB,oBAAMI,YAAY,GAAGT,YAAY,CAACvD,cAAb,CAA4B+D,OAAO,CAAC,CAAD,CAAP,CAAWxE,KAAvC,KACdgE,YAAY,CAACvD,cAAb,CAA4B+D,OAAO,CAAC,CAAD,CAAP,CAAWxE,KAAvC,EAA8CF,KADrD;AAEA,kBAAI2E,YAAY,KAAK1B,SAArB,EACIO,kBAAkB,CAAC,cAAD,CAAlB,GAAqCmB,YAArC;AACJnB,cAAAA,kBAAkB,CAAC,iBAAD,CAAlB,GAAwCgB,eAAxC;AACA,oBAAMI,UAAU,GAAG;AACfd,gBAAAA,YADe;AAEfC,gBAAAA,eAFe;AAGfrE,gBAAAA,UAHe;AAIfe,gBAAAA,YAAY,EAAEL,MAJC;AAKfpB,gBAAAA,SALe;AAMfsE,gBAAAA,eANe;AAOfC,gBAAAA,qBAPe;AAQfrE,gBAAAA;AARe,eAAnB;AAUAlB,cAAAA,QAAQ,CAACL,gBAAgB,CAAC6F,kBAAD,EACrBU,YAAY,CAACvD,cADQ,EAErBuD,YAAY,CAAC7B,SAFQ,EAEGuC,UAFH,CAAjB,CAAR;AAGH;AACJ;AAEJ,SA5BD,MA4BO;AACH5G,UAAAA,QAAQ,CAAC;AACLM,YAAAA,IAAI,EAAEtB,cADD;AAELuB,YAAAA,OAAO,EAAE;AACLuF,cAAAA,YADK;AAELC,cAAAA,eAFK;AAGLrE,cAAAA,UAHK;AAILe,cAAAA,YAAY,EAAEL,MAJT;AAKLpB,cAAAA,SALK;AAMLC,cAAAA,OAAO,EAAE,KANJ;AAOLoD,cAAAA,SAAS,EAAE6B,YAAY,CAAC7B,SAPnB;AAQL1B,cAAAA,cAAc,EAAEuD,YAAY,CAACvD,cARxB;AASL2C,cAAAA,eATK;AAULC,cAAAA,qBAVK;AAWLrE,cAAAA;AAXK;AAFJ,WAAD,CAAR;AAgBH;AACJ,OAnDD,MAmDO;AACHlB,QAAAA,QAAQ,CAAC;AACLM,UAAAA,IAAI,EAAEtB,cADD;AAELuB,UAAAA,OAAO,EAAE;AACLuF,YAAAA,YADK;AAELC,YAAAA,eAFK;AAGLrE,YAAAA,UAHK;AAILe,YAAAA,YAAY,EAAEL,MAJT;AAKLpB,YAAAA,SALK;AAMLC,YAAAA,OAAO,EAAE,KANJ;AAOLoD,YAAAA,SAAS,EAAE6B,YAAY,CAAC7B,SAPnB;AAQL1B,YAAAA,cAAc,EAAEuD,YAAY,CAACvD,cARxB;AASL2C,YAAAA,eATK;AAULC,YAAAA,qBAVK;AAWLrE,YAAAA;AAXK;AAFJ,SAAD,CAAR;AAgBH;AAGJ,KAhFL,EAiFKC,KAjFL,CAiFWC,KAAK,IAAI;AACZpB,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEtB,cAAR;AAAwBuB,QAAAA,OAAO,EAAE;AAAEU,UAAAA,OAAO,EAAE;AAAX;AAAjC,OAAD,CAAR;;AACA,UAAIG,KAAK,CAACf,QAAN,CAAegB,MAAf,KAA0B,GAA9B,EAAmC;AAC/BpC,QAAAA,KAAK,CAACmC,KAAN,CAAYA,KAAK,CAACE,OAAlB;AACH,OAFD,MAEO;AACHrC,QAAAA,KAAK,CAACsC,IAAN,CAAWH,KAAK,CAACf,QAAN,CAAeK,IAA1B;AACH;AACJ,KAxFL;AAyFH,GAjGD;AAkGH;AAED,OAAO,SAASmG,cAAT,CAAwBC,UAAxB,EACHjH,QADG,EACO8C,cADP,EACuB0B,SADvB,EACkCsB,gBADlC,EAEHC,eAFG,EAEcL,qBAFd,EAEqCwB,sBAFrC,EAGHC,eAHG,EAGcC,OAHd,EAGuBC,kBAHvB,EAG2C;AAC9C,SAAO,UAAUlH,QAAV,EAAoB;AACvBA,IAAAA,QAAQ,CAACd,WAAW,CAAC,IAAD,CAAZ,CAAR;AACAH,IAAAA,KAAK,CAACmB,IAAN,CAAW,oCAAX,EAAiD;AAC7CiH,MAAAA,KAAK,EAAEL,UAAU,CAACK,KAD2B;AAE7CC,MAAAA,UAAU,EAAEN,UAAU,CAACxC,IAFsB;AAG7C+C,MAAAA,YAAY,EAAEP,UAAU,CAACQ,MAHoB;AAI7C,OAACR,UAAU,CAACS,eAAZ,GAA8BT,UAAU,CAAC9E,KAJI;AAK7C6C,MAAAA,WAAW,EAAEiC,UAAU,CAACS,eALqB;AAM7C3B,MAAAA,eAN6C;AAO7C/F,MAAAA,QAP6C;AAQ7C8F,MAAAA;AAR6C,KAAjD,EAUKvF,IAVL,CAUUC,QAAQ,IAAI;AACd,UAAImH,SAAS,GAAG,EAAE,GAAGnD,SAAL;AAAgB,WAAGhE,QAAQ,CAACK;AAA5B,OAAhB;AACA8G,MAAAA,SAAS,GAAGlI,oBAAoB,CAACyH,sBAAD,EAAyBS,SAAzB,EAAoC7E,cAApC,EAAoDiD,eAApD,EAAqEL,qBAArE,EAA4FuB,UAAU,CAACxC,IAAvG,CAAhC;AACA3B,MAAAA,cAAc,GAAG,EAAE,GAAGA,cAAL;AAAqB,WAAG6E,SAAS,CAAC7E;AAAlC,OAAjB;;AACA,UAAIqE,eAAJ,EAAqB;AACjB,cAAMR,eAAe,GAAG7D,cAAc,CAAC,kBAAD,CAAd,IAAsCA,cAAc,CAAC,kBAAD,CAAd,CAAmCX,KAAjG;AAEH,OAHD,MAGO,IAAIiF,OAAJ,EAAa;AAChBjH,QAAAA,QAAQ,CAACL,gBAAgB,CAACuH,kBAAD,EAAqBvE,cAArB,EAAqC,EAAE,GAAG6E,SAAS,CAACnD;AAAf,SAArC,CAAjB,CAAR;AACH,OAFM,MAGF;AACDrE,QAAAA,QAAQ,CAAC;AACLM,UAAAA,IAAI,EAAEtB,cADD;AAELuB,UAAAA,OAAO,EAAE;AACLU,YAAAA,OAAO,EAAE,KADJ;AAELoD,YAAAA,SAAS,EAAE,EAAE,GAAGmD,SAAS,CAACnD;AAAf,aAFN;AAGL1B,YAAAA;AAHK;AAFJ,SAAD,CAAR;AAQH;AACJ,KA9BL,EA+BKxB,KA/BL,CA+BWC,KAAK,IAAI;AACZpB,MAAAA,QAAQ,CAAC;AAAEM,QAAAA,IAAI,EAAEtB,cAAR;AAAwBuB,QAAAA,OAAO,EAAE;AAAEU,UAAAA,OAAO,EAAE;AAAX;AAAjC,OAAD,CAAR;;AACA,UAAIG,KAAK,CAACf,QAAN,CAAegB,MAAf,KAA0B,GAA9B,EAAmC;AAC/BpC,QAAAA,KAAK,CAACmC,KAAN,CAAYA,KAAK,CAACE,OAAlB;AACH,OAFD,MAEO;AACHrC,QAAAA,KAAK,CAACsC,IAAN,CAAWH,KAAK,CAACf,QAAN,CAAeK,IAA1B;AACH;AACJ,KAtCL;AAuCH,GAzCD;AA0CH","sourcesContent":["import rsapi from '../rsapi';\r\nimport { DEFAULT_RETURN } from './LoginTypes';\r\nimport { toast } from 'react-toastify';\r\nimport { initRequest } from './LoginAction';\r\nimport { sortData, constructjsonOptionList, constructOptionList, parentChildComboLoad } from '../components/CommonScript';\r\nimport { getValidComponent, replaceChildFromChildren } from '../components/droparea/helpers';\r\nimport { ReactComponents } from '../components/Enumeration';\r\nimport Axios from 'axios';\r\nimport { getTreeByProduct } from '.';\r\n\r\nexport function getReactInputFields(userinfo, operation, respObj) {\r\n\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        const listURL = [];\r\n        listURL[0] = rsapi.post(\"dynamicpreregdesign/getReactComponents\", { userinfo })\r\n        listURL[1] = rsapi.post(\"dynamicpreregdesign/getReactInputFields\", { userinfo })\r\n        Axios.all(listURL)\r\n            .then(response => {\r\n                respObj = respObj ? { ...respObj } : {}\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        ReactInputFields: getJsonValue(response[1].data),\r\n                        ReactComponents: getJsonValue(response[0].data.components),\r\n                        ReactTables: constructOptionList(response[0].data.tables, 'stablename', 'displayname').get(\"OptionList\"),\r\n                        selectedFieldRecord: {},\r\n                        openModal: false,\r\n                        loading: false,\r\n                        openPortal: true,\r\n                        operation,\r\n                        ...respObj\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\nexport function selectRegistrationTemplate(template, masterData, userinfo) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"dynamicpreregdesign/getRegistrationTemplateById\", {\r\n            nreactregtemplatecode: template.nreactregtemplatecode,\r\n            userinfo\r\n        })\r\n            .then(response => {\r\n\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: { masterData: { ...masterData, selectedTemplate: response.data }, loading: false }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\nexport function getRegistrationTemplate(selectedSampleType, masterData, userinfo) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"dynamicpreregdesign/getDynamicPreRegDesign\", {\r\n            nsampletypecode: selectedSampleType.value,\r\n            userinfo\r\n        })\r\n            .then(response => {\r\n                masterData = { ...masterData, ...response.data }\r\n                sortData(masterData)\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        masterData,\r\n                        realSampleType: [{\r\n                            \"label\": \"IDS_SAMPLETYPE\",\r\n                            \"value\": selectedSampleType.label,\r\n                            \"item\": selectedSampleType\r\n                        }],\r\n                        loading: false\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\nexport function getEditRegTemplate(masterData, userinfo, editId) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"dynamicpreregdesign/getRegistrationTemplateById\", {\r\n            nreactregtemplatecode: masterData.selectedTemplate.nreactregtemplatecode,\r\n            userinfo\r\n        })\r\n            .then(response => {\r\n                let jsonData = JSON.parse(response.data.jsondata.value);\r\n                sortData(masterData)\r\n\r\n                const respObj = {\r\n                    masterData,\r\n                    ncontrolcode: editId,\r\n                    openPortal: true,\r\n                    loading: false,\r\n                    openModal: false,\r\n                    design: jsonData,\r\n                    selectedRecord: { templateName: response.data.sregtemplatename }\r\n                }\r\n                // dispatch({\r\n                //     type: DEFAULT_RETURN,\r\n                //     payload: {\r\n                //         masterData,\r\n                //         ncontrolcode: editId,\r\n                //         // openPortal: true,\r\n                //         // loading: false,\r\n                //         design: jsonData,\r\n                //         selectedRecord: { templateName: response.data.sregtemplatename }\r\n                //     }\r\n                // })\r\n                dispatch(getReactInputFields(userinfo, \"update\", respObj))\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport function getJsonValue(PGjsonData) {\r\n\r\n    if (Array.isArray(PGjsonData)) {\r\n        let JSONData = [];\r\n        PGjsonData.map(data => {\r\n            JSONData.push(JSON.parse(data.jsondata.value))\r\n        })\r\n        return JSONData;\r\n    } else {\r\n        return JSON.parse(PGjsonData.value);\r\n    }\r\n\r\n}\r\nexport function getTableColumns(design, selectedFieldRecord, stablename, userinfo, path, columnInfo, componentData, updateComponents) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"dynamicpreregdesign/getTableColumns\", { stablename, userinfo })\r\n            .then(response => {\r\n                columnInfo = columnInfo || {}\r\n                const staicColumns = response.data.jstaticcolumns ? getJsonValue(response.data.jstaticcolumns) : []\r\n                const dynamicColumns = response.data.jdynamiccolumns ? getJsonValue(response.data.jdynamiccolumns) : []\r\n                const multilingualColumns = response.data.jmultilingualcolumn ? getJsonValue(response.data.jmultilingualcolumn) : []\r\n                const numericColumns = response.data.jnumericcolumns ? getJsonValue(response.data.jnumericcolumns) : []\r\n                const primaryKeyName = response.data.sprimarykeyname\r\n                columnInfo = {\r\n                    ...columnInfo,\r\n                    [stablename]: {\r\n                        staicColumns,\r\n                        dynamicColumns,\r\n                        multilingualColumns,\r\n                        numericColumns,\r\n                        primaryKeyName\r\n                    }\r\n                }\r\n                let defaultColumn;\r\n                let comboData = []\r\n                staicColumns.map(item => {\r\n                    comboData.push({\r\n                        label: item.displayname[userinfo.slanguagetypecode],\r\n                        value: item.columnname,\r\n                        item\r\n                    })\r\n                    if (item.default) {\r\n                        defaultColumn = {\r\n                            label: item.displayname[userinfo.slanguagetypecode],\r\n                            value: item.columnname,\r\n                            item\r\n                        }\r\n                    }\r\n                })\r\n                dynamicColumns.map(item => {\r\n                    comboData.push({\r\n                        label: item.displayname[userinfo.slanguagetypecode],\r\n                        value: item.columnname,\r\n                        item\r\n                    })\r\n                    if (item.default) {\r\n                        defaultColumn = {\r\n                            label: item.displayname[userinfo.slanguagetypecode],\r\n                            value: item.columnname,\r\n                            item\r\n                        }\r\n                    }\r\n                })\r\n                multilingualColumns.map(item => {\r\n                    comboData.push({\r\n                        label: item.displayname[userinfo.slanguagetypecode],\r\n                        value: item.columnname,\r\n                        item\r\n                    })\r\n                    if (item.default) {\r\n                        defaultColumn = {\r\n                            label: item.displayname[userinfo.slanguagetypecode],\r\n                            value: item.columnname,\r\n                            item\r\n                        }\r\n                    }\r\n                })\r\n                if (updateComponents) {\r\n                    componentData = componentData || {}\r\n                    selectedFieldRecord = { ...selectedFieldRecord, column: defaultColumn, displaymember: defaultColumn.value, valuemember: primaryKeyName };\r\n                    design = replaceChildFromChildren(design, path, selectedFieldRecord)\r\n                    if (selectedFieldRecord.componentcode !== ReactComponents.COMBO) {\r\n                        let validComponents = getValidComponent(selectedFieldRecord, componentData.components, columnInfo);\r\n                        componentData = { ...componentData, validComponents }\r\n                    }\r\n                } else if (componentData === undefined) {\r\n                    componentData = componentData || {}\r\n                    selectedFieldRecord = { ...selectedFieldRecord, column: defaultColumn, displaymember: defaultColumn.value, valuemember: primaryKeyName };\r\n                    design = replaceChildFromChildren(design, path, selectedFieldRecord)\r\n                    if (selectedFieldRecord.componentcode !== ReactComponents.COMBO) {\r\n                        let validComponents = getValidComponent(selectedFieldRecord, componentData.components, columnInfo);\r\n                        componentData = { ...componentData, validComponents }\r\n                    }\r\n                } else {\r\n                    let validComponents = getValidComponent(selectedFieldRecord, componentData.components, columnInfo);\r\n                    componentData = { ...componentData, validComponents }\r\n                }\r\n                columnInfo = {\r\n                    ...columnInfo,\r\n                    [stablename]: { ...columnInfo[stablename], tableColumn: comboData }\r\n                }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        loading: false,\r\n                        design,\r\n                        selectedFieldRecord,\r\n                        tableColumn: comboData,\r\n                        columnInfo,\r\n                        primaryKeyName,\r\n                        ...componentData\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport function getPreviewTemplate(masterData, userinfo,\r\n    editId, columnList, selectedRecord, childColumnList, comboComponents, withoutCombocomponent,\r\n    openPortal, openModal, mapOfFilterRegData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        const timeZoneService = rsapi.post(\"timezone/getTimeZone\");\r\n        const actualService = rsapi.post(\"dynamicpreregdesign/getComboValues\", {\r\n            parentcolumnlist: columnList,\r\n            childcolumnlist: childColumnList,\r\n            userinfo\r\n        })\r\n        Axios.all([timeZoneService, actualService])\r\n            .then(response => {\r\n                const timeZoneMap = constructOptionList(response[0].data || [], \"ntimezonecode\", \"stimezoneid\", undefined, undefined, true);\r\n                const timeZoneList = timeZoneMap.get(\"OptionList\");\r\n                const defaultTimeZone = { label: userinfo.stimezoneid, value: userinfo.ntimezonecode }\r\n                const newcomboData = parentChildComboLoad(columnList, response[1].data, selectedRecord, childColumnList, withoutCombocomponent)\r\n                sortData(masterData)\r\n\r\n                const ProductCategory = comboComponents.filter(x => x.name === 'Product Category');\r\n                if (ProductCategory.length > 0) {\r\n                    const nproductcatcode = newcomboData.selectedRecord[ProductCategory[0].label] &&\r\n                        newcomboData.selectedRecord[ProductCategory[0].label].value\r\n                    const ncategorybasedFlow = newcomboData.selectedRecord[ProductCategory[0].label]\r\n                        && newcomboData.selectedRecord[ProductCategory[0].label]['item']['ncategorybasedflow'];\r\n                    if (ncategorybasedFlow !== undefined) {\r\n                        if (ncategorybasedFlow === 3) {\r\n\r\n                        }\r\n                        else {\r\n                            const Product = comboComponents.filter(x => x.name === 'Product');\r\n                            if (Product.length > 0) {\r\n                                const nproductcode = newcomboData.selectedRecord[Product[0].label]\r\n                                    && newcomboData.selectedRecord[Product[0].label].value;\r\n                                if (nproductcode !== undefined)\r\n                                    mapOfFilterRegData['nproductcode'] = nproductcode\r\n                                mapOfFilterRegData['nproductcatcode'] = nproductcatcode\r\n                                const inputParam = {\r\n                                    timeZoneList,\r\n                                    defaultTimeZone,\r\n                                    masterData,\r\n                                    ncontrolcode: editId,\r\n                                    openModal,\r\n                                    comboComponents,\r\n                                    withoutCombocomponent,\r\n                                    openPortal\r\n                                }\r\n                                dispatch(getTreeByProduct(mapOfFilterRegData,\r\n                                    newcomboData.selectedRecord,\r\n                                    newcomboData.comboData, inputParam))\r\n                            }\r\n                        }\r\n\r\n                    } else {\r\n                        dispatch({\r\n                            type: DEFAULT_RETURN,\r\n                            payload: {\r\n                                timeZoneList,\r\n                                defaultTimeZone,\r\n                                masterData,\r\n                                ncontrolcode: editId,\r\n                                openModal,\r\n                                loading: false,\r\n                                comboData: newcomboData.comboData,\r\n                                selectedRecord: newcomboData.selectedRecord,\r\n                                comboComponents,\r\n                                withoutCombocomponent,\r\n                                openPortal\r\n                            }\r\n                        })\r\n                    }\r\n                } else {\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN,\r\n                        payload: {\r\n                            timeZoneList,\r\n                            defaultTimeZone,\r\n                            masterData,\r\n                            ncontrolcode: editId,\r\n                            openModal,\r\n                            loading: false,\r\n                            comboData: newcomboData.comboData,\r\n                            selectedRecord: newcomboData.selectedRecord,\r\n                            comboComponents,\r\n                            withoutCombocomponent,\r\n                            openPortal\r\n                        }\r\n                    })\r\n                }\r\n\r\n\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport function getChildValues(inputParem,\r\n    userinfo, selectedRecord, comboData, parentcolumnlist,\r\n    childcolumnlist, withoutCombocomponent, parentListWithReadonly,\r\n    productCategory, product, mapOfRegFilterData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post('dynamicpreregdesign/getChildValues', {\r\n            child: inputParem.child,\r\n            parentdata: inputParem.item,\r\n            parentsource: inputParem.source,\r\n            [inputParem.primarykeyField]: inputParem.value,\r\n            valuemember: inputParem.primarykeyField,\r\n            childcolumnlist,\r\n            userinfo,\r\n            parentcolumnlist\r\n        })\r\n            .then(response => {\r\n                let returnObj = { ...comboData, ...response.data }\r\n                returnObj = parentChildComboLoad(parentListWithReadonly, returnObj, selectedRecord, childcolumnlist, withoutCombocomponent, inputParem.item)\r\n                selectedRecord = { ...selectedRecord, ...returnObj.selectedRecord }\r\n                if (productCategory) {\r\n                    const nproductcatcode = selectedRecord['Product Category'] && selectedRecord['Product Category'].value\r\n\r\n                } else if (product) {\r\n                    dispatch(getTreeByProduct(mapOfRegFilterData, selectedRecord, { ...returnObj.comboData }))\r\n                }\r\n                else {\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN,\r\n                        payload: {\r\n                            loading: false,\r\n                            comboData: { ...returnObj.comboData },\r\n                            selectedRecord\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}