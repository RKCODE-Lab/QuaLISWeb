{"ast":null,"code":"import _defineProperty from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Nav}from'react-bootstrap';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{FormattedMessage,injectIntl}from'react-intl';import{faPlus}from'@fortawesome/free-solid-svg-icons';import ListAttachment from'../../../components/ListAttachment';import SlideOutModal from'../../../components/slide-out-modal/SlideOutModal';import{DEFAULT_RETURN}from'../../../actions/LoginTypes';import AddAttachment from'./AddAttachment';import{updateStore,getAttachmentCombo,validateEsignCredential,crudMaster,viewAttachment,deleteAttachment}from'../../../actions';import{connect}from'react-redux';import{attachmentType,designProperties,transactionStatus}from'../../../components/Enumeration';import Esign from'../../audittrail/Esign';import{QUALISFORMS}from'../../../components/Enumeration';import{deleteAttachmentDropZone,onDropAttachFileList,Lims_JSON_stringify}from'../../../components/CommonScript';var mapStateToProps=function mapStateToProps(state){return{Login:state.Login};};var Attachments=/*#__PURE__*/function(_Component){_inherits(Attachments,_Component);var _super=_createSuper(Attachments);function Attachments(props){var _this;_classCallCheck(this,Attachments);_this=_super.call(this,props);_this.deleteAttachment=function(event,file,fieldName){var selectedRecord=_this.state.selectedRecord||{};selectedRecord[fieldName]=deleteAttachmentDropZone(selectedRecord[fieldName],file);_this.setState({selectedRecord:selectedRecord,actionType:\"delete\"//fileToDelete:file.name \n});};_this.onDropFiles=function(attachedFiles,fieldName,maxSize){var selectedRecord=_this.state.selectedRecord||{};selectedRecord[fieldName]=onDropAttachFileList(selectedRecord[fieldName],attachedFiles,maxSize);_this.setState({selectedRecord:selectedRecord,actionType:\"new\"});};_this.onAttachmentInputChange=function(event,caseNo,optional){var selectedRecord=_this.state.selectedRecord||{};switch(caseNo){case 1:if(event.target.type==='radio'){selectedRecord[event.target.name]=event.target.checked===true&&optional;// selectedRecord[\"sfilename\"] = \"\";\n}else if(event.target.type==='checkbox'){selectedRecord[event.target.name]=event.target.checked==true?transactionStatus.YES:transactionStatus.NO;}else{selectedRecord[event.target.name]=event.target.value;}_this.setState({selectedRecord:selectedRecord});break;default:selectedRecord[event.target.name]=event.target.value;_this.setState({selectedRecord:selectedRecord});break;}};_this.onInputOnChange=function(event){var selectedRecord=_this.state.selectedRecord||{};if(event.target.type==='checkbox'){selectedRecord[event.target.name]=event.target.checked===true?transactionStatus.YES:transactionStatus.NO;}else{selectedRecord[event.target.name]=event.target.value;}_this.setState({selectedRecord:selectedRecord});};_this.onComboChange=function(comboData,comboName){var selectedRecord=_this.state.selectedRecord||{};if(comboData){selectedRecord[comboName]=comboData;_this.setState({selectedRecord:selectedRecord});}else{selectedRecord[comboName]=[];_this.setState({selectedRecord:selectedRecord});}};_this.onSaveClick=function(saveType,formRef){// const masterData = this.props.Login.masterData;\n// let inputData = {}\n// let inputParam = {}\n// inputData[\"userinfo\"] = this.props.Login.userInfo;\n// if(this.props.Login.screenName === \"IDS_SAMPLEATTACHMENTS\") {\n//     let saveParam={userInfo:this.props.Login.userInfo,\n//         selectedRecord:this.state.selectedRecord,\n//         masterData:this.props.Login.masterData,\n//         saveType, formRef,\n//         operation:this.props.Login.operation,\n//         selectedMaster:this.props.selectedMaster\n//     }\n//     inputParam = onSaveSampleAttachment(saveParam,this.props.selectedMaster);\n// }else if(this.props.Login.screenName === \"IDS_TESTATTACHMENTS\") {\n//     let saveParam={userInfo:this.props.Login.userInfo,\n//         selectedRecord:this.state.selectedRecord,\n//         masterData:this.props.Login.masterData,\n//         saveType, formRef,\n//         operation:this.props.Login.operation,\n//         selectedMaster:this.props.selectedMaster\n//     }\n//     inputParam = onSaveTestAttachment(saveParam,this.props.selectedMaster);\n_this.props.onSaveClick(saveType,formRef,_this.state.selectedRecord);// }\n// if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolCode)) {\n//     const updateInfo = {\n//         typeName: DEFAULT_RETURN,\n//         data: {\n//             loadEsign: true,\n//             screenData: { inputParam, masterData },\n//             operation: this.props.Login.operation,\n//             screenName: this.props.Login.screenName,\n//         }\n//     }\n//     this.props.updateStore(updateInfo);\n// }\n// else {\n//     this.props.crudMaster(inputParam, masterData, \"openAttachmentModal\");\n// }\n};_this.handleClose=function(){var loadEsign=_this.props.Login.loadEsign;var openAttachmentModal=_this.props.Login.openAttachmentModal;var selectedRecord=_this.props.Login.selectedRecord;var operation=_this.props.Login.operation;if(_this.props.Login.loadEsign){if(_this.props.Login.operation===\"delete\"){loadEsign=false;openAttachmentModal=false;selectedRecord={};operation=undefined;}else{loadEsign=false;selectedRecord[\"esigncomments\"]=\"\";selectedRecord[\"esignpassword\"]=\"\";selectedRecord['esignreason']='';}}else{openAttachmentModal=false;selectedRecord={};}var updateInfo={typeName:DEFAULT_RETURN,data:{openAttachmentModal:openAttachmentModal,loadEsign:loadEsign,selectedRecord:selectedRecord,selectedParamId:null,operation:operation}};_this.props.updateStore(updateInfo);};_this.validateEsign=function(){var inputParam={inputData:{\"userinfo\":_objectSpread(_objectSpread({},_this.props.Login.userInfo),{},{sformname:Lims_JSON_stringify(_this.props.Login.userInfo.sformname),smodulename:Lims_JSON_stringify(_this.props.Login.userInfo.smodulename),slanguagename:Lims_JSON_stringify(_this.props.Login.userInfo.slanguagename),sreason:_this.state.selectedRecord[\"esigncomments\"],nreasoncode:_this.state.selectedRecord[\"esignreason\"]&&_this.state.selectedRecord[\"esignreason\"].value,spredefinedreason:_this.state.selectedRecord[\"esignreason\"]&&_this.state.selectedRecord[\"esignreason\"].label}),password:_this.state.selectedRecord[\"esignpassword\"]},screenData:_this.props.Login.screenData};if(_this.props.Login.operation==='dynamic'){_this.props.validateEsignforApproval(inputParam,\"openChildModal\");}else{_this.props.validateEsignCredential(inputParam,\"openAttachmentModal\");}};_this.viewFile=function(filedata){var inputParam={inputData:{file:filedata,userinfo:_this.props.Login.userInfo},classUrl:\"attachment\",operation:\"view\",methodUrl:_this.props.methodUrl,screenName:_this.props.Login.screenName};_this.props.viewAttachment(inputParam);};_this.state={showMore:{},selectedRecord:{}};return _this;}_createClass(Attachments,[{key:\"render\",value:function render(){var _ref4,_ref5,_ref6,_ref7,_ref8,_ref9,_this2=this;var subFields=this.props.subFields?this.props.subFields:[_defineProperty({},designProperties.LABEL,\"\".concat(this.props.Login.screenName==='IDS_TESTATTACHMENTS'?'IDS_TESTNAME':this.props.Login.screenName==='IDS_SUBSAMPLEATTACHMENTS'?this.props.Login.genericLabel?this.props.Login.genericLabel[\"SubARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_SAMPLEARNO\":this.props.Login.genericLabel?this.props.Login.genericLabel[\"ARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_ARNO\")),_defineProperty({},designProperties.VALUE,\"\".concat(this.props.screenName==='IDS_SAMPLEATTACHMENTS'?this.props.Login.userInfo&&this.props.Login.userInfo.nformcode===QUALISFORMS.SAMPLEREGISTRATION?\"groupingField\":\"sarno\":this.props.Login.screenName==='IDS_SUBSAMPLEATTACHMENTS'?this.props.Login.userInfo&&this.props.Login.userInfo.nformcode===QUALISFORMS.SAMPLEREGISTRATION?\"groupingField2\":\"ssamplearno\":\"stestsynonym\")),_defineProperty({},designProperties.VALUE,\"screateddate\")// { [designProperties.VALUE]: \"nfilesize\", \"fieldType\": \"size\" }\n];var moreField=this.props.moreField?this.props.moreField:[(_ref4={},_defineProperty(_ref4,designProperties.LABEL,\"IDS_SCREENNAME\"),_defineProperty(_ref4,designProperties.VALUE,\"sdisplayname\"),_ref4),(_ref5={},_defineProperty(_ref5,designProperties.LABEL,\"IDS_USERNAME\"),_defineProperty(_ref5,designProperties.VALUE,\"susername\"),_ref5),(_ref6={},_defineProperty(_ref6,designProperties.LABEL,\"IDS_USERROLE\"),_defineProperty(_ref6,designProperties.VALUE,\"suserrolename\"),_ref6),this.props.isneedHeader?this.props.isneedHeader&&(_ref7={},_defineProperty(_ref7,designProperties.LABEL,\"IDS_HEADER\"),_defineProperty(_ref7,designProperties.VALUE,\"sheader\"),_ref7):\"\",(_ref8={},_defineProperty(_ref8,designProperties.LABEL,\"IDS_DESCRIPTION\"),_defineProperty(_ref8,designProperties.VALUE,\"sdescription\"),_ref8),this.props.isneedReport?this.props.isneedReport&&(_ref9={},_defineProperty(_ref9,designProperties.LABEL,\"IDS_INCULDEINREPORT\"),_defineProperty(_ref9,designProperties.VALUE,\"sneedreport\"),_ref9):\"\"];if(this.props.screenName==='IDS_TESTATTACHMENTS'){if(this.props.nsubsampleneed===true){if(this.props.moreField===undefined){var _moreField$unshift;moreField.unshift((_moreField$unshift={},_defineProperty(_moreField$unshift,designProperties.LABEL,this.props.Login.genericLabel?this.props.Login.genericLabel[\"SubARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_SAMPLEARNO\"),_defineProperty(_moreField$unshift,designProperties.VALUE,\"groupingField2\"),_moreField$unshift));};}if(this.props.moreField===undefined){var _moreField$unshift2;moreField.unshift((_moreField$unshift2={},_defineProperty(_moreField$unshift2,designProperties.LABEL,this.props.Login.genericLabel?this.props.Login.genericLabel[\"ARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_ARNO\"),_defineProperty(_moreField$unshift2,designProperties.VALUE,\"groupingField1\"),_moreField$unshift2));};}var addFileId=this.props.controlMap.has(this.props.addName)&&this.props.controlMap.get(this.props.addName).ncontrolcode;var editFileId=this.props.controlMap.has(this.props.editName)&&this.props.controlMap.get(this.props.editName).ncontrolcode;var deleteFileId=this.props.controlMap.has(this.props.deleteName)&&this.props.controlMap.get(this.props.deleteName).ncontrolcode;var viewFileId=this.props.controlMap.has(this.props.viewName)&&this.props.controlMap.get(this.props.viewName).ncontrolcode;var mandatoryFields=[];if(this.state.selectedRecord&&this.state.selectedRecord.nattachmenttypecode===attachmentType.LINK){mandatoryFields.push({\"idsName\":\"IDS_FILENAME\",\"dataField\":\"slinkfilename\",\"mandatoryLabel\":\"IDS_CHOOSE\",\"controlType\":\"file\"},{\"idsName\":\"IDS_LINKNAME\",\"dataField\":\"nlinkcode\",\"mandatoryLabel\":\"IDS_ENTER\",\"controlType\":\"textbox\"});}else{// if (this.props.Login.operation !== 'update') {\nmandatoryFields.push({\"idsName\":\"IDS_FILE\",\"dataField\":\"sfilename\",\"mandatoryLabel\":\"IDS_CHOOSE\",\"controlType\":\"file\"});// if(this.props.isneedHeader){\n//     mandatoryFields.push(\n//         { \"idsName\": \"IDS_HEADER\", \"dataField\": \"sheader\", \"mandatoryLabel\": \"IDS_ENTER\", \"controlType\": \"textbox\" })       \n// }\n// }\n}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"actions-stripe border-bottom\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-end\"},/*#__PURE__*/React.createElement(Nav.Link,{name:\"add_\".concat(this.props.Login.screenName,\"_file\"),className:\"add-txt-btn\",hidden:this.props.userRoleControlRights.indexOf(addFileId)===-1,onClick:function onClick(){return _this2.props.getAttachmentCombo({userInfo:_this2.props.Login.userInfo,operation:\"create\",ncontrolCode:addFileId,screenName:_this2.props.screenName,modalName:\"openAttachmentModal\",masterList:_this2.props.masterList,masterAlertStatus:_this2.props.masterAlertStatus});}},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faPlus}),\" \",/*#__PURE__*/React.createElement(FormattedMessage,{id:\"IDS_ATTACHMENT\",defaultMessage:\"Attachment\"})))),/*#__PURE__*/React.createElement(ListAttachment,{attachmentList:this.props.attachments,fileName:\"sfilename\",filesize:\"nfilesize\",linkname:\"slinkname\",isjsonfield:true,jsonfield:\"jsondata\",deleteRecord:this.props.deleteAttachment,deleteParam:this.props.deleteParam,editParam:_objectSpread(_objectSpread({},this.props.editParam),{},{operation:\"update\",ncontrolCode:editFileId,screenName:this.props.screenName,modalName:\"openAttachmentModal\",masterList:this.props.masterList,masterAlertStatus:this.props.masterAlertStatus}),fetchRecord:this.props.fetchRecord,deleteId:deleteFileId,editId:editFileId,viewId:viewFileId,userRoleControlRights:this.props.userRoleControlRights,viewFile:this.viewFile,mainField:this.props.mainField,subFields:subFields,moreField:moreField,hidePaging:false,userInfo:this.props.Login.userInfo// skip={this.props.skip}\n// take={this.props.take}\n,settings:this.props.Login.settings}),this.props.Login.openAttachmentModal?/*#__PURE__*/React.createElement(SlideOutModal,{onSaveClick:this.onSaveClick,operation:this.props.Login.operation,screenName:this.props.Login.screenName,closeModal:this.handleClose,show:this.props.Login.openAttachmentModal,inputParam:this.props.Login.inputParam,esign:this.props.Login.loadEsign,validateEsign:this.validateEsign,masterStatus:this.props.Login.masterStatus,updateStore:this.props.updateStore,selectedRecord:this.state.selectedRecord||{},mandatoryFields:mandatoryFields,addComponent:this.props.Login.loadEsign?/*#__PURE__*/React.createElement(Esign,{operation:this.props.Login.operation,onInputOnChange:this.onInputOnChange,inputParam:this.props.Login.inputParam,selectedRecord:this.state.selectedRecord||{}}):/*#__PURE__*/React.createElement(AddAttachment,{selectedRecord:this.state.selectedRecord||{},onDrop:this.onDropFiles,deleteAttachment:this.deleteAttachment,jsonField:'jsondata',actionType:this.state.actionType,linkMaster:this.props.Login.linkMaster,onInputOnChange:this.onAttachmentInputChange,editFiles:this.props.Login.editFiles,onComboChange:this.onComboChange,maxSize:20,fileNameLength:this.props.screenName==='IDS_TESTATTACHMENTS'?255:150,maxFiles:this.props.Login.operation===\"update\"?1:3,operation:this.props.Login.operation,selectedListName:this.props.selectedListName,displayName:this.props.displayName,masterList:this.props.masterList,multiple:this.props.Login.operation===\"update\"?false:true,isneedReport:this.props.isneedReport||false,isneedHeader:this.props.isneedHeader||false})}):\"\");}},{key:\"componentDidUpdate\",value:function componentDidUpdate(previousProps){if(this.props.Login.selectedRecord!==previousProps.Login.selectedRecord){this.setState({selectedRecord:this.props.Login.selectedRecord});}}}]);return Attachments;}(Component);export default connect(mapStateToProps,{updateStore:updateStore,viewAttachment:viewAttachment,validateEsignCredential:validateEsignCredential,crudMaster:crudMaster,getAttachmentCombo:getAttachmentCombo,deleteAttachment:deleteAttachment})(injectIntl(Attachments));","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/pages/attachmentscomments/attachments/Attachments.jsx"],"names":["React","Component","Nav","FontAwesomeIcon","FormattedMessage","injectIntl","faPlus","ListAttachment","SlideOutModal","DEFAULT_RETURN","AddAttachment","updateStore","getAttachmentCombo","validateEsignCredential","crudMaster","viewAttachment","deleteAttachment","connect","attachmentType","designProperties","transactionStatus","Esign","QUALISFORMS","deleteAttachmentDropZone","onDropAttachFileList","Lims_JSON_stringify","mapStateToProps","state","Login","Attachments","props","event","file","fieldName","selectedRecord","setState","actionType","onDropFiles","attachedFiles","maxSize","onAttachmentInputChange","caseNo","optional","target","type","name","checked","YES","NO","value","onInputOnChange","onComboChange","comboData","comboName","onSaveClick","saveType","formRef","handleClose","loadEsign","openAttachmentModal","operation","undefined","updateInfo","typeName","data","selectedParamId","validateEsign","inputParam","inputData","userInfo","sformname","smodulename","slanguagename","sreason","nreasoncode","spredefinedreason","label","password","screenData","validateEsignforApproval","viewFile","filedata","userinfo","classUrl","methodUrl","screenName","showMore","subFields","LABEL","genericLabel","slanguagetypecode","VALUE","nformcode","SAMPLEREGISTRATION","moreField","isneedHeader","isneedReport","nsubsampleneed","unshift","addFileId","controlMap","has","addName","get","ncontrolcode","editFileId","editName","deleteFileId","deleteName","viewFileId","viewName","mandatoryFields","nattachmenttypecode","LINK","push","userRoleControlRights","indexOf","ncontrolCode","modalName","masterList","masterAlertStatus","attachments","deleteParam","editParam","fetchRecord","mainField","settings","masterStatus","linkMaster","editFiles","selectedListName","displayName","previousProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Nav } from 'react-bootstrap';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { FormattedMessage, injectIntl } from 'react-intl';\r\nimport { faPlus } from '@fortawesome/free-solid-svg-icons';\r\nimport ListAttachment from '../../../components/ListAttachment';\r\nimport SlideOutModal from '../../../components/slide-out-modal/SlideOutModal';\r\nimport { DEFAULT_RETURN } from '../../../actions/LoginTypes';\r\nimport AddAttachment from './AddAttachment';\r\nimport {\r\n    updateStore, getAttachmentCombo, validateEsignCredential, crudMaster, viewAttachment, deleteAttachment\r\n} from '../../../actions'\r\nimport { connect } from 'react-redux';\r\nimport { attachmentType, designProperties, transactionStatus } from '../../../components/Enumeration';\r\nimport Esign from '../../audittrail/Esign';\r\nimport { QUALISFORMS } from '../../../components/Enumeration';\r\nimport { deleteAttachmentDropZone, onDropAttachFileList,  Lims_JSON_stringify } from '../../../components/CommonScript';\r\n\r\nconst mapStateToProps = state => {\r\n    return ({ Login: state.Login })\r\n}\r\nclass Attachments extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            showMore: {},\r\n            selectedRecord: {}\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        let subFields = this.props.subFields ? this.props.subFields : [\r\n            ({\r\n                [designProperties.LABEL]: `${this.props.Login.screenName === 'IDS_TESTATTACHMENTS' ? 'IDS_TESTNAME' :\r\n                    this.props.Login.screenName === 'IDS_SUBSAMPLEATTACHMENTS'\r\n                        ? this.props.Login.genericLabel ? this.props.Login.genericLabel[\"SubARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_SAMPLEARNO\" \r\n                        : this.props.Login.genericLabel ? this.props.Login.genericLabel[\"ARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_ARNO\"}`\r\n            }),\r\n            {\r\n                [designProperties.VALUE]: `${this.props.screenName === 'IDS_SAMPLEATTACHMENTS'\r\n                    ? this.props.Login.userInfo && this.props.Login.userInfo.nformcode === QUALISFORMS.SAMPLEREGISTRATION\r\n                        ? \"groupingField\" : \"sarno\"\r\n                    : this.props.Login.screenName === 'IDS_SUBSAMPLEATTACHMENTS'\r\n                        ? this.props.Login.userInfo && this.props.Login.userInfo.nformcode === QUALISFORMS.SAMPLEREGISTRATION ?\r\n                            \"groupingField2\" : \"ssamplearno\" :\r\n                        \"stestsynonym\"}`\r\n            },\r\n            { [designProperties.VALUE]: \"screateddate\" },\r\n            // { [designProperties.VALUE]: \"nfilesize\", \"fieldType\": \"size\" }\r\n        ];\r\n        let moreField = this.props.moreField ? this.props.moreField : [\r\n            { [designProperties.LABEL]: \"IDS_SCREENNAME\", [designProperties.VALUE]: \"sdisplayname\" },\r\n            { [designProperties.LABEL]: \"IDS_USERNAME\", [designProperties.VALUE]: \"susername\" },\r\n            { [designProperties.LABEL]: \"IDS_USERROLE\", [designProperties.VALUE]: \"suserrolename\" },\r\n            this.props.isneedHeader  ? this.props.isneedHeader &&\r\n            { [designProperties.LABEL]: \"IDS_HEADER\", [designProperties.VALUE]: \"sheader\" } :\"\",\r\n            { [designProperties.LABEL]: \"IDS_DESCRIPTION\", [designProperties.VALUE]: \"sdescription\" },\r\n            this.props.isneedReport  ? this.props.isneedReport &&\r\n            { [designProperties.LABEL]: \"IDS_INCULDEINREPORT\", [designProperties.VALUE]: \"sneedreport\" } :\"\"\r\n        ];\r\n        if (this.props.screenName === 'IDS_TESTATTACHMENTS') {\r\n            if (this.props.nsubsampleneed === true) {\r\n                if (this.props.moreField === undefined  ) {\r\n                    moreField.unshift({\r\n                        [designProperties.LABEL]: this.props.Login.genericLabel ? this.props.Login.genericLabel[\"SubARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_SAMPLEARNO\",\r\n                        [designProperties.VALUE]: \"groupingField2\"\r\n                    })\r\n                };\r\n            }\r\n\r\n            if (this.props.moreField === undefined ) {\r\n                moreField.unshift({\r\n                    //  [designProperties.LABEL]: this.props.nsubsampleneed && `${this.props.nsubsampleneed.nneedsubsample ? \"IDS_SAMPLEARNO\" : \"IDS_ARNO\"}`, \r\n                    //  [designProperties.VALUE]: this.props.nsubsampleneed && `${this.props.nsubsampleneed.nneedsubsample ? \"ssamplearno\" : \"sarno\"}`\r\n                    [designProperties.LABEL]: this.props.Login.genericLabel ? this.props.Login.genericLabel[\"ARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_ARNO\",\r\n                    [designProperties.VALUE]: \"groupingField1\"\r\n                })\r\n            };\r\n        }\r\n        let addFileId = this.props.controlMap.has(this.props.addName) && this.props.controlMap.get(this.props.addName).ncontrolcode;\r\n        let editFileId = this.props.controlMap.has(this.props.editName) && this.props.controlMap.get(this.props.editName).ncontrolcode;\r\n        let deleteFileId = this.props.controlMap.has(this.props.deleteName) && this.props.controlMap.get(this.props.deleteName).ncontrolcode;\r\n        let viewFileId = this.props.controlMap.has(this.props.viewName) && this.props.controlMap.get(this.props.viewName).ncontrolcode;\r\n        let mandatoryFields = [];\r\n        if (this.state.selectedRecord && this.state.selectedRecord.nattachmenttypecode === attachmentType.LINK) {\r\n            mandatoryFields.push(\r\n                { \"idsName\": \"IDS_FILENAME\", \"dataField\": \"slinkfilename\", \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" },\r\n                { \"idsName\": \"IDS_LINKNAME\", \"dataField\": \"nlinkcode\", \"mandatoryLabel\": \"IDS_ENTER\", \"controlType\": \"textbox\" })\r\n        } else {\r\n            // if (this.props.Login.operation !== 'update') {\r\n            mandatoryFields.push(\r\n                { \"idsName\": \"IDS_FILE\", \"dataField\": \"sfilename\", \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" },\r\n            );\r\n            // if(this.props.isneedHeader){\r\n            //     mandatoryFields.push(\r\n            //         { \"idsName\": \"IDS_HEADER\", \"dataField\": \"sheader\", \"mandatoryLabel\": \"IDS_ENTER\", \"controlType\": \"textbox\" })       \r\n            // }\r\n            // }\r\n        }\r\n        return (\r\n            <>\r\n                <div className=\"actions-stripe border-bottom\">\r\n                    <div className=\"d-flex justify-content-end\">\r\n                        <Nav.Link name={`add_${this.props.Login.screenName}_file`} className=\"add-txt-btn\" hidden={this.props.userRoleControlRights.indexOf(addFileId) === -1}\r\n                            onClick={() => this.props.getAttachmentCombo({ userInfo: this.props.Login.userInfo, operation: \"create\", ncontrolCode: addFileId, screenName: this.props.screenName, modalName: \"openAttachmentModal\", masterList: this.props.masterList, masterAlertStatus: this.props.masterAlertStatus })}>\r\n                            <FontAwesomeIcon icon={faPlus} /> { }\r\n                            <FormattedMessage id=\"IDS_ATTACHMENT\" defaultMessage=\"Attachment\" />\r\n                        </Nav.Link>\r\n                    </div>\r\n                </div>\r\n                <ListAttachment\r\n                    attachmentList={this.props.attachments}\r\n                    fileName=\"sfilename\"\r\n                    filesize=\"nfilesize\"\r\n                    linkname=\"slinkname\"\r\n                    isjsonfield={true}\r\n                    jsonfield=\"jsondata\"\r\n                    deleteRecord={this.props.deleteAttachment}\r\n                    deleteParam={this.props.deleteParam}\r\n                    editParam={{ ...this.props.editParam, operation: \"update\", ncontrolCode: editFileId, screenName: this.props.screenName, modalName: \"openAttachmentModal\", masterList: this.props.masterList, masterAlertStatus: this.props.masterAlertStatus }}\r\n                    fetchRecord={this.props.fetchRecord}\r\n                    deleteId={deleteFileId}\r\n                    editId={editFileId}\r\n                    viewId={viewFileId}\r\n                    userRoleControlRights={this.props.userRoleControlRights}\r\n                    viewFile={this.viewFile}\r\n                    mainField={this.props.mainField}\r\n                    subFields={subFields}\r\n                    moreField={moreField}\r\n                    hidePaging={false}\r\n                    userInfo={this.props.Login.userInfo}\r\n                    // skip={this.props.skip}\r\n                    // take={this.props.take}\r\n                    settings={this.props.Login.settings}\r\n                />\r\n                {\r\n                    this.props.Login.openAttachmentModal ?\r\n                        <SlideOutModal\r\n                            onSaveClick={this.onSaveClick}\r\n                            operation={this.props.Login.operation}\r\n                            screenName={this.props.Login.screenName}\r\n                            closeModal={this.handleClose}\r\n                            show={this.props.Login.openAttachmentModal}\r\n                            inputParam={this.props.Login.inputParam}\r\n                            esign={this.props.Login.loadEsign}\r\n                            validateEsign={this.validateEsign}\r\n                            masterStatus={this.props.Login.masterStatus}\r\n                            updateStore={this.props.updateStore}\r\n                            selectedRecord={this.state.selectedRecord || {}}\r\n                            mandatoryFields={mandatoryFields}\r\n                            addComponent={this.props.Login.loadEsign ?\r\n                                <Esign\r\n                                    operation={this.props.Login.operation}\r\n                                    onInputOnChange={this.onInputOnChange}\r\n                                    inputParam={this.props.Login.inputParam}\r\n                                    selectedRecord={this.state.selectedRecord || {}}\r\n                                />\r\n                                :\r\n                                <AddAttachment\r\n                                    selectedRecord={this.state.selectedRecord || {}}\r\n                                    onDrop={this.onDropFiles}\r\n                                    deleteAttachment={this.deleteAttachment}\r\n                                    jsonField={'jsondata'}\r\n                                    actionType={this.state.actionType}\r\n                                    linkMaster={this.props.Login.linkMaster}\r\n                                    onInputOnChange={this.onAttachmentInputChange}\r\n                                    editFiles={this.props.Login.editFiles}\r\n                                    onComboChange={this.onComboChange}\r\n                                    maxSize={20}\r\n                                    fileNameLength={this.props.screenName === 'IDS_TESTATTACHMENTS' ? 255 : 150}\r\n                                    maxFiles={this.props.Login.operation === \"update\" ? 1 : 3}\r\n                                    operation={this.props.Login.operation}\r\n                                    selectedListName={this.props.selectedListName}\r\n                                    displayName={this.props.displayName}\r\n                                    masterList={this.props.masterList}\r\n                                    multiple={this.props.Login.operation === \"update\" ? false : true}\r\n                                    isneedReport={this.props.isneedReport || false}\r\n                                    isneedHeader={this.props.isneedHeader||false}\r\n                                />\r\n                            }\r\n                        />\r\n                        : \"\"}\r\n            </>\r\n        );\r\n    }\r\n\r\n    deleteAttachment = (event, file, fieldName) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        selectedRecord[fieldName] = deleteAttachmentDropZone(selectedRecord[fieldName], file)\r\n\r\n        this.setState({\r\n            selectedRecord, actionType: \"delete\" //fileToDelete:file.name \r\n        });\r\n    }\r\n\r\n\r\n    onDropFiles = (attachedFiles, fieldName, maxSize) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        selectedRecord[fieldName] = onDropAttachFileList(selectedRecord[fieldName], attachedFiles, maxSize)\r\n        this.setState({ selectedRecord, actionType: \"new\" });\r\n    }\r\n\r\n\r\n    onAttachmentInputChange = (event, caseNo, optional) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n        switch (caseNo) {\r\n            case 1:\r\n                if (event.target.type === 'radio') {\r\n                    selectedRecord[event.target.name] = event.target.checked === true && optional;\r\n                    // selectedRecord[\"sfilename\"] = \"\";\r\n                } \r\n                else if(event.target.type === 'checkbox')\r\n                {\r\n                    selectedRecord[event.target.name] = event.target.checked == true ? transactionStatus.YES : transactionStatus.NO;\r\n                }\r\n                else {\r\n                    selectedRecord[event.target.name] = event.target.value;\r\n                }\r\n                this.setState({ selectedRecord });\r\n                break;\r\n\r\n            default:\r\n                selectedRecord[event.target.name] = event.target.value;\r\n                this.setState({ selectedRecord });\r\n                break;\r\n        }\r\n    }\r\n    onInputOnChange = (event) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        if (event.target.type === 'checkbox') {\r\n            selectedRecord[event.target.name] = event.target.checked === true ? transactionStatus.YES : transactionStatus.NO;\r\n        }\r\n        else {\r\n            selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n    }\r\n    onComboChange = (comboData, comboName) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n\r\n        if (comboData) {\r\n            selectedRecord[comboName] = comboData;\r\n            this.setState({ selectedRecord });\r\n        } else {\r\n            selectedRecord[comboName] = []\r\n            this.setState({ selectedRecord });\r\n        }\r\n    }\r\n    componentDidUpdate(previousProps) {\r\n        if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n            this.setState({ selectedRecord: this.props.Login.selectedRecord });\r\n        }\r\n    }\r\n    onSaveClick = (saveType, formRef) => {\r\n        // const masterData = this.props.Login.masterData;\r\n        // let inputData = {}\r\n        // let inputParam = {}\r\n        // inputData[\"userinfo\"] = this.props.Login.userInfo;\r\n        // if(this.props.Login.screenName === \"IDS_SAMPLEATTACHMENTS\") {\r\n        //     let saveParam={userInfo:this.props.Login.userInfo,\r\n        //         selectedRecord:this.state.selectedRecord,\r\n        //         masterData:this.props.Login.masterData,\r\n        //         saveType, formRef,\r\n        //         operation:this.props.Login.operation,\r\n        //         selectedMaster:this.props.selectedMaster\r\n        //     }\r\n        //     inputParam = onSaveSampleAttachment(saveParam,this.props.selectedMaster);\r\n        // }else if(this.props.Login.screenName === \"IDS_TESTATTACHMENTS\") {\r\n        //     let saveParam={userInfo:this.props.Login.userInfo,\r\n        //         selectedRecord:this.state.selectedRecord,\r\n        //         masterData:this.props.Login.masterData,\r\n        //         saveType, formRef,\r\n        //         operation:this.props.Login.operation,\r\n        //         selectedMaster:this.props.selectedMaster\r\n        //     }\r\n        //     inputParam = onSaveTestAttachment(saveParam,this.props.selectedMaster);\r\n        this.props.onSaveClick(saveType, formRef, this.state.selectedRecord)\r\n        // }\r\n        // if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolCode)) {\r\n        //     const updateInfo = {\r\n        //         typeName: DEFAULT_RETURN,\r\n        //         data: {\r\n        //             loadEsign: true,\r\n        //             screenData: { inputParam, masterData },\r\n        //             operation: this.props.Login.operation,\r\n        //             screenName: this.props.Login.screenName,\r\n        //         }\r\n        //     }\r\n        //     this.props.updateStore(updateInfo);\r\n        // }\r\n        // else {\r\n        //     this.props.crudMaster(inputParam, masterData, \"openAttachmentModal\");\r\n        // }\r\n    }\r\n    handleClose = () => {\r\n        let loadEsign = this.props.Login.loadEsign;\r\n        let openAttachmentModal = this.props.Login.openAttachmentModal\r\n        let selectedRecord = this.props.Login.selectedRecord;\r\n        let operation = this.props.Login.operation;\r\n        if (this.props.Login.loadEsign) {\r\n            if (this.props.Login.operation === \"delete\") {\r\n                loadEsign = false;\r\n                openAttachmentModal = false;\r\n                selectedRecord = {};\r\n                operation = undefined;\r\n            }\r\n            else {\r\n                loadEsign = false;\r\n                selectedRecord[\"esigncomments\"] = \"\";\r\n                selectedRecord[\"esignpassword\"] = \"\";\r\n                selectedRecord['esignreason'] = '';\r\n\r\n            }\r\n        }\r\n        else {\r\n            openAttachmentModal = false;\r\n            selectedRecord = {};\r\n        }\r\n\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: { openAttachmentModal, loadEsign, selectedRecord, selectedParamId: null, operation }\r\n        }\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n    validateEsign = () => {\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": {\r\n                    ...this.props.Login.userInfo, \r\n                    sformname: Lims_JSON_stringify(this.props.Login.userInfo.sformname),\r\n                    smodulename: Lims_JSON_stringify(this.props.Login.userInfo.smodulename),\r\n                    slanguagename: Lims_JSON_stringify(this.props.Login.userInfo.slanguagename),\r\n                    sreason: this.state.selectedRecord[\"esigncomments\"],\r\n                    nreasoncode:this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\r\n                    spredefinedreason:this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label,\r\n               \r\n                },\r\n                password: this.state.selectedRecord[\"esignpassword\"]\r\n            },\r\n            screenData: this.props.Login.screenData\r\n        }\r\n        if (this.props.Login.operation === 'dynamic') {\r\n            this.props.validateEsignforApproval(inputParam, \"openChildModal\");\r\n        } else {\r\n            this.props.validateEsignCredential(inputParam, \"openAttachmentModal\");\r\n        }\r\n    }\r\n    viewFile = (filedata) => {\r\n        const inputParam = {\r\n            inputData: {\r\n                file: filedata,\r\n                userinfo: this.props.Login.userInfo\r\n            },\r\n            classUrl: \"attachment\",\r\n            operation: \"view\",\r\n            methodUrl: this.props.methodUrl,\r\n            screenName: this.props.Login.screenName\r\n        }\r\n        this.props.viewAttachment(inputParam);\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, {\r\n    updateStore, viewAttachment, validateEsignCredential, crudMaster, getAttachmentCombo, deleteAttachment\r\n})(injectIntl(Attachments));"]},"metadata":{},"sourceType":"module"}