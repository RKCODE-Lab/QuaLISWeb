{"ast":null,"code":"import rsapi from '../rsapi';\nimport Axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { filterRecordBasedOnTwoArrays, sortData, rearrangeDateFormat, convertDateTimetoString, fillRecordBasedOnCheckBoxSelection, getRecordBasedOnPrimaryKeyName, updatedObjectWithNewElement, replaceUpdatedObject, parentChildComboLoad, getSameRecordFromTwoArrays, constructjsonOptionList, constructjsonOptionDefault, childComboLoad } from '../components/CommonScript';\nimport { DEFAULT_RETURN } from './LoginTypes';\nimport { intl } from '../components/App';\nimport { initRequest } from './LoginAction';\nimport { RegistrationSubType, RegistrationType, transactionStatus } from '../components/Enumeration';\nimport { crudMaster, postCRUDOrganiseTransSearch } from './ServiceAction';\nimport { getTestChildTabDetail } from './index.js';\nimport { constructOptionList } from '../components/CommonScript';\nexport function getSampleTypeChange(Map, masterData, event, labelname) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"/registration/getRegTypeBySampleType\", Map).then(response => {\n      masterData = { ...masterData,\n        ...response.data,\n        [labelname]: { ...event.item\n        }\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport function getRegTypeChange(Map, masterData, event, labelname) {\n  return function (dispatch) {\n    rsapi.post(\"/registration/getRegSubTypeByRegType\", Map).then(response => {\n      // const RegistrationSubType = response.data[\"RegistrationSubType\"];\n      //  console.log(response.data);\n      // RegistrationSubType.length > 0 ?\n      //     selectedRecord[\"nregsubtypecode\"] = {\n      //         \"value\": RegistrationSubType[0].nregsubtypecode,\n      //         \"label\": RegistrationSubType[0].sregsubtypename\n      //     } : selectedRecord[\"nregsubtypecode\"] = \"\";\n      // const [labelname] = event.item;\n      masterData = { ...masterData,\n        ...response.data,\n        [labelname]: { ...event.item\n        }\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport function getRegSubTypeChange(Map, masterData, event, labelname) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"/registration/getRegSubTypeByRegType\", Map).then(response => {\n      masterData = { ...masterData,\n        ...response.data,\n        [labelname]: { ...event.item\n        }\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport function getComponentTestBySpec(Map, selectedRecord, masterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"/registration/getComponentTestBySpec\", Map).then(response => {\n      const {\n        Component,\n        Test\n      } = response.data;\n      let slno = Component.length > 0 ? Component[0].slno : -1;\n      let selectedComponent = Component.length > 0 ? Component[0] : undefined;\n      let SelectedTest = [];\n      let SelectedSource = [];\n\n      if (Object.keys(Test).length > 0) {\n        SelectedTest = Test[slno];\n      }\n\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          Component,\n          Test,\n          SelectedTest,\n          selectedComponent,\n          loading: false,\n          SelectedSource,\n          selectedRecord,\n          popUptestDataState: {\n            skip: 0,\n            take: 10\n          },\n          Source: []\n        }\n      });\n    }).catch(error => {\n      // console.log(error);\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport function getTestfromDB(objComponent, LoginProps, nflag) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    let component = { ...objComponent\n    };\n    component[\"ncomponentcode\"] = objComponent[\"ncomponentcode\"] ? objComponent[\"ncomponentcode\"].value : -1;\n    component[\"nstoragelocationcode\"] = objComponent[\"nstoragelocationcode\"] ? objComponent[\"nstoragelocationcode\"].value : -1;\n    component[\"nstorageconditioncode\"] = objComponent[\"nstorageconditioncode\"] ? objComponent[\"nstorageconditioncode\"].value : -1;\n    component[\"slno\"] = LoginProps.Component ? Object.keys(LoginProps.Component).length + 1 : 0;\n    component[\"scomponentname\"] = objComponent[\"ncomponentcode\"].label;\n    component[\"sstoragelocationname\"] = objComponent[\"nstoragelocationcode\"] && objComponent[\"nstoragelocationcode\"].label ? objComponent[\"nstoragelocationcode\"].label : \"\";\n    component[\"sstorageconditionname\"] = objComponent[\"nstorageconditioncode\"] && objComponent[\"nstorageconditioncode\"].label ? objComponent[\"nstorageconditioncode\"].label : \"\";\n    component[\"ntzdmanufdate\"] = objComponent[\"ntzdmanufdate\"] ? objComponent[\"ntzdmanufdate\"].value : -1;\n    component[\"ntzdreceivedate\"] = objComponent[\"ntzdreceivedate\"] ? objComponent[\"ntzdreceivedate\"].value : -1;\n    component[\"stzdreceivedate\"] = objComponent[\"ntzdreceivedate\"] ? objComponent[\"ntzdreceivedate\"].label : \"\";\n    component[\"nplasmafilecode\"] = objComponent[\"nplasmafilecode\"] ? objComponent[\"nplasmafilecode\"].value : -1;\n    component[\"splasmafilenumber\"] = objComponent[\"nplasmafilecode\"] ? objComponent[\"nplasmafilecode\"].label : \"\";\n    const dreceiveddate = objComponent[\"dreceiveddate\"];\n    component[\"dreceiveddate\"] = dreceiveddate; //formatInputDate(objComponent[\"dreceiveddate\"], false);\n\n    component[\"sreceiveddate\"] = convertDateTimetoString(dreceiveddate, LoginProps.userInfo); //formatInputDateWithoutT(objComponent[\"dreceiveddate\"], false);//formatDate(objComponent[\"sreceiveddate\"]);\n    // rsapi.post(\"/registration/getTestfromDB\", { \"Component\": component })\n\n    rsapi.post(\"/registration/getTestfromDB\", {\n      nspecsampletypecode: component.nspecsampletypecode,\n      slno: component.slno\n    }).then(response => {\n      let TestData = response.data;\n      let slno = component.slno;\n      let SelectedTest = [];\n      let loadComponent = true;\n      let selectComponent = {};\n      let showSaveContinue = true;\n      let SelectedSource = []; // let openChildModal = true;\n\n      let selectedComponent = undefined;\n      let parentPopUpSize = \"lg\"; // selectComponent = objComponent\n\n      if (nflag === 1) {\n        loadComponent = true;\n        objComponent[\"smanuflotno\"] = \"\";\n        objComponent[\"dreceiveddate\"] = rearrangeDateFormat(LoginProps.userInfo, LoginProps.CurrentTime); //new Date(LoginProps.CurrentTime);\n\n        objComponent[\"sreceiveddate\"] = rearrangeDateFormat(LoginProps.userInfo, LoginProps.CurrentTime); //new Date(LoginProps.CurrentTime);\n\n        selectComponent = objComponent;\n      } else {\n        loadComponent = false;\n        parentPopUpSize = \"xl\"; // openChildModal = false;\n\n        showSaveContinue = false;\n        selectComponent = undefined;\n      }\n\n      let Test = LoginProps.Test || [];\n      let Component = LoginProps.Component || [];\n      Component.unshift(component);\n      selectedComponent = component;\n      Test[slno] = response.data;\n      SelectedTest = TestData;\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          Component,\n          Test,\n          SelectedTest,\n          selectComponent,\n          selectedComponent,\n          loadComponent,\n          showSaveContinue,\n          parentPopUpSize,\n          loading: false,\n          SelectedSource\n        }\n      }); // console.log(response.data);\n    }).catch(error => {\n      //   console.log(error);\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport function EditComponent(Map, component, userInfo) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    let urlArray = [];\n    const ComponentTestBySpec = rsapi.post(\"/registration/getComponentBySpec\", Map);\n    const timezone = rsapi.post(\"timezone/getTimeZone\");\n    urlArray = [ComponentTestBySpec, timezone];\n    Axios.all(urlArray).then(response => {\n      const lstComponentMap = constructOptionList(response[0].data.lstComponent || [], \"ncomponentcode\", \"scomponentname\", undefined, undefined, true);\n      const timeZoneListMap = constructOptionList(response[1].data || [], \"ntimezonecode\", \"stimezoneid\", undefined, undefined, true);\n      const TimeZoneField = response[1].data;\n      const lstComponent = lstComponentMap.get(\"OptionList\");\n      const timeZoneList = timeZoneListMap.get(\"OptionList\");\n      component[\"ncomponentcode\"] = {\n        label: component.scomponentname,\n        value: component.ncomponentcode\n      };\n      component[\"dreceiveddate\"] = rearrangeDateFormat(userInfo, component[\"sreceiveddate\"]);\n      component[\"scomments\"] = component[\"scomments\"];\n      let ntzdreceivedate = component.ntzdreceivedate;\n\n      if (component.ntzdreceivedate !== null && typeof component.ntzdreceivedate === \"object\") {\n        ntzdreceivedate = component.ntzdreceivedate.value;\n      }\n\n      component[\"ntzdreceivedate\"] = component.ntzdreceivedate ? {\n        \"label\": TimeZoneField[TimeZoneField.findIndex(x => x.ntimezonecode === ntzdreceivedate)].stimezoneid,\n        \"value\": TimeZoneField[TimeZoneField.findIndex(x => x.ntimezonecode === ntzdreceivedate)].ntimezonecode\n      } : \"\";\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loadComponent: true,\n          childoperation: \"update\",\n          lstComponent,\n          ChildscreenName: \"Component\",\n          openChildModal: false,\n          selectComponent: component,\n          parentPopUpSize: \"lg\",\n          timeZoneList,\n          loading: false\n        }\n      });\n    }).catch(error => {\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport function ReloadData(inputData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"registration/getRegistrationByFilterSubmit\", { ...inputData.inputData\n    }).then(response => {\n      let masterData = { ...inputData.masterData,\n        ...response.data\n      };\n\n      if (inputData.searchSampleRef !== undefined && inputData.searchSampleRef.current !== null) {\n        inputData.searchSampleRef.current.value = \"\";\n        masterData['searchedSample'] = undefined;\n      }\n\n      if (inputData.searchSubSampleRef !== undefined && inputData.searchSubSampleRef.current !== null) {\n        inputData.searchSubSampleRef.current.value = \"\";\n        masterData['searchedSubSample'] = undefined;\n      }\n\n      if (inputData.searchTestRef !== undefined && inputData.searchTestRef.current !== null) {\n        inputData.searchTestRef.current.value = \"\"; //masterData['searchedTests'] = undefined\n\n        masterData['searchedTest'] = undefined;\n      } // let selectedFilter = inputData.selectedFilter;\n      // selectedFilter[\"fromdate\"] = \"\";\n      // selectedFilter[\"todate\"] = \"\";\n\n\n      sortData(masterData);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          loading: false,\n          showFilter: false,\n          skip: 0,\n          testskip: 0,\n          take: undefined,\n          testtake: undefined,\n          showSample: undefined //selectedFilter\n\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getTreeByProduct(Map, selectedRecord, comboData, inputParam) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"/registration/getTreeByProduct\", Map).then(response => {\n      let {\n        Specification,\n        AgaramTree,\n        ActiveKey,\n        FocusKey,\n        OpenNodes,\n        Manufacturer\n      } = [];\n      const selectedSpec = {};\n\n      if (response.data[\"rtn\"] === true) {\n        Specification = constructOptionList(response.data[\"Specification\"] || [], \"nallottedspeccode\", \"sspecname\", undefined, undefined, true).get(\"OptionList\");\n        AgaramTree = response.data[\"AgaramTree\"];\n        ActiveKey = response.data[\"ActiveKey\"];\n        FocusKey = response.data[\"FocusKey\"];\n        OpenNodes = response.data[\"OpenNodes\"]; //Manufacturer = response.data[\"Manufacturer\"];\n\n        selectedSpec[\"nallottedspeccode\"] = Specification.length > 0 ? {\n          \"value\": Specification[0].value,\n          \"label\": Specification[0].label,\n          \"item\": Specification[0].item\n        } : \"\";\n        selectedSpec[\"sversion\"] = Specification.length > 0 ? Specification[0].item.sversion : \"\";\n        selectedSpec[\"ntemplatemanipulationcode\"] = Specification.length > 0 ? Specification[0].item.ntemplatemanipulationcode : -1;\n      }\n\n      selectedRecord = { ...selectedRecord,\n        ...selectedSpec\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          Specification,\n          selectedRecord,\n          AgaramTree,\n          ActiveKey,\n          FocusKey,\n          OpenNodes,\n          Test: [],\n          SelectedTest: [],\n          loading: false,\n          comboData,\n          ...inputParam,\n          selectedSpec,\n          Component: [],\n          selectComponent: {},\n          selectedComponent: {}\n        }\n      });\n    }).catch(error => {\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport const getNewRegSpecification = (inputParam, masterData) => {\n  return dispatch => {\n    if (inputParam.selectedNode !== null) {\n      dispatch(initRequest(true));\n      rsapi.post(\"/registration/\" + inputParam.operation + inputParam.methodUrl, { ...inputParam,\n        ntreetemplatemanipulationcode: inputParam.selectedNode.ntemplatemanipulationcode\n      }).then(response => {\n        sortData(response.data);\n        let Specification = constructOptionList(response.data || [], \"nallottedspeccode\", \"sspecname\", false, false, true).get(\"OptionList\");\n        let selectedComponent = undefined;\n        inputParam.selectedRecord[\"nallottedspeccode\"] = Specification.length > 0 ? {\n          value: Specification[0].value,\n          label: Specification[0].label,\n          item: Specification[0].item\n        } : \"\";\n        inputParam.selectedRecord[\"sversion\"] = Specification.length > 0 ? Specification[0].item.sversion : \"\";\n        inputParam.selectedRecord[\"ntemplatemanipulationcode\"] = Specification.length > 0 ? Specification[0].item.ntemplatemanipulationcode : -1;\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            ActiveKey: inputParam.activeKey,\n            FocusKey: inputParam.focusKey,\n            primaryKey: inputParam.primaryKey,\n            Specification: Specification,\n            selectedNode: inputParam.selectedNode,\n            selectedRecord: inputParam.selectedRecord,\n            Test: [],\n            selectedComponent,\n            SelectedTest: [],\n            loading: false,\n            showSample: undefined\n          }\n        });\n      }).catch(error => {\n        if (error.response.status === 409 || error.response.status === 417) {\n          toast.warn(error.response.data);\n        } else {\n          toast.error(error.message);\n        }\n      });\n    }\n  };\n};\nexport function AddComponents(Map) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    let urlArray = [];\n    const ComponentTestBySpec = rsapi.post(\"/registration/getComponentBySpec\", Map);\n    const timezone = rsapi.post(\"timezone/getTimeZone\");\n    urlArray = [ComponentTestBySpec, timezone];\n    Axios.all(urlArray).then(response => {\n      const lstComponentMap = constructOptionList(response[0].data.lstComponent || [], \"ncomponentcode\", \"scomponentname\", undefined, undefined, true);\n      const timeZoneListMap = constructOptionList(response[1].data || [], \"ntimezonecode\", \"stimezoneid\", undefined, undefined, true);\n      const lstComponent = lstComponentMap.get(\"OptionList\");\n      const timeZoneList = timeZoneListMap.get(\"OptionList\");\n      let dreceiveddate = null;\n      if (lstComponent[0].item.sreceiveddate) dreceiveddate = rearrangeDateFormat(Map[\"userinfo\"], lstComponent[0].item.sreceiveddate); //new Date(lstComponent[0].item.sreceiveddate);//|| [];\n\n      let selectComponent = {\n        sreceiveddate: dreceiveddate,\n        dreceiveddate,\n        ntzdreceivedate: {\n          \"label\": Map[\"userinfo\"].stimezoneid,\n          \"value\": Map[\"userinfo\"].ntimezonecode\n        },\n        stzdreceivedate: Map[\"userinfo\"].stimezoneid,\n        scomments: \"\",\n        nallottedspeccode: lstComponent[0].item.nallottedspeccode\n      };\n      let CurrentTime = dreceiveddate;\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loadComponent: true,\n          lstComponent,\n          dreceiveddate,\n          ChildscreenName: \"Component\",\n          showSaveContinue: true,\n          openChildModal: false,\n          childoperation: \"create\",\n          selectComponent,\n          parentPopUpSize: \"lg\",\n          CurrentTime,\n          timeZoneList,\n          loading: false,\n          openPortal: true,\n          openModal: false\n        }\n      });\n    }).catch(error => {\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport function getTest(objComponent, LoginProps, nneedsubsample, specBasedComponent) {\n  return function (dispatch) {\n    if (Object.keys(objComponent).length > 0) {\n      dispatch(initRequest(true));\n      rsapi.post(\"/registration/getTestfromDB\", {\n        nspecsampletypecode: objComponent.nspecsampletypecode,\n        slno: objComponent.slno,\n        nneedsubsample: nneedsubsample,\n        nallottedspeccode: objComponent.nallottedspeccode,\n        specBasedComponent: specBasedComponent\n      }).then(response => {\n        let TestData = response.data;\n        let Test = LoginProps.Test || [];\n        let componentTest = Test[objComponent.slno] ? Test[objComponent.slno] : [];\n        const TestCombined = filterRecordBasedOnTwoArrays(TestData, componentTest, \"ntestgrouptestcode\"); // const lstComponentMap = constructOptionList(TestCombined|| [], \"ntestgrouptestcode\",\n        //\"stestsynonym\", undefined, undefined, true);\n\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            TestCombined,\n            loadTest: true,\n            openChildModal: false,\n            ChildscreenName: \"Test\",\n            childoperation: \"create\",\n            parentPopUpSize: \"lg\",\n            loading: false\n          }\n        });\n      }).catch(error => {\n        toast.error(error.message);\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n      });\n    } else {\n      toast.warn(intl.formatMessage({\n        id: \"IDS_SELECTCOMPONENTTOADDTEST\"\n      }));\n    }\n  };\n}\nexport function addsubSample(masterData, userinfo, columnList, selectComponent, childColumnList, SubSamplecomboComponents, SubSamplewithoutCombocomponent, specBasedComponent, Map, Component, isServiceRequired, SubSamplecomboData) {\n  if (isServiceRequired) {\n    return function (dispatch) {\n      dispatch(initRequest(true));\n      const urlArray = [];\n      const actualService = rsapi.post(\"dynamicpreregdesign/getComboValues\", {\n        parentcolumnlist: columnList,\n        childcolumnlist: childColumnList,\n        userinfo\n      });\n      urlArray[0] = actualService;\n\n      if (specBasedComponent === 4) {\n        Component = Component ? Component : [];\n        const TestGet = rsapi.post(\"/registration/getTestfromDB\", {\n          nallottedspeccode: Map[\"nallottedspeccode\"],\n          slno: Component ? Object.keys(Component).length + 1 : 1,\n          //nneedsubsample: nneedsubsample,\n          // nallottedspeccode: objComponent.nallottedspeccode,\n          specBasedComponent: specBasedComponent\n        });\n        urlArray[1] = TestGet;\n      }\n\n      Axios.all(urlArray).then(response => {\n        const newcomboData = parentChildComboLoad(columnList, response[0].data, selectComponent, childColumnList, SubSamplewithoutCombocomponent);\n        let TestCombined = [];\n\n        if (specBasedComponent === 4) {\n          TestCombined = response[1].data;\n        }\n\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            ChildscreenName: \"SubSample\",\n            showSaveContinue: true,\n            openChildModal: false,\n            childoperation: \"create\",\n            parentPopUpSize: \"lg\",\n            loading: false,\n            lstComponent: [],\n            openPortal: true,\n            openModal: false,\n            operation: \"create\",\n            loadSubSample: true,\n            selectComponent: newcomboData.selectedRecord,\n            SubSamplecomboData: newcomboData.comboData,\n            SubSamplecomboComponents,\n            SubSamplewithoutCombocomponent,\n            TestCombined,\n            parentSubSampleColumnList: columnList\n          }\n        });\n      }).catch(error => {\n        toast.error(error.message);\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n      });\n    };\n  } else {\n    const newcomboData = parentChildComboLoad(columnList, SubSamplecomboData, selectComponent, childColumnList, SubSamplewithoutCombocomponent);\n    return dispatch => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          ChildscreenName: \"SubSample\",\n          showSaveContinue: true,\n          openChildModal: false,\n          childoperation: \"create\",\n          parentPopUpSize: \"lg\",\n          loading: false,\n          lstComponent: [],\n          openPortal: true,\n          openModal: false,\n          operation: \"create\",\n          loadSubSample: true,\n          selectComponent: newcomboData.selectedRecord\n        }\n      });\n    };\n  }\n}\nexport function editSubSample(Map, component, userInfo, specBasedComponent) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    let urlArray = [];\n    const Unit = rsapi.post(\"/unit/getUnit\", {\n      userinfo: userInfo\n    });\n    let Componnet = {};\n\n    if (specBasedComponent === 4) {\n      Componnet = rsapi.post(\"/component/getComponent\", {\n        userinfo: userInfo\n      });\n    } else {\n      Componnet = rsapi.post(\"/registration/getComponentBySpec\", Map);\n    }\n\n    urlArray = [Unit, Componnet];\n    Axios.all(urlArray).then(response => {\n      const lstUnitMap = constructOptionList(response[0].data || [], \"nunitcode\", \"sunitname\", undefined, undefined, true);\n      let comp = [];\n\n      if (specBasedComponent === 4) {\n        comp = response[1].data;\n      } else {\n        comp = response[1].data.lstComponent;\n      }\n\n      const lstComponentMap = constructOptionList(comp || [], \"ncomponentcode\", \"scomponentname\", undefined, undefined, true);\n      const lstUnit = lstUnitMap.get(\"OptionList\");\n      const lstComponent = lstComponentMap.get(\"OptionList\");\n      component[\"nunitcode\"] = {\n        label: component.sunitname,\n        value: component.nunitcode\n      };\n      component[\"ssubsamplename\"] = component[\"ssubsamplename\"];\n      component[\"ssampleqty\"] = component[\"ssampleqty\"];\n      component[\"scomments\"] = component[\"scomments\"];\n      component[\"ncomponentcode\"] = {\n        label: component.scomponentname,\n        value: component.ncomponentcode\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loadSubSample: true,\n          childoperation: \"update\",\n          ChildscreenName: \"SubSample\",\n          Unit: lstUnit,\n          openChildModal: false,\n          selectComponent: component,\n          parentPopUpSize: \"lg\",\n          loading: false,\n          lstComponent\n        }\n      });\n    }).catch(error => {\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n    });\n  };\n}\nexport function insertRegistration(inputParam, masterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"/registration/createRegistration\", inputParam.inputData).then(response => {\n      let RegistrationGetSample = updatedObjectWithNewElement(response.data[\"RegistrationGetSample\"], masterData.RegistrationGetSample);\n      let selectedSample = response.data[\"selectedSample\"];\n      let RegistrationGetSubSample = response.data[\"RegistrationGetSubSample\"];\n      let RegistrationGetTest = response.data[\"RegistrationGetTest\"];\n      let selectedSubSample = RegistrationGetSubSample;\n      RegistrationGetTest = sortData(RegistrationGetTest, \"npreregno\", \"desc\");\n      let selectedTest = response.data[\"selectedTest\"];\n      ;\n\n      if (inputParam.nneedsubsample === 3) {\n        RegistrationGetSubSample = response.data[\"RegistrationGetSubSample\"];\n        selectedSubSample = response.data[\"selectedSubSample\"];\n      }\n\n      if (inputParam.multipleselectionFlag) {\n        selectedSample = updatedObjectWithNewElement(response.data[\"selectedSample\"], masterData.selectedSample);\n        updatedObjectWithNewElement(response.data[\"selectedSubSample\"], masterData.RegistrationGetSubSample);\n        updatedObjectWithNewElement(response.data[\"selectedTest\"], masterData.RegistrationGetTest);\n        RegistrationGetSubSample = masterData.RegistrationGetSubSample;\n        RegistrationGetTest = masterData.RegistrationGetTest;\n      }\n\n      masterData = { ...masterData,\n        ...response.data,\n        selectedSample,\n        selectedSubSample,\n        selectedTest,\n        RegistrationGetSubSample,\n        RegistrationGetTest,\n        RegistrationGetSample\n      };\n      let respObject = {\n        masterData,\n        ...inputParam.inputData,\n        openModal: false,\n        loadEsign: false,\n        showConfirmAlert: false,\n        selectedRecord: undefined,\n        loading: false,\n        loadPreregister: false,\n        showSample: undefined,\n        openPortal: false,\n        selectedSpec: {},\n        selectComponent: {},\n        SelectedTest: {},\n        selectedComponent: {},\n        Component: [],\n        selectedRecord: {},\n        SelectedTest: [],\n        Test: [],\n        selectedComponent: {}\n      };\n      inputParam.postParamList[0]['clearFilter'] = 'yes';\n      dispatch(postCRUDOrganiseTransSearch(inputParam.postParamList, respObject));\n    }).catch(error => {\n      // console.log(error);\n      toast.error(error.message);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false,\n          showConfirmAlert: false\n        }\n      });\n    });\n  };\n}\nexport function getRegistrationSample(inputData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"registration/getRegistrationByFilterSubmit\", { ...inputData.inputData\n    }).then(response => {\n      let masterData = { ...inputData.masterData,\n        ...response.data\n      };\n\n      if (inputData.searchSampleRef !== undefined && inputData.searchSampleRef.current !== null) {\n        inputData.searchSampleRef.current.value = \"\";\n        masterData['searchedSample'] = undefined;\n      }\n\n      if (inputData.searchSubSampleRef !== undefined && inputData.searchSubSampleRef.current !== null) {\n        inputData.searchSubSampleRef.current.value = \"\";\n        masterData['searchedSubSample'] = undefined;\n      }\n\n      if (inputData.searchTestRef !== undefined && inputData.searchTestRef.current !== null) {\n        inputData.searchTestRef.current.value = \"\";\n        masterData['searchedTest'] = undefined;\n      }\n\n      let respObject = {};\n\n      if (inputData.selectedFilter) {\n        respObject = {\n          selectedFilter: { ...inputData.selectedFilter\n          }\n        };\n      }\n\n      sortData(masterData);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          loading: false,\n          showFilter: false,\n          skip: 0,\n          testskip: 0,\n          take: undefined,\n          testtake: undefined,\n          showSample: undefined,\n          ...respObject,\n          activeSampleTab: inputData.inputData.activeSampleTab\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getRegistrationsubSampleDetail(inputData, isServiceRequired) {\n  return function (dispatch) {\n    let inputParamData = {\n      nsampletypecode: inputData.nsampletypecode,\n      nregtypecode: inputData.nregtypecode,\n      nregsubtypecode: inputData.nregsubtypecode,\n      npreregno: inputData.npreregno,\n      ntransactionstatus: inputData.ntransactionstatus,\n      napprovalconfigcode: inputData.napprovalconfigcode,\n      activeTestTab: inputData.activeTestTab,\n      activeSampleTab: inputData.activeSampleTab,\n      userinfo: inputData.userinfo,\n      ndesigntemplatemappingcode: inputData.ndesigntemplatemappingcode,\n      nneedsubsample: inputData.nneedsubsample,\n      checkBoxOperation: inputData.checkBoxOperation\n    };\n    let activeName = \"\";\n    let dataStateName = \"\";\n    const subSample = inputData.nneedsubsample;\n    dispatch(initRequest(true));\n\n    if (isServiceRequired) {\n      rsapi.post(\"registration/getRegistrationSubSample\", inputParamData).then(response => {\n        sortData(response.data);\n        let masterData = {};\n        let skipInfo = {};\n        let oldSelectedTest = inputData.masterData.selectedTest;\n\n        if (subSample === 3) {\n          let oldSelectedSubSample = inputData.masterData.selectedSubSample;\n          fillRecordBasedOnCheckBoxSelection(inputData.masterData, response.data, inputData.childTabsKey, inputData.checkBoxOperation, \"npreregno\", inputData.removeElementFromArray);\n          masterData = { ...inputData.masterData,\n            selectedSample: inputData.selectedSample,\n            selectedPreregno: inputData.npreregno,\n            selectedSubSample: inputData.masterData.RegistrationGetSubSample.length > 0 ? [inputData.masterData.RegistrationGetSubSample[0]] : []\n          };\n\n          if (inputData.checkBoxOperation === 1 || inputData.checkBoxOperation === 7) {\n            const wholeSubSampleList = masterData.RegistrationGetSubSample.map(b => b.ntransactionsamplecode);\n            oldSelectedSubSample.forEach((subsample, index) => {\n              if (!wholeSubSampleList.includes(subsample.ntransactionsamplecode)) {\n                oldSelectedSubSample.splice(index, 1);\n              }\n            });\n\n            if (oldSelectedSubSample.length > 0) {\n              masterData = { ...masterData,\n                selectedSubSample: oldSelectedSubSample\n              };\n            }\n\n            const selectedTest = getSameRecordFromTwoArrays(oldSelectedTest, masterData.selectedSubSample, 'npreregno');\n            masterData = { ...masterData,\n              selectedTest\n            };\n          }\n\n          if (inputData.checkBoxOperation === 3) {\n            masterData = { ...masterData,\n              selectedTest: masterData.RegistrationGetTest.length > 0 ? [masterData.RegistrationGetTest[0]] : []\n            };\n          }\n\n          let {\n            testskip,\n            testtake,\n            subsampleskip,\n            subsampletake\n          } = inputData;\n          let bool = false;\n\n          if (inputData.masterData.RegistrationGetSubSample.length < inputData.subsampleskip) {\n            testskip = 0;\n            subsampleskip = 0;\n            bool = true;\n          }\n\n          if (bool) {\n            skipInfo = {\n              testskip,\n              testtake,\n              subsampleskip,\n              subsampletake\n            };\n          }\n        } else {\n          //let oldSelectedTest = inputData.masterData.selectedTest\n          //  let oldSelectedSubSample = inputData.masterData.selectedSubSample\n          fillRecordBasedOnCheckBoxSelection(inputData.masterData, response.data, inputData.childTabsKey, inputData.checkBoxOperation, \"npreregno\", inputData.removeElementFromArray);\n          masterData = { ...inputData.masterData,\n            selectedSample: inputData.selectedSample,\n            selectedPreregno: inputData.npreregno,\n            selectedTest: inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : [],\n            selectedSubSample: inputData.masterData.RegistrationGetSubSample\n          };\n          let RegistrationTestComment = [];\n          let RegistrationParameter = [];\n\n          if (inputData.checkBoxOperation === 7 || inputData.checkBoxOperation === 1) {\n            const wholeTestList = masterData.RegistrationGetTest.map(b => b.ntransactiontestcode);\n            oldSelectedTest.forEach((test, index) => {\n              if (!wholeTestList.includes(test.ntransactiontestcode)) {\n                oldSelectedTest.splice(index, 1);\n              }\n            });\n            let keepOld = false;\n            let ntransactiontestcode;\n\n            if (oldSelectedTest.length > 0) {\n              keepOld = true;\n              masterData = { ...masterData,\n                selectedTest: oldSelectedTest\n              };\n            } else {\n              ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : \"\";\n            }\n\n            switch (inputData.activeTestTab) {\n              case \"IDS_PARAMETERRESULTS\":\n                RegistrationParameter = keepOld ? inputData.masterData.RegistrationParameter ? inputData.masterData.RegistrationParameter : [] : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\");\n                activeName = \"RegistrationParameter\";\n                dataStateName = \"resultDataState\";\n                break;\n\n              case \"IDS_TESTCOMMENTS\":\n                RegistrationTestComment = keepOld ? inputData.masterData.RegistrationTestComment ? inputData.masterData.RegistrationTestComment : [] : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationTestComment, ntransactiontestcode, \"ntransactiontestcode\");\n                activeName = \"RegistrationTestComment\";\n                dataStateName = \"testCommentDataState\";\n                break;\n\n              default:\n                RegistrationParameter = keepOld ? inputData.masterData.RegistrationParameter ? inputData.masterData.RegistrationParameter : [] : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\");\n                activeName = \"RegistrationParameter\";\n                dataStateName = \"resultDataState\";\n                break;\n            }\n          } else if (inputData.checkBoxOperation === 5) {\n            switch (inputData.activeTestTab) {\n              case \"IDS_TESTCOMMENTS\":\n                let ResponseData = response.data.RegistrationTestComment ? response.data.RegistrationTestComment : [];\n                let RegistrationTestComment1 = [];\n\n                if (inputData.masterData.RegistrationTestComment !== undefined) {\n                  RegistrationTestComment1 = [...inputData.masterData.RegistrationTestComment, ...ResponseData];\n                }\n\n                let ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1;\n                RegistrationTestComment = getRecordBasedOnPrimaryKeyName(RegistrationTestComment1, ntransactiontestcode, \"ntransactiontestcode\");\n                activeName = \"RegistrationTestComment\";\n                dataStateName = \"testCommentDataState\";\n                break;\n\n              case \"IDS_PARAMETERRESULTS\":\n                let resultResponseData = response.data.RegistrationParameter ? response.data.RegistrationParameter : [];\n                let RegistrationParameter1 = [...inputData.masterData.RegistrationParameter, ...resultResponseData];\n                let ntransactiontestcode1 = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1;\n                RegistrationParameter = getRecordBasedOnPrimaryKeyName(RegistrationParameter1, ntransactiontestcode1, \"ntransactiontestcode\");\n                activeName = \"RegistrationParameter\";\n                dataStateName = \"resultDataState\";\n                break;\n\n              default:\n                let ResponseData1 = response.data.RegistrationTestComment ? response.data.RegistrationTestComment : [];\n                let RegistrationTestComment2 = [];\n\n                if (inputData.masterData.RegistrationTestComment !== undefined) {\n                  RegistrationTestComment2 = [...inputData.masterData.RegistrationTestComment, ...ResponseData1];\n                }\n\n                let ntransactionTestCode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1;\n                RegistrationTestComment = getRecordBasedOnPrimaryKeyName(RegistrationTestComment2, ntransactionTestCode, \"ntransactiontestcode\");\n                activeName = \"RegistrationParameter\";\n                dataStateName = \"resultDataState\";\n                break;\n            } // RegistrationTestComment = response.data.RegistrationTestComment ? [...response.data.RegistrationTestComment] : [];\n\n          } else {\n            switch (inputData.activeTestTab) {\n              case \"IDS_TESTCOMMENTS\":\n                RegistrationTestComment = response.data.RegistrationTestComment ? [...response.data.RegistrationTestComment] : [];\n                activeName = \"RegistrationTestComment\";\n                dataStateName = \"testCommentDataState\";\n                break;\n\n              case \"IDS_PARAMETERRESULTS\":\n                RegistrationParameter = response.data.RegistrationParameter ? [...response.data.RegistrationParameter] : [];\n                activeName = \"RegistrationParameter\";\n                dataStateName = \"resultDataState\";\n                break;\n\n              default:\n                RegistrationParameter = response.data.RegistrationParameter ? [...response.data.RegistrationParameter] : [];\n                activeName = \"RegistrationParameter\";\n                dataStateName = \"resultDataState\";\n                break;\n            }\n          }\n\n          masterData['RegistrationTestComment'] = RegistrationTestComment;\n          masterData[\"RegistrationParameter\"] = RegistrationParameter;\n          let {\n            testskip,\n            testtake\n          } = inputData;\n          let bool = false;\n\n          if (inputData.masterData.RegistrationGetTest.length < inputData.testskip) {\n            testskip = 0;\n            bool = true;\n          }\n\n          if (bool) {\n            skipInfo = {\n              testskip,\n              testtake\n            };\n          }\n        }\n\n        if (inputData.masterData.selectedSample && inputData.sampleGridDataState && inputData.masterData.selectedSample.length <= inputData.sampleGridDataState.skip) {\n          skipInfo = { ...skipInfo,\n            sampleGridDataState: { ...inputData.sampleGridDataState,\n              skip: 0,\n              sort: undefined,\n              filter: undefined\n            }\n          };\n        } else {\n          skipInfo = { ...skipInfo,\n            sampleGridDataState: { ...inputData.sampleGridDataState,\n              sort: undefined,\n              filter: undefined\n            }\n          };\n        }\n\n        if (inputData.searchTestRef !== undefined && inputData.searchTestRef.current !== null) {\n          inputData.searchTestRef.current.value = \"\";\n          masterData['searchedTest'] = undefined;\n        }\n\n        let inputParam = {\n          attachmentskip: undefined\n        };\n\n        if (inputData[dataStateName] && masterData[activeName].length <= inputData[dataStateName].skip) {\n          skipInfo = { ...skipInfo,\n            [dataStateName]: { ...inputData[dataStateName],\n              skip: 0,\n              sort: undefined,\n              filter: undefined\n            }\n          };\n        } else {\n          skipInfo = { ...skipInfo,\n            [dataStateName]: { ...inputData[dataStateName],\n              sort: undefined,\n              filter: undefined\n            }\n          };\n        }\n\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            masterData,\n            loading: false,\n            showFilter: false,\n            activeSampleTab: inputData.activeSampleTab,\n            activeTestTab: inputData.activeTestTab,\n            skip: undefined,\n            take: undefined,\n            ...skipInfo,\n            inputParam\n          }\n        });\n      }).catch(error => {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n\n        if (error.response.status === 500) {\n          toast.error(error.message);\n        } else {\n          toast.warn(error.response.data);\n        }\n      });\n    } else {\n      let bool = false;\n      let skipInfo = {};\n      let {\n        testskip,\n        testtake,\n        subsampletake,\n        subsampleskip\n      } = inputData;\n      let oldSelectedTest = inputData.masterData.selectedTest;\n      let oldSelectedSubSample = inputData.masterData.selectedSubSample;\n      let TestSelected = getRecordBasedOnPrimaryKeyName(inputData.masterData.selectedTest, inputData.removeElementFromArray[0].npreregno, \"npreregno\");\n      let isGrandChildGetRequired = false;\n\n      if (TestSelected.length > 0) {\n        isGrandChildGetRequired = true;\n      } else {\n        isGrandChildGetRequired = false;\n      }\n\n      fillRecordBasedOnCheckBoxSelection(inputData.masterData, inputData.selectedSample, inputData.childTabsKey, inputData.checkBoxOperation, \"npreregno\", inputData.removeElementFromArray);\n\n      if (isGrandChildGetRequired) {\n        let selectedSample = inputData.selectedSample;\n        let filterTestSameOldSelectedTest = getSameRecordFromTwoArrays(oldSelectedTest, inputData.masterData.RegistrationGetTest, \"ntransactiontestcode\");\n        let selectedTest = filterTestSameOldSelectedTest.length > 0 ? filterTestSameOldSelectedTest : inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : [];\n        let ntransactiontestcode = selectedTest.length > 0 ? selectedTest.map(x => x.ntransactiontestcode).join(\",\") : \"-1\";\n        let selectedSubSample = inputData.masterData.RegistrationGetSubSample;\n\n        if (subSample === 3) {\n          let filterSelectedSubSample = getSameRecordFromTwoArrays(oldSelectedSubSample, inputData.masterData.RegistrationGetSubSample, \"ntransactionsamplecode\");\n          selectedSubSample = filterSelectedSubSample.length > 0 ? filterSelectedSubSample : [inputData.masterData.RegistrationGetSubSample[0]];\n\n          if (inputData.masterData.RegistrationGetSubSample.length <= inputData.subsampleskip) {\n            subsampleskip = 0;\n            skipInfo = {\n              subsampletake,\n              subsampleskip\n            };\n          }\n        }\n\n        let masterData = { ...inputData.masterData,\n          selectedSample,\n          selectedSubSample,\n          selectedTest\n        };\n\n        if (inputData.masterData.RegistrationGetTest.length <= inputData.testskip) {\n          testskip = 0;\n          bool = true;\n        }\n\n        if (bool) {\n          skipInfo = { ...skipInfo,\n            testskip,\n            testtake\n          };\n        }\n\n        inputData = { ...inputData,\n          childTabsKey: [\"RegistrationTestComment\", \"RegistrationParameter\"],\n          ntransactiontestcode,\n          masterData,\n          selectedTest,\n          selectedSubSample,\n          checkBoxOperation: 3,\n          skipInfo\n        };\n\n        if (subSample === 3) {\n          if (selectedTest.length === 0) {\n            inputData[\"npreregno\"] = selectedSubSample.map(x => x.npreregno).join(\",\");\n            inputData[\"ntransactionsamplecode\"] = selectedSubSample.map(x => x.ntransactionsamplecode).join(\",\");\n            inputData[\"checkBoxOperation\"] = 3;\n            inputData[\"childTabsKey\"] = [\"RegistrationGetTest\"];\n            dispatch(getRegistrationTestDetail(inputData, true));\n          } else {\n            dispatch(getTestChildTabDetail(inputData, true));\n          }\n        } else {\n          dispatch(getTestChildTabDetail(inputData, true));\n        }\n      } else {\n        let masterData = { ...inputData.masterData,\n          selectedSample: inputData.selectedSample,\n          selectedPreregno: inputData.npreregno,\n          selectedTest: inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : [],\n          // RegistrationTestComment,\n          selectedSubSample: inputData.masterData.RegistrationGetSubSample\n        };\n        let subsamplecheck = true;\n\n        if (subSample === 3) {\n          let SubSampleSelected = getRecordBasedOnPrimaryKeyName(inputData.masterData.selectedSubSample, inputData.removeElementFromArray[0].npreregno, \"npreregno\");\n\n          if (SubSampleSelected.length > 0) {\n            let filterSelectedSubSample = getSameRecordFromTwoArrays(oldSelectedSubSample, inputData.masterData.RegistrationGetSubSample, \"ntransactionsamplecode\");\n\n            if (filterSelectedSubSample.length === 0) {\n              let wholeSubSample = masterData.RegistrationGetSubSample.map(b => b.ntransactionsamplecode);\n              oldSelectedSubSample.forEach((test, index) => {\n                if (!wholeSubSample.includes(test.ntransactionsamplecode)) {\n                  oldSelectedSubSample.splice(index, 1);\n                }\n\n                return null;\n              });\n\n              if (oldSelectedSubSample.length === 0 && wholeSubSample.length > 0 && masterData.selectedTest.length === 0) {\n                const selectedSubSample1 = [inputData.masterData.RegistrationGetSubSample[0]];\n                masterData = { ...masterData,\n                  selectedSubSample: selectedSubSample1,\n                  selectedTest: []\n                };\n                inputData = { ...inputData,\n                  ...masterData\n                };\n                inputData[\"npreregno\"] = selectedSubSample1.map(x => x.npreregno).join(\",\");\n                inputData[\"ntransactionsamplecode\"] = selectedSubSample1.map(x => x.ntransactionsamplecode).join(\",\");\n                inputData[\"checkBoxOperation\"] = 3;\n                inputData[\"childTabsKey\"] = [\"RegistrationGetTest\"];\n                subsamplecheck = false;\n                dispatch(getRegistrationTestDetail(inputData, true));\n              }\n            } else {\n              oldSelectedSubSample = filterSelectedSubSample;\n            }\n          } else {\n            let wholeSubSample = masterData.RegistrationGetSubSample.map(b => b.ntransactionsamplecode);\n            oldSelectedSubSample.forEach((test, index) => {\n              if (!wholeSubSample.includes(test.ntransactionsamplecode)) {\n                oldSelectedSubSample.splice(index, 1);\n              }\n\n              return null;\n            });\n          }\n\n          if (subsamplecheck) {\n            masterData = { ...masterData,\n              selectedSubSample: oldSelectedSubSample\n            };\n          }\n\n          if (inputData.masterData.RegistrationGetSubSample.length <= inputData.subsampleskip) {\n            subsampleskip = 0;\n            skipInfo = {\n              subsampleskip,\n              subsampletake\n            };\n          }\n        }\n\n        let wholeTestList = masterData.RegistrationGetTest.map(b => b.ntransactiontestcode);\n        oldSelectedTest.forEach((test, index) => {\n          if (!wholeTestList.includes(test.ntransactiontestcode)) {\n            oldSelectedTest.splice(index, 1);\n          }\n\n          return null;\n        });\n        let keepOld = false;\n        let ntransactiontestcode;\n\n        if (oldSelectedTest.length > 0) {\n          keepOld = true;\n          masterData = { ...masterData,\n            selectedTest: oldSelectedTest\n          };\n        } else {\n          ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : \"-1\";\n        }\n\n        masterData[\"RegistrationTestComment\"] = keepOld ? inputData.masterData.RegistrationTestComment : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationTestComment, ntransactiontestcode, \"ntransactiontestcode\");\n        masterData[\"RegistrationParameter\"] = keepOld ? inputData.masterData.RegistrationParameter : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\");\n        let skipInfo = {};\n\n        if (inputData.masterData.RegistrationGetTest.length <= inputData.testskip) {\n          testskip = 0;\n          bool = true;\n        }\n\n        if (bool) {\n          skipInfo = { ...skipInfo,\n            testskip,\n            testtake\n          };\n        }\n\n        let dataStateArray = [{\n          activeName: 'selectedSample',\n          dataStateName: 'sampleGridDataState'\n        }, {\n          activeName: 'RegistrationSourceCountry',\n          dataStateName: 'sourceDataState'\n        }, {\n          activeName: 'RegistrationTestComment',\n          dataStateName: 'testCommentDataState'\n        }, {\n          activeName: 'RegistrationParameter',\n          dataStateName: 'resultDataState'\n        }];\n        dataStateArray.map(arr => {\n          if (inputData[arr.dataStateName] && masterData[arr.activeName] && masterData[arr.activeName].length <= inputData[arr.dataStateName].skip) {\n            skipInfo = { ...skipInfo,\n              [arr.dataStateName]: { ...inputData[arr.dataStateName],\n                skip: 0,\n                sort: undefined,\n                filter: undefined\n              }\n            };\n          } else {\n            skipInfo = { ...skipInfo,\n              [arr.dataStateName]: { ...inputData[arr.dataStateName],\n                sort: undefined,\n                filter: undefined\n              }\n            };\n          }\n\n          return null;\n        });\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            masterData,\n            loading: false,\n            showFilter: false,\n            activeSampleTab: inputData.activeSampleTab,\n            activeTestTab: inputData.activeTestTab,\n            ...skipInfo\n          }\n        });\n      }\n    }\n  };\n}\nexport function getRegistrationTestDetail(inputData, isServiceRequired) {\n  return function (dispatch) {\n    let inputParamData = {\n      nsampletypecode: inputData.nsampletypecode,\n      nregtypecode: inputData.nregtypecode,\n      nregsubtypecode: inputData.nregsubtypecode,\n      npreregno: inputData.npreregno,\n      ntransactionsamplecode: inputData.ntransactionsamplecode,\n      ntransactionstatus: inputData.ntransactionstatus,\n      napprovalconfigcode: inputData.napprovalconfigcode,\n      activeTestTab: inputData.activeTestTab,\n      activeSampleTab: inputData.activeSampleTab,\n      userinfo: inputData.userinfo,\n      ndesigntemplatemappingcode: inputData.ndesigntemplatemappingcode\n    };\n    let activeName = \"\";\n    let dataStateName = \"\";\n    dispatch(initRequest(true));\n\n    if (isServiceRequired) {\n      rsapi.post(\"registration/getRegistrationTest\", inputParamData).then(response => {\n        sortData(response.data);\n        let oldSelectedTest = inputData.masterData.selectedTest;\n        fillRecordBasedOnCheckBoxSelection(inputData.masterData, response.data, inputData.childTabsKey, inputData.checkBoxOperation, \"ntransactionsamplecode\", inputData.removeElementFromArray);\n        let masterData = { ...inputData.masterData,\n          selectedSubSample: inputData.selectedSubSample,\n          selectedTransactionsamplecode: inputData.ntransactionsamplecode,\n          selectedTest: inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : [] // RegistrationTestComment,\n\n        }; //let wholeRegistrationTestComments = [];\n\n        let RegistrationTestComment = [];\n        let RegistrationParameter = [];\n\n        if (inputData.checkBoxOperation === 1) {\n          const wholeTestList = masterData.RegistrationGetTest.map(b => b.ntransactiontestcode);\n          oldSelectedTest.forEach((test, index) => {\n            if (!wholeTestList.includes(test.ntransactiontestcode)) {\n              oldSelectedTest.splice(index, 1);\n            }\n          });\n          let keepOld = false;\n          let ntransactiontestcode;\n\n          if (oldSelectedTest.length > 0) {\n            keepOld = true;\n            masterData = { ...masterData,\n              selectedTest: oldSelectedTest\n            };\n          } else {\n            ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : \"\";\n          }\n\n          switch (inputData.activeTestTab) {\n            case \"IDS_PARAMETERRESULTS\":\n              RegistrationParameter = keepOld ? inputData.masterData.RegistrationParameter ? inputData.masterData.RegistrationParameter : [] : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\");\n              activeName = \"RegistrationParameter\";\n              dataStateName = \"resultDataState\";\n              break;\n\n            case \"IDS_TESTCOMMENTS\":\n              RegistrationTestComment = keepOld ? inputData.masterData.RegistrationTestComment ? inputData.masterData.RegistrationTestComment : [] : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationTestComment, ntransactiontestcode, \"ntransactiontestcode\");\n              activeName = \"RegistrationTestComment\";\n              dataStateName = \"testCommentDataState\";\n              break;\n\n            default:\n              RegistrationParameter = keepOld ? inputData.masterData.RegistrationParameter ? inputData.masterData.RegistrationParameter : [] : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\");\n              activeName = \"RegistrationParameter\";\n              dataStateName = \"resultDataState\";\n              break;\n          }\n        } else if (inputData.checkBoxOperation === 5) {\n          switch (inputData.activeTestTab) {\n            case \"IDS_TESTCOMMENTS\":\n              let ResponseData = response.data.RegistrationTestComment ? response.data.RegistrationTestComment : [];\n              let RegistrationTestComment1 = [];\n\n              if (inputData.masterData.RegistrationTestComment !== undefined) {\n                RegistrationTestComment1 = [...inputData.masterData.RegistrationTestComment, ...ResponseData];\n              }\n\n              let ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1;\n              RegistrationTestComment = getRecordBasedOnPrimaryKeyName(RegistrationTestComment1, ntransactiontestcode, \"ntransactiontestcode\");\n              activeName = \"RegistrationTestComment\";\n              dataStateName = \"testCommentDataState\";\n              break;\n\n            case \"IDS_PARAMETERRESULTS\":\n              let resultResponseData = response.data.RegistrationParameter ? response.data.RegistrationParameter : [];\n              let RegistrationParameter1 = [...inputData.masterData.RegistrationParameter, ...resultResponseData];\n              let ntransactiontestcode1 = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1;\n              RegistrationParameter = getRecordBasedOnPrimaryKeyName(RegistrationParameter1, ntransactiontestcode1, \"ntransactiontestcode\");\n              activeName = \"RegistrationParameter\";\n              dataStateName = \"resultDataState\";\n              break;\n\n            default:\n              let ResponseData1 = response.data.RegistrationTestComment ? response.data.RegistrationTestComment : [];\n              let RegistrationTestComment2 = [];\n\n              if (inputData.masterData.RegistrationTestComment !== undefined) {\n                RegistrationTestComment2 = [...inputData.masterData.RegistrationTestComment, ...ResponseData1];\n              }\n\n              let ntransactionTestCode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1;\n              RegistrationTestComment = getRecordBasedOnPrimaryKeyName(RegistrationTestComment2, ntransactionTestCode, \"ntransactiontestcode\");\n              activeName = \"RegistrationParameter\";\n              dataStateName = \"resultDataState\";\n              break;\n          } // RegistrationTestComment = response.data.RegistrationTestComment ? [...response.data.RegistrationTestComment] : [];\n\n        } else {\n          switch (inputData.activeTestTab) {\n            case \"IDS_TESTCOMMENTS\":\n              RegistrationTestComment = response.data.RegistrationTestComment ? [...response.data.RegistrationTestComment] : [];\n              activeName = \"RegistrationTestComment\";\n              dataStateName = \"testCommentDataState\";\n              break;\n\n            case \"IDS_PARAMETERRESULTS\":\n              RegistrationParameter = response.data.RegistrationParameter ? [...response.data.RegistrationParameter] : [];\n              activeName = \"RegistrationParameter\";\n              dataStateName = \"resultDataState\";\n              break;\n\n            default:\n              RegistrationParameter = response.data.RegistrationParameter ? [...response.data.RegistrationParameter] : [];\n              activeName = \"RegistrationParameter\";\n              dataStateName = \"resultDataState\";\n              break;\n          }\n        }\n\n        masterData['RegistrationTestComment'] = RegistrationTestComment;\n        masterData[\"RegistrationParameter\"] = RegistrationParameter;\n        let {\n          testskip,\n          testtake\n        } = inputData;\n        let bool = false;\n        let skipInfo = {};\n\n        if (inputData.masterData.RegistrationGetTest.length < inputData.testskip) {\n          testskip = 0;\n          bool = true;\n        }\n\n        if (bool) {\n          skipInfo = {\n            testskip,\n            testtake\n          };\n        }\n\n        if (inputData.masterData.selectedSample && inputData.sampleGridDataState && inputData.masterData.selectedSample.length <= inputData.sampleGridDataState.skip) {\n          skipInfo = { ...skipInfo,\n            sampleGridDataState: { ...inputData.sampleGridDataState,\n              skip: 0,\n              sort: undefined,\n              filter: undefined\n            }\n          };\n        } else {\n          skipInfo = { ...skipInfo,\n            sampleGridDataState: { ...inputData.sampleGridDataState,\n              sort: undefined,\n              filter: undefined\n            }\n          };\n        }\n\n        if (inputData.searchTestRef !== undefined && inputData.searchTestRef.current !== null) {\n          inputData.searchTestRef.current.value = \"\";\n          masterData['searchedTest'] = undefined;\n        }\n\n        let inputParam = {\n          attachmentskip: undefined\n        };\n\n        if (inputData[dataStateName] && masterData[activeName].length <= inputData[dataStateName].skip) {\n          skipInfo = { ...skipInfo,\n            [dataStateName]: { ...inputData[dataStateName],\n              skip: 0,\n              sort: undefined,\n              filter: undefined\n            }\n          };\n        } else {\n          skipInfo = { ...skipInfo,\n            [dataStateName]: { ...inputData[dataStateName],\n              sort: undefined,\n              filter: undefined\n            }\n          };\n        }\n\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            masterData,\n            loading: false,\n            showFilter: false,\n            activeSampleTab: inputData.activeSampleTab,\n            activeTestTab: inputData.activeTestTab,\n            skip: undefined,\n            take: undefined,\n            ...skipInfo,\n            inputParam\n          }\n        });\n      }).catch(error => {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n\n        if (error.response.status === 500) {\n          toast.error(error.message);\n        } else {\n          toast.warn(error.response.data);\n        }\n      });\n    } else {\n      let oldSelectedTest = inputData.masterData.selectedTest;\n      let TestSelected = getRecordBasedOnPrimaryKeyName(inputData.masterData.selectedTest, inputData.removeElementFromArray[0].npreregno, \"npreregno\");\n      let isGrandChildGetRequired = false;\n\n      if (TestSelected.length > 0) {\n        isGrandChildGetRequired = true;\n      } else {\n        isGrandChildGetRequired = false;\n      }\n\n      fillRecordBasedOnCheckBoxSelection(inputData.masterData, inputData.selectedSample, inputData.childTabsKey, inputData.checkBoxOperation, \"npreregno\", inputData.removeElementFromArray);\n\n      if (isGrandChildGetRequired) {\n        let ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode.toString() : \"-1\";\n        let selectedSubSample = inputData.selectedSubSample; // let selectedPreregno = inputData.npreregno;\n\n        let selectedTest = inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : []; // let selectedSubSample = inputData.masterData.RegistrationGetSubSample\n\n        let masterData = { ...inputData.masterData,\n          selectedSubSample,\n          selectedTest\n        };\n        inputData = { ...inputData,\n          childTabsKey: [\"RegistrationTestComment\", \"RegistrationParameter\"],\n          ntransactiontestcode,\n          masterData,\n          selectedTest,\n          selectedSubSample,\n          checkBoxOperation: 3\n        };\n        dispatch(getTestChildTabDetail(inputData, true));\n      } else {\n        let masterData = { ...inputData.masterData,\n          selectedSubSample: inputData.selectedSubSample,\n          selectedTransactioncode: inputData.ntransactionsamplecode,\n          selectedTest: inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : []\n        };\n        const wholeTestList = masterData.RegistrationGetTest.map(b => b.ntransactiontestcode);\n        oldSelectedTest.forEach((test, index) => {\n          if (!wholeTestList.includes(test.ntransactiontestcode)) {\n            oldSelectedTest.splice(index, 1);\n          }\n\n          return null;\n        });\n        let keepOld = false;\n        let ntransactiontestcode;\n\n        if (oldSelectedTest.length > 0) {\n          keepOld = true;\n          masterData = { ...masterData,\n            selectedTest: oldSelectedTest\n          };\n        } else {\n          ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : \"-1\";\n        }\n\n        masterData[\"RegistrationTestComment\"] = keepOld ? inputData.masterData.RegistrationTestComment ? inputData.masterData.RegistrationTestComment : [] : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationTestComment, ntransactiontestcode, \"ntransactiontestcode\");\n        masterData[\"RegistrationParameter\"] = keepOld ? inputData.masterData.RegistrationParameter ? inputData.masterData.RegistrationParameter : [] : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\");\n        let skipInfo = {};\n        let dataStateArray = [{\n          activeName: 'selectedSample',\n          dataStateName: 'sampleGridDataState'\n        }, {\n          activeName: 'RegistrationSourceCountry',\n          dataStateName: 'sourceDataState'\n        }, {\n          activeName: 'RegistrationTestComment',\n          dataStateName: 'testCommentDataState'\n        }, {\n          activeName: 'RegistrationParameter',\n          dataStateName: 'resultDataState'\n        }];\n        dataStateArray.map(arr => {\n          if (inputData[arr.dataStateName] && masterData[arr.activeName] && masterData[arr.activeName].length <= inputData[arr.dataStateName].skip) {\n            skipInfo = { ...skipInfo,\n              [arr.dataStateName]: { ...inputData[arr.dataStateName],\n                skip: 0,\n                sort: undefined,\n                filter: undefined\n              }\n            };\n          } else {\n            skipInfo = { ...skipInfo,\n              [arr.dataStateName]: { ...inputData[arr.dataStateName],\n                sort: undefined,\n                filter: undefined\n              }\n            };\n          }\n\n          return null;\n        });\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            masterData,\n            loading: false,\n            showFilter: false,\n            activeSampleTab: inputData.activeSampleTab,\n            activeTestTab: inputData.activeTestTab,\n            ...skipInfo\n          }\n        });\n      }\n    }\n  };\n}\nexport function acceptRegistration(inputParam, LoginProps) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    rsapi.post(\"/registration/acceptRegistration\", inputParam.inputData).then(response => {\n      if (response.data.rtn === undefined || response.data.rtn === \"Success\" || response.data.rtn === \"IDS_ATLEASTONETESTMUSTBEPREREGISTER\" || response.data.rtn === \"IDS_ALLSAMPLESAREREGISTERED\" || response.data.rtn === \"IDS_SELECTPREREGISTERORQUARANTINESAMPLES\") {\n        replaceUpdatedObject(response.data[\"RegistrationGetSample\"], LoginProps.RegistrationGetSample, \"npreregno\");\n        replaceUpdatedObject(response.data[\"RegistrationGetSubSample\"], LoginProps.RegistrationGetSubSample, \"ntransactionsamplecode\");\n        replaceUpdatedObject(response.data[\"RegistrationGetTest\"], LoginProps.RegistrationGetTest, \"ntransactiontestcode\");\n        delete response.data[\"RegistrationGetSample\"];\n        delete response.data[\"RegistrationGetSubSample\"];\n        delete response.data[\"RegistrationGetTest\"];\n        let masterData = { ...LoginProps,\n          ...response.data,\n          selectedSample: replaceUpdatedObject(response.data[\"selectedSample\"], LoginProps.selectedSample, \"npreregno\"),\n          selectedSubSample: replaceUpdatedObject(response.data[\"selectedSubSample\"], LoginProps.selectedSubSample, \"ntransactionsamplecode\"),\n          selectedTest: replaceUpdatedObject(response.data[\"selectedTest\"], LoginProps.selectedTest, \"ntransactiontestcode\")\n        };\n        let respObject = {\n          masterData,\n          ...inputParam.inputData,\n          loading: false,\n          loadEsign: false,\n          openModal: false,\n          showSample: undefined\n        };\n        dispatch(postCRUDOrganiseTransSearch(inputParam.postParamList, respObject));\n\n        if (response.data.rtn === \"IDS_ATLEASTONETESTMUSTBEPREREGISTER\" || response.data.rtn === \"IDS_ALLSAMPLESAREREGISTERED\" || response.data.rtn === \"IDS_SELECTPREREGISTERORQUARANTINESAMPLES\") {\n          toast.warn(intl.formatMessage({\n            id: response.data.rtn\n          }));\n        }\n      } else {\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false,\n            loadEsign: false,\n            openModal: false\n          }\n        });\n        toast.warn(response.data.rtn);\n      }\n    }).catch(error => {\n      toast.error(error.message);\n    });\n  };\n}\nexport const addMoreTest = (inputParam, ncontrolCode) => {\n  return dispatch => {\n    let {\n      sampleList\n    } = inputParam;\n    let value = false;\n    value = inputParam.selectedsubsample.some(obj => obj.nspecsampletypecode !== inputParam.selectedsubsample[0].nspecsampletypecode);\n\n    if (value) {\n      return toast.warn(intl.formatMessage({\n        id: \"IDS_PLEASESELECTSAMPLEWITHSAMESPECANDCOMPONENT\"\n      }));\n    }\n\n    sampleList = sampleList ? [...sampleList.slice(inputParam.skip, inputParam.take)] : [];\n    const selectedsample = getSameRecordFromTwoArrays(sampleList, inputParam.selectedsample, \"npreregno\");\n    const selectsubsample = getSameRecordFromTwoArrays(sampleList, inputParam.selectedsubsample, \"npreregno\");\n\n    if (selectedsample && selectedsample.length > 0) {\n      const findTransactionStatus = [...new Set(selectedsample.map(item => item.jsondata.ntransactionstatus))];\n\n      if (findTransactionStatus.length === 1) {\n        if (findTransactionStatus[0] !== transactionStatus.REJECT && findTransactionStatus[0] !== transactionStatus.CANCELLED) {\n          if (findTransactionStatus[0] !== transactionStatus.CERTIFIED && findTransactionStatus[0] !== transactionStatus.SENT) {\n            const findApprovalVersion = [...new Set(selectedsample.map(item => item.napprovalversioncode))];\n\n            if (findApprovalVersion.length === 1) {\n              const findSampleSpec = [...new Set(selectedsample.map(item => item.nallottedspeccode))]; //const findComponent = [...new Set(selectsubsample.map(item => item.ncomponentcode))];\n\n              if (findSampleSpec.length === 1) //&& findComponent.length === 1 \n                {\n                  dispatch(initRequest(true));\n                  rsapi.post(\"/registration/getMoreTest\", { ...inputParam\n                  }).then(response => {\n                    dispatch({\n                      type: DEFAULT_RETURN,\n                      payload: {\n                        availableTest: response.data,\n                        loadChildTest: true,\n                        loading: false,\n                        ncontrolCode,\n                        screenName: \"IDS_TEST\",\n                        operation: \"create\",\n                        openModal: true,\n                        parentPopUpSize: \"lg\",\n                        selectedRecord: {},\n                        showSample: undefined\n                      }\n                    });\n                  }).catch(error => {\n                    dispatch({\n                      type: DEFAULT_RETURN,\n                      payload: {\n                        loading: false\n                      }\n                    });\n\n                    if (error.response.status === 500) {\n                      toast.error(error.message);\n                    } else {\n                      toast.warn(this.props.formatMessage({\n                        id: error.response.data\n                      }));\n                    }\n                  });\n                } else {\n                toast.warn(intl.formatMessage({\n                  id: \"IDS_PLEASESELECTSAMPLEWITHSAMESPECANDCOMPONENT\"\n                }));\n              }\n            } else {\n              toast.warn(intl.formatMessage({\n                id: \"IDS_PLEASESELECTSAMPLEWITHSAMEAPPROVALCONFIG\"\n              }));\n            }\n          } else {\n            toast.warn(intl.formatMessage({\n              id: \"IDS_TESTCANNOTBEFORCERTIFIEDSAMPLES\"\n            }));\n          }\n        } else {\n          ////     toast.warn(intl.formatMessage({ id: \"IDS_TESTCANNOTBEFORCANCELLEDREJECTSAMPLES\" }));\n          toast.warn(intl.formatMessage({\n            id: \"IDS_SAMPLEISREJECTEDORCANCELLED\"\n          }));\n        }\n      } else {\n        toast.warn(intl.formatMessage({\n          id: \"IDS_PLEASESELECTSAMPLEWITHSAMESTATUS\"\n        }));\n      }\n    } else {\n      toast.warn(intl.formatMessage({\n        id: \"IDS_SELECTSAMPLE\"\n      }));\n    }\n  };\n};\nexport const createRegistrationTest = (inputParam, masterData, modalName) => {\n  return dispatch => {\n    dispatch(initRequest(true));\n    rsapi.post(inputParam.classUrl + \"/\" + inputParam.operation + inputParam.methodUrl, { ...inputParam.inputData\n    }).then(response => {\n      let RegistrationGetTest = updatedObjectWithNewElement(masterData[\"RegistrationGetTest\"], response.data[\"RegistrationGetTest\"]);\n      masterData = { ...masterData,\n        RegistrationGetTest,\n        selectedTest: response.data[\"RegistrationGetTest\"],\n        RegistrationParameter: response.data.RegistrationParameter // RegistrationGetSample: replaceUpdatedObject(response.data.selectedSample, masterData.RegistrationGetSample, 'npreregno')\n\n      };\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          [modalName]: false,\n          loading: false,\n          loadChildTest: false,\n          showSample: undefined,\n          openModal: false,\n          selectedRecord: {}\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(intl.formatMessage({\n          id: error.response.data\n        }));\n      }\n    });\n  };\n};\nexport function getEditRegistrationComboService(inputParam, columnList, selectedRecord1, childColumnList, comboComponents, withoutCombocomponent) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    const {\n      userInfo,\n      operation\n    } = { ...inputParam\n    };\n    const npreregno = inputParam.mastertoedit[inputParam.primaryKeyName];\n    let urlArray = [];\n    const timeZoneService = rsapi.post(\"timezone/getTimeZone\");\n    const actualService = rsapi.post(\"dynamicpreregdesign/getComboValues\", {\n      parentcolumnlist: columnList,\n      childcolumnlist: childColumnList,\n      userinfo: userInfo\n    });\n    const selectedRegistration = rsapi.post(\"/registration/getEditRegistrationDetails\", { ...inputParam.editRegParam,\n      npreregno\n    });\n    urlArray = [timeZoneService, actualService, selectedRegistration];\n    Axios.all(urlArray).then(response => {\n      let selectedRecord = { ...response[2].data[\"SelectedRegistration\"][0]\n      };\n      selectedRecord = { ...selectedRecord,\n        ...selectedRecord['jsondata']\n      }; // const recordToEdit = { ...response[2].data[\"SelectedRegistration\"][0] };\n      //  const currentTime = rearrangeDateFormat(userInfo, response[6].data);\n\n      const timeZoneMap = constructOptionList(response[0].data || [], \"ntimezonecode\", \"stimezoneid\", undefined, undefined, true);\n      const timeZoneList = timeZoneMap.get(\"OptionList\");\n      const defaultTimeZone = {\n        label: userInfo.stimezoneid,\n        value: userInfo.ntimezonecode\n      }; //  const newcomboData = parentChildComboLoad(columnList, response[1].data,\n      // selectedRecord, childColumnList, withoutCombocomponent)\n\n      if (selectedRecord.ntransactionstatus === transactionStatus.CANCELLED || selectedRecord.ntransactionstatus === transactionStatus.REJECT) {\n        toast.warn(intl.formatMessage({\n          id: \"IDS_CANNOTEDITCANCELLEDSAMPLE\"\n        }));\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            loading: false\n          }\n        });\n      } else {\n        const languagetypeCode = undefined;\n        const comboData = response[1].data;\n        let comboValues = {};\n\n        if (columnList.length > 0) {\n          columnList.map(x => {\n            if (x.inputtype === 'combo') {\n              if (comboData[x.label] && comboData[x.label].length > 0) //&& comboData[x.label][0].hasOwnProperty(x.source) \n                {\n                  if (comboData[x.label].length > 0) {\n                    if (comboData[x.label][0].label === undefined) {\n                      const optionList = constructjsonOptionList(comboData[x.label] || [], x.valuemember, x.displaymember, false, false, true, undefined, x.source, x.isMultiLingual, languagetypeCode);\n                      comboData[x.label] = optionList.get(\"OptionList\");\n                    } else {\n                      comboData[x.label] = comboData[x.label];\n                      const optionList = constructjsonOptionDefault(comboData[x.label] || [], x.valuemember, x.displaymember, false, false, true, undefined, x.source, x.isMultiLingual, languagetypeCode);\n                    }\n                  } else {\n                    comboData[x.label] = [];\n                  } //comboValues = childComboLoad(x, comboData, selectedRecord, \n                  //   childColumnList, withoutCombocomponent)\\\n\n\n                  comboValues = childComboLoad(x, comboData, selectedRecord1, childColumnList, withoutCombocomponent);\n                } else {\n                comboValues = {\n                  \"comboData\": comboData\n                };\n              }\n            } else {\n              comboValues = {\n                comboData: comboData,\n                ...comboValues\n              };\n            }\n          });\n        } else {\n          comboValues = {\n            \"comboData\": comboData\n          };\n        }\n\n        dispatch({\n          type: DEFAULT_RETURN,\n          payload: {\n            AgaramTree: response[2].data[\"AgaramTree\"],\n            FocusKey: response[2].data[\"FocusKey\"],\n            ActiveKey: response[2].data[\"ActiveKey\"],\n            OpenNodes: response[2].data[\"OpenNodes\"],\n            // statustoEditDetail: response[2].data[\"ApprovalConfigRole\"] || {},\n            // currentTime,\n            operation,\n            //  screenName: popUpLabel,\n            // PopUpLabel: popUpLabel,\n            timeZoneList,\n            defaultTimeZone,\n            selectedRecord,\n            openPortal: true,\n            ncontrolCode: inputParam.editRegParam.ncontrolCode,\n            loadPreregister: true,\n            parentPopUpSize: \"xl\",\n            loading: false,\n            showSample: undefined,\n            comboData: comboValues.comboData //  regRecordToEdit:recordToEdit\n\n          }\n        });\n      }\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(intl.formatMessage({\n          id: error.response.data\n        }));\n      }\n    });\n  };\n}","map":{"version":3,"sources":["D:/Postgres_workingFolder/QuaLISWeb/src/actions/RegistrationAction.js"],"names":["rsapi","Axios","toast","filterRecordBasedOnTwoArrays","sortData","rearrangeDateFormat","convertDateTimetoString","fillRecordBasedOnCheckBoxSelection","getRecordBasedOnPrimaryKeyName","updatedObjectWithNewElement","replaceUpdatedObject","parentChildComboLoad","getSameRecordFromTwoArrays","constructjsonOptionList","constructjsonOptionDefault","childComboLoad","DEFAULT_RETURN","intl","initRequest","RegistrationSubType","RegistrationType","transactionStatus","crudMaster","postCRUDOrganiseTransSearch","getTestChildTabDetail","constructOptionList","getSampleTypeChange","Map","masterData","event","labelname","dispatch","post","then","response","data","item","type","payload","loading","catch","error","message","getRegTypeChange","getRegSubTypeChange","getComponentTestBySpec","selectedRecord","Component","Test","slno","length","selectedComponent","undefined","SelectedTest","SelectedSource","Object","keys","popUptestDataState","skip","take","Source","getTestfromDB","objComponent","LoginProps","nflag","component","value","label","dreceiveddate","userInfo","nspecsampletypecode","TestData","loadComponent","selectComponent","showSaveContinue","parentPopUpSize","CurrentTime","unshift","EditComponent","urlArray","ComponentTestBySpec","timezone","all","lstComponentMap","lstComponent","timeZoneListMap","TimeZoneField","get","timeZoneList","scomponentname","ncomponentcode","ntzdreceivedate","findIndex","x","ntimezonecode","stimezoneid","childoperation","ChildscreenName","openChildModal","ReloadData","inputData","searchSampleRef","current","searchSubSampleRef","searchTestRef","showFilter","testskip","testtake","showSample","status","warn","getTreeByProduct","comboData","inputParam","Specification","AgaramTree","ActiveKey","FocusKey","OpenNodes","Manufacturer","selectedSpec","sversion","ntemplatemanipulationcode","getNewRegSpecification","selectedNode","operation","methodUrl","ntreetemplatemanipulationcode","activeKey","focusKey","primaryKey","AddComponents","sreceiveddate","stzdreceivedate","scomments","nallottedspeccode","openPortal","openModal","getTest","nneedsubsample","specBasedComponent","componentTest","TestCombined","loadTest","formatMessage","id","addsubSample","userinfo","columnList","childColumnList","SubSamplecomboComponents","SubSamplewithoutCombocomponent","isServiceRequired","SubSamplecomboData","actualService","parentcolumnlist","childcolumnlist","TestGet","newcomboData","loadSubSample","parentSubSampleColumnList","editSubSample","Unit","Componnet","lstUnitMap","comp","lstUnit","sunitname","nunitcode","insertRegistration","RegistrationGetSample","selectedSample","RegistrationGetSubSample","RegistrationGetTest","selectedSubSample","selectedTest","multipleselectionFlag","respObject","loadEsign","showConfirmAlert","loadPreregister","postParamList","getRegistrationSample","selectedFilter","activeSampleTab","getRegistrationsubSampleDetail","inputParamData","nsampletypecode","nregtypecode","nregsubtypecode","npreregno","ntransactionstatus","napprovalconfigcode","activeTestTab","ndesigntemplatemappingcode","checkBoxOperation","activeName","dataStateName","subSample","skipInfo","oldSelectedTest","oldSelectedSubSample","childTabsKey","removeElementFromArray","selectedPreregno","wholeSubSampleList","map","b","ntransactionsamplecode","forEach","subsample","index","includes","splice","subsampleskip","subsampletake","bool","RegistrationTestComment","RegistrationParameter","wholeTestList","ntransactiontestcode","test","keepOld","ResponseData","RegistrationTestComment1","resultResponseData","RegistrationParameter1","ntransactiontestcode1","ResponseData1","RegistrationTestComment2","ntransactionTestCode","sampleGridDataState","sort","filter","attachmentskip","TestSelected","isGrandChildGetRequired","filterTestSameOldSelectedTest","join","filterSelectedSubSample","getRegistrationTestDetail","subsamplecheck","SubSampleSelected","wholeSubSample","selectedSubSample1","dataStateArray","arr","selectedTransactionsamplecode","toString","selectedTransactioncode","acceptRegistration","rtn","addMoreTest","ncontrolCode","sampleList","selectedsubsample","some","obj","slice","selectedsample","selectsubsample","findTransactionStatus","Set","jsondata","REJECT","CANCELLED","CERTIFIED","SENT","findApprovalVersion","napprovalversioncode","findSampleSpec","availableTest","loadChildTest","screenName","props","createRegistrationTest","modalName","classUrl","getEditRegistrationComboService","selectedRecord1","comboComponents","withoutCombocomponent","mastertoedit","primaryKeyName","timeZoneService","selectedRegistration","editRegParam","timeZoneMap","defaultTimeZone","languagetypeCode","comboValues","inputtype","optionList","valuemember","displaymember","source","isMultiLingual"],"mappings":"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","sourcesContent":["import rsapi from '../rsapi';\r\nimport Axios from 'axios';\r\nimport {\r\n    toast\r\n} from 'react-toastify';\r\nimport {\r\n    filterRecordBasedOnTwoArrays, sortData,\r\n    rearrangeDateFormat, convertDateTimetoString, fillRecordBasedOnCheckBoxSelection, getRecordBasedOnPrimaryKeyName, updatedObjectWithNewElement, replaceUpdatedObject, parentChildComboLoad, getSameRecordFromTwoArrays, constructjsonOptionList, constructjsonOptionDefault, childComboLoad\r\n} from '../components/CommonScript'\r\nimport {\r\n    DEFAULT_RETURN\r\n} from './LoginTypes';\r\nimport { intl } from '../components/App';\r\nimport { initRequest } from './LoginAction';\r\nimport { RegistrationSubType, RegistrationType, transactionStatus } from '../components/Enumeration';\r\nimport { crudMaster, postCRUDOrganiseTransSearch } from './ServiceAction'\r\nimport { getTestChildTabDetail } from './index.js'\r\nimport { constructOptionList } from '../components/CommonScript';\r\n\r\nexport function getSampleTypeChange(Map, masterData, event, labelname) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"/registration/getRegTypeBySampleType\", Map)\r\n            .then(response => {\r\n                masterData = {\r\n                    ...masterData,\r\n                    ...response.data,\r\n                    [labelname]: { ...event.item }\r\n                };\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        masterData, loading: false\r\n                    }\r\n                });\r\n\r\n            })\r\n            .catch(error => {\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\n\r\nexport function getRegTypeChange(Map, masterData, event, labelname) {\r\n    return function (dispatch) {\r\n        rsapi.post(\"/registration/getRegSubTypeByRegType\", Map)\r\n            .then(response => {\r\n                // const RegistrationSubType = response.data[\"RegistrationSubType\"];\r\n\r\n                //  console.log(response.data);\r\n                // RegistrationSubType.length > 0 ?\r\n                //     selectedRecord[\"nregsubtypecode\"] = {\r\n                //         \"value\": RegistrationSubType[0].nregsubtypecode,\r\n                //         \"label\": RegistrationSubType[0].sregsubtypename\r\n                //     } : selectedRecord[\"nregsubtypecode\"] = \"\";\r\n                // const [labelname] = event.item;\r\n                masterData = {\r\n                    ...masterData,\r\n                    ...response.data,\r\n                    [labelname]: { ...event.item }\r\n                };\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        masterData, loading: false\r\n                    }\r\n                });\r\n\r\n            })\r\n            .catch(error => {\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\n\r\nexport function getRegSubTypeChange(Map, masterData, event, labelname) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"/registration/getRegSubTypeByRegType\", Map)\r\n\r\n            .then(response => {\r\n                masterData = {\r\n                    ...masterData,\r\n                    ...response.data,\r\n                    [labelname]: { ...event.item }\r\n                };\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        masterData, loading: false\r\n                    }\r\n                });\r\n\r\n            })\r\n            .catch(error => {\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport function getComponentTestBySpec(Map, selectedRecord, masterData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"/registration/getComponentTestBySpec\", Map)\r\n            .then(response => {\r\n                const { Component, Test } = response.data;\r\n                let slno = Component.length > 0 ? Component[0].slno : -1;\r\n                let selectedComponent = Component.length > 0 ? Component[0] : undefined\r\n                let SelectedTest = [];\r\n                let SelectedSource = [];\r\n\r\n                if (Object.keys(Test).length > 0) {\r\n                    SelectedTest = Test[slno];\r\n                }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        Component, Test, SelectedTest, selectedComponent, loading: false,\r\n                        SelectedSource, selectedRecord, popUptestDataState: { skip: 0, take: 10 }, Source: []\r\n                    }\r\n                });\r\n\r\n            })\r\n            .catch(error => {\r\n                // console.log(error);\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\n\r\n\r\nexport function getTestfromDB(objComponent, LoginProps, nflag) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        let component = { ...objComponent };\r\n        component[\"ncomponentcode\"] = objComponent[\"ncomponentcode\"] ? objComponent[\"ncomponentcode\"].value : -1;\r\n        component[\"nstoragelocationcode\"] = objComponent[\"nstoragelocationcode\"] ? objComponent[\"nstoragelocationcode\"].value : -1;\r\n        component[\"nstorageconditioncode\"] = objComponent[\"nstorageconditioncode\"] ? objComponent[\"nstorageconditioncode\"].value : -1;\r\n        component[\"slno\"] = LoginProps.Component ? Object.keys(LoginProps.Component).length + 1 : 0;\r\n        component[\"scomponentname\"] = objComponent[\"ncomponentcode\"].label;\r\n        component[\"sstoragelocationname\"] = objComponent[\"nstoragelocationcode\"] && objComponent[\"nstoragelocationcode\"].label ? objComponent[\"nstoragelocationcode\"].label : \"\";\r\n        component[\"sstorageconditionname\"] = objComponent[\"nstorageconditioncode\"] && objComponent[\"nstorageconditioncode\"].label ? objComponent[\"nstorageconditioncode\"].label : \"\";\r\n        component[\"ntzdmanufdate\"] = objComponent[\"ntzdmanufdate\"] ? objComponent[\"ntzdmanufdate\"].value : -1;\r\n        component[\"ntzdreceivedate\"] = objComponent[\"ntzdreceivedate\"] ? objComponent[\"ntzdreceivedate\"].value : -1;\r\n        component[\"stzdreceivedate\"] = objComponent[\"ntzdreceivedate\"] ? objComponent[\"ntzdreceivedate\"].label : \"\";\r\n        component[\"nplasmafilecode\"] = objComponent[\"nplasmafilecode\"] ? objComponent[\"nplasmafilecode\"].value : -1;\r\n        component[\"splasmafilenumber\"] = objComponent[\"nplasmafilecode\"] ? objComponent[\"nplasmafilecode\"].label : \"\";\r\n        const dreceiveddate = objComponent[\"dreceiveddate\"];\r\n        component[\"dreceiveddate\"] = dreceiveddate;//formatInputDate(objComponent[\"dreceiveddate\"], false);\r\n        component[\"sreceiveddate\"] = convertDateTimetoString(dreceiveddate, LoginProps.userInfo);//formatInputDateWithoutT(objComponent[\"dreceiveddate\"], false);//formatDate(objComponent[\"sreceiveddate\"]);\r\n        // rsapi.post(\"/registration/getTestfromDB\", { \"Component\": component })\r\n        rsapi.post(\"/registration/getTestfromDB\", {\r\n            nspecsampletypecode: component.nspecsampletypecode,\r\n            slno: component.slno\r\n        })\r\n            .then(response => {\r\n                let TestData = response.data;\r\n                let slno = component.slno;\r\n                let SelectedTest = [];\r\n                let loadComponent = true;\r\n                let selectComponent = {};\r\n                let showSaveContinue = true;\r\n                let SelectedSource = [];\r\n                // let openChildModal = true;\r\n                let selectedComponent = undefined;\r\n                let parentPopUpSize = \"lg\"\r\n                // selectComponent = objComponent\r\n                if (nflag === 1) {\r\n                    loadComponent = true;\r\n                    objComponent[\"smanuflotno\"] = \"\";\r\n                    objComponent[\"dreceiveddate\"] = rearrangeDateFormat(LoginProps.userInfo, LoginProps.CurrentTime)//new Date(LoginProps.CurrentTime);\r\n                    objComponent[\"sreceiveddate\"] = rearrangeDateFormat(LoginProps.userInfo, LoginProps.CurrentTime)//new Date(LoginProps.CurrentTime);\r\n                    selectComponent = objComponent;\r\n                } else {\r\n                    loadComponent = false;\r\n                    parentPopUpSize = \"xl\"\r\n                    // openChildModal = false;\r\n                    showSaveContinue = false;\r\n                    selectComponent = undefined\r\n                }\r\n                let Test = LoginProps.Test || [];\r\n                let Component = LoginProps.Component || [];\r\n                Component.unshift(component);\r\n                selectedComponent = component;\r\n                Test[slno] = response.data;\r\n                SelectedTest = TestData;\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        Component, Test, SelectedTest, selectComponent, selectedComponent,\r\n                        loadComponent, showSaveContinue, parentPopUpSize, loading: false, SelectedSource\r\n                    }\r\n                });\r\n                // console.log(response.data);\r\n            })\r\n            .catch(error => {\r\n                //   console.log(error);\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\n\r\nexport function EditComponent(Map, component, userInfo) {\r\n\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        let urlArray = [];\r\n        const ComponentTestBySpec = rsapi.post(\"/registration/getComponentBySpec\",\r\n            Map);\r\n\r\n        const timezone = rsapi.post(\"timezone/getTimeZone\");\r\n\r\n        urlArray = [ComponentTestBySpec, timezone]\r\n        Axios.all(urlArray)\r\n            .then(response => {\r\n                const lstComponentMap = constructOptionList(response[0].data.lstComponent || [], \"ncomponentcode\",\r\n                    \"scomponentname\", undefined, undefined, true);\r\n                const timeZoneListMap = constructOptionList(response[1].data || [], \"ntimezonecode\",\r\n                    \"stimezoneid\", undefined, undefined, true);\r\n                const TimeZoneField = response[1].data;\r\n                const lstComponent = lstComponentMap.get(\"OptionList\");\r\n                const timeZoneList = timeZoneListMap.get(\"OptionList\");\r\n\r\n                component[\"ncomponentcode\"] = { label: component.scomponentname, value: component.ncomponentcode }\r\n                component[\"dreceiveddate\"] = rearrangeDateFormat(userInfo, component[\"sreceiveddate\"]);\r\n                component[\"scomments\"] = component[\"scomments\"]\r\n\r\n                let ntzdreceivedate = component.ntzdreceivedate;\r\n                if (component.ntzdreceivedate !== null && typeof component.ntzdreceivedate === \"object\") {\r\n                    ntzdreceivedate = component.ntzdreceivedate.value;\r\n                }\r\n                component[\"ntzdreceivedate\"] = component.ntzdreceivedate ?\r\n                    {\r\n                        \"label\": TimeZoneField[TimeZoneField.findIndex(x => x.ntimezonecode === ntzdreceivedate)].stimezoneid, \"value\":\r\n                            TimeZoneField[TimeZoneField.findIndex(x => x.ntimezonecode === ntzdreceivedate)].ntimezonecode\r\n                    } : \"\"\r\n\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        loadComponent: true, childoperation: \"update\",\r\n                        lstComponent, ChildscreenName: \"Component\",\r\n                        openChildModal: false, selectComponent: component, parentPopUpSize: \"lg\",\r\n                        timeZoneList, loading: false\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\n\r\n\r\nexport function ReloadData(inputData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"registration/getRegistrationByFilterSubmit\", { ...inputData.inputData })\r\n            .then(response => {\r\n                let masterData = {\r\n                    ...inputData.masterData,\r\n                    ...response.data\r\n                }\r\n                if (inputData.searchSampleRef !== undefined && inputData.searchSampleRef.current !== null) {\r\n                    inputData.searchSampleRef.current.value = \"\";\r\n                    masterData['searchedSample'] = undefined\r\n                }\r\n                if (inputData.searchSubSampleRef !== undefined && inputData.searchSubSampleRef.current !== null) {\r\n                    inputData.searchSubSampleRef.current.value = \"\";\r\n                    masterData['searchedSubSample'] = undefined\r\n                }\r\n                if (inputData.searchTestRef !== undefined && inputData.searchTestRef.current !== null) {\r\n                    inputData.searchTestRef.current.value = \"\"\r\n                    //masterData['searchedTests'] = undefined\r\n                    masterData['searchedTest'] = undefined\r\n                }\r\n                // let selectedFilter = inputData.selectedFilter;\r\n                // selectedFilter[\"fromdate\"] = \"\";\r\n                // selectedFilter[\"todate\"] = \"\";\r\n\r\n                sortData(masterData);\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData,\r\n                        loading: false,\r\n                        showFilter: false,\r\n                        skip: 0,\r\n                        testskip: 0,\r\n                        take: undefined,\r\n                        testtake: undefined,\r\n                        showSample: undefined,\r\n                        //selectedFilter\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport function getTreeByProduct(Map, selectedRecord, comboData, inputParam) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"/registration/getTreeByProduct\", Map)\r\n            .then(response => {\r\n                let { Specification, AgaramTree, ActiveKey, FocusKey, OpenNodes, Manufacturer } = [];\r\n                const selectedSpec = {}\r\n                if (response.data[\"rtn\"] === true) {\r\n                    Specification = constructOptionList(response.data[\"Specification\"] || [], \"nallottedspeccode\",\r\n                        \"sspecname\", undefined, undefined, true).get(\"OptionList\");\r\n                    AgaramTree = response.data[\"AgaramTree\"];\r\n                    ActiveKey = response.data[\"ActiveKey\"];\r\n                    FocusKey = response.data[\"FocusKey\"];\r\n                    OpenNodes = response.data[\"OpenNodes\"];\r\n                    //Manufacturer = response.data[\"Manufacturer\"];\r\n                    selectedSpec[\"nallottedspeccode\"] = Specification.length > 0 ? {\r\n                        \"value\": Specification[0].value,\r\n                        \"label\": Specification[0].label,\r\n                        \"item\": Specification[0].item\r\n                    } : \"\";\r\n\r\n                    selectedSpec[\"sversion\"] = Specification.length > 0 ? Specification[0].item.sversion : \"\"\r\n                    selectedSpec[\"ntemplatemanipulationcode\"] = Specification.length > 0 ? Specification[0].item.ntemplatemanipulationcode : -1\r\n                }\r\n                selectedRecord = { ...selectedRecord, ...selectedSpec }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        Specification,\r\n                        selectedRecord,\r\n                        AgaramTree, ActiveKey, FocusKey, OpenNodes,\r\n                        Test: [],\r\n                        SelectedTest: [],\r\n                        loading: false,\r\n                        comboData,\r\n                        ...inputParam,\r\n                        selectedSpec,\r\n                        Component: [],\r\n                        selectComponent: {},\r\n                        selectedComponent: {}\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\n\r\nexport const getNewRegSpecification = (inputParam, masterData) => {\r\n    return (dispatch) => {\r\n        if (inputParam.selectedNode !== null) {\r\n            dispatch(initRequest(true));\r\n            rsapi.post(\"/registration/\" + inputParam.operation + inputParam.methodUrl, { ...inputParam, ntreetemplatemanipulationcode: inputParam.selectedNode.ntemplatemanipulationcode })\r\n                .then(response => {\r\n                    sortData(response.data);\r\n                    let Specification = constructOptionList(response.data || [], \"nallottedspeccode\", \"sspecname\", false, false, true).get(\"OptionList\");\r\n                    let selectedComponent = undefined;\r\n                    inputParam.selectedRecord[\"nallottedspeccode\"] = Specification.length > 0 ? { value: Specification[0].value, label: Specification[0].label, item: Specification[0].item } : \"\";\r\n                    inputParam.selectedRecord[\"sversion\"] = Specification.length > 0 ? Specification[0].item.sversion : \"\";\r\n                    inputParam.selectedRecord[\"ntemplatemanipulationcode\"] = Specification.length > 0 ? Specification[0].item.ntemplatemanipulationcode : -1;\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN,\r\n                        payload: {\r\n                            ActiveKey: inputParam.activeKey,\r\n                            FocusKey: inputParam.focusKey,\r\n                            primaryKey: inputParam.primaryKey,\r\n                            Specification: Specification,\r\n                            selectedNode: inputParam.selectedNode,\r\n                            selectedRecord: inputParam.selectedRecord,\r\n                            Test: [],\r\n                            selectedComponent,\r\n                            SelectedTest: [],\r\n                            loading: false,\r\n                            showSample: undefined\r\n                        }\r\n                    }\r\n                    );\r\n                })\r\n                .catch(error => {\r\n                    if (error.response.status === 409 || error.response.status === 417) {\r\n                        toast.warn(error.response.data);\r\n                    } else {\r\n                        toast.error(error.message)\r\n                    }\r\n                });\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport function AddComponents(Map) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        let urlArray = []\r\n        const ComponentTestBySpec = rsapi.post(\"/registration/getComponentBySpec\",\r\n            Map);\r\n        const timezone = rsapi.post(\"timezone/getTimeZone\");\r\n\r\n        urlArray = [ComponentTestBySpec, timezone\r\n        ]\r\n        Axios.all(urlArray)\r\n            .then(response => {\r\n                const lstComponentMap = constructOptionList(response[0].data.lstComponent || [], \"ncomponentcode\",\r\n                    \"scomponentname\", undefined, undefined, true);\r\n                const timeZoneListMap = constructOptionList(response[1].data || [], \"ntimezonecode\",\r\n                    \"stimezoneid\", undefined, undefined, true);\r\n                const lstComponent = lstComponentMap.get(\"OptionList\");\r\n                const timeZoneList = timeZoneListMap.get(\"OptionList\");\r\n                let dreceiveddate = null;\r\n                if (lstComponent[0].item.sreceiveddate)\r\n                    dreceiveddate = rearrangeDateFormat(Map[\"userinfo\"], lstComponent[0].item.sreceiveddate);//new Date(lstComponent[0].item.sreceiveddate);//|| [];\r\n\r\n                let selectComponent = {\r\n                    sreceiveddate: dreceiveddate,\r\n                    dreceiveddate,\r\n                    ntzdreceivedate: { \"label\": Map[\"userinfo\"].stimezoneid, \"value\": Map[\"userinfo\"].ntimezonecode },\r\n                    stzdreceivedate: Map[\"userinfo\"].stimezoneid,\r\n                    scomments: \"\",\r\n                    nallottedspeccode: lstComponent[0].item.nallottedspeccode\r\n                };\r\n                let CurrentTime = dreceiveddate;\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        loadComponent: true,\r\n                        lstComponent, dreceiveddate, ChildscreenName: \"Component\",\r\n                        showSaveContinue: true, openChildModal: false, childoperation: \"create\", selectComponent\r\n                        , parentPopUpSize: \"lg\", CurrentTime, timeZoneList, loading: false,\r\n                        openPortal: true, openModal: false\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\nexport function getTest(objComponent, LoginProps, nneedsubsample, specBasedComponent) {\r\n    return function (dispatch) {\r\n        if (Object.keys(objComponent).length > 0) {\r\n            dispatch(initRequest(true));\r\n            rsapi.post(\"/registration/getTestfromDB\", {\r\n                nspecsampletypecode: objComponent.nspecsampletypecode,\r\n                slno: objComponent.slno,\r\n                nneedsubsample: nneedsubsample,\r\n                nallottedspeccode: objComponent.nallottedspeccode,\r\n                specBasedComponent: specBasedComponent\r\n\r\n            })\r\n                .then(response => {\r\n                    let TestData = response.data;\r\n                    let Test = LoginProps.Test || [];\r\n                    let componentTest = Test[objComponent.slno] ? Test[objComponent.slno] : [];\r\n                    const TestCombined = filterRecordBasedOnTwoArrays(TestData, componentTest, \"ntestgrouptestcode\");\r\n                    // const lstComponentMap = constructOptionList(TestCombined|| [], \"ntestgrouptestcode\",\r\n                    //\"stestsynonym\", undefined, undefined, true);\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN,\r\n                        payload: {\r\n                            TestCombined, loadTest: true, openChildModal: false, ChildscreenName: \"Test\",\r\n                            childoperation: \"create\", parentPopUpSize: \"lg\", loading: false\r\n                        }\r\n                    });\r\n                })\r\n                .catch(error => {\r\n                    toast.error(error.message);\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                })\r\n        } else {\r\n            toast.warn(intl.formatMessage({ id: \"IDS_SELECTCOMPONENTTOADDTEST\" }));\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport function addsubSample(masterData, userinfo, columnList,\r\n    selectComponent, childColumnList,\r\n    SubSamplecomboComponents, SubSamplewithoutCombocomponent,\r\n    specBasedComponent, Map, Component, isServiceRequired, SubSamplecomboData) {\r\n    if (isServiceRequired) {\r\n        return function (dispatch) {\r\n            dispatch(initRequest(true));\r\n            const urlArray = []\r\n            const actualService = rsapi.post(\"dynamicpreregdesign/getComboValues\", {\r\n                parentcolumnlist: columnList,\r\n                childcolumnlist: childColumnList,\r\n                userinfo\r\n            })\r\n            urlArray[0] = actualService;\r\n            if (specBasedComponent === 4) {\r\n                Component = Component ? Component : []\r\n                const TestGet = rsapi.post(\"/registration/getTestfromDB\", {\r\n                    nallottedspeccode: Map[\"nallottedspeccode\"],\r\n                    slno: Component ? Object.keys(Component).length + 1 : 1,\r\n                    //nneedsubsample: nneedsubsample,\r\n                    // nallottedspeccode: objComponent.nallottedspeccode,\r\n                    specBasedComponent: specBasedComponent\r\n\r\n                })\r\n                urlArray[1] = TestGet;\r\n            }\r\n            Axios.all(urlArray).then(response => {\r\n                const newcomboData = parentChildComboLoad(columnList, response[0].data,\r\n                    selectComponent, childColumnList, SubSamplewithoutCombocomponent)\r\n                let TestCombined = [];\r\n                if (specBasedComponent === 4) {\r\n                    TestCombined = response[1].data\r\n                }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        ChildscreenName: \"SubSample\",\r\n                        showSaveContinue: true,\r\n                        openChildModal: false,\r\n                        childoperation: \"create\",\r\n                        parentPopUpSize: \"lg\",\r\n                        loading: false,\r\n                        lstComponent: [],\r\n                        openPortal: true,\r\n                        openModal: false,\r\n                        operation: \"create\",\r\n                        loadSubSample: true,\r\n                        selectComponent: newcomboData.selectedRecord,\r\n                        SubSamplecomboData: newcomboData.comboData,\r\n                        SubSamplecomboComponents,\r\n                        SubSamplewithoutCombocomponent,\r\n                        TestCombined,\r\n                        parentSubSampleColumnList: columnList,\r\n                    }\r\n                });\r\n            })\r\n                .catch(error => {\r\n                    toast.error(error.message);\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                })\r\n        }\r\n    } else {\r\n        const newcomboData = parentChildComboLoad(columnList, SubSamplecomboData,\r\n            selectComponent, childColumnList, SubSamplewithoutCombocomponent)\r\n        return (dispatch) => {\r\n            dispatch({\r\n                type: DEFAULT_RETURN,\r\n                payload: {\r\n                    ChildscreenName: \"SubSample\",\r\n                    showSaveContinue: true,\r\n                    openChildModal: false,\r\n                    childoperation: \"create\",\r\n                    parentPopUpSize: \"lg\",\r\n                    loading: false,\r\n                    lstComponent: [],\r\n                    openPortal: true,\r\n                    openModal: false,\r\n                    operation: \"create\",\r\n                    loadSubSample: true,\r\n                    selectComponent: newcomboData.selectedRecord,\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nexport function editSubSample(Map,\r\n    component, userInfo, specBasedComponent) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        let urlArray = []\r\n        const Unit = rsapi.post(\"/unit/getUnit\",\r\n            { userinfo: userInfo })\r\n        let Componnet = {}\r\n        if (specBasedComponent === 4) {\r\n            Componnet = rsapi.post(\"/component/getComponent\",\r\n                { userinfo: userInfo })\r\n        } else {\r\n            Componnet = rsapi.post(\"/registration/getComponentBySpec\",\r\n                Map);\r\n        }\r\n\r\n        urlArray = [Unit, Componnet\r\n        ]\r\n        Axios.all(urlArray)\r\n\r\n            .then(response => {\r\n                const lstUnitMap = constructOptionList(response[0].data || [], \"nunitcode\",\r\n                    \"sunitname\", undefined, undefined, true);\r\n                let comp = []\r\n                if (specBasedComponent === 4) {\r\n                    comp = response[1].data\r\n                } else {\r\n                    comp = response[1].data.lstComponent\r\n                }\r\n                const lstComponentMap = constructOptionList(comp || [], \"ncomponentcode\",\r\n                    \"scomponentname\", undefined, undefined, true);\r\n                const lstUnit = lstUnitMap.get(\"OptionList\");\r\n                const lstComponent = lstComponentMap.get(\"OptionList\");\r\n\r\n                component[\"nunitcode\"] = { label: component.sunitname, value: component.nunitcode }\r\n                component[\"ssubsamplename\"] = component[\"ssubsamplename\"];\r\n                component[\"ssampleqty\"] = component[\"ssampleqty\"];\r\n                component[\"scomments\"] = component[\"scomments\"]\r\n                component[\"ncomponentcode\"] = { label: component.scomponentname, value: component.ncomponentcode }\r\n\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        loadSubSample: true, childoperation: \"update\",\r\n                        ChildscreenName: \"SubSample\", Unit: lstUnit,\r\n                        openChildModal: false, selectComponent: component,\r\n                        parentPopUpSize: \"lg\", loading: false, lstComponent\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n            })\r\n    }\r\n}\r\n\r\nexport function insertRegistration(inputParam, masterData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"/registration/createRegistration\", inputParam.inputData)\r\n            .then(response => {\r\n                let RegistrationGetSample = updatedObjectWithNewElement(response.data[\"RegistrationGetSample\"], masterData.RegistrationGetSample);\r\n                let selectedSample = response.data[\"selectedSample\"];\r\n                let RegistrationGetSubSample = response.data[\"RegistrationGetSubSample\"];\r\n                let RegistrationGetTest = response.data[\"RegistrationGetTest\"];\r\n                let selectedSubSample = RegistrationGetSubSample;\r\n                RegistrationGetTest = sortData(RegistrationGetTest, \"npreregno\", \"desc\");\r\n                let selectedTest = response.data[\"selectedTest\"];;\r\n                if (inputParam.nneedsubsample === 3) {\r\n                    RegistrationGetSubSample = response.data[\"RegistrationGetSubSample\"]\r\n                    selectedSubSample = response.data[\"selectedSubSample\"];\r\n                }\r\n\r\n\r\n                if (inputParam.multipleselectionFlag) {\r\n                    selectedSample = updatedObjectWithNewElement(response.data[\"selectedSample\"], masterData.selectedSample);\r\n                    updatedObjectWithNewElement(response.data[\"selectedSubSample\"], masterData.RegistrationGetSubSample);\r\n                    updatedObjectWithNewElement(response.data[\"selectedTest\"], masterData.RegistrationGetTest);\r\n                    RegistrationGetSubSample = masterData.RegistrationGetSubSample;\r\n                    RegistrationGetTest = masterData.RegistrationGetTest;\r\n                }\r\n\r\n                masterData = {\r\n                    ...masterData, ...response.data,\r\n                    selectedSample, selectedSubSample, selectedTest,\r\n                    RegistrationGetSubSample, RegistrationGetTest, RegistrationGetSample\r\n                }\r\n                let respObject = {\r\n                    masterData,\r\n                    ...inputParam.inputData,\r\n                    openModal: false,\r\n                    loadEsign: false,\r\n                    showConfirmAlert: false,\r\n                    selectedRecord: undefined,\r\n                    loading: false,\r\n                    loadPreregister: false,\r\n                    showSample: undefined,\r\n                    openPortal: false,\r\n                    selectedSpec: {},\r\n                    selectComponent: {},\r\n                    SelectedTest: {},\r\n                    selectedComponent: {},\r\n                    Component: [],\r\n                    selectedRecord: {},\r\n                    SelectedTest: [],\r\n                    Test: [],\r\n                    selectedComponent: {}\r\n                }\r\n                inputParam.postParamList[0]['clearFilter'] = 'yes'\r\n                dispatch(postCRUDOrganiseTransSearch(inputParam.postParamList, respObject))\r\n            })\r\n            .catch(error => {\r\n                // console.log(error);\r\n                toast.error(error.message);\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false, showConfirmAlert: false } })\r\n            })\r\n    }\r\n}\r\n\r\n\r\n\r\nexport function getRegistrationSample(inputData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"registration/getRegistrationByFilterSubmit\", { ...inputData.inputData })\r\n            .then(response => {\r\n                let masterData = {\r\n                    ...inputData.masterData,\r\n                    ...response.data\r\n                }\r\n                if (inputData.searchSampleRef !== undefined && inputData.searchSampleRef.current !== null) {\r\n                    inputData.searchSampleRef.current.value = \"\";\r\n                    masterData['searchedSample'] = undefined\r\n                }\r\n                if (inputData.searchSubSampleRef !== undefined && inputData.searchSubSampleRef.current !== null) {\r\n                    inputData.searchSubSampleRef.current.value = \"\";\r\n                    masterData['searchedSubSample'] = undefined\r\n                }\r\n                if (inputData.searchTestRef !== undefined && inputData.searchTestRef.current !== null) {\r\n                    inputData.searchTestRef.current.value = \"\"\r\n                    masterData['searchedTest'] = undefined\r\n                }\r\n                let respObject = {};\r\n                if (inputData.selectedFilter) {\r\n                    respObject = { selectedFilter: { ...inputData.selectedFilter } };\r\n                }\r\n                sortData(masterData);\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData,\r\n                        loading: false,\r\n                        showFilter: false,\r\n                        skip: 0,\r\n                        testskip: 0,\r\n                        take: undefined,\r\n                        testtake: undefined,\r\n                        showSample: undefined,\r\n                        ...respObject,\r\n                        activeSampleTab: inputData.inputData.activeSampleTab\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport function getRegistrationsubSampleDetail(inputData, isServiceRequired) {\r\n    return function (dispatch) {\r\n        let inputParamData = {\r\n            nsampletypecode: inputData.nsampletypecode,\r\n            nregtypecode: inputData.nregtypecode,\r\n            nregsubtypecode: inputData.nregsubtypecode,\r\n            npreregno: inputData.npreregno,\r\n            ntransactionstatus: inputData.ntransactionstatus,\r\n            napprovalconfigcode: inputData.napprovalconfigcode,\r\n            activeTestTab: inputData.activeTestTab,\r\n            activeSampleTab: inputData.activeSampleTab,\r\n            userinfo: inputData.userinfo,\r\n            ndesigntemplatemappingcode: inputData.ndesigntemplatemappingcode,\r\n            nneedsubsample: inputData.nneedsubsample,\r\n            checkBoxOperation: inputData.checkBoxOperation\r\n        }\r\n        let activeName = \"\";\r\n        let dataStateName = \"\";\r\n        const subSample = inputData.nneedsubsample\r\n        dispatch(initRequest(true));\r\n        if (isServiceRequired) {\r\n            rsapi.post(\"registration/getRegistrationSubSample\", inputParamData)\r\n                .then(response => {\r\n                    sortData(response.data);\r\n                    let masterData = {}\r\n                    let skipInfo = {}\r\n                    let oldSelectedTest = inputData.masterData.selectedTest\r\n                    if (subSample === 3) {\r\n                        let oldSelectedSubSample = inputData.masterData.selectedSubSample\r\n                        fillRecordBasedOnCheckBoxSelection(inputData.masterData, response.data,\r\n                            inputData.childTabsKey, inputData.checkBoxOperation, \"npreregno\",\r\n                            inputData.removeElementFromArray);\r\n                        masterData = {\r\n                            ...inputData.masterData,\r\n                            selectedSample: inputData.selectedSample,\r\n                            selectedPreregno: inputData.npreregno,\r\n                            selectedSubSample: inputData.masterData.RegistrationGetSubSample.length > 0 ?\r\n                                [inputData.masterData.RegistrationGetSubSample[0]] : [],\r\n                        }\r\n\r\n                        if (inputData.checkBoxOperation === 1 || inputData.checkBoxOperation === 7) {\r\n\r\n                            const wholeSubSampleList = masterData.RegistrationGetSubSample.map(b => b.ntransactionsamplecode)\r\n                            oldSelectedSubSample.forEach((subsample, index) => {\r\n                                if (!wholeSubSampleList.includes(subsample.ntransactionsamplecode)) {\r\n                                    oldSelectedSubSample.splice(index, 1)\r\n                                }\r\n\r\n                            })\r\n                            if (oldSelectedSubSample.length > 0) {\r\n                                masterData = {\r\n                                    ...masterData,\r\n                                    selectedSubSample: oldSelectedSubSample\r\n                                }\r\n                            }\r\n                            const selectedTest = getSameRecordFromTwoArrays(oldSelectedTest,\r\n                                masterData.selectedSubSample, 'npreregno')\r\n                            masterData = {\r\n                                ...masterData,\r\n                                selectedTest\r\n                            }\r\n                        }\r\n                        if (inputData.checkBoxOperation === 3) {\r\n                            masterData = {\r\n                                ...masterData,\r\n                                selectedTest: masterData.RegistrationGetTest.length > 0 ? [masterData.RegistrationGetTest[0]] : []\r\n                            }\r\n                        }\r\n\r\n\r\n                        let { testskip, testtake, subsampleskip, subsampletake } = inputData\r\n                        let bool = false;\r\n\r\n                        if (inputData.masterData.RegistrationGetSubSample.length < inputData.subsampleskip) {\r\n                            testskip = 0;\r\n                            subsampleskip = 0;\r\n                            bool = true\r\n                        }\r\n                        if (bool) {\r\n                            skipInfo = { testskip, testtake, subsampleskip, subsampletake }\r\n                        }\r\n                    } else {\r\n\r\n                        //let oldSelectedTest = inputData.masterData.selectedTest\r\n                        //  let oldSelectedSubSample = inputData.masterData.selectedSubSample\r\n                        fillRecordBasedOnCheckBoxSelection(inputData.masterData, response.data,\r\n                            inputData.childTabsKey, inputData.checkBoxOperation, \"npreregno\",\r\n                            inputData.removeElementFromArray);\r\n                        masterData = {\r\n                            ...inputData.masterData,\r\n                            selectedSample: inputData.selectedSample,\r\n                            selectedPreregno: inputData.npreregno,\r\n                            selectedTest: inputData.masterData.RegistrationGetTest.length > 0 ?\r\n                                [inputData.masterData.RegistrationGetTest[0]] : [],\r\n                            selectedSubSample: inputData.masterData.RegistrationGetSubSample,\r\n                        }\r\n                        let RegistrationTestComment = [];\r\n                        let RegistrationParameter = [];\r\n                        if (inputData.checkBoxOperation === 7 || inputData.checkBoxOperation === 1) {\r\n                            const wholeTestList = masterData.RegistrationGetTest.map(b => b.ntransactiontestcode)\r\n                            oldSelectedTest.forEach((test, index) => {\r\n                                if (!wholeTestList.includes(test.ntransactiontestcode)) {\r\n                                    oldSelectedTest.splice(index, 1)\r\n                                }\r\n\r\n                            })\r\n\r\n                            let keepOld = false;\r\n                            let ntransactiontestcode;\r\n                            if (oldSelectedTest.length > 0) {\r\n                                keepOld = true\r\n                                masterData = {\r\n                                    ...masterData,\r\n                                    selectedTest: oldSelectedTest,\r\n                                }\r\n                            } else {\r\n                                ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ?\r\n                                    inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : \"\"\r\n                            }\r\n                            switch (inputData.activeTestTab) {\r\n                                case \"IDS_PARAMETERRESULTS\":\r\n                                    RegistrationParameter = keepOld ? inputData.masterData.RegistrationParameter ?\r\n                                        inputData.masterData.RegistrationParameter : [] :\r\n                                        getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\")\r\n                                    activeName = \"RegistrationParameter\"\r\n                                    dataStateName = \"resultDataState\"\r\n                                    break;\r\n                                case \"IDS_TESTCOMMENTS\":\r\n                                    RegistrationTestComment = keepOld ? inputData.masterData.RegistrationTestComment ?\r\n                                        inputData.masterData.RegistrationTestComment : [] :\r\n                                        getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationTestComment, ntransactiontestcode, \"ntransactiontestcode\")\r\n                                    activeName = \"RegistrationTestComment\"\r\n                                    dataStateName = \"testCommentDataState\"\r\n                                    break;\r\n                                default:\r\n                                    RegistrationParameter = keepOld ? inputData.masterData.RegistrationParameter ?\r\n                                        inputData.masterData.RegistrationParameter : [] :\r\n                                        getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\")\r\n                                    activeName = \"RegistrationParameter\"\r\n                                    dataStateName = \"resultDataState\"\r\n                                    break;\r\n                            }\r\n                        }\r\n                        else if (inputData.checkBoxOperation === 5) {\r\n                            switch (inputData.activeTestTab) {\r\n                                case \"IDS_TESTCOMMENTS\":\r\n                                    let ResponseData = response.data.RegistrationTestComment ? response.data.RegistrationTestComment : [];\r\n                                    let RegistrationTestComment1 = [];\r\n                                    if (inputData.masterData.RegistrationTestComment !== undefined) {\r\n                                        RegistrationTestComment1 = [...inputData.masterData.RegistrationTestComment, ...ResponseData];\r\n                                    }\r\n                                    let ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1\r\n                                    RegistrationTestComment = getRecordBasedOnPrimaryKeyName(RegistrationTestComment1, ntransactiontestcode, \"ntransactiontestcode\");\r\n                                    activeName = \"RegistrationTestComment\"\r\n                                    dataStateName = \"testCommentDataState\"\r\n                                    break;\r\n                                case \"IDS_PARAMETERRESULTS\":\r\n                                    let resultResponseData = response.data.RegistrationParameter ? response.data.RegistrationParameter : [];\r\n                                    let RegistrationParameter1 = [...inputData.masterData.RegistrationParameter, ...resultResponseData];\r\n                                    let ntransactiontestcode1 = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1\r\n                                    RegistrationParameter = getRecordBasedOnPrimaryKeyName(RegistrationParameter1, ntransactiontestcode1, \"ntransactiontestcode\");\r\n                                    activeName = \"RegistrationParameter\"\r\n                                    dataStateName = \"resultDataState\"\r\n                                    break;\r\n                                default:\r\n                                    let ResponseData1 = response.data.RegistrationTestComment ? response.data.RegistrationTestComment : [];\r\n                                    let RegistrationTestComment2 = [];\r\n                                    if (inputData.masterData.RegistrationTestComment !== undefined) {\r\n                                        RegistrationTestComment2 = [...inputData.masterData.RegistrationTestComment, ...ResponseData1];\r\n                                    }\r\n                                    let ntransactionTestCode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1\r\n                                    RegistrationTestComment = getRecordBasedOnPrimaryKeyName(RegistrationTestComment2, ntransactionTestCode, \"ntransactiontestcode\");\r\n                                    activeName = \"RegistrationParameter\"\r\n                                    dataStateName = \"resultDataState\"\r\n                                    break;\r\n                            }\r\n                            // RegistrationTestComment = response.data.RegistrationTestComment ? [...response.data.RegistrationTestComment] : [];\r\n                        }\r\n                        else {\r\n                            switch (inputData.activeTestTab) {\r\n                                case \"IDS_TESTCOMMENTS\":\r\n                                    RegistrationTestComment = response.data.RegistrationTestComment ?\r\n                                        [...response.data.RegistrationTestComment] : [];\r\n                                    activeName = \"RegistrationTestComment\"\r\n                                    dataStateName = \"testCommentDataState\"\r\n                                    break;\r\n                                case \"IDS_PARAMETERRESULTS\":\r\n                                    RegistrationParameter = response.data.RegistrationParameter ?\r\n                                        [...response.data.RegistrationParameter] : [];\r\n                                    activeName = \"RegistrationParameter\"\r\n                                    dataStateName = \"resultDataState\"\r\n                                    break;\r\n                                default:\r\n                                    RegistrationParameter = response.data.RegistrationParameter ?\r\n                                        [...response.data.RegistrationParameter] : [];\r\n                                    activeName = \"RegistrationParameter\"\r\n                                    dataStateName = \"resultDataState\"\r\n                                    break;\r\n                            }\r\n                        }\r\n                        masterData['RegistrationTestComment'] = RegistrationTestComment;\r\n                        masterData[\"RegistrationParameter\"] = RegistrationParameter;\r\n                        let { testskip, testtake } = inputData\r\n                        let bool = false;\r\n\r\n                        if (inputData.masterData.RegistrationGetTest.length < inputData.testskip) {\r\n                            testskip = 0;\r\n                            bool = true\r\n                        }\r\n                        if (bool) {\r\n                            skipInfo = { testskip, testtake }\r\n                        }\r\n\r\n                    }\r\n                    if (inputData.masterData.selectedSample && inputData.sampleGridDataState\r\n                        && inputData.masterData.selectedSample.length <= inputData.sampleGridDataState.skip) {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            sampleGridDataState: {\r\n                                ...inputData.sampleGridDataState,\r\n                                skip: 0,\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    } else {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            sampleGridDataState: {\r\n                                ...inputData.sampleGridDataState,\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    }\r\n                    if (inputData.searchTestRef !== undefined && inputData.searchTestRef.current !== null) {\r\n                        inputData.searchTestRef.current.value = \"\"\r\n                        masterData['searchedTest'] = undefined\r\n                    }\r\n                    let inputParam = { attachmentskip: undefined }\r\n                    if (inputData[dataStateName] && masterData[activeName].length <= inputData[dataStateName].skip) {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            [dataStateName]: {\r\n                                ...inputData[dataStateName],\r\n                                skip: 0,\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    } else {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            [dataStateName]: {\r\n                                ...inputData[dataStateName],\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    }\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            masterData,\r\n                            loading: false,\r\n                            showFilter: false,\r\n                            activeSampleTab: inputData.activeSampleTab,\r\n                            activeTestTab: inputData.activeTestTab,\r\n                            skip: undefined,\r\n                            take: undefined,\r\n                            ...skipInfo,\r\n                            inputParam\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        } else {\r\n\r\n            let bool = false;\r\n            let skipInfo = {};\r\n            let { testskip, testtake, subsampletake, subsampleskip } = inputData;\r\n            let oldSelectedTest = inputData.masterData.selectedTest\r\n            let oldSelectedSubSample = inputData.masterData.selectedSubSample\r\n            let TestSelected = getRecordBasedOnPrimaryKeyName(inputData.masterData.selectedTest, inputData.removeElementFromArray[0].npreregno, \"npreregno\");\r\n            let isGrandChildGetRequired = false;\r\n            if (TestSelected.length > 0) {\r\n                isGrandChildGetRequired = true;\r\n            } else {\r\n                isGrandChildGetRequired = false;\r\n            }\r\n            fillRecordBasedOnCheckBoxSelection(inputData.masterData, inputData.selectedSample, inputData.childTabsKey, inputData.checkBoxOperation, \"npreregno\", inputData.removeElementFromArray);\r\n            if (isGrandChildGetRequired) {\r\n                let selectedSample = inputData.selectedSample;\r\n                let filterTestSameOldSelectedTest = getSameRecordFromTwoArrays(oldSelectedTest, inputData.masterData.RegistrationGetTest, \"ntransactiontestcode\");\r\n                let selectedTest = filterTestSameOldSelectedTest.length > 0 ? filterTestSameOldSelectedTest :\r\n                    inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : [];\r\n                let ntransactiontestcode = selectedTest.length > 0 ? selectedTest.map(x => x.ntransactiontestcode).join(\",\") : \"-1\";\r\n                let selectedSubSample = inputData.masterData.RegistrationGetSubSample\r\n\r\n                if (subSample === 3) {\r\n                    let filterSelectedSubSample = getSameRecordFromTwoArrays(oldSelectedSubSample, inputData.masterData.RegistrationGetSubSample, \"ntransactionsamplecode\");\r\n                    selectedSubSample = filterSelectedSubSample.length > 0 ? filterSelectedSubSample : [inputData.masterData.RegistrationGetSubSample[0]];\r\n                    if (inputData.masterData.RegistrationGetSubSample.length <= inputData.subsampleskip) {\r\n                        subsampleskip = 0;\r\n                        skipInfo = { subsampletake, subsampleskip }\r\n                    }\r\n\r\n                }\r\n                let masterData = { ...inputData.masterData, selectedSample, selectedSubSample, selectedTest }\r\n                if (inputData.masterData.RegistrationGetTest.length <= inputData.testskip) {\r\n                    testskip = 0;\r\n                    bool = true\r\n                }\r\n                if (bool) {\r\n                    skipInfo = { ...skipInfo, testskip, testtake }\r\n                }\r\n                inputData = {\r\n                    ...inputData, childTabsKey: [\"RegistrationTestComment\", \"RegistrationParameter\"], ntransactiontestcode, masterData, selectedTest,\r\n                    selectedSubSample, checkBoxOperation: 3, skipInfo\r\n                }\r\n                if (subSample === 3) {\r\n                    if (selectedTest.length === 0) {\r\n                        inputData[\"npreregno\"] = selectedSubSample.map(x => x.npreregno).join(\",\")\r\n                        inputData[\"ntransactionsamplecode\"] = selectedSubSample.map(x => x.ntransactionsamplecode).join(\",\")\r\n                        inputData[\"checkBoxOperation\"] = 3\r\n                        inputData[\"childTabsKey\"] = [\"RegistrationGetTest\"]\r\n                        dispatch(getRegistrationTestDetail(inputData, true));\r\n                    } else {\r\n                        dispatch(getTestChildTabDetail(inputData, true));\r\n                    }\r\n                } else {\r\n                    dispatch(getTestChildTabDetail(inputData, true));\r\n                }\r\n            } else {\r\n                let masterData = {\r\n                    ...inputData.masterData,\r\n                    selectedSample: inputData.selectedSample,\r\n                    selectedPreregno: inputData.npreregno,\r\n                    selectedTest: inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : [],\r\n                    // RegistrationTestComment,\r\n                    selectedSubSample: inputData.masterData.RegistrationGetSubSample\r\n                }\r\n                let subsamplecheck = true;\r\n                if (subSample === 3) {\r\n                    let SubSampleSelected = getRecordBasedOnPrimaryKeyName(inputData.masterData.selectedSubSample, inputData.removeElementFromArray[0].npreregno, \"npreregno\");\r\n                    if (SubSampleSelected.length > 0) {\r\n                        let filterSelectedSubSample = getSameRecordFromTwoArrays(oldSelectedSubSample, inputData.masterData.RegistrationGetSubSample, \"ntransactionsamplecode\");\r\n                        if (filterSelectedSubSample.length === 0) {\r\n                            let wholeSubSample = masterData.RegistrationGetSubSample.map(b => b.ntransactionsamplecode)\r\n                            oldSelectedSubSample.forEach((test, index) => {\r\n                                if (!wholeSubSample.includes(test.ntransactionsamplecode)) {\r\n                                    oldSelectedSubSample.splice(index, 1)\r\n                                }\r\n                                return null;\r\n                            })\r\n                            if (oldSelectedSubSample.length === 0 && wholeSubSample.length > 0\r\n                                && masterData.selectedTest.length === 0) {\r\n                                const selectedSubSample1 = [inputData.masterData.RegistrationGetSubSample[0]];\r\n                                masterData = {\r\n                                    ...masterData,\r\n                                    selectedSubSample: selectedSubSample1,\r\n                                    selectedTest: []\r\n                                }\r\n                                inputData = { ...inputData, ...masterData }\r\n                                inputData[\"npreregno\"] = selectedSubSample1.map(x => x.npreregno).join(\",\")\r\n                                inputData[\"ntransactionsamplecode\"] = selectedSubSample1.map(x => x.ntransactionsamplecode).join(\",\")\r\n                                inputData[\"checkBoxOperation\"] = 3\r\n                                inputData[\"childTabsKey\"] = [\"RegistrationGetTest\"]\r\n                                subsamplecheck = false;\r\n                                dispatch(getRegistrationTestDetail(inputData, true));\r\n\r\n                            }\r\n                        } else {\r\n                            oldSelectedSubSample = filterSelectedSubSample\r\n                        }\r\n\r\n                    } else {\r\n                        let wholeSubSample = masterData.RegistrationGetSubSample.map(b => b.ntransactionsamplecode)\r\n                        oldSelectedSubSample.forEach((test, index) => {\r\n                            if (!wholeSubSample.includes(test.ntransactionsamplecode)) {\r\n                                oldSelectedSubSample.splice(index, 1)\r\n                            }\r\n                            return null;\r\n                        })\r\n                    }\r\n\r\n                    if (subsamplecheck) {\r\n                        masterData = {\r\n                            ...masterData,\r\n                            selectedSubSample: oldSelectedSubSample\r\n                        }\r\n                    }\r\n                    if (inputData.masterData.RegistrationGetSubSample.length <= inputData.subsampleskip) {\r\n                        subsampleskip = 0;\r\n                        skipInfo = { subsampleskip, subsampletake }\r\n                    }\r\n                }\r\n                let wholeTestList = masterData.RegistrationGetTest.map(b => b.ntransactiontestcode)\r\n                oldSelectedTest.forEach((test, index) => {\r\n                    if (!wholeTestList.includes(test.ntransactiontestcode)) {\r\n                        oldSelectedTest.splice(index, 1)\r\n                    }\r\n                    return null;\r\n                })\r\n                let keepOld = false;\r\n                let ntransactiontestcode;\r\n                if (oldSelectedTest.length > 0) {\r\n                    keepOld = true\r\n                    masterData = {\r\n                        ...masterData,\r\n                        selectedTest: oldSelectedTest\r\n                    }\r\n                } else {\r\n                    ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : \"-1\"\r\n                }\r\n                masterData[\"RegistrationTestComment\"] = keepOld ? inputData.masterData.RegistrationTestComment : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationTestComment, ntransactiontestcode, \"ntransactiontestcode\")\r\n                masterData[\"RegistrationParameter\"] = keepOld ? inputData.masterData.RegistrationParameter : getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\")\r\n                let skipInfo = {};\r\n                if (inputData.masterData.RegistrationGetTest.length <= inputData.testskip) {\r\n                    testskip = 0;\r\n                    bool = true\r\n                }\r\n                if (bool) {\r\n                    skipInfo = { ...skipInfo, testskip, testtake }\r\n                }\r\n\r\n                let dataStateArray = [\r\n                    { activeName: 'selectedSample', dataStateName: 'sampleGridDataState' },\r\n                    { activeName: 'RegistrationSourceCountry', dataStateName: 'sourceDataState' },\r\n                    { activeName: 'RegistrationTestComment', dataStateName: 'testCommentDataState' },\r\n                    { activeName: 'RegistrationParameter', dataStateName: 'resultDataState' },\r\n                ]\r\n                dataStateArray.map(arr => {\r\n                    if (inputData[arr.dataStateName] && masterData[arr.activeName] &&\r\n                        masterData[arr.activeName].length <= inputData[arr.dataStateName].skip) {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            [arr.dataStateName]: {\r\n                                ...inputData[arr.dataStateName],\r\n                                skip: 0,\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    } else {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            [arr.dataStateName]: {\r\n                                ...inputData[arr.dataStateName],\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    }\r\n                    return null;\r\n                });\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData,\r\n                        loading: false,\r\n                        showFilter: false,\r\n                        activeSampleTab: inputData.activeSampleTab,\r\n                        activeTestTab: inputData.activeTestTab,\r\n                        ...skipInfo\r\n                    }\r\n                })\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n}\r\n\r\n\r\nexport function getRegistrationTestDetail(inputData, isServiceRequired) {\r\n    return function (dispatch) {\r\n        let inputParamData = {\r\n            nsampletypecode: inputData.nsampletypecode,\r\n            nregtypecode: inputData.nregtypecode,\r\n            nregsubtypecode: inputData.nregsubtypecode,\r\n            npreregno: inputData.npreregno,\r\n            ntransactionsamplecode: inputData.ntransactionsamplecode,\r\n            ntransactionstatus: inputData.ntransactionstatus,\r\n            napprovalconfigcode: inputData.napprovalconfigcode,\r\n            activeTestTab: inputData.activeTestTab,\r\n            activeSampleTab: inputData.activeSampleTab,\r\n            userinfo: inputData.userinfo,\r\n            ndesigntemplatemappingcode: inputData.ndesigntemplatemappingcode\r\n        }\r\n        let activeName = \"\";\r\n        let dataStateName = \"\";\r\n        dispatch(initRequest(true));\r\n        if (isServiceRequired) {\r\n            rsapi.post(\"registration/getRegistrationTest\", inputParamData)\r\n                .then(response => {\r\n                    sortData(response.data);\r\n                    let oldSelectedTest = inputData.masterData.selectedTest\r\n                    fillRecordBasedOnCheckBoxSelection(inputData.masterData, response.data,\r\n                        inputData.childTabsKey, inputData.checkBoxOperation, \"ntransactionsamplecode\",\r\n                        inputData.removeElementFromArray);\r\n                    let masterData = {\r\n                        ...inputData.masterData,\r\n                        selectedSubSample: inputData.selectedSubSample,\r\n                        selectedTransactionsamplecode: inputData.ntransactionsamplecode,\r\n                        selectedTest: inputData.masterData.RegistrationGetTest.length > 0 ?\r\n                            [inputData.masterData.RegistrationGetTest[0]] : [],\r\n                        // RegistrationTestComment,\r\n                    }\r\n                    //let wholeRegistrationTestComments = [];\r\n                    let RegistrationTestComment = [];\r\n                    let RegistrationParameter = [];\r\n                    if (inputData.checkBoxOperation === 1) {\r\n                        const wholeTestList = masterData.RegistrationGetTest.map(b => b.ntransactiontestcode)\r\n                        oldSelectedTest.forEach((test, index) => {\r\n                            if (!wholeTestList.includes(test.ntransactiontestcode)) {\r\n                                oldSelectedTest.splice(index, 1)\r\n                            }\r\n\r\n                        })\r\n\r\n                        let keepOld = false;\r\n                        let ntransactiontestcode;\r\n                        if (oldSelectedTest.length > 0) {\r\n                            keepOld = true\r\n                            masterData = {\r\n                                ...masterData,\r\n                                selectedTest: oldSelectedTest,\r\n                            }\r\n                        } else {\r\n                            ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ?\r\n                                inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : \"\"\r\n                        }\r\n                        switch (inputData.activeTestTab) {\r\n                            case \"IDS_PARAMETERRESULTS\":\r\n                                RegistrationParameter = keepOld ? inputData.masterData.RegistrationParameter ?\r\n                                    inputData.masterData.RegistrationParameter : [] :\r\n                                    getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\")\r\n                                activeName = \"RegistrationParameter\"\r\n                                dataStateName = \"resultDataState\"\r\n                                break;\r\n                            case \"IDS_TESTCOMMENTS\":\r\n                                RegistrationTestComment = keepOld ? inputData.masterData.RegistrationTestComment ?\r\n                                    inputData.masterData.RegistrationTestComment : [] :\r\n                                    getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationTestComment, ntransactiontestcode, \"ntransactiontestcode\")\r\n                                activeName = \"RegistrationTestComment\"\r\n                                dataStateName = \"testCommentDataState\"\r\n                                break;\r\n                            default:\r\n                                RegistrationParameter = keepOld ? inputData.masterData.RegistrationParameter ?\r\n                                    inputData.masterData.RegistrationParameter : [] :\r\n                                    getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\")\r\n                                activeName = \"RegistrationParameter\"\r\n                                dataStateName = \"resultDataState\"\r\n                                break;\r\n                        }\r\n\r\n\r\n\r\n                    }\r\n                    else if (inputData.checkBoxOperation === 5) {\r\n                        switch (inputData.activeTestTab) {\r\n                            case \"IDS_TESTCOMMENTS\":\r\n                                let ResponseData = response.data.RegistrationTestComment ? response.data.RegistrationTestComment : [];\r\n                                let RegistrationTestComment1 = [];\r\n                                if (inputData.masterData.RegistrationTestComment !== undefined) {\r\n                                    RegistrationTestComment1 = [...inputData.masterData.RegistrationTestComment, ...ResponseData];\r\n                                }\r\n                                let ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1\r\n                                RegistrationTestComment = getRecordBasedOnPrimaryKeyName(RegistrationTestComment1, ntransactiontestcode, \"ntransactiontestcode\");\r\n                                activeName = \"RegistrationTestComment\"\r\n                                dataStateName = \"testCommentDataState\"\r\n                                break;\r\n                            case \"IDS_PARAMETERRESULTS\":\r\n                                let resultResponseData = response.data.RegistrationParameter ? response.data.RegistrationParameter : [];\r\n                                let RegistrationParameter1 = [...inputData.masterData.RegistrationParameter, ...resultResponseData];\r\n                                let ntransactiontestcode1 = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1\r\n                                RegistrationParameter = getRecordBasedOnPrimaryKeyName(RegistrationParameter1, ntransactiontestcode1, \"ntransactiontestcode\");\r\n                                activeName = \"RegistrationParameter\"\r\n                                dataStateName = \"resultDataState\"\r\n                                break;\r\n                            default:\r\n                                let ResponseData1 = response.data.RegistrationTestComment ? response.data.RegistrationTestComment : [];\r\n                                let RegistrationTestComment2 = [];\r\n                                if (inputData.masterData.RegistrationTestComment !== undefined) {\r\n                                    RegistrationTestComment2 = [...inputData.masterData.RegistrationTestComment, ...ResponseData1];\r\n                                }\r\n                                let ntransactionTestCode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : -1\r\n                                RegistrationTestComment = getRecordBasedOnPrimaryKeyName(RegistrationTestComment2, ntransactionTestCode, \"ntransactiontestcode\");\r\n                                activeName = \"RegistrationParameter\"\r\n                                dataStateName = \"resultDataState\"\r\n                                break;\r\n                        }\r\n                        // RegistrationTestComment = response.data.RegistrationTestComment ? [...response.data.RegistrationTestComment] : [];\r\n                    }\r\n                    else {\r\n                        switch (inputData.activeTestTab) {\r\n                            case \"IDS_TESTCOMMENTS\":\r\n                                RegistrationTestComment = response.data.RegistrationTestComment ?\r\n                                    [...response.data.RegistrationTestComment] : [];\r\n                                activeName = \"RegistrationTestComment\"\r\n                                dataStateName = \"testCommentDataState\"\r\n                                break;\r\n                            case \"IDS_PARAMETERRESULTS\":\r\n                                RegistrationParameter = response.data.RegistrationParameter ?\r\n                                    [...response.data.RegistrationParameter] : [];\r\n                                activeName = \"RegistrationParameter\"\r\n                                dataStateName = \"resultDataState\"\r\n                                break;\r\n                            default:\r\n                                RegistrationParameter = response.data.RegistrationParameter ?\r\n                                    [...response.data.RegistrationParameter] : [];\r\n                                activeName = \"RegistrationParameter\"\r\n                                dataStateName = \"resultDataState\"\r\n                                break;\r\n                        }\r\n                    }\r\n                    masterData['RegistrationTestComment'] = RegistrationTestComment;\r\n                    masterData[\"RegistrationParameter\"] = RegistrationParameter;\r\n                    let { testskip, testtake } = inputData\r\n                    let bool = false;\r\n                    let skipInfo = {}\r\n                    if (inputData.masterData.RegistrationGetTest.length < inputData.testskip) {\r\n                        testskip = 0;\r\n                        bool = true\r\n                    }\r\n\r\n                    if (bool) {\r\n                        skipInfo = { testskip, testtake }\r\n                    }\r\n                    if (inputData.masterData.selectedSample && inputData.sampleGridDataState\r\n                        && inputData.masterData.selectedSample.length <= inputData.sampleGridDataState.skip) {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            sampleGridDataState: {\r\n                                ...inputData.sampleGridDataState,\r\n                                skip: 0,\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    } else {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            sampleGridDataState: {\r\n                                ...inputData.sampleGridDataState,\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    }\r\n                    if (inputData.searchTestRef !== undefined && inputData.searchTestRef.current !== null) {\r\n                        inputData.searchTestRef.current.value = \"\"\r\n                        masterData['searchedTest'] = undefined\r\n                    }\r\n                    let inputParam = { attachmentskip: undefined }\r\n                    if (inputData[dataStateName] && masterData[activeName].length <= inputData[dataStateName].skip) {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            [dataStateName]: {\r\n                                ...inputData[dataStateName],\r\n                                skip: 0,\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    } else {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            [dataStateName]: {\r\n                                ...inputData[dataStateName],\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    }\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            masterData,\r\n                            loading: false,\r\n                            showFilter: false,\r\n                            activeSampleTab: inputData.activeSampleTab,\r\n                            activeTestTab: inputData.activeTestTab,\r\n                            skip: undefined,\r\n                            take: undefined,\r\n                            ...skipInfo,\r\n                            inputParam\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        } else {\r\n            let oldSelectedTest = inputData.masterData.selectedTest\r\n            let TestSelected = getRecordBasedOnPrimaryKeyName(inputData.masterData.selectedTest, inputData.removeElementFromArray[0].npreregno, \"npreregno\");\r\n            let isGrandChildGetRequired = false;\r\n            if (TestSelected.length > 0) {\r\n                isGrandChildGetRequired = true;\r\n            } else {\r\n                isGrandChildGetRequired = false;\r\n            }\r\n            fillRecordBasedOnCheckBoxSelection(inputData.masterData, inputData.selectedSample, inputData.childTabsKey, inputData.checkBoxOperation, \"npreregno\", inputData.removeElementFromArray);\r\n            if (isGrandChildGetRequired) {\r\n                let ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ? inputData.masterData.RegistrationGetTest[0].ntransactiontestcode.toString() : \"-1\";\r\n                let selectedSubSample = inputData.selectedSubSample;\r\n                // let selectedPreregno = inputData.npreregno;\r\n                let selectedTest = inputData.masterData.RegistrationGetTest.length > 0 ? [inputData.masterData.RegistrationGetTest[0]] : [];\r\n                // let selectedSubSample = inputData.masterData.RegistrationGetSubSample\r\n                let masterData = { ...inputData.masterData, selectedSubSample, selectedTest }\r\n                inputData = {\r\n                    ...inputData, childTabsKey: [\"RegistrationTestComment\", \"RegistrationParameter\"], ntransactiontestcode, masterData, selectedTest,\r\n                    selectedSubSample, checkBoxOperation: 3\r\n                }\r\n                dispatch(getTestChildTabDetail(inputData, true));\r\n            } else {\r\n                let masterData = {\r\n                    ...inputData.masterData,\r\n                    selectedSubSample: inputData.selectedSubSample,\r\n                    selectedTransactioncode: inputData.ntransactionsamplecode,\r\n                    selectedTest: inputData.masterData.RegistrationGetTest.length > 0 ?\r\n                        [inputData.masterData.RegistrationGetTest[0]] : [],\r\n                }\r\n\r\n                const wholeTestList = masterData.RegistrationGetTest.map(b => b.ntransactiontestcode)\r\n                oldSelectedTest.forEach((test, index) => {\r\n                    if (!wholeTestList.includes(test.ntransactiontestcode)) {\r\n                        oldSelectedTest.splice(index, 1)\r\n                    }\r\n                    return null;\r\n                })\r\n                let keepOld = false;\r\n                let ntransactiontestcode;\r\n                if (oldSelectedTest.length > 0) {\r\n                    keepOld = true\r\n                    masterData = {\r\n                        ...masterData,\r\n                        selectedTest: oldSelectedTest,\r\n                    }\r\n                } else {\r\n                    ntransactiontestcode = inputData.masterData.RegistrationGetTest.length > 0 ?\r\n                        inputData.masterData.RegistrationGetTest[0].ntransactiontestcode : \"-1\"\r\n                }\r\n                masterData[\"RegistrationTestComment\"] = keepOld ? inputData.masterData.RegistrationTestComment ?\r\n                    inputData.masterData.RegistrationTestComment : [] :\r\n                    getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationTestComment, ntransactiontestcode, \"ntransactiontestcode\")\r\n                masterData[\"RegistrationParameter\"] = keepOld ? inputData.masterData.RegistrationParameter ?\r\n                    inputData.masterData.RegistrationParameter : [] :\r\n                    getRecordBasedOnPrimaryKeyName(inputData.masterData.RegistrationParameter, ntransactiontestcode, \"ntransactiontestcode\")\r\n                let skipInfo = {};\r\n                let dataStateArray = [\r\n                    { activeName: 'selectedSample', dataStateName: 'sampleGridDataState' },\r\n                    { activeName: 'RegistrationSourceCountry', dataStateName: 'sourceDataState' },\r\n                    { activeName: 'RegistrationTestComment', dataStateName: 'testCommentDataState' },\r\n                    { activeName: 'RegistrationParameter', dataStateName: 'resultDataState' },\r\n                ]\r\n                dataStateArray.map(arr => {\r\n                    if (inputData[arr.dataStateName] && masterData[arr.activeName] &&\r\n                        masterData[arr.activeName].length <= inputData[arr.dataStateName].skip) {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            [arr.dataStateName]: {\r\n                                ...inputData[arr.dataStateName],\r\n                                skip: 0,\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    } else {\r\n                        skipInfo = {\r\n                            ...skipInfo,\r\n                            [arr.dataStateName]: {\r\n                                ...inputData[arr.dataStateName],\r\n                                sort: undefined,\r\n                                filter: undefined\r\n                            }\r\n                        }\r\n                    }\r\n                    return null;\r\n                });\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData,\r\n                        loading: false,\r\n                        showFilter: false,\r\n                        activeSampleTab: inputData.activeSampleTab,\r\n                        activeTestTab: inputData.activeTestTab,\r\n                        ...skipInfo\r\n                    }\r\n                })\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n}\r\nexport function acceptRegistration(inputParam, LoginProps) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"/registration/acceptRegistration\", inputParam.inputData)\r\n            .then(response => {\r\n                if (response.data.rtn === undefined || response.data.rtn === \"Success\"\r\n                    || response.data.rtn === \"IDS_ATLEASTONETESTMUSTBEPREREGISTER\"\r\n                    || response.data.rtn === \"IDS_ALLSAMPLESAREREGISTERED\" || response.data.rtn === \"IDS_SELECTPREREGISTERORQUARANTINESAMPLES\") {\r\n                    replaceUpdatedObject(response.data[\"RegistrationGetSample\"], LoginProps.RegistrationGetSample, \"npreregno\");\r\n                    replaceUpdatedObject(response.data[\"RegistrationGetSubSample\"], LoginProps.RegistrationGetSubSample, \"ntransactionsamplecode\");\r\n                    replaceUpdatedObject(response.data[\"RegistrationGetTest\"], LoginProps.RegistrationGetTest, \"ntransactiontestcode\");\r\n\r\n                    delete response.data[\"RegistrationGetSample\"];\r\n                    delete response.data[\"RegistrationGetSubSample\"];\r\n                    delete response.data[\"RegistrationGetTest\"];\r\n                    let masterData = {\r\n                        ...LoginProps, ...response.data,\r\n                        selectedSample: replaceUpdatedObject(response.data[\"selectedSample\"], LoginProps.selectedSample, \"npreregno\"),\r\n                        selectedSubSample: replaceUpdatedObject(response.data[\"selectedSubSample\"], LoginProps.selectedSubSample, \"ntransactionsamplecode\"),\r\n                        selectedTest: replaceUpdatedObject(response.data[\"selectedTest\"], LoginProps.selectedTest, \"ntransactiontestcode\"),\r\n                    }\r\n                    let respObject = {\r\n                        masterData,\r\n                        ...inputParam.inputData,\r\n                        loading: false,\r\n                        loadEsign: false,\r\n                        openModal: false,\r\n                        showSample: undefined\r\n                    }\r\n                    dispatch(postCRUDOrganiseTransSearch(inputParam.postParamList, respObject))\r\n                    if (response.data.rtn === \"IDS_ATLEASTONETESTMUSTBEPREREGISTER\"\r\n                        || response.data.rtn === \"IDS_ALLSAMPLESAREREGISTERED\" || response.data.rtn === \"IDS_SELECTPREREGISTERORQUARANTINESAMPLES\") {\r\n                        toast.warn(intl.formatMessage({ id: response.data.rtn }));\r\n                    }\r\n                } else {\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN,\r\n                        payload: {\r\n                            loading: false,\r\n                            loadEsign: false,\r\n                            openModal: false\r\n                        }\r\n                    });\r\n                    toast.warn(response.data.rtn);\r\n                }\r\n            })\r\n            .catch(error => {\r\n                toast.error(error.message);\r\n            })\r\n    }\r\n}\r\n\r\nexport const addMoreTest = (inputParam, ncontrolCode) => {\r\n    return (dispatch) => {\r\n        let { sampleList } = inputParam;\r\n        let value = false;\r\n        value = inputParam.selectedsubsample.some(obj => obj.nspecsampletypecode !== inputParam.selectedsubsample[0].nspecsampletypecode)\r\n        if (value) {\r\n            return toast.warn(intl.formatMessage({ id: \"IDS_PLEASESELECTSAMPLEWITHSAMESPECANDCOMPONENT\" }));\r\n        }\r\n        sampleList = sampleList ? [...sampleList.slice(inputParam.skip, inputParam.take)] : [];\r\n        const selectedsample = getSameRecordFromTwoArrays(sampleList, inputParam.selectedsample, \"npreregno\");\r\n        const selectsubsample = getSameRecordFromTwoArrays(sampleList, inputParam.selectedsubsample, \"npreregno\");\r\n        if (selectedsample && selectedsample.length > 0) {\r\n            const findTransactionStatus = [...new Set(selectedsample.map(item => item.jsondata.ntransactionstatus))];\r\n\r\n            if (findTransactionStatus.length === 1) {\r\n                if (findTransactionStatus[0] !== transactionStatus.REJECT && findTransactionStatus[0] !== transactionStatus.CANCELLED) {\r\n                    if (findTransactionStatus[0] !== transactionStatus.CERTIFIED && findTransactionStatus[0] !== transactionStatus.SENT) {\r\n                        const findApprovalVersion = [...new Set(selectedsample.map(item => item.napprovalversioncode))];\r\n                        if (findApprovalVersion.length === 1) {\r\n                            const findSampleSpec = [...new Set(selectedsample.map(item => item.nallottedspeccode))];\r\n                            //const findComponent = [...new Set(selectsubsample.map(item => item.ncomponentcode))];\r\n                            if (findSampleSpec.length === 1)//&& findComponent.length === 1 \r\n                            {\r\n                                dispatch(initRequest(true));\r\n                                rsapi.post(\"/registration/getMoreTest\", { ...inputParam })\r\n                                    .then(response => {\r\n                                        dispatch({\r\n                                            type: DEFAULT_RETURN,\r\n                                            payload: {\r\n                                                availableTest: response.data,\r\n                                                loadChildTest: true,\r\n                                                loading: false, ncontrolCode,\r\n                                                screenName: \"IDS_TEST\",\r\n                                                operation: \"create\",\r\n                                                openModal: true,\r\n                                                parentPopUpSize: \"lg\",\r\n                                                selectedRecord: {},\r\n                                                showSample: undefined\r\n                                            }\r\n                                        });\r\n                                    })\r\n                                    .catch(error => {\r\n                                        dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                                        if (error.response.status === 500) {\r\n                                            toast.error(error.message);\r\n                                        } else {\r\n                                            toast.warn(this.props.formatMessage({ id: error.response.data }));\r\n                                        }\r\n                                    });\r\n                            } else {\r\n                                toast.warn(intl.formatMessage({ id: \"IDS_PLEASESELECTSAMPLEWITHSAMESPECANDCOMPONENT\" }));\r\n                            }\r\n                        } else {\r\n                            toast.warn(intl.formatMessage({ id: \"IDS_PLEASESELECTSAMPLEWITHSAMEAPPROVALCONFIG\" }));\r\n                        }\r\n                    }\r\n                    else {\r\n                        toast.warn(intl.formatMessage({ id: \"IDS_TESTCANNOTBEFORCERTIFIEDSAMPLES\" }));\r\n                    }\r\n                }\r\n                else {\r\n                    ////     toast.warn(intl.formatMessage({ id: \"IDS_TESTCANNOTBEFORCANCELLEDREJECTSAMPLES\" }));\r\n                    toast.warn(intl.formatMessage({ id: \"IDS_SAMPLEISREJECTEDORCANCELLED\" }));\r\n                }\r\n            } else {\r\n                toast.warn(intl.formatMessage({ id: \"IDS_PLEASESELECTSAMPLEWITHSAMESTATUS\" }));\r\n            }\r\n        } else {\r\n            toast.warn(intl.formatMessage({ id: \"IDS_SELECTSAMPLE\" }));\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nexport const createRegistrationTest = (inputParam, masterData, modalName) => {\r\n    return (dispatch) => {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(inputParam.classUrl + \"/\" + inputParam.operation + inputParam.methodUrl, { ...inputParam.inputData })\r\n            .then(response => {\r\n                let RegistrationGetTest = updatedObjectWithNewElement(masterData[\"RegistrationGetTest\"], response.data[\"RegistrationGetTest\"]);\r\n                masterData = {\r\n                    ...masterData,\r\n                    RegistrationGetTest,\r\n                    selectedTest: response.data[\"RegistrationGetTest\"],\r\n                    RegistrationParameter: response.data.RegistrationParameter,\r\n                    // RegistrationGetSample: replaceUpdatedObject(response.data.selectedSample, masterData.RegistrationGetSample, 'npreregno')\r\n                }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        masterData,\r\n                        [modalName]: false,\r\n                        loading: false,\r\n                        loadChildTest: false,\r\n                        showSample: undefined,\r\n                        openModal: false,\r\n                        selectedRecord: {}\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(intl.formatMessage({ id: error.response.data }));\r\n                }\r\n            });\r\n    }\r\n}\r\n\r\nexport function getEditRegistrationComboService(inputParam, columnList, selectedRecord1, childColumnList, comboComponents,\r\n    withoutCombocomponent) {\r\n    return function (dispatch) {\r\n\r\n        dispatch(initRequest(true));\r\n        const { userInfo, operation } = { ...inputParam };\r\n\r\n        const npreregno = inputParam.mastertoedit[inputParam.primaryKeyName];\r\n        let urlArray = [];\r\n\r\n        const timeZoneService = rsapi.post(\"timezone/getTimeZone\");\r\n        const actualService = rsapi.post(\"dynamicpreregdesign/getComboValues\", {\r\n            parentcolumnlist: columnList,\r\n            childcolumnlist: childColumnList,\r\n            userinfo:userInfo\r\n        })\r\n        const selectedRegistration = rsapi.post(\"/registration/getEditRegistrationDetails\", { ...inputParam.editRegParam, npreregno })\r\n\r\n        urlArray = [timeZoneService, actualService, selectedRegistration]\r\n\r\n        Axios.all(urlArray)\r\n            .then(response => {\r\n                let selectedRecord = { ...response[2].data[\"SelectedRegistration\"][0] };\r\n                selectedRecord={...selectedRecord,...selectedRecord['jsondata']}\r\n                // const recordToEdit = { ...response[2].data[\"SelectedRegistration\"][0] };\r\n                //  const currentTime = rearrangeDateFormat(userInfo, response[6].data);\r\n\r\n                const timeZoneMap = constructOptionList(response[0].data || [], \"ntimezonecode\", \"stimezoneid\", undefined, undefined, true);\r\n                const timeZoneList = timeZoneMap.get(\"OptionList\");\r\n                const defaultTimeZone = { label: userInfo.stimezoneid, value: userInfo.ntimezonecode }\r\n                //  const newcomboData = parentChildComboLoad(columnList, response[1].data,\r\n                // selectedRecord, childColumnList, withoutCombocomponent)\r\n\r\n                if (selectedRecord.ntransactionstatus === transactionStatus.CANCELLED\r\n                    || selectedRecord.ntransactionstatus === transactionStatus.REJECT) {\r\n                    toast.warn(intl.formatMessage({ id: \"IDS_CANNOTEDITCANCELLEDSAMPLE\" }));\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } });\r\n                }\r\n\r\n                else {\r\n                    const languagetypeCode = undefined\r\n                    const comboData = response[1].data;\r\n                    let comboValues = {}\r\n                    if (columnList.length > 0) {\r\n                        columnList.map(x => {\r\n                            if (x.inputtype === 'combo') {\r\n                                if (comboData[x.label] && comboData[x.label].length > 0) //&& comboData[x.label][0].hasOwnProperty(x.source) \r\n                                {\r\n                                    if (comboData[x.label].length > 0) {\r\n                                        if (comboData[x.label][0].label === undefined) {\r\n                                            const optionList = constructjsonOptionList(comboData[x.label] || [], x.valuemember,\r\n                                                x.displaymember, false, false, true, undefined, x.source, x.isMultiLingual, languagetypeCode)\r\n                                            comboData[x.label] = optionList.get(\"OptionList\");\r\n                                        } else {\r\n                                            comboData[x.label] = comboData[x.label]\r\n                                            const optionList = constructjsonOptionDefault(comboData[x.label] || [], x.valuemember,\r\n                                                x.displaymember, false, false, true, undefined, x.source, x.isMultiLingual, languagetypeCode)\r\n                                        }\r\n                                    } else {\r\n                                        comboData[x.label] = []\r\n                                    }\r\n                                    //comboValues = childComboLoad(x, comboData, selectedRecord, \r\n                                    //   childColumnList, withoutCombocomponent)\\\r\n                                    comboValues = childComboLoad(x, comboData, selectedRecord1, \r\n                                        childColumnList, withoutCombocomponent)\r\n                                } else {\r\n                                    comboValues = {\r\n                                        \"comboData\": comboData,\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                comboValues = {\r\n                                    comboData: comboData,\r\n                                    ...comboValues\r\n                                }\r\n                            }\r\n                        })\r\n                    }\r\n                    else {\r\n                        comboValues = {\r\n                            \"comboData\": comboData,\r\n                        }\r\n                    }\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN,\r\n                        payload: {\r\n                            AgaramTree: response[2].data[\"AgaramTree\"],\r\n                            FocusKey: response[2].data[\"FocusKey\"],\r\n                            ActiveKey: response[2].data[\"ActiveKey\"],\r\n                            OpenNodes: response[2].data[\"OpenNodes\"],\r\n                            // statustoEditDetail: response[2].data[\"ApprovalConfigRole\"] || {},\r\n                            // currentTime,\r\n                            operation,\r\n                            //  screenName: popUpLabel,\r\n                            // PopUpLabel: popUpLabel,\r\n                            timeZoneList,\r\n                            defaultTimeZone,\r\n                            selectedRecord,\r\n                            openPortal: true,\r\n                            ncontrolCode: inputParam.editRegParam.ncontrolCode,\r\n                            loadPreregister: true,\r\n                            parentPopUpSize: \"xl\",\r\n                            loading: false,\r\n                            showSample: undefined,\r\n                            comboData: comboValues.comboData\r\n                            //  regRecordToEdit:recordToEdit\r\n\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                } else {\r\n                    toast.warn(intl.formatMessage({\r\n                        id: error.response.data\r\n                    }));\r\n                }\r\n            })\r\n\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}