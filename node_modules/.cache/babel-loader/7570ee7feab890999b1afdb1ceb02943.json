{"ast":null,"code":"var __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport { clone } from '@progress/kendo-react-common';\nimport * as React from 'react';\nimport { useSchedulerFieldsContext, useSchedulerGroupsContext, useSchedulerViewSelectedItemsContext } from '../../context';\nimport { useControlledState } from '../../hooks/useControlledState';\nimport { DATA_ACTION } from '../../main';\nimport { getField, setField, slotDive } from '../../utils';\n/**\n * Represents the available `action` types for the `SchedulerItemDragItemAction` objects.\n *\n * The available types are:\n * - `DRAG_ITEM_SET'`\n * - `DRAG_ITEM_START'`\n * - `DRAG_ITEM_DRAG'`\n * - `DRAG_ITEM_COMPLETE'`\n * - `DRAG_ITEM_COMPLETE_OCCURRENCE'`\n * - `DRAG_ITEM_COMPLETE_SERIES'`\n * - `DRAG_ITEM_RESET'`\n * - `DRAG_ITEM_DRAG_SELECTED`\n */\n\nexport var DRAG_ITEM_ACTION;\n\n(function (DRAG_ITEM_ACTION) {\n  DRAG_ITEM_ACTION[\"set\"] = \"DRAG_ITEM_SET\";\n  DRAG_ITEM_ACTION[\"start\"] = \"DRAG_ITEM_START\";\n  DRAG_ITEM_ACTION[\"drag\"] = \"DRAG_ITEM_DRAG\";\n  DRAG_ITEM_ACTION[\"complete\"] = \"DRAG_ITEM_COMPLETE\";\n  DRAG_ITEM_ACTION[\"completeOccurrence\"] = \"DRAG_ITEM_COMPLETE_OCCURRENCE\";\n  DRAG_ITEM_ACTION[\"completeSeries\"] = \"DRAG_ITEM_COMPLETE_SERIES\";\n  DRAG_ITEM_ACTION[\"reset\"] = \"DRAG_ITEM_RESET\";\n  DRAG_ITEM_ACTION[\"dragSelected\"] = \"DRAG_ITEM_DRAG_SELECTED\";\n})(DRAG_ITEM_ACTION || (DRAG_ITEM_ACTION = {}));\n\n;\n/** @hidden */\n\nexport var useDragItem = function useDragItem(config, state) {\n  var offset = React.useRef(0);\n  var initialXRef = React.useRef(0);\n  var initialYRef = React.useRef(0);\n  var oldSlot = React.useRef(null);\n\n  var _a = useControlledState.apply(void 0, state),\n      dragItem = _a[0],\n      setDragItem = _a[1];\n\n  var selectedItems = useSchedulerViewSelectedItemsContext()[0];\n  var fields = useSchedulerFieldsContext();\n  var groups = useSchedulerGroupsContext();\n\n  var handleDragItemAction = function handleDragItemAction(action) {\n    switch (action.type) {\n      case DRAG_ITEM_ACTION.set:\n        {\n          setDragItem(action.payload);\n          break;\n        }\n\n      case DRAG_ITEM_ACTION.reset:\n        {\n          setDragItem(null);\n          break;\n        }\n\n      case DRAG_ITEM_ACTION.dragSelected:\n        {\n          if (Math.abs(initialXRef.current - action.payload.x) < 10 && Math.abs(initialYRef.current - action.payload.y) < 10) {\n            return;\n          }\n\n          var slot = slotDive(action.payload.x, action.payload.y, 7);\n\n          if (!slot) {\n            return;\n          }\n\n          if (slot === oldSlot.current) {\n            return;\n          }\n\n          var dataItem = clone(config.dataItem);\n          var slotStart = slot.getAttribute('data-slot-start');\n          var slotIsAllDay = slot.getAttribute('data-slot-allday') === 'true';\n\n          if (!config.ignoreIsAllDay && slotIsAllDay !== config.isAllDay) {\n            return;\n          }\n\n          var itemStart = new Date(getField(dataItem, fields.start));\n          var distance_1 = Number(slotStart) - itemStart.getTime();\n          var newDragItems = selectedItems.map(function (si) {\n            if (!si.current) {\n              return null;\n            }\n\n            var selectedDataItem = clone(si.current.props.dataItem);\n            var selectedStart = new Date(si.current.props.start.getTime() + distance_1);\n            var selectedEnd = new Date(si.current.props.end.getTime() + distance_1);\n            setField(selectedDataItem, fields.start, selectedStart);\n            setField(selectedDataItem, fields.end, selectedEnd);\n            return selectedDataItem;\n          }).filter(Boolean);\n          oldSlot.current = slot;\n          setDragItem(__spreadArray([], newDragItems, true));\n          break;\n        }\n\n      case DRAG_ITEM_ACTION.start:\n        {\n          var clientX = action.payload.x;\n          var clientY = action.payload.y;\n          initialXRef.current = clientX;\n          initialYRef.current = clientY;\n          var slot = slotDive(clientX, clientY, 7);\n\n          if (!slot) {\n            return;\n          }\n\n          var dataItem = clone(config.dataItem);\n          var slotStart = slot.getAttribute('data-slot-start');\n          var itemStart = getField(dataItem, fields.start);\n\n          if (slotStart === null) {\n            return;\n          }\n\n          offset.current = Number(slotStart) - new Date(itemStart).getTime();\n          break;\n        }\n\n      case DRAG_ITEM_ACTION.drag:\n        {\n          if (Math.abs(initialXRef.current - action.payload.x) < 10 && Math.abs(initialYRef.current - action.payload.y) < 10) {\n            return;\n          }\n\n          var slot = slotDive(action.payload.x, action.payload.y, 7);\n\n          if (!slot) {\n            return;\n          }\n\n          if (slot === oldSlot.current) {\n            return;\n          }\n\n          var dataItem_1 = clone(config.dataItem);\n          var slotStart = slot.getAttribute('data-slot-start');\n          var slotGroupIndex_1 = slot.getAttribute('data-slot-group');\n          var slotIsAllDay = slot.getAttribute('data-slot-allday') === 'true';\n\n          if (!config.ignoreIsAllDay && slotIsAllDay !== config.isAllDay) {\n            return;\n          }\n\n          var itemStart = new Date(getField(dataItem_1, fields.start));\n          var itemEnd = new Date(getField(dataItem_1, fields.end));\n          var duration = itemEnd.getTime() - itemStart.getTime();\n          var start = new Date(Number(slotStart) - Number(offset.current));\n          var end = new Date(Number(slotStart) - Number(offset.current) + duration);\n          var group = groups.find(function (g) {\n            return g.index === Number(slotGroupIndex_1);\n          });\n          setField(dataItem_1, fields.start, start);\n          setField(dataItem_1, fields.end, end);\n\n          if (group && groups.length > 1) {\n            group.resources.forEach(function (resource) {\n              if (!resource.multiple) {\n                setField(dataItem_1, resource.field, resource[resource.valueField]);\n              }\n            });\n          }\n\n          oldSlot.current = slot;\n\n          if (dataItem_1) {\n            setDragItem(dataItem_1);\n          }\n\n          break;\n        }\n\n      case DRAG_ITEM_ACTION.complete:\n        {\n          setDragItem(null);\n\n          if (config.onDataAction && dragItem) {\n            config.onDataAction.call(undefined, {\n              type: DATA_ACTION.update,\n              series: false,\n              dataItem: dragItem\n            });\n          }\n\n          break;\n        }\n\n      case DRAG_ITEM_ACTION.completeOccurrence:\n        {\n          var newDataItem = Array.isArray(dragItem) ? dragItem.slice() : clone(dragItem);\n          setDragItem(null);\n\n          if (config.onDataAction && dragItem) {\n            config.onDataAction.call(undefined, {\n              type: DATA_ACTION.update,\n              series: false,\n              dataItem: newDataItem\n            });\n          }\n\n          break;\n        }\n\n      case DRAG_ITEM_ACTION.completeSeries:\n        {\n          var newDataItems = void 0;\n\n          if (Array.isArray(dragItem)) {\n            newDataItems = dragItem.map(function (di) {\n              var updated = clone(di);\n              setField(updated, fields.start, getField(di, fields.start));\n              setField(updated, fields.end, getField(di, fields.end));\n              return updated;\n            });\n          } else {\n            var updated = clone(dragItem);\n            setField(updated, fields.start, getField(dragItem, fields.start));\n            setField(updated, fields.end, getField(dragItem, fields.end));\n            newDataItems = updated;\n          }\n\n          setDragItem(null);\n\n          if (config.onDataAction && newDataItems) {\n            config.onDataAction.call(undefined, {\n              type: DATA_ACTION.update,\n              series: true,\n              dataItem: newDataItems\n            });\n          }\n\n          break;\n        }\n\n      default:\n        setDragItem(dragItem);\n        break;\n    }\n  };\n\n  return [dragItem, setDragItem, handleDragItemAction];\n};","map":{"version":3,"sources":["E:/WorkingFolder/React_Postgres/ALPD/SOURCE-512/QuaLISWeb/node_modules/@progress/kendo-react-scheduler/dist/es/items/hooks/use-drag-item.js"],"names":["__spreadArray","to","from","pack","arguments","length","i","l","ar","Array","prototype","slice","call","concat","clone","React","useSchedulerFieldsContext","useSchedulerGroupsContext","useSchedulerViewSelectedItemsContext","useControlledState","DATA_ACTION","getField","setField","slotDive","DRAG_ITEM_ACTION","useDragItem","config","state","offset","useRef","initialXRef","initialYRef","oldSlot","_a","apply","dragItem","setDragItem","selectedItems","fields","groups","handleDragItemAction","action","type","set","payload","reset","dragSelected","Math","abs","current","x","y","slot","dataItem","slotStart","getAttribute","slotIsAllDay","ignoreIsAllDay","isAllDay","itemStart","Date","start","distance_1","Number","getTime","newDragItems","map","si","selectedDataItem","props","selectedStart","selectedEnd","end","filter","Boolean","clientX","clientY","drag","dataItem_1","slotGroupIndex_1","itemEnd","duration","group","find","g","index","resources","forEach","resource","multiple","field","valueField","complete","onDataAction","undefined","update","series","completeOccurrence","newDataItem","isArray","completeSeries","newDataItems","di","updated"],"mappings":"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","sourcesContent":["var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { clone } from '@progress/kendo-react-common';\nimport * as React from 'react';\nimport { useSchedulerFieldsContext, useSchedulerGroupsContext, useSchedulerViewSelectedItemsContext } from '../../context';\nimport { useControlledState } from '../../hooks/useControlledState';\nimport { DATA_ACTION } from '../../main';\nimport { getField, setField, slotDive } from '../../utils';\n/**\n * Represents the available `action` types for the `SchedulerItemDragItemAction` objects.\n *\n * The available types are:\n * - `DRAG_ITEM_SET'`\n * - `DRAG_ITEM_START'`\n * - `DRAG_ITEM_DRAG'`\n * - `DRAG_ITEM_COMPLETE'`\n * - `DRAG_ITEM_COMPLETE_OCCURRENCE'`\n * - `DRAG_ITEM_COMPLETE_SERIES'`\n * - `DRAG_ITEM_RESET'`\n * - `DRAG_ITEM_DRAG_SELECTED`\n */\nexport var DRAG_ITEM_ACTION;\n(function (DRAG_ITEM_ACTION) {\n    DRAG_ITEM_ACTION[\"set\"] = \"DRAG_ITEM_SET\";\n    DRAG_ITEM_ACTION[\"start\"] = \"DRAG_ITEM_START\";\n    DRAG_ITEM_ACTION[\"drag\"] = \"DRAG_ITEM_DRAG\";\n    DRAG_ITEM_ACTION[\"complete\"] = \"DRAG_ITEM_COMPLETE\";\n    DRAG_ITEM_ACTION[\"completeOccurrence\"] = \"DRAG_ITEM_COMPLETE_OCCURRENCE\";\n    DRAG_ITEM_ACTION[\"completeSeries\"] = \"DRAG_ITEM_COMPLETE_SERIES\";\n    DRAG_ITEM_ACTION[\"reset\"] = \"DRAG_ITEM_RESET\";\n    DRAG_ITEM_ACTION[\"dragSelected\"] = \"DRAG_ITEM_DRAG_SELECTED\";\n})(DRAG_ITEM_ACTION || (DRAG_ITEM_ACTION = {}));\n;\n/** @hidden */\nexport var useDragItem = function (config, state) {\n    var offset = React.useRef(0);\n    var initialXRef = React.useRef(0);\n    var initialYRef = React.useRef(0);\n    var oldSlot = React.useRef(null);\n    var _a = useControlledState.apply(void 0, state), dragItem = _a[0], setDragItem = _a[1];\n    var selectedItems = useSchedulerViewSelectedItemsContext()[0];\n    var fields = useSchedulerFieldsContext();\n    var groups = useSchedulerGroupsContext();\n    var handleDragItemAction = function (action) {\n        switch (action.type) {\n            case DRAG_ITEM_ACTION.set: {\n                setDragItem(action.payload);\n                break;\n            }\n            case DRAG_ITEM_ACTION.reset: {\n                setDragItem(null);\n                break;\n            }\n            case DRAG_ITEM_ACTION.dragSelected: {\n                if (Math.abs(initialXRef.current - action.payload.x) < 10\n                    && Math.abs(initialYRef.current - action.payload.y) < 10) {\n                    return;\n                }\n                var slot = slotDive(action.payload.x, action.payload.y, 7);\n                if (!slot) {\n                    return;\n                }\n                if (slot === oldSlot.current) {\n                    return;\n                }\n                var dataItem = clone(config.dataItem);\n                var slotStart = slot.getAttribute('data-slot-start');\n                var slotIsAllDay = slot.getAttribute('data-slot-allday') === 'true';\n                if (!config.ignoreIsAllDay && slotIsAllDay !== config.isAllDay) {\n                    return;\n                }\n                var itemStart = new Date(getField(dataItem, fields.start));\n                var distance_1 = Number(slotStart) - itemStart.getTime();\n                var newDragItems = selectedItems.map(function (si) {\n                    if (!si.current) {\n                        return null;\n                    }\n                    var selectedDataItem = clone(si.current.props.dataItem);\n                    var selectedStart = new Date(si.current.props.start.getTime() + distance_1);\n                    var selectedEnd = new Date(si.current.props.end.getTime() + distance_1);\n                    setField(selectedDataItem, fields.start, selectedStart);\n                    setField(selectedDataItem, fields.end, selectedEnd);\n                    return selectedDataItem;\n                }).filter(Boolean);\n                oldSlot.current = slot;\n                setDragItem(__spreadArray([], newDragItems, true));\n                break;\n            }\n            case DRAG_ITEM_ACTION.start: {\n                var clientX = action.payload.x;\n                var clientY = action.payload.y;\n                initialXRef.current = clientX;\n                initialYRef.current = clientY;\n                var slot = slotDive(clientX, clientY, 7);\n                if (!slot) {\n                    return;\n                }\n                var dataItem = clone(config.dataItem);\n                var slotStart = slot.getAttribute('data-slot-start');\n                var itemStart = getField(dataItem, fields.start);\n                if (slotStart === null) {\n                    return;\n                }\n                offset.current = Number(slotStart) - new Date(itemStart).getTime();\n                break;\n            }\n            case DRAG_ITEM_ACTION.drag: {\n                if (Math.abs(initialXRef.current - action.payload.x) < 10\n                    && Math.abs(initialYRef.current - action.payload.y) < 10) {\n                    return;\n                }\n                var slot = slotDive(action.payload.x, action.payload.y, 7);\n                if (!slot) {\n                    return;\n                }\n                if (slot === oldSlot.current) {\n                    return;\n                }\n                var dataItem_1 = clone(config.dataItem);\n                var slotStart = slot.getAttribute('data-slot-start');\n                var slotGroupIndex_1 = slot.getAttribute('data-slot-group');\n                var slotIsAllDay = slot.getAttribute('data-slot-allday') === 'true';\n                if (!config.ignoreIsAllDay && slotIsAllDay !== config.isAllDay) {\n                    return;\n                }\n                var itemStart = new Date(getField(dataItem_1, fields.start));\n                var itemEnd = new Date(getField(dataItem_1, fields.end));\n                var duration = itemEnd.getTime() - itemStart.getTime();\n                var start = new Date(Number(slotStart) - Number(offset.current));\n                var end = new Date(Number(slotStart) - Number(offset.current) + duration);\n                var group = groups.find(function (g) { return g.index === Number(slotGroupIndex_1); });\n                setField(dataItem_1, fields.start, start);\n                setField(dataItem_1, fields.end, end);\n                if (group && groups.length > 1) {\n                    group.resources.forEach(function (resource) {\n                        if (!resource.multiple) {\n                            setField(dataItem_1, resource.field, resource[resource.valueField]);\n                        }\n                    });\n                }\n                oldSlot.current = slot;\n                if (dataItem_1) {\n                    setDragItem(dataItem_1);\n                }\n                break;\n            }\n            case DRAG_ITEM_ACTION.complete: {\n                setDragItem(null);\n                if (config.onDataAction && dragItem) {\n                    config.onDataAction.call(undefined, {\n                        type: DATA_ACTION.update,\n                        series: false,\n                        dataItem: dragItem\n                    });\n                }\n                break;\n            }\n            case DRAG_ITEM_ACTION.completeOccurrence: {\n                var newDataItem = Array.isArray(dragItem) ? dragItem.slice() : clone(dragItem);\n                setDragItem(null);\n                if (config.onDataAction && dragItem) {\n                    config.onDataAction.call(undefined, {\n                        type: DATA_ACTION.update,\n                        series: false,\n                        dataItem: newDataItem\n                    });\n                }\n                break;\n            }\n            case DRAG_ITEM_ACTION.completeSeries: {\n                var newDataItems = void 0;\n                if (Array.isArray(dragItem)) {\n                    newDataItems = dragItem.map(function (di) {\n                        var updated = clone(di);\n                        setField(updated, fields.start, getField(di, fields.start));\n                        setField(updated, fields.end, getField(di, fields.end));\n                        return updated;\n                    });\n                }\n                else {\n                    var updated = clone(dragItem);\n                    setField(updated, fields.start, getField(dragItem, fields.start));\n                    setField(updated, fields.end, getField(dragItem, fields.end));\n                    newDataItems = updated;\n                }\n                setDragItem(null);\n                if (config.onDataAction && newDataItems) {\n                    config.onDataAction.call(undefined, {\n                        type: DATA_ACTION.update,\n                        series: true,\n                        dataItem: newDataItems\n                    });\n                }\n                break;\n            }\n            default:\n                setDragItem(dragItem);\n                break;\n        }\n    };\n    return [dragItem, setDragItem, handleDragItemAction];\n};\n"]},"metadata":{},"sourceType":"module"}