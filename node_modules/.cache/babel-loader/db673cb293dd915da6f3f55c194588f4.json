{"ast":null,"code":"import { DEFAULT_RETURN } from './LoginTypes';\nimport rsapi from '../rsapi';\nimport { toast } from 'react-toastify';\nimport { sortData, constructOptionList } from '../components/CommonScript';\nimport { initRequest } from './LoginAction';\nimport { intl } from '../components/App';\nimport Axios from 'axios';\nimport { transactionStatus } from '../components/Enumeration';\nexport function getSiteDetail(Site, userInfo, masterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    return rsapi.post(\"site/getSiteScreen\", {\n      nsitecode: Site.nsitecode,\n      userinfo: userInfo\n    }).then(response => {\n      masterData = { ...masterData,\n        ...response.data\n      };\n      sortData(masterData);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          operation: null,\n          modalName: undefined,\n          loading: false,\n          dataState: undefined\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getSiteCombo(siteParam) {\n  return function (dispatch) {\n    let urlArray = [];\n    let selectedId = null;\n    const timeZoneService = rsapi.post(\"timezone/getTimeZone\");\n    const dateformat = rsapi.post(\"site/getDateFormat\", {\n      userinfo: siteParam.userInfo\n    });\n\n    if (siteParam.operation === \"create\") {\n      urlArray = [timeZoneService, dateformat];\n    } else {\n      const SiteByID = rsapi.post(\"site/getActiveSiteById\", {\n        [siteParam.primaryKeyField]: siteParam.primaryKeyValue,\n        \"userinfo\": siteParam.userInfo\n      });\n      const districtService = rsapi.post(\"site/getDistrict\", {\n        userinfo: siteParam.userInfo,\n        \"nregioncode\": siteParam.editRow.nregioncode\n      });\n      urlArray = [timeZoneService, dateformat, SiteByID, districtService];\n      selectedId = siteParam.primaryKeyValue;\n    }\n\n    dispatch(initRequest(true));\n    Axios.all(urlArray).then(response => {\n      let timezone = [];\n      let dateFormat = [];\n      let region = [];\n      let district = [];\n      let districtList = [];\n      let selectedRecord = {};\n      const timezoneMap = constructOptionList(response[0].data || [], \"ntimezonecode\", \"stimezoneid\", undefined, undefined, false);\n      const TimeZoneList = timezoneMap.get(\"OptionList\");\n      const dateFormatMap = constructOptionList(response[1].data.DateFormat || [], \"ndateformatcode\", \"sdateformat\", undefined, undefined, false);\n      const dateFormatList = dateFormatMap.get(\"OptionList\");\n      const regionMap = constructOptionList(response[1].data.Region || [], \"nregioncode\", \"sregionname\", undefined, undefined, false);\n      const regionList = regionMap.get(\"OptionList\");\n\n      if (siteParam.operation === \"update\") {\n        const districtMap = constructOptionList(response[3].data.districtList || [], \"ndistrictcode\", \"sdistrictname\", undefined, undefined, false);\n        districtList = districtMap.get(\"OptionList\");\n      }\n\n      if (siteParam.operation === \"update\") {\n        selectedRecord = response[2].data;\n        timezone.push({\n          \"value\": response[2].data[\"ntimezonecode\"],\n          \"label\": response[2].data[\"stimezoneid\"]\n        });\n        dateFormat.push({\n          \"value\": response[2].data[\"ndateformatcode\"],\n          \"label\": response[2].data[\"sdateformat\"]\n        });\n        region.push({\n          \"value\": response[2].data[\"nregioncode\"],\n          \"label\": response[2].data[\"sregionname\"]\n        });\n        district.push({\n          \"value\": response[2].data[\"ndistrictcode\"],\n          \"label\": response[2].data[\"sdistrictname\"]\n        });\n\n        if (response[2].data.nutcconversation !== transactionStatus.NO) {\n          selectedRecord[\"ntimezonecode\"] = timezone[0];\n          selectedRecord[\"ndateformatcode\"] = dateFormat[0];\n        } else {\n          selectedRecord[\"ntimezonecode\"] = undefined;\n          selectedRecord[\"ndateformatcode\"] = undefined;\n          selectedRecord[\"nutcconversation\"] = response[2].data.nutcconversation;\n        }\n\n        if (response[2].data.nisdistributed !== transactionStatus.NO) {\n          selectedRecord[\"nregioncode\"] = region[0].label !== 'NA' ? region[0] : undefined;\n          selectedRecord[\"ndistrictcode\"] = district[0].label !== 'NA' ? district[0] : undefined;\n        } else {\n          selectedRecord[\"nregioncode\"] = undefined;\n          selectedRecord[\"ndistrictcode\"] = undefined;\n          selectedRecord[\"ssitecode\"] = \"\";\n        }\n      } // else {\n      //     selectedRecord = {\n      //         ntimezonecode: {\n      //             \"label\": siteParam.userInfo.stimezoneid,\n      //             \"value\": siteParam.userInfo.ntimezonecode\n      //         }\n      //     };\n      // }\n\n\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          TimeZoneList,\n          isOpen: true,\n          selectedRecord: siteParam.operation === \"update\" ? selectedRecord : {\n            \"ntransactionstatus\": 1\n          },\n          operation: siteParam.operation,\n          screenName: siteParam.screenName,\n          selectedRecord,\n          openModal: true,\n          ncontrolCode: siteParam.ncontrolCode,\n          loading: false,\n          selectedId,\n          dateFormatList,\n          regionList,\n          districtList\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(intl.formatMessage({\n          id: error.message\n        }));\n      } else {\n        toast.warn(intl.formatMessage({\n          id: error.response.data\n        }));\n      }\n    });\n  };\n}\nexport function getDistrictByRegion(methodParam) {\n  return function (dispatch) {\n    let URL = [];\n    URL = rsapi.post(\"/site/getDistrict\", {\n      \"userinfo\": methodParam.inputData.userinfo,\n      \"nregioncode\": methodParam.inputData.primarykey\n    });\n    dispatch(initRequest(true));\n    Axios.all([URL]).then(response => {\n      const districtMap = constructOptionList(response[0].data['districtList'] || [], \"ndistrictcode\", \"sdistrictname\", undefined, undefined, false);\n      const districtList = districtMap.get(\"OptionList\");\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          districtList,\n          loading: false,\n          data: undefined,\n          dataState: undefined\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/actions/SiteAction.js"],"names":["DEFAULT_RETURN","rsapi","toast","sortData","constructOptionList","initRequest","intl","Axios","transactionStatus","getSiteDetail","Site","userInfo","masterData","dispatch","post","nsitecode","userinfo","then","response","data","type","payload","operation","modalName","undefined","loading","dataState","catch","error","status","message","warn","getSiteCombo","siteParam","urlArray","selectedId","timeZoneService","dateformat","SiteByID","primaryKeyField","primaryKeyValue","districtService","editRow","nregioncode","all","timezone","dateFormat","region","district","districtList","selectedRecord","timezoneMap","TimeZoneList","get","dateFormatMap","DateFormat","dateFormatList","regionMap","Region","regionList","districtMap","push","nutcconversation","NO","nisdistributed","label","isOpen","screenName","openModal","ncontrolCode","formatMessage","id","getDistrictByRegion","methodParam","URL","inputData","primarykey"],"mappings":"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","sourcesContent":["import { DEFAULT_RETURN } from './LoginTypes';\r\nimport rsapi from '../rsapi';\r\nimport { toast } from 'react-toastify';\r\nimport { sortData, constructOptionList } from '../components/CommonScript';\r\nimport { initRequest } from './LoginAction';\r\nimport { intl } from '../components/App';\r\nimport Axios from 'axios';\r\nimport { transactionStatus } from '../components/Enumeration';\r\n\r\n\r\nexport function getSiteDetail(Site, userInfo, masterData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        return rsapi.post(\"site/getSiteScreen\", { nsitecode: Site.nsitecode, userinfo: userInfo })\r\n            .then(response => {\r\n                masterData = { ...masterData, ...response.data };\r\n                sortData(masterData);\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData, operation: null, modalName: undefined,\r\n                        loading: false, dataState: undefined\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n\r\n            })\r\n    }\r\n}\r\n\r\nexport function getSiteCombo(siteParam) {\r\n    return function (dispatch) {\r\n        let urlArray = [];\r\n        let selectedId = null;\r\n        const timeZoneService = rsapi.post(\"timezone/getTimeZone\");\r\n        const dateformat = rsapi.post(\"site/getDateFormat\", { userinfo: siteParam.userInfo });\r\n        if (siteParam.operation === \"create\") {\r\n\r\n            urlArray = [timeZoneService, dateformat];\r\n        }\r\n        else {\r\n\r\n            const SiteByID = rsapi.post(\"site/getActiveSiteById\", { [siteParam.primaryKeyField]: siteParam.primaryKeyValue, \"userinfo\": siteParam.userInfo });\r\n            const districtService = rsapi.post(\"site/getDistrict\", { userinfo: siteParam.userInfo, \"nregioncode\": siteParam.editRow.nregioncode });\r\n            urlArray = [timeZoneService, dateformat, SiteByID, districtService];\r\n            selectedId = siteParam.primaryKeyValue;\r\n\r\n        }\r\n\r\n        dispatch(initRequest(true));\r\n        Axios.all(urlArray)\r\n            .then(response => {\r\n\r\n                let timezone = [];\r\n                let dateFormat = [];\r\n                let region = [];\r\n                let district = [];\r\n                let districtList = [];\r\n\r\n                let selectedRecord = {};\r\n                const timezoneMap = constructOptionList(response[0].data || [], \"ntimezonecode\",\r\n                    \"stimezoneid\", undefined, undefined, false);\r\n\r\n                const TimeZoneList = timezoneMap.get(\"OptionList\");\r\n\r\n                const dateFormatMap = constructOptionList(response[1].data.DateFormat || [], \"ndateformatcode\",\r\n                    \"sdateformat\", undefined, undefined, false);\r\n\r\n                const dateFormatList = dateFormatMap.get(\"OptionList\");\r\n\r\n                const regionMap = constructOptionList(response[1].data.Region || [], \"nregioncode\",\r\n                    \"sregionname\", undefined, undefined, false);\r\n\r\n                const regionList = regionMap.get(\"OptionList\");\r\n                if (siteParam.operation === \"update\") {\r\n                    const districtMap = constructOptionList(response[3].data.districtList || [], \"ndistrictcode\",\r\n                        \"sdistrictname\", undefined, undefined, false);\r\n\r\n                    districtList = districtMap.get(\"OptionList\");\r\n                }\r\n                if (siteParam.operation === \"update\") {\r\n\r\n                    selectedRecord = response[2].data;\r\n                    timezone.push({ \"value\": response[2].data[\"ntimezonecode\"], \"label\": response[2].data[\"stimezoneid\"] });\r\n                    dateFormat.push({ \"value\": response[2].data[\"ndateformatcode\"], \"label\": response[2].data[\"sdateformat\"] });\r\n                    region.push({ \"value\": response[2].data[\"nregioncode\"], \"label\": response[2].data[\"sregionname\"] });\r\n                    district.push({ \"value\": response[2].data[\"ndistrictcode\"], \"label\": response[2].data[\"sdistrictname\"] });\r\n                    if (response[2].data.nutcconversation !== transactionStatus.NO) {\r\n                        selectedRecord[\"ntimezonecode\"] = timezone[0];\r\n                        selectedRecord[\"ndateformatcode\"] = dateFormat[0];\r\n                    } else {\r\n                        selectedRecord[\"ntimezonecode\"] = undefined;\r\n                        selectedRecord[\"ndateformatcode\"] = undefined;\r\n                        selectedRecord[\"nutcconversation\"] = response[2].data.nutcconversation;\r\n                    }\r\n                    if(response[2].data.nisdistributed !== transactionStatus.NO){\r\n                        selectedRecord[\"nregioncode\"] = region[0].label!=='NA'?region[0]:undefined;\r\n                        selectedRecord[\"ndistrictcode\"] = district[0].label!=='NA'?district[0]:undefined;\r\n                    }\r\n                    else {\r\n                        selectedRecord[\"nregioncode\"] = undefined;\r\n                        selectedRecord[\"ndistrictcode\"] = undefined;\r\n                        selectedRecord[\"ssitecode\"] = \"\";\r\n                    }\r\n                    \r\n                }\r\n                // else {\r\n                //     selectedRecord = {\r\n                //         ntimezonecode: {\r\n                //             \"label\": siteParam.userInfo.stimezoneid,\r\n                //             \"value\": siteParam.userInfo.ntimezonecode\r\n                //         }\r\n                //     };\r\n                // }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        TimeZoneList, isOpen: true,\r\n                        selectedRecord: siteParam.operation === \"update\" ? selectedRecord : { \"ntransactionstatus\": 1 },\r\n                        operation: siteParam.operation, screenName: siteParam.screenName, selectedRecord,\r\n                        openModal: true,\r\n                        ncontrolCode: siteParam.ncontrolCode,\r\n                        loading: false, selectedId, dateFormatList, regionList, districtList\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(intl.formatMessage({ id: error.message }));\r\n                }\r\n                else {\r\n                    toast.warn(intl.formatMessage({ id: error.response.data }));\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport function getDistrictByRegion(methodParam) {\r\n    return function (dispatch) {\r\n        let URL = [];\r\n        URL = rsapi.post(\"/site/getDistrict\", { \"userinfo\": methodParam.inputData.userinfo, \"nregioncode\": methodParam.inputData.primarykey })\r\n        dispatch(initRequest(true));\r\n        Axios.all([URL])\r\n            .then(response => {\r\n                const districtMap = constructOptionList(response[0].data['districtList'] || [], \"ndistrictcode\",\r\n                    \"sdistrictname\", undefined, undefined, false);\r\n\r\n                const districtList = districtMap.get(\"OptionList\");\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload:\r\n                        { districtList, loading: false, data: undefined, dataState: undefined }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}