{"ast":null,"code":"import { DEFAULT_RETURN } from './LoginTypes';\nimport rsapi from '../rsapi';\nimport { toast } from 'react-toastify';\nimport { sortData, constructOptionList } from '../components/CommonScript';\nimport { initRequest } from './LoginAction';\nimport { intl } from '../components/App';\nimport Axios from 'axios';\nexport function getSiteDetail(Site, userInfo, masterData) {\n  return function (dispatch) {\n    dispatch(initRequest(true));\n    return rsapi.post(\"site/getSiteScreen\", {\n      nsitecode: Site.nsitecode,\n      userinfo: userInfo\n    }).then(response => {\n      masterData = { ...masterData,\n        ...response.data\n      };\n      sortData(masterData);\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          masterData,\n          operation: null,\n          modalName: undefined,\n          loading: false,\n          dataState: undefined\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(error.message);\n      } else {\n        toast.warn(error.response.data);\n      }\n    });\n  };\n}\nexport function getSiteCombo(siteParam) {\n  return function (dispatch) {\n    let urlArray = [];\n    let selectedId = null;\n    const timeZoneService = rsapi.post(\"timezone/getTimeZone\");\n    const dateformat = rsapi.post(\"site/getDateFormat\", {\n      userinfo: siteParam.userInfo\n    });\n\n    if (siteParam.operation === \"create\") {\n      urlArray = [timeZoneService, dateformat];\n    } else {\n      const SiteByID = rsapi.post(\"site/getActiveSiteById\", {\n        [siteParam.primaryKeyField]: siteParam.primaryKeyValue,\n        \"userinfo\": siteParam.userInfo\n      });\n      urlArray = [timeZoneService, dateformat, SiteByID];\n      selectedId = siteParam.primaryKeyValue;\n    }\n\n    dispatch(initRequest(true));\n    Axios.all(urlArray).then(response => {\n      let timezone = [];\n      let dateFormat = [];\n      let selectedRecord = {};\n      const timezoneMap = constructOptionList(response[0].data || [], \"ntimezonecode\", \"stimezoneid\", undefined, undefined, false);\n      const TimeZoneList = timezoneMap.get(\"OptionList\");\n      const dateFormatMap = constructOptionList(response[1].data.DateFormat || [], \"ndateformatcode\", \"sdateformat\", undefined, undefined, false);\n      const dateFormatList = dateFormatMap.get(\"OptionList\");\n\n      if (siteParam.operation === \"update\") {\n        selectedRecord = response[2].data;\n        timezone.push({\n          \"value\": response[2].data[\"ntimezonecode\"],\n          \"label\": response[2].data[\"stimezoneid\"]\n        });\n        dateFormat.push({\n          \"value\": response[2].data[\"ndateformatcode\"],\n          \"label\": response[2].data[\"sdateformat\"]\n        });\n        selectedRecord[\"ntimezonecode\"] = timezone[0];\n        selectedRecord[\"ndateformatcode\"] = dateFormat[0];\n      } // else {\n      //     selectedRecord = {\n      //         ntimezonecode: {\n      //             \"label\": siteParam.userInfo.stimezoneid,\n      //             \"value\": siteParam.userInfo.ntimezonecode\n      //         }\n      //     };\n      // }\n\n\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          TimeZoneList,\n          isOpen: true,\n          selectedRecord: siteParam.operation === \"update\" ? selectedRecord : {\n            \"ntransactionstatus\": 1\n          },\n          operation: siteParam.operation,\n          screenName: siteParam.screenName,\n          selectedRecord,\n          openModal: true,\n          ncontrolCode: siteParam.ncontrolCode,\n          loading: false,\n          selectedId,\n          dateFormatList\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(intl.formatMessage({\n          id: error.message\n        }));\n      } else {\n        toast.warn(intl.formatMessage({\n          id: error.response.data\n        }));\n      }\n    });\n  };\n}","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/actions/SiteAction.js"],"names":["DEFAULT_RETURN","rsapi","toast","sortData","constructOptionList","initRequest","intl","Axios","getSiteDetail","Site","userInfo","masterData","dispatch","post","nsitecode","userinfo","then","response","data","type","payload","operation","modalName","undefined","loading","dataState","catch","error","status","message","warn","getSiteCombo","siteParam","urlArray","selectedId","timeZoneService","dateformat","SiteByID","primaryKeyField","primaryKeyValue","all","timezone","dateFormat","selectedRecord","timezoneMap","TimeZoneList","get","dateFormatMap","DateFormat","dateFormatList","push","isOpen","screenName","openModal","ncontrolCode","formatMessage","id"],"mappings":"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","sourcesContent":["import { DEFAULT_RETURN } from './LoginTypes';\r\nimport rsapi from '../rsapi';\r\nimport { toast } from 'react-toastify';\r\nimport { sortData, constructOptionList } from '../components/CommonScript';\r\nimport { initRequest } from './LoginAction';\r\nimport { intl } from '../components/App';\r\nimport Axios from 'axios';\r\n\r\n\r\nexport function getSiteDetail(Site, userInfo, masterData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        return rsapi.post(\"site/getSiteScreen\", { nsitecode: Site.nsitecode, userinfo: userInfo })\r\n            .then(response => {\r\n                masterData = { ...masterData, ...response.data };\r\n                sortData(masterData);\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData, operation: null, modalName: undefined,\r\n                        loading: false, dataState: undefined\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n\r\n            })\r\n    }\r\n}\r\n\r\nexport function getSiteCombo(siteParam) {\r\n    return function (dispatch) {\r\n        let urlArray = [];\r\n        let selectedId = null;\r\n        const timeZoneService = rsapi.post(\"timezone/getTimeZone\");\r\n        const dateformat = rsapi.post(\"site/getDateFormat\", { userinfo: siteParam.userInfo });\r\n        if (siteParam.operation === \"create\") {\r\n\r\n            urlArray = [timeZoneService, dateformat];\r\n        }\r\n        else {\r\n\r\n            const SiteByID = rsapi.post(\"site/getActiveSiteById\", { [siteParam.primaryKeyField]: siteParam.primaryKeyValue, \"userinfo\": siteParam.userInfo });\r\n            urlArray = [timeZoneService, dateformat, SiteByID];\r\n            selectedId = siteParam.primaryKeyValue;\r\n\r\n        }\r\n\r\n        dispatch(initRequest(true));\r\n        Axios.all(urlArray)\r\n            .then(response => {\r\n\r\n                let timezone = [];\r\n                let dateFormat = [];\r\n\r\n                let selectedRecord = {};\r\n                const timezoneMap = constructOptionList(response[0].data || [], \"ntimezonecode\",\r\n                    \"stimezoneid\", undefined, undefined, false);\r\n\r\n                const TimeZoneList = timezoneMap.get(\"OptionList\");\r\n\r\n                const dateFormatMap = constructOptionList(response[1].data.DateFormat || [], \"ndateformatcode\",\r\n                    \"sdateformat\", undefined, undefined, false);\r\n\r\n                const dateFormatList = dateFormatMap.get(\"OptionList\");\r\n                if (siteParam.operation === \"update\") {\r\n\r\n                    selectedRecord = response[2].data;\r\n                    timezone.push({ \"value\": response[2].data[\"ntimezonecode\"], \"label\": response[2].data[\"stimezoneid\"] });\r\n                    dateFormat.push({ \"value\": response[2].data[\"ndateformatcode\"], \"label\": response[2].data[\"sdateformat\"] });\r\n\r\n                    selectedRecord[\"ntimezonecode\"] = timezone[0];\r\n                    selectedRecord[\"ndateformatcode\"] = dateFormat[0];\r\n\r\n\r\n                }\r\n                // else {\r\n                //     selectedRecord = {\r\n                //         ntimezonecode: {\r\n                //             \"label\": siteParam.userInfo.stimezoneid,\r\n                //             \"value\": siteParam.userInfo.ntimezonecode\r\n                //         }\r\n                //     };\r\n                // }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN,\r\n                    payload: {\r\n                        TimeZoneList, isOpen: true,\r\n                        selectedRecord: siteParam.operation === \"update\" ? selectedRecord : { \"ntransactionstatus\": 1 },\r\n                        operation: siteParam.operation, screenName: siteParam.screenName, selectedRecord,\r\n                        openModal: true,\r\n                        ncontrolCode: siteParam.ncontrolCode,\r\n                        loading: false, selectedId, dateFormatList\r\n                    }\r\n                });\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(intl.formatMessage({ id: error.message }));\r\n                }\r\n                else {\r\n                    toast.warn(intl.formatMessage({ id: error.response.data }));\r\n                }\r\n            })\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}