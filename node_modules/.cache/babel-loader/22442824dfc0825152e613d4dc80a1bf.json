{"ast":null,"code":"import _defineProperty from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import rsapi from'../rsapi';import{DEFAULT_RETURN}from'./LoginTypes';import{constructOptionList,sortData}from'../components/CommonScript';import{toast}from'react-toastify';import{initRequest}from'./LoginAction';import{intl}from'../components/App';import{ApprovalSubType}from'../components/Enumeration';export function getUserMappingFilterChange(inputParamData,oldState,masterData){return function(dispatch){dispatch(initRequest(true));rsapi.post(\"usermapping/getUserMapping\",inputParamData).then(function(response){var RegistrationTypeListMap=constructOptionList(response.data.RegistrationType||[],\"nregtypecode\",\"sregtypename\",'ascending','nregtypecode',false);var RegistrationSubTypeListMap=constructOptionList(response.data.RegistrationSubType||[],\"nregsubtypecode\",\"sregsubtypename\",'ascending','nregsubtypecode',false);var templateVersionOptionListMap=constructOptionList(response.data.TreeVersion||[],\"ntreeversiontempcode\",\"sversiondescription\",'decending','ntreeversiontempcode',false);var RegistrationTypeList=response.data.RegistrationType?RegistrationTypeListMap.get(\"OptionList\"):oldState.RegistrationTypeList;var RegistrationSubTypeList=response.data.RegistrationSubType?RegistrationSubTypeListMap.get(\"OptionList\"):oldState.RegistrationSubTypeList;var templateVersionOptionList=response.data.TreeVersion?templateVersionOptionListMap.get(\"OptionList\"):oldState.templateVersionOptionList;dispatch({type:DEFAULT_RETURN,payload:{masterData:_objectSpread(_objectSpread({},masterData),{},{Approvalsubtype:oldState.Approvalsubtype,RegistrationTypeList:RegistrationTypeList,RegistrationSubTypeList:RegistrationSubTypeList,templateVersionOptionList:templateVersionOptionList,approvalSubTypeValue:oldState.approvalSubTypeValue,RegistrationType:response.data.RegistrationType?response.data.RegistrationType:oldState.RegistrationType,registrationTypeValue:response.data.RegistrationType?response.data.RegistrationType.length>0?{value:response.data.RegistrationType[0].nregtypecode,label:response.data.RegistrationType[0].sregtypename}:oldState.registrationTypeValue:oldState.registrationTypeValue,RegistrationSubType:response.data.RegistrationSubType?response.data.RegistrationSubType:oldState.RegistrationSubType,registrationSubTypeValue:response.data.RegistrationSubType?response.data.RegistrationSubType.length>0?{value:response.data.RegistrationSubType[0].nregsubtypecode,label:response.data.RegistrationSubType[0].sregsubtypename}:oldState.registrationSubTypeValue:oldState.registrationSubTypeValue,TreeVersion:response.data.TreeVersion?response.data.TreeVersion:oldState.TreeVersion,templateVersionValue:response.data.TreeVersion?response.data.TreeVersion.length>0?{value:response.data.TreeVersion[0].ntreeversiontempcode,label:response.data.TreeVersion[0].sversiondescription}:{}:oldState.templateVersionValue},sortData(response.data)),loading:false,dataState:undefined}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});};}export function getUserMapping(inputData){return function(dispatch){dispatch(initRequest(true));var Map={userinfo:inputData.userinfo,nFlag:inputData.nFlag,napprovalsubtypecode:inputData.napprovalsubtypecode,nregtypecode:inputData.nregtypecode,nregsubtypecode:inputData.nregsubtypecode,ntemplatecode:inputData.ntemplatecode,nversioncode:inputData.nversioncode};rsapi.post(\"usermapping/getUserMapping\",Map).then(function(response){if(inputData.searchRef!==undefined&&inputData.searchRef.current.value!==\"\"){inputData.searchRef.current.value=\"\";inputData.masterData[\"searchedData\"]=undefined;}dispatch({type:DEFAULT_RETURN,payload:{masterData:_objectSpread(_objectSpread({},inputData.masterData),{},{selectedSite:response.data.selectedSite,site:response.data.Site,UserRole:response.data.UserRole?sortData(response.data.UserRole):[]},sortData(response.data)),loading:false}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});};}export function getUserMappingBySite(site,nversioncode,userInfo,masterData){return function(dispatch){dispatch(initRequest(true));rsapi.post(\"usermapping/getUserMappingBySite\",{nsitecode:site.nsitecode,nversioncode:nversioncode?nversioncode:-1,userinfo:userInfo}).then(function(response){dispatch({type:DEFAULT_RETURN,payload:{masterData:_objectSpread(_objectSpread({},masterData),sortData(response.data)),loading:false}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});};}export function getChildUsers(user,role,siteCode,nversionCode,userInfo,masterData,dataState,userRoles){return function(dispatch){if(role.schildnode>0){dispatch(initRequest(true));rsapi.post(\"usermapping/getChildUserMapping\",{nparusermappingcode:user.nusermappingcode,nuserrolecode:role.nuserrolecode,nsitecode:siteCode,nversioncode:nversionCode,levelno:-1,userinfo:userInfo,loading:false}).then(function(response){var datastate=_objectSpread({},dataState);userRoles.map(function(userRole){if(userRole.nlevelno<=role.nlevelno){if(dataState[userRole.nuserrolecode]){datastate[userRole.nuserrolecode]=dataState[userRole.nuserrolecode];}else{datastate[userRole.nuserrolecode]={skip:0,take:10};}}return null;});dispatch({type:DEFAULT_RETURN,payload:{masterData:_objectSpread(_objectSpread({},masterData),{},_defineProperty({},\"selectedUser_\".concat(role.nuserrolecode),user),sortData(response.data)),loading:false,dataState:datastate}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});}};}export function openUserMappingModal(role,siteCode,selectedUser,versionCode,userInfo,masterData,parentRoleName){return function(dispatch){if(role.nlevelno===1?true:selectedUser?Object.keys(selectedUser).length>0?true:false:false){dispatch(initRequest(true));rsapi.post(\"usermapping/getAvailableUsers\",{nuserrolecode:role.nuserrolecode,nsitecode:siteCode,nparusermappingcode:role.nlevelno===1?-2:selectedUser.nusermappingcode,nversioncode:versionCode,userinfo:userInfo}).then(function(response){var AvailableUsersMap=constructOptionList(response.data.AvailableUsers||[],\"id\",\"Name\",undefined,undefined,true);var AvailableUsers=AvailableUsersMap.get(\"OptionList\");dispatch({type:DEFAULT_RETURN,payload:_objectSpread({openModal:true,graphView:false,operation:'create',loading:false,AvailableUsers:AvailableUsers,parentRole:role.nparentrolecode,childRole:role.nuserrolecode,childRoleName:role.suserrolename,nlevelno:role.nlevelno,selectedRecord:{}},masterData)});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});}else{toast.warn(intl.formatMessage({id:\"IDS_SELECT\"})+' '+parentRoleName);}};}// export function filterUserColumn(filterValue, masterData, userInfo,role,siteCode,nversionCode) {\n//     return function(dispatch){\n//         let nusermappingcode = 0;   \n//         let searchedData = undefined;\n//         if (filterValue === \"\"){\n//             nusermappingcode = masterData[role.nuserrolecode][0].nusermappingcode;\n//         } \n//         else{\n//             searchedData = searchData(filterValue, masterData[role.nuserrolecode]);\n//             if (searchedData.length > 0){\n//                 nusermappingcode = searchedData[0].nusermappingcode; \n//             }\n//         }\n//         if (nusermappingcode !== 0){\n//             dispatch(initRequest(true));\n//             rsapi.post(\"usermapping/getChildUserMapping\",{\n//                                                             nparusermappingcode:nusermappingcode,\n//                                                             nuserrolecode:role.nuserrolecode,\n//                                                             nsitecode:siteCode,\n//                                                             nversioncode:nversionCode,\n//                                                             levelno:-1,\n//                                                             userinfo:userInfo,\n//                                                             loading:false\n//                                                         }\n//                     )\n//             .then(response=>{  \n//                 masterData={\n//                     ...masterData,\n//                     [`selectedUser_${role.nuserrolecode}`]:searchedData?searchedData[0]:masterData[role.nuserrolecode][0],\n//                     ...sortData(response.data),\n//                     [`searchedData_${role.nuserrolecode}`] : searchedData\n//                 }              \n//                 dispatch({type: DEFAULT_RETURN, payload:{masterData,   loading:false}});\n//             })\n//             .catch(error=>{\n//                 dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\n//                 if (error.response.status === 500) {\n//                     toast.error(error.message);\n//                 }\n//                 else {\n//                     toast.warn(error.response.data);\n//                 }\n//             })\n//         }else{\n//             masterData[\"checklistversion\"] = [];\n//             masterData[\"selectedversion\"] = [];\n//             masterData[\"checklistversionqb\"] = [];\n//             masterData[\"selectedchecklist\"] =[];\n//             masterData[\"searchedData\"] = [];\n//             dispatch({type: DEFAULT_RETURN, payload:{masterData,   loading:false}});\n//         }\n//     }\n// }\nexport function getUserMappingGraphView(site,nversioncode,userinfo,selectedUser,selectedRole){return function(dispatch){if(site&&site.nsitecode){var inputData={nsitecode:site.nsitecode,nversioncode:nversioncode?nversioncode:-1,userinfo:userinfo};if(selectedUser){inputData['nusermappingcode']=selectedUser.nusermappingcode;}//let files=fs.readdirSync(fileViewURL+\"/SharedFolder\")\ndispatch(initRequest(true));rsapi.post(\"usermapping/getUserMappingTree\",inputData).then(function(response){var selectedRecord={};var hideFilters=false;var selectedTreeParent=undefined;if(selectedUser){selectedTreeParent=response.data.userTree&&response.data.userTree.length>0?response.data.userTree.find(function(x){return x.nusermappingcode=selectedUser.nusermappingcode;}):{};hideFilters=true;}dispatch({type:DEFAULT_RETURN,payload:{loading:false,userTree:response.data.userTree,openModal:true,graphView:true,operation:\"view\",selectedTreeParent:selectedTreeParent,selectedRecord:selectedRecord,hideFilters:hideFilters,files:response.data.folderFiles}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});}else{dispatch({type:DEFAULT_RETURN,payload:{loading:false,multilingualError:\"IDS_SELECTSITE\"}});}};}export function getCopyUserMapping(nsubtypecode,nregsubtypecode,userInfo,masterData,ncontrolcode){return function(dispatch){if(nsubtypecode===ApprovalSubType.TESTRESULTAPPROVAL){dispatch(initRequest(true));rsapi.post('usermapping/getUserMappingCopy',{nsubtypecode:nsubtypecode,nregsubtypecode:nregsubtypecode,nsitecode:userInfo.nmastersitecode,userinfo:userInfo}).then(function(response){if(response.data.CopyRegType.length===0){dispatch({type:DEFAULT_RETURN,payload:{loading:false,loadEsign:false,openModal:false}});return toast.warn(intl.formatMessage({id:\"IDS_NOREGISTRATIONTOCOPY\"}));}var selectedRecord={};var RegistrationTypeListMap=constructOptionList(response.data.CopyRegType||[],\"nregtypecode\",\"sregtypename\",'ascending','nregtypecode',false);var RegistrationSubTypeListMap=constructOptionList(response.data.CopyRegSubType||[],\"nregsubtypecode\",\"sregsubtypename\",'ascending','nregsubtypecode',false);var optCopyRegType=RegistrationTypeListMap.get(\"OptionList\");var optCopyRegSubType=RegistrationSubTypeListMap.get(\"OptionList\");selectedRecord['regtype']=response.data.CopyRegType.length>0?{value:response.data.CopyRegType[0].nregtypecode,label:response.data.CopyRegType[0].sregtypename}:[];selectedRecord['regsubtype']=response.data.CopyRegSubType?response.data.CopyRegSubType.length>0?{value:response.data.CopyRegSubType[0].nregsubtypecode,label:response.data.CopyRegSubType[0].sregsubtypename}:[]:[];dispatch({type:DEFAULT_RETURN,payload:{operation:\"copy\",openModal:true,optCopyRegSubType:optCopyRegSubType,optCopyRegType:optCopyRegType,selectedRecord:selectedRecord,masterData:masterData,ncontrolcode:ncontrolcode,loading:false}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});}};}export function getCopyUserMappingSubType(comboData,nregsubtypecode,selectedRecord,userInfo,masterData,optCopyRegType){return function(dispatch){dispatch(initRequest(true));rsapi.post('usermapping/getCopyRegSubType',{nregtypecode:comboData.value,nregsubtypecode:nregsubtypecode,nsitecode:userInfo.nmastersitecode,userinfo:userInfo}).then(function(response){var RegistrationSubTypeListMap=constructOptionList(response.data.CopyRegSubType||[],\"nregsubtypecode\",\"sregsubtypename\",'ascending','nregsubtypecode',false);var optCopyRegSubType=RegistrationSubTypeListMap.get(\"OptionList\");selectedRecord['regsubtype']=response.data.CopyRegSubType.length>0?{value:response.data.CopyRegSubType[0].nregsubtypecode,label:response.data.CopyRegSubType[0].sregsubtypename}:[];dispatch({type:DEFAULT_RETURN,payload:{operation:\"copy\",openModal:true,loading:false,optCopyRegType:optCopyRegType,optCopyRegSubType:optCopyRegSubType,selectedRecord:selectedRecord,masterData:masterData}});}).catch(function(error){dispatch({type:DEFAULT_RETURN,payload:{loading:false}});if(error.response.status===500){toast.error(error.message);}else{toast.warn(error.response.data);}});};}","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/actions/UserMappingAction.js"],"names":["rsapi","DEFAULT_RETURN","constructOptionList","sortData","toast","initRequest","intl","ApprovalSubType","getUserMappingFilterChange","inputParamData","oldState","masterData","dispatch","post","then","response","RegistrationTypeListMap","data","RegistrationType","RegistrationSubTypeListMap","RegistrationSubType","templateVersionOptionListMap","TreeVersion","RegistrationTypeList","get","RegistrationSubTypeList","templateVersionOptionList","type","payload","Approvalsubtype","approvalSubTypeValue","registrationTypeValue","length","value","nregtypecode","label","sregtypename","registrationSubTypeValue","nregsubtypecode","sregsubtypename","templateVersionValue","ntreeversiontempcode","sversiondescription","loading","dataState","undefined","catch","error","status","message","warn","getUserMapping","inputData","Map","userinfo","nFlag","napprovalsubtypecode","ntemplatecode","nversioncode","searchRef","current","selectedSite","site","Site","UserRole","getUserMappingBySite","userInfo","nsitecode","getChildUsers","user","role","siteCode","nversionCode","userRoles","schildnode","nparusermappingcode","nusermappingcode","nuserrolecode","levelno","datastate","map","userRole","nlevelno","skip","take","openUserMappingModal","selectedUser","versionCode","parentRoleName","Object","keys","AvailableUsersMap","AvailableUsers","openModal","graphView","operation","parentRole","nparentrolecode","childRole","childRoleName","suserrolename","selectedRecord","formatMessage","id","getUserMappingGraphView","selectedRole","hideFilters","selectedTreeParent","userTree","find","x","files","folderFiles","multilingualError","getCopyUserMapping","nsubtypecode","ncontrolcode","TESTRESULTAPPROVAL","nmastersitecode","CopyRegType","loadEsign","CopyRegSubType","optCopyRegType","optCopyRegSubType","getCopyUserMappingSubType","comboData"],"mappings":"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","sourcesContent":["import rsapi from '../rsapi';\r\nimport { DEFAULT_RETURN } from './LoginTypes';\r\nimport { constructOptionList, sortData } from '../components/CommonScript'\r\nimport { toast } from 'react-toastify';\r\nimport { initRequest } from './LoginAction';\r\nimport { intl } from '../components/App';\r\nimport { ApprovalSubType } from '../components/Enumeration';\r\n\r\nexport function getUserMappingFilterChange(inputParamData, oldState, masterData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"usermapping/getUserMapping\", inputParamData)\r\n            .then(response => {\r\n                const RegistrationTypeListMap = constructOptionList(response.data.RegistrationType || [], \"nregtypecode\", \"sregtypename\", 'ascending', 'nregtypecode', false);\r\n                const RegistrationSubTypeListMap = constructOptionList(response.data.RegistrationSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\r\n                const templateVersionOptionListMap = constructOptionList(response.data.TreeVersion || [], \"ntreeversiontempcode\", \"sversiondescription\", 'decending', 'ntreeversiontempcode', false);\r\n                const RegistrationTypeList = response.data.RegistrationType ? RegistrationTypeListMap.get(\"OptionList\") : oldState.RegistrationTypeList;\r\n                const RegistrationSubTypeList = response.data.RegistrationSubType ? RegistrationSubTypeListMap.get(\"OptionList\") : oldState.RegistrationSubTypeList;\r\n                const templateVersionOptionList = response.data.TreeVersion ? templateVersionOptionListMap.get(\"OptionList\") : oldState.templateVersionOptionList;\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData: {\r\n                            ...masterData,\r\n                            Approvalsubtype: oldState.Approvalsubtype,\r\n                            RegistrationTypeList, RegistrationSubTypeList, templateVersionOptionList,\r\n                            approvalSubTypeValue: oldState.approvalSubTypeValue,\r\n\r\n                            RegistrationType: response.data.RegistrationType ?\r\n                                response.data.RegistrationType\r\n                                : oldState.RegistrationType,\r\n\r\n                            registrationTypeValue: response.data.RegistrationType ?\r\n                                response.data.RegistrationType.length > 0 ?\r\n                                    {\r\n                                        value: response.data.RegistrationType[0].nregtypecode,\r\n                                        label: response.data.RegistrationType[0].sregtypename\r\n                                    }\r\n                                    : oldState.registrationTypeValue\r\n                                : oldState.registrationTypeValue,\r\n\r\n                            RegistrationSubType: response.data.RegistrationSubType ?\r\n                                response.data.RegistrationSubType\r\n                                : oldState.RegistrationSubType,\r\n\r\n                            registrationSubTypeValue: response.data.RegistrationSubType ?\r\n                                response.data.RegistrationSubType.length > 0 ?\r\n                                    {\r\n                                        value: response.data.RegistrationSubType[0].nregsubtypecode,\r\n                                        label: response.data.RegistrationSubType[0].sregsubtypename\r\n                                    }\r\n                                    : oldState.registrationSubTypeValue\r\n                                : oldState.registrationSubTypeValue,\r\n\r\n                            TreeVersion: response.data.TreeVersion ?\r\n                                response.data.TreeVersion\r\n                                : oldState.TreeVersion,\r\n\r\n                            templateVersionValue: response.data.TreeVersion ?\r\n                                response.data.TreeVersion.length > 0 ?\r\n                                    {\r\n                                        value: response.data.TreeVersion[0].ntreeversiontempcode,\r\n                                        label: response.data.TreeVersion[0].sversiondescription\r\n                                    }\r\n                                    : {}\r\n                                : oldState.templateVersionValue,\r\n                            // Site: response.data.Site ? sortData(response.data.Site) : [],\r\n                            // selectedSite: response.data.selectedSite,\r\n                            // UserRole: response.data.UserRole ? sortData(response.data.UserRole) : [],\r\n                            ...sortData(response.data)\r\n                        }, loading: false,\r\n                        dataState: undefined\r\n\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport function getUserMapping(inputData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        const Map={userinfo:inputData.userinfo,\r\n            nFlag:inputData.nFlag,\r\n            napprovalsubtypecode:inputData.napprovalsubtypecode,\r\n            nregtypecode:inputData.nregtypecode,\r\n            nregsubtypecode:inputData.nregsubtypecode,\r\n            ntemplatecode:inputData.ntemplatecode,\r\n            nversioncode:inputData.nversioncode\r\n        }\r\n        rsapi.post(\"usermapping/getUserMapping\", Map)\r\n            .then(response => {\r\n\r\n                if (inputData.searchRef !== undefined && inputData.searchRef.current.value !== \"\") {\r\n                    inputData.searchRef.current.value=\"\"\r\n                    inputData.masterData[\"searchedData\"] = undefined\r\n                }\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData: {\r\n                            ...inputData.masterData,\r\n                            selectedSite: response.data.selectedSite,\r\n                            site: response.data.Site,\r\n                            UserRole: response.data.UserRole ? sortData(response.data.UserRole) : [],\r\n                            ...sortData(response.data)\r\n                        }, loading: false\r\n\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}\r\n\r\nexport function getUserMappingBySite(site, nversioncode, userInfo, masterData) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post(\"usermapping/getUserMappingBySite\", { nsitecode: site.nsitecode, nversioncode: nversioncode ? nversioncode : -1, userinfo: userInfo })\r\n            .then(response => {\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        masterData: {\r\n                            ...masterData,\r\n                            //  selectedSite: site,\r\n                            // UserRole: sortData(response.data.UserRole),\r\n                            ...sortData(response.data)\r\n                        }, loading: false\r\n\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n\r\n}\r\nexport function getChildUsers(user, role, siteCode, nversionCode, userInfo, masterData, dataState, userRoles) {\r\n\r\n    return function (dispatch) {\r\n        if (role.schildnode > 0) {\r\n            dispatch(initRequest(true));\r\n            rsapi.post(\"usermapping/getChildUserMapping\",\r\n                {\r\n                    nparusermappingcode: user.nusermappingcode,\r\n                    nuserrolecode: role.nuserrolecode,\r\n                    nsitecode: siteCode,\r\n                    nversioncode: nversionCode,\r\n                    levelno: -1,\r\n                    userinfo: userInfo,\r\n                    loading: false\r\n                }\r\n            )\r\n                .then(response => {\r\n                    let datastate = { ...dataState }\r\n                    userRoles.map(userRole => {\r\n                        if (userRole.nlevelno <= role.nlevelno) {\r\n                            if (dataState[userRole.nuserrolecode]) {\r\n                                datastate[userRole.nuserrolecode] = dataState[userRole.nuserrolecode]\r\n                            } else {\r\n                                datastate[userRole.nuserrolecode] = { skip: 0, take: 10 }\r\n                            }\r\n                        }\r\n                        return null;\r\n                    })\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            masterData: {\r\n                                ...masterData,\r\n                                [`selectedUser_${role.nuserrolecode}`]: user,\r\n                                ...sortData(response.data)\r\n                            }, loading: false, dataState: datastate\r\n\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        }\r\n    }\r\n}\r\n\r\nexport function openUserMappingModal(role, siteCode, selectedUser, versionCode, userInfo, masterData, parentRoleName) {\r\n    return function (dispatch) {\r\n        if (role.nlevelno === 1 ? true : selectedUser ? Object.keys(selectedUser).length > 0 ? true : false : false) {\r\n            dispatch(initRequest(true));\r\n            rsapi.post(\"usermapping/getAvailableUsers\",\r\n                {\r\n                    nuserrolecode: role.nuserrolecode,\r\n                    nsitecode: siteCode,\r\n                    nparusermappingcode: role.nlevelno === 1 ? -2 : selectedUser.nusermappingcode,\r\n                    nversioncode: versionCode,\r\n                    userinfo: userInfo,\r\n                }\r\n            )\r\n                .then(response => {\r\n                    const AvailableUsersMap = constructOptionList(response.data.AvailableUsers || [], \"id\", \"Name\", undefined, undefined, true);\r\n                    const AvailableUsers = AvailableUsersMap.get(\"OptionList\");\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            openModal: true,\r\n                            graphView: false,\r\n                            operation: 'create',\r\n                            loading: false,\r\n                            AvailableUsers,\r\n                            parentRole: role.nparentrolecode,\r\n                            childRole: role.nuserrolecode,\r\n                            childRoleName: role.suserrolename,\r\n                            nlevelno: role.nlevelno,\r\n                            selectedRecord: {},\r\n                            ...masterData\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        } else {\r\n            toast.warn(intl.formatMessage({ id: \"IDS_SELECT\" }) + ' ' + parentRoleName);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n// export function filterUserColumn(filterValue, masterData, userInfo,role,siteCode,nversionCode) {\r\n//     return function(dispatch){\r\n//         let nusermappingcode = 0;   \r\n//         let searchedData = undefined;\r\n//         if (filterValue === \"\"){\r\n//             nusermappingcode = masterData[role.nuserrolecode][0].nusermappingcode;\r\n//         } \r\n//         else{\r\n\r\n//             searchedData = searchData(filterValue, masterData[role.nuserrolecode]);\r\n\r\n//             if (searchedData.length > 0){\r\n//                 nusermappingcode = searchedData[0].nusermappingcode; \r\n//             }\r\n\r\n//         }\r\n//         if (nusermappingcode !== 0){\r\n\r\n//             dispatch(initRequest(true));\r\n//             rsapi.post(\"usermapping/getChildUserMapping\",{\r\n//                                                             nparusermappingcode:nusermappingcode,\r\n//                                                             nuserrolecode:role.nuserrolecode,\r\n//                                                             nsitecode:siteCode,\r\n//                                                             nversioncode:nversionCode,\r\n//                                                             levelno:-1,\r\n//                                                             userinfo:userInfo,\r\n//                                                             loading:false\r\n//                                                         }\r\n//                     )\r\n//             .then(response=>{  \r\n//                 masterData={\r\n//                     ...masterData,\r\n//                     [`selectedUser_${role.nuserrolecode}`]:searchedData?searchedData[0]:masterData[role.nuserrolecode][0],\r\n//                     ...sortData(response.data),\r\n//                     [`searchedData_${role.nuserrolecode}`] : searchedData\r\n//                 }              \r\n\r\n\r\n//                 dispatch({type: DEFAULT_RETURN, payload:{masterData,   loading:false}});\r\n//             })\r\n//             .catch(error=>{\r\n//                 dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\r\n//                 if (error.response.status === 500) {\r\n//                     toast.error(error.message);\r\n//                 }\r\n//                 else {\r\n//                     toast.warn(error.response.data);\r\n//                 }\r\n//             })\r\n\r\n//         }else{\r\n//             masterData[\"checklistversion\"] = [];\r\n//             masterData[\"selectedversion\"] = [];\r\n//             masterData[\"checklistversionqb\"] = [];\r\n//             masterData[\"selectedchecklist\"] =[];\r\n//             masterData[\"searchedData\"] = [];\r\n//             dispatch({type: DEFAULT_RETURN, payload:{masterData,   loading:false}});\r\n\r\n//         }\r\n//     }\r\n// }\r\nexport function getUserMappingGraphView(site, nversioncode, userinfo, selectedUser, selectedRole) {\r\n\r\n    return function (dispatch) {\r\n        if (site && site.nsitecode) {\r\n            let inputData = { nsitecode: site.nsitecode, nversioncode: nversioncode ? nversioncode : -1, userinfo };\r\n            if (selectedUser) {\r\n                inputData['nusermappingcode'] = selectedUser.nusermappingcode\r\n            }\r\n\r\n            //let files=fs.readdirSync(fileViewURL+\"/SharedFolder\")\r\n            dispatch(initRequest(true));\r\n            rsapi.post(\"usermapping/getUserMappingTree\", inputData)\r\n                .then(response => {\r\n                    let selectedRecord = {};\r\n                    let hideFilters = false;\r\n                    let selectedTreeParent = undefined;\r\n                    if (selectedUser) {\r\n                        selectedTreeParent = response.data.userTree && response.data.userTree.length > 0 ? response.data.userTree.find(x => x.nusermappingcode = selectedUser.nusermappingcode) : {}\r\n                        hideFilters = true;\r\n                    }\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            loading: false,\r\n                            userTree: response.data.userTree,\r\n                            openModal: true,\r\n                            graphView: true,\r\n                            operation: \"view\",\r\n                            selectedTreeParent,\r\n                            selectedRecord,\r\n                            hideFilters,\r\n                            files: response.data.folderFiles\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        } else {\r\n            dispatch({ type: DEFAULT_RETURN, payload: { loading: false, multilingualError: \"IDS_SELECTSITE\" } })\r\n        }\r\n    }\r\n}\r\nexport function getCopyUserMapping(nsubtypecode, nregsubtypecode, userInfo, masterData, ncontrolcode) {\r\n    return function (dispatch) {\r\n        if (nsubtypecode === ApprovalSubType.TESTRESULTAPPROVAL) {\r\n            dispatch(initRequest(true));\r\n            rsapi.post('usermapping/getUserMappingCopy', { nsubtypecode: nsubtypecode, nregsubtypecode, nsitecode: userInfo.nmastersitecode, userinfo: userInfo })\r\n                .then(response => {\r\n                    if (response.data.CopyRegType.length === 0) {\r\n                        dispatch({\r\n                            type: DEFAULT_RETURN,\r\n                            payload: {\r\n                                loading: false,\r\n                                loadEsign: false,\r\n                                openModal: false\r\n                            }\r\n                        });\r\n                        return toast.warn(intl.formatMessage({ id: \"IDS_NOREGISTRATIONTOCOPY\" }));\r\n                    }\r\n\r\n                    let selectedRecord = {};\r\n                    const RegistrationTypeListMap = constructOptionList(response.data.CopyRegType || [], \"nregtypecode\", \"sregtypename\", 'ascending', 'nregtypecode', false);\r\n                    const RegistrationSubTypeListMap = constructOptionList(response.data.CopyRegSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\r\n                    let optCopyRegType = RegistrationTypeListMap.get(\"OptionList\");\r\n                    let optCopyRegSubType = RegistrationSubTypeListMap.get(\"OptionList\");\r\n                    selectedRecord['regtype'] = response.data.CopyRegType.length > 0 ? { value: response.data.CopyRegType[0].nregtypecode, label: response.data.CopyRegType[0].sregtypename } : []\r\n                    selectedRecord['regsubtype'] = response.data.CopyRegSubType ? response.data.CopyRegSubType.length > 0 ? { value: response.data.CopyRegSubType[0].nregsubtypecode, label: response.data.CopyRegSubType[0].sregsubtypename } : [] : []\r\n                    dispatch({\r\n                        type: DEFAULT_RETURN, payload: {\r\n                            operation: \"copy\", openModal: true,\r\n                            optCopyRegSubType,\r\n                            optCopyRegType,\r\n                            selectedRecord,\r\n                            masterData, ncontrolcode, loading: false\r\n                        }\r\n                    })\r\n                })\r\n                .catch(error => {\r\n                    dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                    if (error.response.status === 500) {\r\n                        toast.error(error.message);\r\n                    }\r\n                    else {\r\n                        toast.warn(error.response.data);\r\n                    }\r\n                })\r\n        }\r\n    }\r\n\r\n}\r\nexport function getCopyUserMappingSubType(comboData, nregsubtypecode, selectedRecord, userInfo, masterData, optCopyRegType) {\r\n    return function (dispatch) {\r\n        dispatch(initRequest(true));\r\n        rsapi.post('usermapping/getCopyRegSubType', { nregtypecode: comboData.value, nregsubtypecode, nsitecode: userInfo.nmastersitecode, userinfo: userInfo })\r\n            .then(response => {\r\n                const RegistrationSubTypeListMap = constructOptionList(response.data.CopyRegSubType || [], \"nregsubtypecode\", \"sregsubtypename\", 'ascending', 'nregsubtypecode', false);\r\n                let optCopyRegSubType = RegistrationSubTypeListMap.get(\"OptionList\");\r\n                selectedRecord['regsubtype'] = response.data.CopyRegSubType.length > 0 ? { value: response.data.CopyRegSubType[0].nregsubtypecode, label: response.data.CopyRegSubType[0].sregsubtypename } : []\r\n                dispatch({\r\n                    type: DEFAULT_RETURN, payload: {\r\n                        operation: \"copy\", openModal: true, loading: false,\r\n                        optCopyRegType,\r\n                        optCopyRegSubType,\r\n                        selectedRecord,\r\n                        masterData\r\n                    }\r\n                })\r\n            })\r\n            .catch(error => {\r\n                dispatch({ type: DEFAULT_RETURN, payload: { loading: false } })\r\n                if (error.response.status === 500) {\r\n                    toast.error(error.message);\r\n                }\r\n                else {\r\n                    toast.warn(error.response.data);\r\n                }\r\n            })\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}