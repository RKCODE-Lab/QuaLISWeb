{"ast":null,"code":"var _jsxFileName = \"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\src\\\\pages\\\\attachmentscomments\\\\attachments\\\\Attachments.jsx\";\nimport React, { Component } from 'react';\nimport { Nav } from 'react-bootstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { FormattedMessage, injectIntl } from 'react-intl';\nimport { faPlus } from '@fortawesome/free-solid-svg-icons';\nimport ListAttachment from '../../../components/ListAttachment';\nimport SlideOutModal from '../../../components/slide-out-modal/SlideOutModal';\nimport { DEFAULT_RETURN } from '../../../actions/LoginTypes';\nimport AddAttachment from './AddAttachment';\nimport { updateStore, getAttachmentCombo, validateEsignCredential, crudMaster, viewAttachment, deleteAttachment } from '../../../actions';\nimport { connect } from 'react-redux';\nimport { attachmentType, designProperties, transactionStatus } from '../../../components/Enumeration';\nimport Esign from '../../audittrail/Esign';\nimport { QUALISFORMS } from '../../../components/Enumeration';\nimport { deleteAttachmentDropZone, onDropAttachFileList } from '../../../components/CommonScript';\n\nconst mapStateToProps = state => {\n  return {\n    Login: state.Login\n  };\n};\n\nclass Attachments extends Component {\n  constructor(props) {\n    super(props);\n\n    this.deleteAttachment = (event, file, fieldName) => {\n      let selectedRecord = this.state.selectedRecord || {};\n      selectedRecord[fieldName] = deleteAttachmentDropZone(selectedRecord[fieldName], file);\n      this.setState({\n        selectedRecord,\n        actionType: \"delete\" //fileToDelete:file.name \n\n      });\n    };\n\n    this.onDropFiles = (attachedFiles, fieldName, maxSize) => {\n      let selectedRecord = this.state.selectedRecord || {};\n      selectedRecord[fieldName] = onDropAttachFileList(selectedRecord[fieldName], attachedFiles, maxSize);\n      this.setState({\n        selectedRecord,\n        actionType: \"new\"\n      });\n    };\n\n    this.onAttachmentInputChange = (event, caseNo, optional) => {\n      const selectedRecord = this.state.selectedRecord || {};\n\n      switch (caseNo) {\n        case 1:\n          if (event.target.type === 'radio') {\n            selectedRecord[event.target.name] = event.target.checked === true && optional; // selectedRecord[\"sfilename\"] = \"\";\n          } else if (event.target.type === 'checkbox') {\n            selectedRecord[event.target.name] = event.target.checked == true ? transactionStatus.YES : transactionStatus.NO;\n          } else {\n            selectedRecord[event.target.name] = event.target.value;\n          }\n\n          this.setState({\n            selectedRecord\n          });\n          break;\n\n        default:\n          selectedRecord[event.target.name] = event.target.value;\n          this.setState({\n            selectedRecord\n          });\n          break;\n      }\n    };\n\n    this.onInputOnChange = event => {\n      let selectedRecord = this.state.selectedRecord || {};\n\n      if (event.target.type === 'checkbox') {\n        selectedRecord[event.target.name] = event.target.checked === true ? transactionStatus.YES : transactionStatus.NO;\n      } else {\n        selectedRecord[event.target.name] = event.target.value;\n      }\n\n      this.setState({\n        selectedRecord\n      });\n    };\n\n    this.onComboChange = (comboData, comboName) => {\n      const selectedRecord = this.state.selectedRecord || {};\n\n      if (comboData) {\n        selectedRecord[comboName] = comboData;\n        this.setState({\n          selectedRecord\n        });\n      } else {\n        selectedRecord[comboName] = [];\n        this.setState({\n          selectedRecord\n        });\n      }\n    };\n\n    this.onSaveClick = (saveType, formRef) => {\n      // const masterData = this.props.Login.masterData;\n      // let inputData = {}\n      // let inputParam = {}\n      // inputData[\"userinfo\"] = this.props.Login.userInfo;\n      // if(this.props.Login.screenName === \"IDS_SAMPLEATTACHMENTS\") {\n      //     let saveParam={userInfo:this.props.Login.userInfo,\n      //         selectedRecord:this.state.selectedRecord,\n      //         masterData:this.props.Login.masterData,\n      //         saveType, formRef,\n      //         operation:this.props.Login.operation,\n      //         selectedMaster:this.props.selectedMaster\n      //     }\n      //     inputParam = onSaveSampleAttachment(saveParam,this.props.selectedMaster);\n      // }else if(this.props.Login.screenName === \"IDS_TESTATTACHMENTS\") {\n      //     let saveParam={userInfo:this.props.Login.userInfo,\n      //         selectedRecord:this.state.selectedRecord,\n      //         masterData:this.props.Login.masterData,\n      //         saveType, formRef,\n      //         operation:this.props.Login.operation,\n      //         selectedMaster:this.props.selectedMaster\n      //     }\n      //     inputParam = onSaveTestAttachment(saveParam,this.props.selectedMaster);\n      this.props.onSaveClick(saveType, formRef, this.state.selectedRecord); // }\n      // if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolCode)) {\n      //     const updateInfo = {\n      //         typeName: DEFAULT_RETURN,\n      //         data: {\n      //             loadEsign: true,\n      //             screenData: { inputParam, masterData },\n      //             operation: this.props.Login.operation,\n      //             screenName: this.props.Login.screenName,\n      //         }\n      //     }\n      //     this.props.updateStore(updateInfo);\n      // }\n      // else {\n      //     this.props.crudMaster(inputParam, masterData, \"openAttachmentModal\");\n      // }\n    };\n\n    this.handleClose = () => {\n      let loadEsign = this.props.Login.loadEsign;\n      let openAttachmentModal = this.props.Login.openAttachmentModal;\n      let selectedRecord = this.props.Login.selectedRecord;\n      let operation = this.props.Login.operation;\n\n      if (this.props.Login.loadEsign) {\n        if (this.props.Login.operation === \"delete\") {\n          loadEsign = false;\n          openAttachmentModal = false;\n          selectedRecord = {};\n          operation = undefined;\n        } else {\n          loadEsign = false;\n          selectedRecord[\"esigncomments\"] = \"\";\n          selectedRecord[\"esignpassword\"] = \"\";\n        }\n      } else {\n        openAttachmentModal = false;\n        selectedRecord = {};\n      }\n\n      const updateInfo = {\n        typeName: DEFAULT_RETURN,\n        data: {\n          openAttachmentModal,\n          loadEsign,\n          selectedRecord,\n          selectedParamId: null,\n          operation\n        }\n      };\n      this.props.updateStore(updateInfo);\n    };\n\n    this.validateEsign = () => {\n      const inputParam = {\n        inputData: {\n          \"userinfo\": { ...this.props.Login.userInfo,\n            sreason: this.state.selectedRecord[\"esigncomments\"],\n            nreasoncode: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\n            spredefinedreason: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label\n          },\n          password: this.state.selectedRecord[\"esignpassword\"]\n        },\n        screenData: this.props.Login.screenData\n      };\n\n      if (this.props.Login.operation === 'dynamic') {\n        this.props.validateEsignforApproval(inputParam, \"openChildModal\");\n      } else {\n        this.props.validateEsignCredential(inputParam, \"openAttachmentModal\");\n      }\n    };\n\n    this.viewFile = filedata => {\n      const inputParam = {\n        inputData: {\n          file: filedata,\n          userinfo: this.props.Login.userInfo\n        },\n        classUrl: \"attachment\",\n        operation: \"view\",\n        methodUrl: this.props.methodUrl,\n        screenName: this.props.Login.screenName\n      };\n      this.props.viewAttachment(inputParam);\n    };\n\n    this.state = {\n      showMore: {},\n      selectedRecord: {}\n    };\n  }\n\n  render() {\n    let subFields = this.props.subFields ? this.props.subFields : [{\n      [designProperties.LABEL]: `${this.props.Login.screenName === 'IDS_TESTATTACHMENTS' ? 'IDS_TESTNAME' : this.props.Login.screenName === 'IDS_SUBSAMPLEATTACHMENTS' ? this.props.Login.genericLabel ? this.props.Login.genericLabel[\"SubARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode] : \"IDS_SAMPLEARNO\" : this.props.Login.genericLabel ? this.props.Login.genericLabel[\"ARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode] : \"IDS_ARNO\"}`\n    }, {\n      [designProperties.VALUE]: `${this.props.screenName === 'IDS_SAMPLEATTACHMENTS' ? this.props.Login.userInfo && this.props.Login.userInfo.nformcode === QUALISFORMS.SAMPLEREGISTRATION ? \"groupingField\" : \"sarno\" : this.props.Login.screenName === 'IDS_SUBSAMPLEATTACHMENTS' ? this.props.Login.userInfo && this.props.Login.userInfo.nformcode === QUALISFORMS.SAMPLEREGISTRATION ? \"groupingField2\" : \"ssamplearno\" : \"stestsynonym\"}`\n    }, {\n      [designProperties.VALUE]: \"screateddate\"\n    } // { [designProperties.VALUE]: \"nfilesize\", \"fieldType\": \"size\" }\n    ];\n    let moreField = this.props.moreField ? this.props.moreField : [{\n      [designProperties.LABEL]: \"IDS_SCREENNAME\",\n      [designProperties.VALUE]: \"sdisplayname\"\n    }, {\n      [designProperties.LABEL]: \"IDS_USERNAME\",\n      [designProperties.VALUE]: \"susername\"\n    }, {\n      [designProperties.LABEL]: \"IDS_USERROLE\",\n      [designProperties.VALUE]: \"suserrolename\"\n    }, {\n      [designProperties.LABEL]: \"IDS_DESCRIPTION\",\n      [designProperties.VALUE]: \"sdescription\"\n    }, this.props.isneedReport ? this.props.isneedReport && {\n      [designProperties.LABEL]: \"IDS_INCULDEINREPORT\",\n      [designProperties.VALUE]: \"sneedreport\"\n    } : \"\"];\n\n    if (this.props.screenName === 'IDS_TESTATTACHMENTS') {\n      if (this.props.nsubsampleneed === true) {\n        if (this.props.moreField === undefined) {\n          moreField.unshift({\n            [designProperties.LABEL]: this.props.Login.genericLabel ? this.props.Login.genericLabel[\"SubARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode] : \"IDS_SAMPLEARNO\",\n            [designProperties.VALUE]: \"groupingField2\"\n          });\n        }\n\n        ;\n      }\n\n      if (this.props.moreField === undefined) {\n        moreField.unshift({\n          //  [designProperties.LABEL]: this.props.nsubsampleneed && `${this.props.nsubsampleneed.nneedsubsample ? \"IDS_SAMPLEARNO\" : \"IDS_ARNO\"}`, \n          //  [designProperties.VALUE]: this.props.nsubsampleneed && `${this.props.nsubsampleneed.nneedsubsample ? \"ssamplearno\" : \"sarno\"}`\n          [designProperties.LABEL]: this.props.Login.genericLabel ? this.props.Login.genericLabel[\"ARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode] : \"IDS_ARNO\",\n          [designProperties.VALUE]: \"groupingField1\"\n        });\n      }\n\n      ;\n    }\n\n    let addFileId = this.props.controlMap.has(this.props.addName) && this.props.controlMap.get(this.props.addName).ncontrolcode;\n    let editFileId = this.props.controlMap.has(this.props.editName) && this.props.controlMap.get(this.props.editName).ncontrolcode;\n    let deleteFileId = this.props.controlMap.has(this.props.deleteName) && this.props.controlMap.get(this.props.deleteName).ncontrolcode;\n    let viewFileId = this.props.controlMap.has(this.props.viewName) && this.props.controlMap.get(this.props.viewName).ncontrolcode;\n    let mandatoryFields = [];\n\n    if (this.state.selectedRecord && this.state.selectedRecord.nattachmenttypecode === attachmentType.LINK) {\n      mandatoryFields = [{\n        \"idsName\": \"IDS_FILENAME\",\n        \"dataField\": \"slinkfilename\",\n        \"mandatoryLabel\": \"IDS_CHOOSE\",\n        \"controlType\": \"file\"\n      }, {\n        \"idsName\": \"IDS_LINKNAME\",\n        \"dataField\": \"nlinkcode\",\n        \"mandatoryLabel\": \"IDS_ENTER\",\n        \"controlType\": \"textbox\"\n      }];\n    } else {\n      // if (this.props.Login.operation !== 'update') {\n      mandatoryFields = [{\n        \"idsName\": \"IDS_FILE\",\n        \"dataField\": \"sfilename\",\n        \"mandatoryLabel\": \"IDS_CHOOSE\",\n        \"controlType\": \"file\"\n      }]; // }\n    }\n\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"actions-stripe border-bottom\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-end\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Nav.Link, {\n      name: `add_${this.props.Login.screenName}_file`,\n      className: \"add-txt-btn\",\n      hidden: this.props.userRoleControlRights.indexOf(addFileId) === -1,\n      onClick: () => this.props.getAttachmentCombo({\n        userInfo: this.props.Login.userInfo,\n        operation: \"create\",\n        ncontrolCode: addFileId,\n        screenName: this.props.screenName,\n        modalName: \"openAttachmentModal\",\n        masterList: this.props.masterList,\n        masterAlertStatus: this.props.masterAlertStatus\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n      icon: faPlus,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 29\n      }\n    }), \" \", /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"IDS_ATTACHMENT\",\n      defaultMessage: \"Attachment\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 29\n      }\n    })))), /*#__PURE__*/React.createElement(ListAttachment, {\n      attachmentList: this.props.attachments,\n      fileName: \"sfilename\",\n      filesize: \"nfilesize\",\n      linkname: \"slinkname\",\n      isjsonfield: true,\n      jsonfield: \"jsondata\",\n      deleteRecord: this.props.deleteAttachment,\n      deleteParam: this.props.deleteParam,\n      editParam: { ...this.props.editParam,\n        operation: \"update\",\n        ncontrolCode: editFileId,\n        screenName: this.props.screenName,\n        modalName: \"openAttachmentModal\",\n        masterList: this.props.masterList,\n        masterAlertStatus: this.props.masterAlertStatus\n      },\n      fetchRecord: this.props.fetchRecord,\n      deleteId: deleteFileId,\n      editId: editFileId,\n      viewId: viewFileId,\n      userRoleControlRights: this.props.userRoleControlRights,\n      viewFile: this.viewFile,\n      mainField: this.props.mainField,\n      subFields: subFields,\n      moreField: moreField,\n      hidePaging: false,\n      userInfo: this.props.Login.userInfo // skip={this.props.skip}\n      // take={this.props.take}\n      ,\n      settings: this.props.Login.settings,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }\n    }), this.props.Login.openAttachmentModal ? /*#__PURE__*/React.createElement(SlideOutModal, {\n      onSaveClick: this.onSaveClick,\n      operation: this.props.Login.operation,\n      screenName: this.props.Login.screenName,\n      closeModal: this.handleClose,\n      show: this.props.Login.openAttachmentModal,\n      inputParam: this.props.Login.inputParam,\n      esign: this.props.Login.loadEsign,\n      validateEsign: this.validateEsign,\n      masterStatus: this.props.Login.masterStatus,\n      updateStore: this.props.updateStore,\n      selectedRecord: this.state.selectedRecord || {},\n      mandatoryFields: mandatoryFields,\n      addComponent: this.props.Login.loadEsign ? /*#__PURE__*/React.createElement(Esign, {\n        operation: this.props.Login.operation,\n        onInputOnChange: this.onInputOnChange,\n        inputParam: this.props.Login.inputParam,\n        selectedRecord: this.state.selectedRecord || {},\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 33\n        }\n      }) : /*#__PURE__*/React.createElement(AddAttachment, {\n        selectedRecord: this.state.selectedRecord || {},\n        onDrop: this.onDropFiles,\n        deleteAttachment: this.deleteAttachment,\n        jsonField: 'jsondata',\n        actionType: this.state.actionType,\n        linkMaster: this.props.Login.linkMaster,\n        onInputOnChange: this.onAttachmentInputChange,\n        editFiles: this.props.Login.editFiles,\n        onComboChange: this.onComboChange,\n        maxSize: 20,\n        fileNameLength: this.props.screenName === 'IDS_TESTATTACHMENTS' ? 255 : 150,\n        maxFiles: this.props.Login.operation === \"update\" ? 1 : 3,\n        operation: this.props.Login.operation,\n        selectedListName: this.props.selectedListName,\n        displayName: this.props.displayName,\n        masterList: this.props.masterList,\n        multiple: this.props.Login.operation === \"update\" ? false : true,\n        isneedReport: this.props.isneedReport || false,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 33\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 25\n      }\n    }) : \"\");\n  }\n\n  componentDidUpdate(previousProps) {\n    if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\n      this.setState({\n        selectedRecord: this.props.Login.selectedRecord\n      });\n    }\n  }\n\n}\n\nexport default connect(mapStateToProps, {\n  updateStore,\n  viewAttachment,\n  validateEsignCredential,\n  crudMaster,\n  getAttachmentCombo,\n  deleteAttachment\n})(injectIntl(Attachments));","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/pages/attachmentscomments/attachments/Attachments.jsx"],"names":["React","Component","Nav","FontAwesomeIcon","FormattedMessage","injectIntl","faPlus","ListAttachment","SlideOutModal","DEFAULT_RETURN","AddAttachment","updateStore","getAttachmentCombo","validateEsignCredential","crudMaster","viewAttachment","deleteAttachment","connect","attachmentType","designProperties","transactionStatus","Esign","QUALISFORMS","deleteAttachmentDropZone","onDropAttachFileList","mapStateToProps","state","Login","Attachments","constructor","props","event","file","fieldName","selectedRecord","setState","actionType","onDropFiles","attachedFiles","maxSize","onAttachmentInputChange","caseNo","optional","target","type","name","checked","YES","NO","value","onInputOnChange","onComboChange","comboData","comboName","onSaveClick","saveType","formRef","handleClose","loadEsign","openAttachmentModal","operation","undefined","updateInfo","typeName","data","selectedParamId","validateEsign","inputParam","inputData","userInfo","sreason","nreasoncode","spredefinedreason","label","password","screenData","validateEsignforApproval","viewFile","filedata","userinfo","classUrl","methodUrl","screenName","showMore","render","subFields","LABEL","genericLabel","slanguagetypecode","VALUE","nformcode","SAMPLEREGISTRATION","moreField","isneedReport","nsubsampleneed","unshift","addFileId","controlMap","has","addName","get","ncontrolcode","editFileId","editName","deleteFileId","deleteName","viewFileId","viewName","mandatoryFields","nattachmenttypecode","LINK","userRoleControlRights","indexOf","ncontrolCode","modalName","masterList","masterAlertStatus","attachments","deleteParam","editParam","fetchRecord","mainField","settings","masterStatus","linkMaster","editFiles","selectedListName","displayName","componentDidUpdate","previousProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Nav } from 'react-bootstrap';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { FormattedMessage, injectIntl } from 'react-intl';\r\nimport { faPlus } from '@fortawesome/free-solid-svg-icons';\r\nimport ListAttachment from '../../../components/ListAttachment';\r\nimport SlideOutModal from '../../../components/slide-out-modal/SlideOutModal';\r\nimport { DEFAULT_RETURN } from '../../../actions/LoginTypes';\r\nimport AddAttachment from './AddAttachment';\r\nimport {\r\n    updateStore, getAttachmentCombo, validateEsignCredential, crudMaster, viewAttachment, deleteAttachment\r\n} from '../../../actions'\r\nimport { connect } from 'react-redux';\r\nimport { attachmentType, designProperties, transactionStatus } from '../../../components/Enumeration';\r\nimport Esign from '../../audittrail/Esign';\r\nimport { QUALISFORMS } from '../../../components/Enumeration';\r\nimport { deleteAttachmentDropZone, onDropAttachFileList } from '../../../components/CommonScript';\r\n\r\nconst mapStateToProps = state => {\r\n    return ({ Login: state.Login })\r\n}\r\nclass Attachments extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            showMore: {},\r\n            selectedRecord: {}\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        let subFields = this.props.subFields ? this.props.subFields : [\r\n            ({\r\n                [designProperties.LABEL]: `${this.props.Login.screenName === 'IDS_TESTATTACHMENTS' ? 'IDS_TESTNAME' :\r\n                    this.props.Login.screenName === 'IDS_SUBSAMPLEATTACHMENTS'\r\n                        ? this.props.Login.genericLabel ? this.props.Login.genericLabel[\"SubARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_SAMPLEARNO\" \r\n                        : this.props.Login.genericLabel ? this.props.Login.genericLabel[\"ARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_ARNO\"}`\r\n            }),\r\n            {\r\n                [designProperties.VALUE]: `${this.props.screenName === 'IDS_SAMPLEATTACHMENTS'\r\n                    ? this.props.Login.userInfo && this.props.Login.userInfo.nformcode === QUALISFORMS.SAMPLEREGISTRATION\r\n                        ? \"groupingField\" : \"sarno\"\r\n                    : this.props.Login.screenName === 'IDS_SUBSAMPLEATTACHMENTS'\r\n                        ? this.props.Login.userInfo && this.props.Login.userInfo.nformcode === QUALISFORMS.SAMPLEREGISTRATION ?\r\n                            \"groupingField2\" : \"ssamplearno\" :\r\n                        \"stestsynonym\"}`\r\n            },\r\n            { [designProperties.VALUE]: \"screateddate\" },\r\n            // { [designProperties.VALUE]: \"nfilesize\", \"fieldType\": \"size\" }\r\n        ];\r\n        let moreField = this.props.moreField ? this.props.moreField : [\r\n            { [designProperties.LABEL]: \"IDS_SCREENNAME\", [designProperties.VALUE]: \"sdisplayname\" },\r\n            { [designProperties.LABEL]: \"IDS_USERNAME\", [designProperties.VALUE]: \"susername\" },\r\n            { [designProperties.LABEL]: \"IDS_USERROLE\", [designProperties.VALUE]: \"suserrolename\" },\r\n            { [designProperties.LABEL]: \"IDS_DESCRIPTION\", [designProperties.VALUE]: \"sdescription\" },\r\n            this.props.isneedReport  ? this.props.isneedReport &&\r\n            { [designProperties.LABEL]: \"IDS_INCULDEINREPORT\", [designProperties.VALUE]: \"sneedreport\" } :\"\"\r\n        ];\r\n        if (this.props.screenName === 'IDS_TESTATTACHMENTS') {\r\n            if (this.props.nsubsampleneed === true) {\r\n                if (this.props.moreField === undefined  ) {\r\n                    moreField.unshift({\r\n                        [designProperties.LABEL]: this.props.Login.genericLabel ? this.props.Login.genericLabel[\"SubARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_SAMPLEARNO\",\r\n                        [designProperties.VALUE]: \"groupingField2\"\r\n                    })\r\n                };\r\n            }\r\n\r\n            if (this.props.moreField === undefined ) {\r\n                moreField.unshift({\r\n                    //  [designProperties.LABEL]: this.props.nsubsampleneed && `${this.props.nsubsampleneed.nneedsubsample ? \"IDS_SAMPLEARNO\" : \"IDS_ARNO\"}`, \r\n                    //  [designProperties.VALUE]: this.props.nsubsampleneed && `${this.props.nsubsampleneed.nneedsubsample ? \"ssamplearno\" : \"sarno\"}`\r\n                    [designProperties.LABEL]: this.props.Login.genericLabel ? this.props.Login.genericLabel[\"ARNo\"][\"jsondata\"][\"sdisplayname\"][this.props.Login.userInfo.slanguagetypecode]:\"IDS_ARNO\",\r\n                    [designProperties.VALUE]: \"groupingField1\"\r\n                })\r\n            };\r\n        }\r\n        let addFileId = this.props.controlMap.has(this.props.addName) && this.props.controlMap.get(this.props.addName).ncontrolcode;\r\n        let editFileId = this.props.controlMap.has(this.props.editName) && this.props.controlMap.get(this.props.editName).ncontrolcode;\r\n        let deleteFileId = this.props.controlMap.has(this.props.deleteName) && this.props.controlMap.get(this.props.deleteName).ncontrolcode;\r\n        let viewFileId = this.props.controlMap.has(this.props.viewName) && this.props.controlMap.get(this.props.viewName).ncontrolcode;\r\n        let mandatoryFields = [];\r\n        if (this.state.selectedRecord && this.state.selectedRecord.nattachmenttypecode === attachmentType.LINK) {\r\n            mandatoryFields = [\r\n                { \"idsName\": \"IDS_FILENAME\", \"dataField\": \"slinkfilename\", \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" },\r\n                { \"idsName\": \"IDS_LINKNAME\", \"dataField\": \"nlinkcode\", \"mandatoryLabel\": \"IDS_ENTER\", \"controlType\": \"textbox\" }\r\n            ];\r\n        } else {\r\n            // if (this.props.Login.operation !== 'update') {\r\n            mandatoryFields = [\r\n                { \"idsName\": \"IDS_FILE\", \"dataField\": \"sfilename\", \"mandatoryLabel\": \"IDS_CHOOSE\", \"controlType\": \"file\" },\r\n            ];\r\n            // }\r\n        }\r\n        return (\r\n            <>\r\n                <div className=\"actions-stripe border-bottom\">\r\n                    <div className=\"d-flex justify-content-end\">\r\n                        <Nav.Link name={`add_${this.props.Login.screenName}_file`} className=\"add-txt-btn\" hidden={this.props.userRoleControlRights.indexOf(addFileId) === -1}\r\n                            onClick={() => this.props.getAttachmentCombo({ userInfo: this.props.Login.userInfo, operation: \"create\", ncontrolCode: addFileId, screenName: this.props.screenName, modalName: \"openAttachmentModal\", masterList: this.props.masterList, masterAlertStatus: this.props.masterAlertStatus })}>\r\n                            <FontAwesomeIcon icon={faPlus} /> { }\r\n                            <FormattedMessage id=\"IDS_ATTACHMENT\" defaultMessage=\"Attachment\" />\r\n                        </Nav.Link>\r\n                    </div>\r\n                </div>\r\n                <ListAttachment\r\n                    attachmentList={this.props.attachments}\r\n                    fileName=\"sfilename\"\r\n                    filesize=\"nfilesize\"\r\n                    linkname=\"slinkname\"\r\n                    isjsonfield={true}\r\n                    jsonfield=\"jsondata\"\r\n                    deleteRecord={this.props.deleteAttachment}\r\n                    deleteParam={this.props.deleteParam}\r\n                    editParam={{ ...this.props.editParam, operation: \"update\", ncontrolCode: editFileId, screenName: this.props.screenName, modalName: \"openAttachmentModal\", masterList: this.props.masterList, masterAlertStatus: this.props.masterAlertStatus }}\r\n                    fetchRecord={this.props.fetchRecord}\r\n                    deleteId={deleteFileId}\r\n                    editId={editFileId}\r\n                    viewId={viewFileId}\r\n                    userRoleControlRights={this.props.userRoleControlRights}\r\n                    viewFile={this.viewFile}\r\n                    mainField={this.props.mainField}\r\n                    subFields={subFields}\r\n                    moreField={moreField}\r\n                    hidePaging={false}\r\n                    userInfo={this.props.Login.userInfo}\r\n                    // skip={this.props.skip}\r\n                    // take={this.props.take}\r\n                    settings={this.props.Login.settings}\r\n                />\r\n                {\r\n                    this.props.Login.openAttachmentModal ?\r\n                        <SlideOutModal\r\n                            onSaveClick={this.onSaveClick}\r\n                            operation={this.props.Login.operation}\r\n                            screenName={this.props.Login.screenName}\r\n                            closeModal={this.handleClose}\r\n                            show={this.props.Login.openAttachmentModal}\r\n                            inputParam={this.props.Login.inputParam}\r\n                            esign={this.props.Login.loadEsign}\r\n                            validateEsign={this.validateEsign}\r\n                            masterStatus={this.props.Login.masterStatus}\r\n                            updateStore={this.props.updateStore}\r\n                            selectedRecord={this.state.selectedRecord || {}}\r\n                            mandatoryFields={mandatoryFields}\r\n                            addComponent={this.props.Login.loadEsign ?\r\n                                <Esign\r\n                                    operation={this.props.Login.operation}\r\n                                    onInputOnChange={this.onInputOnChange}\r\n                                    inputParam={this.props.Login.inputParam}\r\n                                    selectedRecord={this.state.selectedRecord || {}}\r\n                                />\r\n                                :\r\n                                <AddAttachment\r\n                                    selectedRecord={this.state.selectedRecord || {}}\r\n                                    onDrop={this.onDropFiles}\r\n                                    deleteAttachment={this.deleteAttachment}\r\n                                    jsonField={'jsondata'}\r\n                                    actionType={this.state.actionType}\r\n                                    linkMaster={this.props.Login.linkMaster}\r\n                                    onInputOnChange={this.onAttachmentInputChange}\r\n                                    editFiles={this.props.Login.editFiles}\r\n                                    onComboChange={this.onComboChange}\r\n                                    maxSize={20}\r\n                                    fileNameLength={this.props.screenName === 'IDS_TESTATTACHMENTS' ? 255 : 150}\r\n                                    maxFiles={this.props.Login.operation === \"update\" ? 1 : 3}\r\n                                    operation={this.props.Login.operation}\r\n                                    selectedListName={this.props.selectedListName}\r\n                                    displayName={this.props.displayName}\r\n                                    masterList={this.props.masterList}\r\n                                    multiple={this.props.Login.operation === \"update\" ? false : true}\r\n                                    isneedReport={this.props.isneedReport || false}\r\n                                />\r\n                            }\r\n                        />\r\n                        : \"\"}\r\n            </>\r\n        );\r\n    }\r\n\r\n    deleteAttachment = (event, file, fieldName) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        selectedRecord[fieldName] = deleteAttachmentDropZone(selectedRecord[fieldName], file)\r\n\r\n        this.setState({\r\n            selectedRecord, actionType: \"delete\" //fileToDelete:file.name \r\n        });\r\n    }\r\n\r\n\r\n    onDropFiles = (attachedFiles, fieldName, maxSize) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        selectedRecord[fieldName] = onDropAttachFileList(selectedRecord[fieldName], attachedFiles, maxSize)\r\n        this.setState({ selectedRecord, actionType: \"new\" });\r\n    }\r\n\r\n\r\n    onAttachmentInputChange = (event, caseNo, optional) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n        switch (caseNo) {\r\n            case 1:\r\n                if (event.target.type === 'radio') {\r\n                    selectedRecord[event.target.name] = event.target.checked === true && optional;\r\n                    // selectedRecord[\"sfilename\"] = \"\";\r\n                } \r\n                else if(event.target.type === 'checkbox')\r\n                {\r\n                    selectedRecord[event.target.name] = event.target.checked == true ? transactionStatus.YES : transactionStatus.NO;\r\n                }\r\n                else {\r\n                    selectedRecord[event.target.name] = event.target.value;\r\n                }\r\n                this.setState({ selectedRecord });\r\n                break;\r\n\r\n            default:\r\n                selectedRecord[event.target.name] = event.target.value;\r\n                this.setState({ selectedRecord });\r\n                break;\r\n        }\r\n    }\r\n    onInputOnChange = (event) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        if (event.target.type === 'checkbox') {\r\n            selectedRecord[event.target.name] = event.target.checked === true ? transactionStatus.YES : transactionStatus.NO;\r\n        }\r\n        else {\r\n            selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n    }\r\n    onComboChange = (comboData, comboName) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n\r\n        if (comboData) {\r\n            selectedRecord[comboName] = comboData;\r\n            this.setState({ selectedRecord });\r\n        } else {\r\n            selectedRecord[comboName] = []\r\n            this.setState({ selectedRecord });\r\n        }\r\n    }\r\n    componentDidUpdate(previousProps) {\r\n        if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n            this.setState({ selectedRecord: this.props.Login.selectedRecord });\r\n        }\r\n    }\r\n    onSaveClick = (saveType, formRef) => {\r\n        // const masterData = this.props.Login.masterData;\r\n        // let inputData = {}\r\n        // let inputParam = {}\r\n        // inputData[\"userinfo\"] = this.props.Login.userInfo;\r\n        // if(this.props.Login.screenName === \"IDS_SAMPLEATTACHMENTS\") {\r\n        //     let saveParam={userInfo:this.props.Login.userInfo,\r\n        //         selectedRecord:this.state.selectedRecord,\r\n        //         masterData:this.props.Login.masterData,\r\n        //         saveType, formRef,\r\n        //         operation:this.props.Login.operation,\r\n        //         selectedMaster:this.props.selectedMaster\r\n        //     }\r\n        //     inputParam = onSaveSampleAttachment(saveParam,this.props.selectedMaster);\r\n        // }else if(this.props.Login.screenName === \"IDS_TESTATTACHMENTS\") {\r\n        //     let saveParam={userInfo:this.props.Login.userInfo,\r\n        //         selectedRecord:this.state.selectedRecord,\r\n        //         masterData:this.props.Login.masterData,\r\n        //         saveType, formRef,\r\n        //         operation:this.props.Login.operation,\r\n        //         selectedMaster:this.props.selectedMaster\r\n        //     }\r\n        //     inputParam = onSaveTestAttachment(saveParam,this.props.selectedMaster);\r\n        this.props.onSaveClick(saveType, formRef, this.state.selectedRecord)\r\n        // }\r\n        // if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolCode)) {\r\n        //     const updateInfo = {\r\n        //         typeName: DEFAULT_RETURN,\r\n        //         data: {\r\n        //             loadEsign: true,\r\n        //             screenData: { inputParam, masterData },\r\n        //             operation: this.props.Login.operation,\r\n        //             screenName: this.props.Login.screenName,\r\n        //         }\r\n        //     }\r\n        //     this.props.updateStore(updateInfo);\r\n        // }\r\n        // else {\r\n        //     this.props.crudMaster(inputParam, masterData, \"openAttachmentModal\");\r\n        // }\r\n    }\r\n    handleClose = () => {\r\n        let loadEsign = this.props.Login.loadEsign;\r\n        let openAttachmentModal = this.props.Login.openAttachmentModal\r\n        let selectedRecord = this.props.Login.selectedRecord;\r\n        let operation = this.props.Login.operation;\r\n        if (this.props.Login.loadEsign) {\r\n            if (this.props.Login.operation === \"delete\") {\r\n                loadEsign = false;\r\n                openAttachmentModal = false;\r\n                selectedRecord = {};\r\n                operation = undefined;\r\n            }\r\n            else {\r\n                loadEsign = false;\r\n                selectedRecord[\"esigncomments\"] = \"\";\r\n                selectedRecord[\"esignpassword\"] = \"\";\r\n            }\r\n        }\r\n        else {\r\n            openAttachmentModal = false;\r\n            selectedRecord = {};\r\n        }\r\n\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: { openAttachmentModal, loadEsign, selectedRecord, selectedParamId: null, operation }\r\n        }\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n    validateEsign = () => {\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": {\r\n                    ...this.props.Login.userInfo,\r\n                    sreason: this.state.selectedRecord[\"esigncomments\"],\r\n                    nreasoncode:this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\r\n                    spredefinedreason:this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label,\r\n               \r\n                },\r\n                password: this.state.selectedRecord[\"esignpassword\"]\r\n            },\r\n            screenData: this.props.Login.screenData\r\n        }\r\n        if (this.props.Login.operation === 'dynamic') {\r\n            this.props.validateEsignforApproval(inputParam, \"openChildModal\");\r\n        } else {\r\n            this.props.validateEsignCredential(inputParam, \"openAttachmentModal\");\r\n        }\r\n    }\r\n    viewFile = (filedata) => {\r\n        const inputParam = {\r\n            inputData: {\r\n                file: filedata,\r\n                userinfo: this.props.Login.userInfo\r\n            },\r\n            classUrl: \"attachment\",\r\n            operation: \"view\",\r\n            methodUrl: this.props.methodUrl,\r\n            screenName: this.props.Login.screenName\r\n        }\r\n        this.props.viewAttachment(inputParam);\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, {\r\n    updateStore, viewAttachment, validateEsignCredential, crudMaster, getAttachmentCombo, deleteAttachment\r\n})(injectIntl(Attachments));"]},"metadata":{},"sourceType":"module"}