{"ast":null,"code":"import { Plugin, PluginKey } from 'prosemirror-state';\nimport { Decoration, DecorationSet } from \"prosemirror-view\"; // The plugin resolves the following problems:\n//\n// 1. white-space: pre-wrap does not work with text-align: justify in firefox\n//  https://bugzilla.mozilla.org/show_bug.cgi?id=1253840\n//  https://bugzilla.mozilla.org/show_bug.cgi?id=299721\n// 2. Align right in pre-wrap doesn't give the expected outcome,\n//  as in pre-wrap it will preserve the white-space when the text breaks based on the container width.\n// Additional info here:\n// https://github.com/ProseMirror/prosemirror/issues/651\n// https://github.com/ProseMirror/prosemirror/issues/857\n\nvar spaces = /\\s+/g;\nvar align = /text-align/;\n\nvar aligned = function aligned(node) {\n  return align.test(node && node.attrs && node.attrs.style || '');\n};\n\nexport var spacesFix = function spacesFix() {\n  return new Plugin({\n    key: new PluginKey('spaces-fix'),\n    props: {\n      decorations: function decorations(state) {\n        var decorations = [];\n        var doc = state.doc;\n        var start, match, length, i;\n        doc.nodesBetween(0, doc.content.size, function (node, position, parent) {\n          if (node.type.isText && aligned(parent)) {\n            match = spaces.exec(node.text || '');\n\n            while (match !== null) {\n              start = position + match.index;\n              length = match[0].length;\n\n              if (match.index + length < match.input.length) {\n                for (i = 0; i <= length - 1; i += 2) {\n                  decorations.push(Decoration.inline(start + i, start + i + 1, {\n                    style: 'white-space: normal'\n                  }));\n                }\n              }\n\n              match = spaces.exec(node.text || '');\n            }\n          }\n        });\n        return DecorationSet.create(doc, decorations);\n      }\n    }\n  });\n};","map":{"version":3,"sources":["D:/Postgres_workingFolder/QuaLISWeb/node_modules/@progress/kendo-editor-common/dist/es/plugins/spaces-fix.js"],"names":["Plugin","PluginKey","Decoration","DecorationSet","spaces","align","aligned","node","test","attrs","style","spacesFix","key","props","decorations","state","doc","start","match","length","i","nodesBetween","content","size","position","parent","type","isText","exec","text","index","input","push","inline","create"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,SAAjB,QAAkC,mBAAlC;AACA,SAASC,UAAT,EAAqBC,aAArB,QAA0C,kBAA1C,C,CACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIC,MAAM,GAAG,MAAb;AACA,IAAIC,KAAK,GAAG,YAAZ;;AACA,IAAIC,OAAO,GAAG,SAAVA,OAAU,CAAUC,IAAV,EAAgB;AAAE,SAAOF,KAAK,CAACG,IAAN,CAAYD,IAAI,IAAIA,IAAI,CAACE,KAAb,IAAsBF,IAAI,CAACE,KAAL,CAAWC,KAAlC,IAA4C,EAAvD,CAAP;AAAoE,CAApG;;AACA,OAAO,IAAIC,SAAS,GAAG,SAAZA,SAAY,GAAY;AAAE,SAAO,IAAIX,MAAJ,CAAW;AACnDY,IAAAA,GAAG,EAAE,IAAIX,SAAJ,CAAc,YAAd,CAD8C;AAEnDY,IAAAA,KAAK,EAAE;AACHC,MAAAA,WAAW,EAAE,qBAAUC,KAAV,EAAiB;AAC1B,YAAID,WAAW,GAAG,EAAlB;AACA,YAAIE,GAAG,GAAGD,KAAK,CAACC,GAAhB;AACA,YAAIC,KAAJ,EAAWC,KAAX,EAAkBC,MAAlB,EAA0BC,CAA1B;AACAJ,QAAAA,GAAG,CAACK,YAAJ,CAAiB,CAAjB,EAAoBL,GAAG,CAACM,OAAJ,CAAYC,IAAhC,EAAsC,UAAUhB,IAAV,EAAgBiB,QAAhB,EAA0BC,MAA1B,EAAkC;AACpE,cAAIlB,IAAI,CAACmB,IAAL,CAAUC,MAAV,IAAoBrB,OAAO,CAACmB,MAAD,CAA/B,EAAyC;AACrCP,YAAAA,KAAK,GAAGd,MAAM,CAACwB,IAAP,CAAYrB,IAAI,CAACsB,IAAL,IAAa,EAAzB,CAAR;;AACA,mBAAOX,KAAK,KAAK,IAAjB,EAAuB;AACnBD,cAAAA,KAAK,GAAGO,QAAQ,GAAGN,KAAK,CAACY,KAAzB;AACAX,cAAAA,MAAM,GAAGD,KAAK,CAAC,CAAD,CAAL,CAASC,MAAlB;;AACA,kBAAID,KAAK,CAACY,KAAN,GAAcX,MAAd,GAAuBD,KAAK,CAACa,KAAN,CAAYZ,MAAvC,EAA+C;AAC3C,qBAAKC,CAAC,GAAG,CAAT,EAAYA,CAAC,IAAID,MAAM,GAAG,CAA1B,EAA6BC,CAAC,IAAI,CAAlC,EAAqC;AACjCN,kBAAAA,WAAW,CAACkB,IAAZ,CAAiB9B,UAAU,CAAC+B,MAAX,CAAkBhB,KAAK,GAAGG,CAA1B,EAA6BH,KAAK,GAAGG,CAAR,GAAY,CAAzC,EAA4C;AACzDV,oBAAAA,KAAK,EAAE;AADkD,mBAA5C,CAAjB;AAGH;AACJ;;AACDQ,cAAAA,KAAK,GAAGd,MAAM,CAACwB,IAAP,CAAYrB,IAAI,CAACsB,IAAL,IAAa,EAAzB,CAAR;AACH;AACJ;AACJ,SAhBD;AAiBA,eAAO1B,aAAa,CAAC+B,MAAd,CAAqBlB,GAArB,EAA0BF,WAA1B,CAAP;AACH;AAvBE;AAF4C,GAAX,CAAP;AA2BhC,CA3BE","sourcesContent":["import { Plugin, PluginKey } from 'prosemirror-state';\nimport { Decoration, DecorationSet } from \"prosemirror-view\";\n// The plugin resolves the following problems:\n//\n// 1. white-space: pre-wrap does not work with text-align: justify in firefox\n//  https://bugzilla.mozilla.org/show_bug.cgi?id=1253840\n//  https://bugzilla.mozilla.org/show_bug.cgi?id=299721\n// 2. Align right in pre-wrap doesn't give the expected outcome,\n//  as in pre-wrap it will preserve the white-space when the text breaks based on the container width.\n// Additional info here:\n// https://github.com/ProseMirror/prosemirror/issues/651\n// https://github.com/ProseMirror/prosemirror/issues/857\nvar spaces = /\\s+/g;\nvar align = /text-align/;\nvar aligned = function (node) { return align.test((node && node.attrs && node.attrs.style) || ''); };\nexport var spacesFix = function () { return new Plugin({\n    key: new PluginKey('spaces-fix'),\n    props: {\n        decorations: function (state) {\n            var decorations = [];\n            var doc = state.doc;\n            var start, match, length, i;\n            doc.nodesBetween(0, doc.content.size, function (node, position, parent) {\n                if (node.type.isText && aligned(parent)) {\n                    match = spaces.exec(node.text || '');\n                    while (match !== null) {\n                        start = position + match.index;\n                        length = match[0].length;\n                        if (match.index + length < match.input.length) {\n                            for (i = 0; i <= length - 1; i += 2) {\n                                decorations.push(Decoration.inline(start + i, start + i + 1, {\n                                    style: 'white-space: normal'\n                                }));\n                            }\n                        }\n                        match = spaces.exec(node.text || '');\n                    }\n                }\n            });\n            return DecorationSet.create(doc, decorations);\n        }\n    }\n}); };\n"]},"metadata":{},"sourceType":"module"}