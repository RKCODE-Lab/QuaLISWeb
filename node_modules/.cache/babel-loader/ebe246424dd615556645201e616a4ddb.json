{"ast":null,"code":"import _classCallCheck from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _objectSpread from\"D:\\\\LIMSWFH\\\\LIMSPOSTGRESQL\\\\QuaLISWeb\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import React,{Component}from\"react\";import merge from\"lodash/merge\";import{Query,Builder,BasicConfig,BasicFuncs,Utils as QbUtils}from\"react-awesome-query-builder\";import\"react-awesome-query-builder/lib/css/styles.css\";import{FormattedMessage,injectIntl}from\"react-intl\";import AddFilteredPatient from\"../pages/contactmaster/AddFilteredPatient\";import{Pager}from\"@progress/kendo-react-data-tools\";import{Grid,GridColumn}from\"@progress/kendo-react-grid\";import{Button}from\"react-bootstrap\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faCalculator}from\"@fortawesome/free-solid-svg-icons\";import{LocalizationProvider}from\"@progress/kendo-react-intl\";var checkTree=QbUtils.checkTree,loadTree=QbUtils.loadTree,uuid=QbUtils.uuid;var InitialConfig=BasicConfig;var conjunctions={AND:InitialConfig.conjunctions.AND,OR:InitialConfig.conjunctions.OR};// Object.keys(conjunctions).map(x=>{\n//   conjunctions[x]['label']=\"IDS_\"+conjunctions[x]['label'].toUpperCase()\n// })\nvar operators1=_objectSpread({},InitialConfig.operators);Object.keys(operators1).map(function(x){operators1[x]['label']=\"IDS_\"+operators1[x]['label'].toUpperCase();});delete operators1.proximity;var operators=_objectSpread(_objectSpread({},operators1),{},{between:_objectSpread(_objectSpread({},operators1.between),{},{textSeparators:[\"from\",\"to\"]})});var widgets=_objectSpread(_objectSpread({},InitialConfig.widgets),{},{date:_objectSpread(_objectSpread({},InitialConfig.widgets.date),{},{dateFormat:\"DD.MM.YYYY\",valueFormat:\"YYYY-MM-DD\"})});var types=_objectSpread(_objectSpread({},InitialConfig.types),{},{boolean:merge(InitialConfig.types.boolean,{widgets:{boolean:{widgetProps:{hideOperator:true,operatorInlineLabel:\"is\"}}}})});var localeSettings={locale:{moment:\"ru\"//  antd:messages['en-US']\n},valueLabel:\"Values\",valuePlaceholder:\"Values\",operatorLabel:\"Operator\",fieldPlaceholder:\"Select field\",operatorPlaceholder:\"Select operator\",deleteLabel:null,addGroupLabel:\"Add group\",addRuleLabel:\"Add rule\",addSubRuleLabel:\"Add sub rule\",delGroupLabel:null,notLabel:\"Not\",funcLabel:\"Function\",valueSourcesPopupTitle:\"Select value source\"// removeRuleConfirmOptions: {\n//   title: \"Are you sure delete this rule?\",\n//   okText: \"Yes\",\n//   okType: \"danger\",\n// },\n// removeGroupConfirmOptions: {\n//   title: \"Are you sure delete this group?\",\n//   okText: \"Yes\",\n//   okType: \"danger\",\n// },\n};var settings1=_objectSpread({},InitialConfig.settings);delete settings1.field;var settings=_objectSpread(_objectSpread(_objectSpread({},settings1),localeSettings),{},{valueSourcesInfo:{value:{label:\"Value\"},field:{label:\"Field\",widget:\"field\"},func:{label:\"Function\",widget:\"func\"}},// canReorder: false,\n// canRegroup: false,\n// showNot: false,\n// showLabels: true,\nmaxNesting:5,canLeaveEmptyGroup:true,shouldCreateEmptyGroup:false,showErrorMessage:true,customFieldSelectProps:{showSearch:true}//after deletion\n// renderField: (props) => <FieldCascader {...props} />,\n// renderOperator: (props) => <FieldDropdown {...props} />,\n// renderFunc: (props) => <FieldSelect {...props} />,\n});var funcs=_objectSpread({},BasicFuncs);// delete funcs.valueSourcesInfo.field\nvar config=_objectSpread(_objectSpread({},InitialConfig),{},{conjunctions:conjunctions,operators:operators,widgets:widgets,types:types,settings:settings,funcs:funcs,fields:{}});Object.keys(config['funcs']).map(function(x){config['funcs'][x]['label']=\"IDS_\"+config['funcs'][x]['label'].toUpperCase();});var FilterQueryBuilder=/*#__PURE__*/function(_Component){_inherits(FilterQueryBuilder,_Component);var _super=_createSuper(FilterQueryBuilder);function FilterQueryBuilder(_props){var _this;_classCallCheck(this,FilterQueryBuilder);_this=_super.call(this,_props);_this.renderBuilder=function(props){return/*#__PURE__*/React.createElement(\"div\",{className:\"query-builder-wrap kendo-theme\"},/*#__PURE__*/React.createElement(Builder,props));};Object.keys(config.operators).map(function(x){config.operators[x]['label']=_this.props.intl.formatMessage({id:config.operators[x]['label']});//  return  {[x]:config.operators[x]};\n});Object.keys(config['funcs']).map(function(x){config['funcs'][x]['label']=_this.props.intl.formatMessage({id:config['funcs'][x]['label']});});_this.state={config:_objectSpread(_objectSpread({},config),{},{settings:_objectSpread(_objectSpread({},config.settings),{},{notLabel:_this.props.intl.formatMessage({id:\"IDS_NOT\"}),valueLabel:_this.props.intl.formatMessage({id:\"IDS_VALUE\"}),valuePlaceholder:_this.props.intl.formatMessage({id:\"IDS_VALUE\"}),operatorLabel:_this.props.intl.formatMessage({id:\"IDS_OPERATOR\"}),fieldPlaceholder:_this.props.intl.formatMessage({id:\"IDS_SELECTFIELD\"}),operatorPlaceholder:_this.props.intl.formatMessage({id:\"IDS_SELECTOPERATOR\"}),// deleteLabel: this.props.intl.formatMessage({id: \"\" }),\naddGroupLabel:_this.props.intl.formatMessage({id:\"IDS_ADDGROUP\"}),addRuleLabel:_this.props.intl.formatMessage({id:\"IDS_ADDRULE\"}),addSubRuleLabel:_this.props.intl.formatMessage({id:\"IDS_ADDSUBRULE\"}),//delGroupLabel: this.props.intl.formatMessage({id: \"\" }),\nvalueSourcesPopupTitle:_this.props.intl.formatMessage({id:\"IDS_SELECTVALUESOURCE\"}),funcLabel:_this.props.intl.formatMessage({id:\"IDS_FUNCTION\"}),valueSourcesInfo:{field:{label:_this.props.intl.formatMessage({id:\"IDS_FIELD\"}),widget:'field'},func:{label:_this.props.intl.formatMessage({id:\"IDS_FUNCTION\"}),widget:'func'},value:{label:_this.props.intl.formatMessage({id:\"IDS_VALUE\"})}}//delete alert\n// removeRuleConfirmOptions: {\n//   title: this.props.intl.formatMessage({ id: \"IDS_AREYOUSUREDELETETHISRULE\" }),\n//   okText: this.props.intl.formatMessage({ id: \"IDS_YES\" }),\n//   okType: \"danger\",\n// },\n// removeGroupConfirmOptions: {\n//   title: this.props.intl.formatMessage({ id: \"IDS_AREYOUSUREDELETETHISGROUP\" }),\n//   okText: this.props.intl.formatMessage({ id: \"IDS_YES\" }),\n//   okType: \"danger\",\n// }\n}),conjunctions:{AND:_objectSpread(_objectSpread({},config['conjunctions']['AND']),{},{label:_this.props.intl.formatMessage({id:\"IDS_AND\"})}),OR:_objectSpread(_objectSpread({},config['conjunctions']['OR']),{},{label:_this.props.intl.formatMessage({id:\"IDS_OR\"})})},//  operators: { ...Object.keys(config.operators).map(x =>) }\nfields:_this.props.fields//,settings:{...config.settings,notLabel:this.props.intl.formatMessage({id: \"NOT\"})}\n})};return _this;}_createClass(FilterQueryBuilder,[{key:\"render\",value:function render(){var _this2=this;var emptyInitValue={\"id\":uuid(),\"type\":\"group\"};var conf=this.props.config?this.props.config:this.state.config;var tree=checkTree(loadTree(emptyInitValue),conf);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Query,Object.assign({},this.state.config,{value:this.props.tree||tree// value={checkTree(loadTree(tree),conf)}\n,onChange:this.props.onChange,renderBuilder:this.renderBuilder})),!this.props.static?/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-end mt-3\"},/*#__PURE__*/React.createElement(Button,{className:\"btn-user btn-primary-blue\",onClick:function onClick(){return _this2.props.handleExecuteClick();}},/*#__PURE__*/React.createElement(FontAwesomeIcon,{icon:faCalculator}),\" \",/*#__PURE__*/React.createElement(FormattedMessage,{id:\"IDS_EXECUTE\",defaultMessage:\"Execute\"}))):\"\",!this.props.static?/*#__PURE__*/React.createElement(\"hr\",null):\"\",!this.props.static?/*#__PURE__*/React.createElement(LocalizationProvider,{language:this.props.userInfo.slanguagetypecode},/*#__PURE__*/React.createElement(Grid,{style:{maxHeight:\"400px\"},onRowClick:this.props.onRowClick,data:this.props.filterData.slice(this.props.skip,this.props.skip+this.props.take)},this.props.gridColumns.map(function(x){return/*#__PURE__*/React.createElement(GridColumn,{field:x.field,title:x.title,width:x.width});}))):\"\",!this.props.static?/*#__PURE__*/React.createElement(\"hr\",null):\"\",!this.props.static?/*#__PURE__*/React.createElement(LocalizationProvider,{language:this.props.userInfo.slanguagetypecode},/*#__PURE__*/React.createElement(Pager,{skip:this.props.skip,take:this.props.take,type:\"input\",previousNext:true,total:this.props.filterData.length,onPageChange:this.props.handlePageChange})):\"\"));}// onChange = (immutableTree, config) => {\n//   this.setState({ tree: immutableTree, config: config });\n//   const jsonTree = QbUtils.getTree(immutableTree);\n//   console.log(jsonTree);\n// };\n}]);return FilterQueryBuilder;}(Component);export default injectIntl(FilterQueryBuilder);","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/src/components/FilterQueryBuilder.jsx"],"names":["React","Component","merge","Query","Builder","BasicConfig","BasicFuncs","Utils","QbUtils","FormattedMessage","injectIntl","AddFilteredPatient","Pager","Grid","GridColumn","Button","FontAwesomeIcon","faCalculator","LocalizationProvider","checkTree","loadTree","uuid","InitialConfig","conjunctions","AND","OR","operators1","operators","Object","keys","map","x","toUpperCase","proximity","between","textSeparators","widgets","date","dateFormat","valueFormat","types","boolean","widgetProps","hideOperator","operatorInlineLabel","localeSettings","locale","moment","valueLabel","valuePlaceholder","operatorLabel","fieldPlaceholder","operatorPlaceholder","deleteLabel","addGroupLabel","addRuleLabel","addSubRuleLabel","delGroupLabel","notLabel","funcLabel","valueSourcesPopupTitle","settings1","settings","field","valueSourcesInfo","value","label","widget","func","maxNesting","canLeaveEmptyGroup","shouldCreateEmptyGroup","showErrorMessage","customFieldSelectProps","showSearch","funcs","config","fields","FilterQueryBuilder","props","renderBuilder","intl","formatMessage","id","state","emptyInitValue","conf","tree","onChange","static","handleExecuteClick","userInfo","slanguagetypecode","maxHeight","onRowClick","filterData","slice","skip","take","gridColumns","title","width","length","handlePageChange"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport merge from \"lodash/merge\";\r\nimport {\r\n  Query,\r\n  Builder,\r\n  BasicConfig, BasicFuncs,\r\n  Utils as QbUtils,\r\n} from \"react-awesome-query-builder\";\r\nimport \"react-awesome-query-builder/lib/css/styles.css\";\r\nimport { FormattedMessage, injectIntl } from \"react-intl\";\r\nimport AddFilteredPatient from \"../pages/contactmaster/AddFilteredPatient\";\r\nimport { Pager } from \"@progress/kendo-react-data-tools\";\r\nimport { Grid, GridColumn } from \"@progress/kendo-react-grid\";\r\nimport { Button } from \"react-bootstrap\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faCalculator } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { LocalizationProvider } from \"@progress/kendo-react-intl\";\r\nconst { checkTree, loadTree, uuid } = QbUtils;\r\n\r\nconst InitialConfig = BasicConfig;\r\n\r\nconst conjunctions = {\r\n  AND: InitialConfig.conjunctions.AND,\r\n  OR: InitialConfig.conjunctions.OR,\r\n};\r\n\r\n// Object.keys(conjunctions).map(x=>{\r\n//   conjunctions[x]['label']=\"IDS_\"+conjunctions[x]['label'].toUpperCase()\r\n// })\r\n\r\nconst operators1 = {\r\n  ...InitialConfig.operators\r\n}\r\n\r\nObject.keys(operators1).map(x => {\r\n  operators1[x]['label'] = \"IDS_\" + operators1[x]['label'].toUpperCase()\r\n})\r\ndelete operators1.proximity\r\nconst operators = {\r\n  ...operators1,\r\n  between: {\r\n    ...operators1.between,\r\n    textSeparators: [\r\n      \"from\",\r\n      \"to\"\r\n    ],\r\n  }\r\n};\r\n\r\n\r\nconst widgets = {\r\n  ...InitialConfig.widgets,\r\n  date: {\r\n    ...InitialConfig.widgets.date,\r\n    dateFormat: \"DD.MM.YYYY\",\r\n    valueFormat: \"YYYY-MM-DD\",\r\n  }\r\n};\r\n\r\n\r\nconst types = {\r\n  ...InitialConfig.types,\r\n  boolean: merge(InitialConfig.types.boolean, {\r\n    widgets: {\r\n      boolean: {\r\n        widgetProps: {\r\n          hideOperator: true,\r\n          operatorInlineLabel: \"is\",\r\n        }\r\n      },\r\n    },\r\n  }),\r\n};\r\n\r\n\r\n\r\n\r\nconst localeSettings = {\r\n  locale: {\r\n    moment: \"ru\",\r\n    //  antd:messages['en-US']\r\n\r\n  },\r\n  valueLabel: \"Values\",\r\n  valuePlaceholder: \"Values\",\r\n  operatorLabel: \"Operator\",\r\n  fieldPlaceholder: \"Select field\",\r\n  operatorPlaceholder: \"Select operator\",\r\n  deleteLabel: null,\r\n  addGroupLabel: \"Add group\",\r\n  addRuleLabel: \"Add rule\",\r\n  addSubRuleLabel: \"Add sub rule\",\r\n  delGroupLabel: null,\r\n  notLabel: \"Not\",\r\n  funcLabel: \"Function\",\r\n  valueSourcesPopupTitle: \"Select value source\",\r\n  // removeRuleConfirmOptions: {\r\n  //   title: \"Are you sure delete this rule?\",\r\n  //   okText: \"Yes\",\r\n  //   okType: \"danger\",\r\n  // },\r\n  // removeGroupConfirmOptions: {\r\n  //   title: \"Are you sure delete this group?\",\r\n  //   okText: \"Yes\",\r\n  //   okType: \"danger\",\r\n  // },\r\n};\r\nconst settings1 = { ...InitialConfig.settings }\r\ndelete settings1.field\r\nconst settings = {\r\n  ...settings1,\r\n  ...localeSettings,\r\n\r\n  valueSourcesInfo: {\r\n    value: {\r\n      label: \"Value\"\r\n    }\r\n    ,\r\n    field: {\r\n      label: \"Field\",\r\n      widget: \"field\",\r\n    },\r\n    func: {\r\n      label: \"Function\",\r\n      widget: \"func\",\r\n    }\r\n  },\r\n  // canReorder: false,\r\n  // canRegroup: false,\r\n  // showNot: false,\r\n  // showLabels: true,\r\n  maxNesting: 5,\r\n  canLeaveEmptyGroup: true,\r\n  shouldCreateEmptyGroup: false,\r\n  showErrorMessage: true,\r\n  customFieldSelectProps: {\r\n    showSearch: true\r\n  }, //after deletion\r\n\r\n  // renderField: (props) => <FieldCascader {...props} />,\r\n  // renderOperator: (props) => <FieldDropdown {...props} />,\r\n  // renderFunc: (props) => <FieldSelect {...props} />,\r\n};\r\n\r\nconst funcs = {\r\n  ...BasicFuncs\r\n};\r\n// delete funcs.valueSourcesInfo.field\r\nconst config = {\r\n  ...InitialConfig, conjunctions,\r\n  operators,\r\n  widgets,\r\n  types,\r\n  settings,\r\n  funcs,\r\n  fields: {}\r\n\r\n};\r\n\r\n\r\n\r\nObject.keys(config['funcs']).map(x => {\r\n  config['funcs'][x]['label'] = \"IDS_\" + config['funcs'][x]['label'].toUpperCase()\r\n})\r\n\r\n\r\nclass FilterQueryBuilder extends Component {\r\n  constructor(props) {\r\n\r\n    super(props);\r\n    Object.keys(config.operators).map(x => {\r\n      config.operators[x]['label'] = this.props.intl.formatMessage({ id: config.operators[x]['label'] })\r\n      //  return  {[x]:config.operators[x]};\r\n    })\r\n\r\n    Object.keys(config['funcs']).map(x => {\r\n      config['funcs'][x]['label'] = this.props.intl.formatMessage({ id: config['funcs'][x]['label'] })\r\n    })\r\n\r\n    this.state = {\r\n      config: {\r\n        ...config, settings: {\r\n          ...config.settings, notLabel: this.props.intl.formatMessage({ id: \"IDS_NOT\" }),\r\n          valueLabel: this.props.intl.formatMessage({ id: \"IDS_VALUE\" }),\r\n          valuePlaceholder: this.props.intl.formatMessage({ id: \"IDS_VALUE\" }),\r\n          operatorLabel: this.props.intl.formatMessage({ id: \"IDS_OPERATOR\" }),\r\n          fieldPlaceholder: this.props.intl.formatMessage({ id: \"IDS_SELECTFIELD\" }),\r\n          operatorPlaceholder: this.props.intl.formatMessage({ id: \"IDS_SELECTOPERATOR\" }),\r\n          // deleteLabel: this.props.intl.formatMessage({id: \"\" }),\r\n          addGroupLabel: this.props.intl.formatMessage({ id: \"IDS_ADDGROUP\" }),\r\n          addRuleLabel: this.props.intl.formatMessage({ id: \"IDS_ADDRULE\" }),\r\n          addSubRuleLabel: this.props.intl.formatMessage({ id: \"IDS_ADDSUBRULE\" }),\r\n          //delGroupLabel: this.props.intl.formatMessage({id: \"\" }),\r\n          valueSourcesPopupTitle: this.props.intl.formatMessage({ id: \"IDS_SELECTVALUESOURCE\" }),\r\n          funcLabel: this.props.intl.formatMessage({ id: \"IDS_FUNCTION\" }),\r\n          valueSourcesInfo: {\r\n            field: { label: this.props.intl.formatMessage({ id: \"IDS_FIELD\" }), widget: 'field' },\r\n            func: { label: this.props.intl.formatMessage({ id: \"IDS_FUNCTION\" }), widget: 'func' },\r\n            value: { label: this.props.intl.formatMessage({ id: \"IDS_VALUE\" }) }\r\n          },\r\n\r\n          //delete alert\r\n          // removeRuleConfirmOptions: {\r\n          //   title: this.props.intl.formatMessage({ id: \"IDS_AREYOUSUREDELETETHISRULE\" }),\r\n          //   okText: this.props.intl.formatMessage({ id: \"IDS_YES\" }),\r\n          //   okType: \"danger\",\r\n          // },\r\n          // removeGroupConfirmOptions: {\r\n          //   title: this.props.intl.formatMessage({ id: \"IDS_AREYOUSUREDELETETHISGROUP\" }),\r\n          //   okText: this.props.intl.formatMessage({ id: \"IDS_YES\" }),\r\n          //   okType: \"danger\",\r\n          // }\r\n\r\n\r\n        }, conjunctions: {\r\n          AND: { ...config['conjunctions']['AND'], label: this.props.intl.formatMessage({ id: \"IDS_AND\" }) },\r\n          OR: { ...config['conjunctions']['OR'], label: this.props.intl.formatMessage({ id: \"IDS_OR\" }) }\r\n        },\r\n        //  operators: { ...Object.keys(config.operators).map(x =>) }\r\n        fields: this.props.fields//,settings:{...config.settings,notLabel:this.props.intl.formatMessage({id: \"NOT\"})}\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  render() {\r\n   const emptyInitValue = { \"id\": uuid(), \"type\": \"group\" };\r\n   let conf = this.props.config ? this.props.config : this.state.config\r\n    let tree = checkTree(loadTree(emptyInitValue), conf)\r\n    return (\r\n      <React.Fragment>\r\n   \r\n        <div >\r\n          <Query\r\n            {...this.state.config}\r\n            value={this.props.tree||tree}\r\n            // value={checkTree(loadTree(tree),conf)}\r\n            onChange={this.props.onChange}\r\n            renderBuilder={this.renderBuilder}\r\n\r\n          />\r\n     {!this.props.static ?\r\n        <div className=\"d-flex justify-content-end mt-3\">\r\n          <Button className=\"btn-user btn-primary-blue\" onClick={() => this.props.handleExecuteClick()}>\r\n            <FontAwesomeIcon icon={faCalculator} /> { }\r\n            <FormattedMessage id='IDS_EXECUTE' defaultMessage='Execute' />\r\n          </Button>\r\n          </div>\r\n          : \"\"}\r\n          {!this.props.static ?\r\n            <hr /> : \"\"}\r\n          {!this.props.static ?\r\n            <LocalizationProvider language={this.props.userInfo.slanguagetypecode}>\r\n              <Grid\r\n                style={{\r\n                  maxHeight: \"400px\",\r\n                }}\r\n                onRowClick={this.props.onRowClick}\r\n                data={this.props.filterData.slice(this.props.skip, this.props.skip + this.props.take)}\r\n              >\r\n                {this.props.gridColumns.map(x => {\r\n\r\n                  return <GridColumn field={x.field} title={x.title} width={x.width} />\r\n\r\n                })}\r\n\r\n                {/* <GridColumn field=\"UnitPrice\" title=\"Price\" />\r\n              <GridColumn field=\"Discontinued\" title=\"Discontinued\" /> */}\r\n              </Grid>\r\n            </LocalizationProvider>\r\n            : \"\"}\r\n          {!this.props.static ?\r\n            <hr />\r\n            : \"\"}\r\n          {!this.props.static ?\r\n            <LocalizationProvider language={this.props.userInfo.slanguagetypecode}>\r\n              <Pager\r\n                skip={this.props.skip}\r\n                take={this.props.take}\r\n                type=\"input\"\r\n                previousNext={true}\r\n                total={this.props.filterData.length}\r\n                onPageChange={this.props.handlePageChange}\r\n              />\r\n            </LocalizationProvider>\r\n            : \"\"}\r\n          {/* {this.props.slideResult && this.props.slideResult.length > 0 ?\r\n          <AddFilteredPatient\r\n            slideList={this.props.slideList}\r\n            slideResult={this.props.slideResult}\r\n            controlMap={this.props.controlMap}\r\n            dataState={this.props.dataState}\r\n            dataStateChange={this.props.dataStateChange}\r\n          />\r\n\r\n          : \"\"} */}\r\n        </div>\r\n      </React.Fragment>\r\n\r\n    );\r\n  }\r\n\r\n  renderBuilder = (props) => (\r\n    <div className=\"query-builder-wrap kendo-theme\">\r\n      <Builder {...props}\r\n      />\r\n    </div>\r\n\r\n  );\r\n  // onChange = (immutableTree, config) => {\r\n  //   this.setState({ tree: immutableTree, config: config });\r\n\r\n  //   const jsonTree = QbUtils.getTree(immutableTree);\r\n  //   console.log(jsonTree);\r\n  // };\r\n\r\n}\r\nexport default injectIntl(FilterQueryBuilder);\r\n"]},"metadata":{},"sourceType":"module"}