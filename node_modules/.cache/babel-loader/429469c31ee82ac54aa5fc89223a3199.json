{"ast":null,"code":"var _jsxFileName = \"E:\\\\WorkingFolder\\\\React_Postgres\\\\ALPD\\\\branches\\\\SOURCE-513-PROD\\\\SOURCE-513-ALPD-5500\\\\QuaLISWeb\\\\src\\\\pages\\\\storagemanagement\\\\SampleProcessing.jsx\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { injectIntl } from 'react-intl';\nimport { Row, Col } from 'react-bootstrap';\nimport { toast } from 'react-toastify';\nimport { process } from '@progress/kendo-data-query';\nimport DataGrid from '../../components/data-grid/data-grid.component';\nimport DateTimePicker from '../../components/date-time-picker/date-time-picker.component';\nimport { ListWrapper } from '../../components/client-group.styles';\nimport AddSampleProcessing from '../storagemanagement//AddSampleProcessing';\nimport SlideOutModal from '../../components/slide-out-modal/SlideOutModal';\nimport Esign from '../audittrail/Esign';\nimport { SampleCycle, transactionStatus } from '../../components/Enumeration';\nimport { DEFAULT_RETURN } from '../../actions/LoginTypes';\nimport FormSelectSearch from '../../components/form-select-search/form-select-search.component';\nimport { callService, crudMaster, updateStore, validateEsignCredential, getComboSampleProcessing, getBarcodeDataDetails, getSampleProcessType, getProcessduration, saveSampleProcessing, getActiveSampleProcessingById, getSampleProcessing, validateEsignCredentialSampleProcessing } from '../../actions';\nimport { sortData, getControlMap, getStartOfDay, getEndOfDay, convertDateValuetoString, rearrangeDateFormat, constructOptionList, Lims_JSON_stringify, formatInputDate, showEsign } from '../../components/CommonScript';\n\nconst mapStateToProps = state => {\n  return {\n    Login: state.Login\n  };\n};\n\nclass SampleProcessing extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.closeModal = () => {\n      let loadEsign = this.props.Login.loadEsign;\n      let openModal = this.props.Login.openModal;\n      let selectedRecord = this.props.Login.selectedRecord;\n\n      if (this.props.Login.loadEsign) {\n        if (this.props.Login.operation === \"delete\") {\n          loadEsign = false;\n          openModal = false;\n          selectedRecord = {};\n        } else {\n          loadEsign = false;\n          selectedRecord['esignpassword'] = \"\";\n          selectedRecord['esignreason'] = \"\";\n          selectedRecord['esigncomments'] = \"\";\n        }\n      } else {\n        openModal = false;\n        selectedRecord = {};\n      }\n\n      const updateInfo = {\n        typeName: DEFAULT_RETURN,\n        data: {\n          openModal,\n          loadEsign,\n          selectedRecord\n        }\n      };\n      this.props.updateStore(updateInfo);\n    };\n\n    this.dataStateChange = event => {\n      this.setState({\n        dataResult: process(this.state.data, event.dataState),\n        dataState: event.dataState\n      });\n    };\n\n    this.validateEsign = () => {\n      const inputParam = {\n        inputData: {\n          \"userinfo\": { ...this.props.Login.userInfo,\n            sreason: this.state.selectedRecord[\"esigncomments\"],\n            nreasoncode: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\n            spredefinedreason: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label\n          },\n          password: this.state.selectedRecord[\"esignpassword\"]\n        },\n        screenData: this.props.Login.screenData\n      };\n\n      if (this.props.Login.operation === 'update') {\n        this.props.validateEsignCredentialSampleProcessing(inputParam, \"openModal\");\n      } else {\n        this.props.validateEsignCredential(inputParam, \"openModal\");\n      }\n    };\n\n    this.deleteRecord = deleteParam => {\n      let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\n      let fromDate = obj.fromDate;\n      let toDate = obj.toDate;\n      const inputParam = {\n        classUrl: this.props.Login.inputParam.classUrl,\n        methodUrl: this.props.Login.inputParam.methodUrl,\n        displayName: this.props.Login.inputParam.displayName,\n        inputData: {\n          [this.props.Login.inputParam.methodUrl.toLowerCase()]: deleteParam.selectedRecord,\n          \"userinfo\": this.props.Login.userInfo,\n          \"fromDate\": fromDate,\n          \"toDate\": toDate,\n          \"nprojecttypecode\": this.props.Login.masterData.selectedProjectType.value || -1,\n          \"nsampleprocessingcode\": deleteParam.selectedRecord['nsampleprocessingcode'],\n          \"sbarcodeid\": deleteParam.selectedRecord['sbarcodeid']\n        },\n        operation: deleteParam.operation,\n        dataState: this.state.dataState\n      };\n\n      if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, deleteParam.ncontrolCode)) {\n        const updateInfo = {\n          typeName: DEFAULT_RETURN,\n          data: {\n            loadEsign: true,\n            screenData: {\n              inputParam,\n              masterData: this.props.Login.masterData\n            },\n            openModal: true,\n            screenName: this.props.intl.formatMessage({\n              id: this.props.Login.inputParam.displayName\n            }),\n            operation: deleteParam.operation\n          }\n        };\n        this.props.updateStore(updateInfo);\n      } else {\n        this.props.crudMaster(inputParam, this.props.Login.masterData, \"openModal\");\n      }\n    };\n\n    this.onSaveClick = (saveType, formRef) => {\n      let selectedRecord = this.state.selectedRecord || {};\n      let alertMessage;\n      const sbarcodeid = this.props.Login.masterData.barcodedata; //ALPD-5139--Vignesh R(24-12-2024)---added the collection tube type in datagrid\n\n      let checkCollectionTubeType = true;\n      let checkSampleType = true; //ALPD-5139--Vignesh R(26-12-2024)---while updating this condition,this can't apply\n\n      if (this.props.Login.operation !== 'update') {\n        let jsonPrimaryKeyValue = this.props.Login.masterData.jsonPrimaryKeyValue;\n\n        if (jsonPrimaryKeyValue.nsamplecollectiontypecode) {\n          if (jsonPrimaryKeyValue.nsamplecollectiontypecode !== selectedRecord['nproductcode'].item.nsamplecollectiontypecode) {\n            checkSampleType = false;\n          }\n        }\n\n        if (jsonPrimaryKeyValue.ncollectiontubetypecode) {\n          if (jsonPrimaryKeyValue.ncollectiontubetypecode !== selectedRecord['ncollectiontubetypecode'].value) {\n            checkCollectionTubeType = false;\n          }\n        }\n      }\n\n      if (checkSampleType) {\n        if (checkCollectionTubeType) {\n          if (selectedRecord[\"sbarcodeid\"] && selectedRecord[\"sbarcodeid\"].length === parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength)) {\n            let invalidbarcode = selectedRecord[\"sbarcodeid\"].substring(1, 2);\n\n            if (parseInt(invalidbarcode) === SampleCycle.PROCESSING) {\n              if (sbarcodeid != undefined && sbarcodeid != '') {\n                let date1;\n                let date2;\n                let diffenecemill;\n                let differenceInMinutes;\n                let flag = false;\n\n                if (selectedRecord[\"dprocessenddate\"] !== undefined && selectedRecord[\"dprocessenddate\"] !== \"\" && selectedRecord[\"dprocessenddate\"] !== null) {\n                  date1 = new Date(formatInputDate(selectedRecord[\"dprocessstartdate\"], false));\n                  date2 = new Date(formatInputDate(selectedRecord[\"dprocessenddate\"], false));\n                  diffenecemill = date2 - date1;\n                  differenceInMinutes = diffenecemill / (1000 * 60);\n                  let nngracetimetime;\n                  let nprocesstime;\n                  nngracetimetime = parseInt(selectedRecord['ngracetime']) + parseInt(selectedRecord['nprocesstime']);\n                  nprocesstime = parseInt(selectedRecord['nprocesstime']);\n\n                  if (differenceInMinutes > nngracetimetime) {\n                    if (selectedRecord[\"sdeviationcomments\"] === undefined || selectedRecord[\"sdeviationcomments\"] === \"\") {\n                      flag = true;\n                      alertMessage = \"IDS_DEVIATIONCOMMENTS\";\n                    }\n                  } else if (differenceInMinutes > nprocesstime) {\n                    if (selectedRecord[\"scomments\"] === undefined || selectedRecord[\"scomments\"] === \"\") {\n                      flag = true;\n                      alertMessage = \"IDS_COMMENTS\";\n                    }\n                  }\n                }\n\n                if (!flag) {\n                  let inputData = {};\n                  inputData[\"sampleprocessing\"] = {};\n\n                  if (this.props.Login.operation === \"create\") {\n                    inputData[\"sampleprocessing\"][\"nsamplecollectiontypecode\"] = selectedRecord[\"nsamplecollectiontypecode\"] ? selectedRecord[\"nsamplecollectiontypecode\"] : -1;\n                    inputData[\"sampleprocessing\"][\"nproductcode\"] = selectedRecord[\"nproductcode\"] ? selectedRecord[\"nproductcode\"].value : -1;\n                    inputData[\"sampleprocessing\"][\"ncollectiontubetypecode\"] = selectedRecord[\"ncollectiontubetypecode\"] ? selectedRecord[\"ncollectiontubetypecode\"].value : -1;\n                    inputData[\"sampleprocessing\"][\"jsondata\"] = Lims_JSON_stringify(JSON.stringify(this.props.Login.masterData.barcodedata));\n                    let listProcessType = [...this.state.selectedRecord[\"processtype\"]];\n                    const removeIndex = listProcessType.findIndex(item => {\n                      return item.value === parseInt(selectedRecord[\"nprocesstypecode\"].value);\n                    });\n\n                    if (removeIndex !== -1) {\n                      listProcessType.splice(removeIndex, listProcessType.length);\n\n                      if (listProcessType.length > 0) {\n                        inputData = { ...inputData,\n                          \"listOfnsampleprocesstypecode\": listProcessType.map(item => item.item.nsampleprocesstypecode).join(','),\n                          \"nsampleprocesstypecode\": selectedRecord[\"nsampleprocesstypecode\"],\n                          \"nprocesstypelength\": listProcessType.length\n                        };\n                      } else {\n                        inputData = { ...inputData,\n                          \"listOfnsampleprocesstypecode\": selectedRecord[\"nsampleprocesstypecode\"],\n                          \"nsampleprocesstypecode\": selectedRecord[\"nsampleprocesstypecode\"],\n                          \"isSingleProcesstype\": true,\n                          \"nprocesstypelength\": 1\n                        };\n                      }\n                    }\n                  }\n\n                  inputData[\"sampleprocessing\"][\"nprojecttypecode\"] = this.props.Login.masterData.selectedProjectType.value || transactionStatus.NA;\n\n                  if (this.props.Login.operation === \"update\") {\n                    inputData[\"sampleprocessing\"][\"nsampleprocessingcode\"] = this.props.Login.selectedId;\n                  }\n\n                  inputData[\"sampleprocessing\"][\"sbarcodeid\"] = selectedRecord[\"sbarcodeid\"] ? selectedRecord[\"sbarcodeid\"] : -1;\n                  inputData[\"sampleprocessing\"][\"nsamplecollectiontypecode\"] = selectedRecord[\"nsamplecollectiontypecode\"] ? selectedRecord[\"nsamplecollectiontypecode\"] : -1;\n                  inputData[\"sampleprocessing\"][\"scomments\"] = selectedRecord[\"scomments\"] && selectedRecord[\"scomments\"] || \"\";\n                  inputData[\"sampleprocessing\"][\"sdeviationcomments\"] = selectedRecord[\"sdeviationcomments\"] && selectedRecord[\"sdeviationcomments\"] || \"\";\n                  inputData[\"sampleprocessing\"][\"dprocessstartdate\"] = formatInputDate(selectedRecord[\"dprocessstartdate\"], false);\n                  inputData[\"sampleprocessing\"][\"ntzprocessstartdate\"] = selectedRecord[\"ntzprocessstartdate\"] && selectedRecord[\"ntzprocessstartdate\"].value || transactionStatus.NA;\n                  inputData[\"sampleprocessing\"][\"noffsetdprocessstartdate\"] = selectedRecord[\"noffsetdprocessenddate\"] && selectedRecord[\"noffsetdprocessenddate\"].value || transactionStatus.NA;\n                  inputData[\"sampleprocessing\"][\"nsampleprocesstypecode\"] = selectedRecord[\"nsampleprocesstypecode\"] ? selectedRecord[\"nsampleprocesstypecode\"] : -1;\n                  inputData[\"sampleprocessing\"][\"noffsetdprocessenddate\"] = selectedRecord[\"noffsetdprocessenddate\"] && selectedRecord[\"noffsetdprocessenddate\"].value || transactionStatus.NA;\n                  inputData[\"sampleprocessing\"][\"ntzprocessenddate\"] = selectedRecord[\"ntzprocessenddate\"] && selectedRecord[\"ntzprocessenddate\"].value || transactionStatus.NA;\n\n                  if (selectedRecord[\"dprocessenddate\"] !== undefined && selectedRecord[\"dprocessenddate\"] !== \"\" && selectedRecord[\"dprocessenddate\"] !== null) {\n                    inputData[\"sampleprocessing\"][\"dprocessenddate\"] = formatInputDate(selectedRecord[\"dprocessenddate\"], false);\n                  }\n\n                  let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\n                  let fromDate = obj.fromDate;\n                  let toDate = obj.toDate;\n                  inputData[\"fromDate\"] = fromDate;\n                  inputData[\"toDate\"] = toDate;\n                  inputData[\"nprojecttypecode\"] = this.props.Login.masterData.selectedProjectType.value || transactionStatus.NA;\n                  inputData[\"userinfo\"] = { ...this.props.Login.userInfo,\n                    sformname: Lims_JSON_stringify(this.props.Login.userInfo.sformname),\n                    smodulename: Lims_JSON_stringify(this.props.Login.userInfo.smodulename)\n                  };\n                  const inputParam = {\n                    nformcode: this.props.Login.userInfo.nformcode,\n                    classUrl: \"storagesampleprocessing\",\n                    methodUrl: \"SampleProcessing\",\n                    inputData: inputData,\n                    operation: this.props.Login.operation,\n                    saveType,\n                    formRef,\n                    selectedRecord: this.state.selectedRecord || {}\n                  };\n                  const masterData = this.props.Login.masterData;\n\n                  if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolcode)) {\n                    const updateInfo = {\n                      typeName: DEFAULT_RETURN,\n                      data: {\n                        loadEsign: true,\n                        screenData: {\n                          inputParam,\n                          masterData\n                        },\n                        saveType\n                      }\n                    };\n                    this.props.updateStore(updateInfo);\n                  } else {\n                    this.props.saveSampleProcessing(inputParam, masterData);\n                  }\n                } else {\n                  toast.warn(this.props.intl.formatMessage({\n                    id: \"IDS_ENTER\"\n                  }) + \" \" + this.props.intl.formatMessage({\n                    id: alertMessage\n                  }));\n                }\n              } else {\n                toast.warn(this.props.intl.formatMessage({\n                  id: \"IDS_CLICKENTERTOJSONRECORD\"\n                }));\n              }\n            } else {\n              toast.warn(this.props.intl.formatMessage({\n                id: \"IDS_INVALIDBARCODEID\"\n              }));\n            }\n          } else {\n            toast.warn(this.props.intl.formatMessage({\n              id: \"IDS_INVALIDABARCODE\" //ALPD-4750 Changed IDS value to throw alert correctly by VISHAKH\n\n            }));\n          }\n        } else {\n          toast.warn(this.props.intl.formatMessage({\n            id: \"IDS_INVALIDCOLLECTIONTUBETYPE\"\n          }));\n        }\n      } else {\n        toast.warn(this.props.intl.formatMessage({\n          id: \"IDS_INVALIDSAMPLETYPE\"\n        }));\n      }\n    };\n\n    this.onComboChange = (comboData, fieldName) => {\n      let selectedRecord = this.state.selectedRecord || {};\n\n      if (fieldName === 'nprojecttypecode') {\n        let inputData = [];\n        let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\n        let fromDate = obj.fromDate;\n        let toDate = obj.toDate;\n        inputData[\"fromDate\"] = fromDate;\n        inputData[\"toDate\"] = toDate;\n        inputData = {\n          userinfo: this.props.Login.userInfo,\n          nprojecttypecode: parseInt(comboData.value),\n          selectedProjectType: comboData,\n          toDate: toDate,\n          fromDate: fromDate\n        };\n        delete selectedRecord[\"nproductcode\"];\n        delete selectedRecord[\"ncollectiontubetypecode\"];\n        delete selectedRecord[\"nprocesstypecode\"];\n        const masterData = { ...this.props.Login.masterData\n        };\n        const inputParam = {\n          masterData,\n          inputData\n        };\n        this.props.getSampleProcessing(inputParam);\n      }\n      /*  if (fieldName === \"nproductcode\") {\r\n            let inputData = [];\r\n            let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n            let fromDate = obj.fromDate;\r\n            let toDate = obj.toDate;\r\n            inputData[\"fromDate\"] = fromDate;\r\n            inputData[\"toDate\"] = toDate;\r\n            inputData = {\r\n                userinfo: this.props.Login.userInfo,\r\n                nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\r\n                toDate: toDate,\r\n                fromDate: fromDate\r\n            }\r\n            const masterData = { ...this.props.Login.masterData }\r\n            selectedRecord={...selectedRecord,\"nproductcode\":comboData}\r\n            const inputParam = { masterData, inputData,selectedRecord }\r\n            this.props.getCollectionTubeType(inputParam)\r\n        } else {*/\n\n\n      if (fieldName === \"ncollectiontubetypecode\" && selectedRecord['nproductcode'] !== undefined) {\n        let inputData = [];\n        let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\n        let fromDate = obj.fromDate;\n        let toDate = obj.toDate;\n        inputData[\"fromDate\"] = fromDate;\n        inputData[\"toDate\"] = toDate;\n        inputData = {\n          userinfo: this.props.Login.userInfo,\n          nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\n          nproductcode: selectedRecord['nproductcode'] && selectedRecord['nproductcode'].value || -1,\n          nsamplecollectiontypecode: selectedRecord['nsamplecollectiontypecode'] && selectedRecord['nsamplecollectiontypecode'] || -1,\n          ncollectiontubetypecode: parseInt(comboData.value),\n          toDate: toDate,\n          fromDate: fromDate\n        };\n        delete selectedRecord[\"ncollectiontubetypecode\"];\n        delete selectedRecord[\"nprocesstypecode\"];\n        const masterData = { ...this.props.Login.masterData\n        };\n        selectedRecord = { ...selectedRecord,\n          [fieldName]: comboData\n        };\n        const inputParam = {\n          masterData,\n          inputData,\n          selectedRecord\n        };\n        this.props.getSampleProcessType(inputParam);\n      } else if (fieldName === \"nproductcode\" && selectedRecord['ncollectiontubetypecode'] !== undefined) {\n        let inputData = [];\n        let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\n        let fromDate = obj.fromDate;\n        let toDate = obj.toDate;\n        inputData[\"fromDate\"] = fromDate;\n        inputData[\"toDate\"] = toDate;\n        inputData = {\n          userinfo: this.props.Login.userInfo,\n          nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\n          nproductcode: parseInt(comboData.value),\n          nsamplecollectiontypecode: parseInt(comboData.item.nsamplecollectiontypecode),\n          ncollectiontubetypecode: selectedRecord['ncollectiontubetypecode'] && selectedRecord['ncollectiontubetypecode'].value || -1,\n          toDate: toDate,\n          fromDate: fromDate\n        };\n        delete selectedRecord[\"ncollectiontubetypecode\"];\n        delete selectedRecord[\"nprocesstypecode\"];\n        const masterData = { ...this.props.Login.masterData\n        };\n        selectedRecord = { ...selectedRecord,\n          [fieldName]: comboData,\n          \"nsamplecollectiontypecode\": parseInt(comboData.item.nsamplecollectiontypecode)\n        };\n        const inputParam = {\n          masterData,\n          inputData,\n          selectedRecord\n        };\n        this.props.getSampleProcessType(inputParam);\n      } else if (fieldName === \"nprocesstypecode\") {\n        let inputData = [];\n        let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\n        let fromDate = obj.fromDate;\n        let toDate = obj.toDate;\n        inputData[\"fromDate\"] = fromDate;\n        inputData[\"toDate\"] = toDate;\n        inputData = {\n          userinfo: this.props.Login.userInfo,\n          nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\n          nproductcode: selectedRecord['nproductcode'] && selectedRecord['nproductcode'].value || -1,\n          ncollectiontubetypecode: selectedRecord['ncollectiontubetypecode'] && selectedRecord['ncollectiontubetypecode'].value,\n          nsamplecollectiontypecode: selectedRecord['nsamplecollectiontypecode'] && selectedRecord['nsamplecollectiontypecode'] || -1,\n          nprocesstypecode: parseInt(comboData.value),\n          toDate: toDate,\n          fromDate: fromDate\n        };\n        const masterData = { ...this.props.Login.masterData\n        };\n        selectedRecord = { ...selectedRecord,\n          \"nprocesstypecode\": comboData\n        };\n        const inputParam = {\n          masterData,\n          inputData,\n          selectedRecord\n        };\n        this.props.getProcessduration(inputParam);\n      } else {\n        selectedRecord[fieldName] = comboData;\n\n        if (fieldName === \"nproductcode\") {\n          selectedRecord = { ...selectedRecord,\n            \"nsamplecollectiontypecode\": comboData.item.nsamplecollectiontypecode\n          };\n        }\n\n        this.setState({\n          selectedRecord\n        });\n      } //  }\n\n    };\n\n    this.handleDateChangeSlidout = (dateName, dateValue) => {\n      let selectedRecord = this.state.selectedRecord || {};\n      selectedRecord[dateName] = dateValue;\n      this.setState({\n        selectedRecord\n      });\n      /* if (selectedRecord[\"sbarcodeid\"] !== undefined) {\r\n            let inputData = {};\r\n            inputData[\"sampleprocessing\"] = {};\r\n          if (dateName === \"dprocessenddate\") {\r\n                inputData[\"sampleprocessing\"][\"dprocessenddate\"] = formatInputDate(dateValue, false);\r\n                inputData[\"sampleprocessing\"][\"nsampleprocesstypecode\"] = selectedRecord[\"nsampleprocesstypecode\"] ? selectedRecord[\"nsampleprocesstypecode\"] : -1;\r\n                inputData[\"sampleprocessing\"][\"sbarcodeid\"] = selectedRecord[\"sbarcodeid\"] ? selectedRecord[\"sbarcodeid\"] : -1;\r\n                inputData[\"userinfo\"] = {\r\n                    ...this.props.Login.userInfo,\r\n                    sformname: Lims_JSON_stringify(this.props.Login.userInfo.sformname),\r\n                    smodulename: Lims_JSON_stringify(this.props.Login.userInfo.smodulename)\r\n                }\r\n                selectedRecord = { ...selectedRecord, [dateName]: dateValue }\r\n                    const inputParam = {\r\n                    nformcode: this.props.Login.userInfo.nformcode,\r\n                    inputData: inputData,\r\n                    operation: this.props.Login.operation,\r\n                    selectedRecord: selectedRecord,\r\n                    masterData: this.props.Login.masterData\r\n                    }\r\n                this.props.getCommentsDeviation(inputParam)\r\n            }\r\n            else {\r\n                  \r\n            }\r\n        } else {\r\n                toast.warn(this.props.intl.formatMessage({\r\n                id: \"IDS_ENTER\",\r\n            }) +\r\n                this.props.intl.formatMessage({\r\n                    id: \"IDS_BARCODEID\",\r\n                })\r\n            );\r\n            }\r\n      */\n    };\n\n    this.autoSaveGetDataProcessing = event => {\n      let selectedRecord = this.state.selectedRecord || {};\n      event.stopPropagation(); //ALPD-4701--Vignesh R(21-08-2024)\n\n      if (event.keyCode === 13) {\n        if (selectedRecord['ncollectiontubetypecode'] && selectedRecord['nproductcode'] && selectedRecord['nprocesstypecode']) {\n          if (parseInt(selectedRecord[\"sbarcodeid\"] && selectedRecord[\"sbarcodeid\"].length) === parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength) && event.keyCode === 13) {\n            let invalidbarcode = event.target.value.substring(1, 2);\n\n            if (parseInt(invalidbarcode) === SampleCycle.PROCESSING) {\n              let checkCollectionTubeType = false;\n              let checkSampleType = false; //if(checkCollectionTubeType){\n\n              let inputParam = {\n                nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\n                spositionvalue: event.target.value,\n                userinfo: this.props.Login.userInfo,\n                nbarcodeLength: parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength),\n                jsondata: {},\n                masterData: this.props.Login.masterData,\n                selectedRecord: selectedRecord || {}\n              };\n              this.props.getBarcodeDataDetails(inputParam); //}\n              // else {\n              //     toast.warn(\n              //         this.props.intl.formatMessage({\n              //             id: \"IDS_INVALIDCOLLECTIONTUBETYPE\",\n              //         })\n              //     );\n              // }\n            } else {\n              toast.warn(this.props.intl.formatMessage({\n                id: \"IDS_INVALIDBARCODEID\"\n              }));\n            }\n          }\n        } else {\n          event.stopPropagation();\n\n          if (selectedRecord['nproductcode'] === undefined) {\n            toast.warn(this.props.intl.formatMessage({\n              id: \"IDS_SELECT\"\n            }) + this.props.intl.formatMessage({\n              id: \"IDS_SAMPLETYPE\"\n            }));\n          } else if (selectedRecord['ncollectiontubetypecode'] === undefined) {\n            toast.warn(this.props.intl.formatMessage({\n              id: \"IDS_SELECT\"\n            }) + this.props.intl.formatMessage({\n              id: \"IDS_COLLECTIONTUBETYPENAME\"\n            }));\n          } else {\n            toast.warn(this.props.intl.formatMessage({\n              id: \"IDS_SELECT\"\n            }) + this.props.intl.formatMessage({\n              id: \"IDS_PROCESSTYPENAME\"\n            }));\n          }\n        }\n      }\n    };\n\n    this.onInputOnChange = (event, fieldname) => {\n      const selectedRecord = this.state.selectedRecord || {};\n\n      if (event.target.type === 'checkbox') {\n        selectedRecord[event.target.name] = event.target.checked === true ? transactionStatus.YES : transactionStatus.NO;\n      } else {\n        selectedRecord[event.target.name] = event.target.value;\n      }\n\n      this.setState({\n        selectedRecord\n      });\n    };\n\n    this.handleDateChange = (dateName, dateValue) => {\n      const {\n        selectedRecord\n      } = this.state;\n\n      if (dateValue === null) {\n        dateValue = new Date();\n      }\n\n      if (dateName === 'todate') {\n        selectedRecord[dateName] = dateValue;\n      } else {\n        selectedRecord[dateName] = dateValue;\n      }\n\n      selectedRecord[dateName] = dateValue; // this.setState({ selectedRecord });\n      // this.reloadData(selectedRecord, true);\n\n      let dateObj = {};\n      let obj = convertDateValuetoString(selectedRecord['fromdate'] && selectedRecord['fromdate'] || this.props.Login.masterData.FromDate, selectedRecord['todate'] && selectedRecord['todate'] || this.props.Login.masterData.ToDate, this.props.Login.userInfo);\n      let fromDate = obj.fromDate;\n      let toDate = obj.toDate;\n      const inputParam = {\n        inputData: {\n          \"userinfo\": this.props.Login.userInfo,\n          fromDate: fromDate,\n          toDate: toDate,\n          nprojecttypecode: this.props.Login.masterData.selectedProjectType && this.props.Login.masterData.selectedProjectType.value || -1\n        }\n      };\n      this.props.getSampleProcessing(inputParam);\n    };\n\n    this.reloadData = () => {\n      //this.searchRef.current.value = \"\";\n      let fromDate = this.props.Login.masterData.FromDate;\n      let toDate = this.props.Login.masterData.ToDate;\n      let obj = convertDateValuetoString(fromDate, toDate, this.props.Login.userInfo, true);\n      const inputParam = {\n        inputData: {\n          \"userinfo\": this.props.Login.userInfo,\n          fromDate: obj.fromDate,\n          toDate: obj.toDate,\n          \"nprojecttypecode\": this.props.Login.masterData.selectedProjectType.value || -1 // currentdate: isDateChange === true ? null : formatInputDate(new Date(), true)\n\n        },\n        classUrl: 'storagesampleprocessing',\n        methodUrl: \"SampleProcessing\",\n        displayName: this.props.Login.inputParam.displayName,\n        userInfo: this.props.Login.userInfo,\n        selectedRecord: this.state.selectedRecord || {}\n      };\n      this.props.getSampleProcessing(inputParam);\n    };\n\n    this.searchRef = React.createRef();\n    const dataState = {\n      skip: 0,\n      take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5\n    };\n    this.state = {\n      data: [],\n      masterStatus: \"\",\n      error: \"\",\n      selectedRecord: {},\n      dataResult: [],\n      dataState: dataState,\n      userRoleControlRights: [],\n      controlMap: new Map(),\n      showSaveContinue: true\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    if (props.Login.masterStatus !== \"\" && props.Login.masterStatus !== state.masterStatus) {\n      toast.warn(props.Login.masterStatus);\n      props.Login.masterStatus = \"\";\n    }\n\n    if (props.Login.error !== state.error) {\n      toast.error(props.Login.error);\n      props.Login.error = \"\";\n    }\n\n    return null;\n  }\n\n  gridfillingColumn(data, barcodeFields) {\n    //  const tempArray = [];\n    const temparray1 = [{\n      idsName: 'IDS_BARCODEID',\n      dataField: 'sbarcodeid',\n      width: '250px',\n      controlType: 'textinput'\n    }, {\n      idsName: 'IDS_SAMPLETYPE',\n      dataField: 'sproductname',\n      width: '250px',\n      controlType: 'selectbox'\n    }, {\n      idsName: 'IDS_COLLECTIONTUBETYPENAME',\n      dataField: 'stubename',\n      width: '250px',\n      controlType: 'selectbox'\n    }, {\n      idsName: 'IDS_PROCESSTYPENAME',\n      dataField: 'sprocesstypename',\n      width: '250px',\n      controlType: 'selectbox'\n    }, {\n      idsName: 'IDS_PROCESSDURATION',\n      dataField: 'sprocessduration',\n      width: '250px',\n      controlType: 'selectbox'\n    }, {\n      idsName: 'IDS_GRACEDURATION',\n      dataField: 'sgraceduration',\n      width: '250px',\n      controlType: 'selectbox'\n    }, {\n      idsName: 'IDS_STARTDATEANDTIME',\n      dataField: 'sprocessstartdate',\n      width: '250px'\n    }, {\n      idsName: 'IDS_ENDDATEANDTIME',\n      dataField: 'sprocessenddate',\n      width: '250px'\n    }];\n    this.mandatoryColumns = [{\n      \"mandatory\": true,\n      \"idsName\": 'IDS_SAMPLETYPE',\n      dataField: 'nproductcode',\n      width: '250px',\n      mandatoryLabel: 'IDS_SELECT',\n      controlType: 'selectbox'\n    }, {\n      \"mandatory\": true,\n      \"idsName\": 'IDS_COLLECTIONTUBETYPENAME',\n      dataField: 'ncollectiontubetypecode',\n      width: '250px',\n      mandatoryLabel: 'IDS_SELECT',\n      controlType: 'selectbox'\n    }, {\n      \"mandatory\": true,\n      \"idsName\": 'IDS_PROCESSTYPENAME',\n      dataField: 'nprocesstypecode',\n      width: '250px',\n      mandatoryLabel: 'IDS_SELECT',\n      controlType: 'selectbox'\n    }, {\n      \"mandatory\": true,\n      \"idsName\": \"IDS_BARCODEID\",\n      \"dataField\": \"sbarcodeid\",\n      \"width\": \"250px\",\n      \"mandatoryLabel\": \"IDS_ENTER\",\n      \"controlType\": \"textinput\"\n    }];\n    this.mandatoryColumns.push(!(this.props.Login.masterData.sprocessstartdatesecondtime && this.props.Login.masterData.sprocessstartdatesecondtime) ? {\n      \"mandatory\": true,\n      \"idsName\": \"IDS_STARTDATEANDTIME\",\n      \"dataField\": \"dprocessstartdate\",\n      \"width\": \"250px\",\n      \"mandatoryLabel\": \"IDS_SELECT\",\n      \"controlType\": \"selectbox\"\n    } : {\n      \"mandatory\": true,\n      \"idsName\": \"IDS_ENDDATEANDTIME\",\n      \"dataField\": \"dprocessenddate\",\n      \"width\": \"250px\",\n      \"mandatoryLabel\": \"IDS_SELECT\",\n      \"controlType\": \"selectbox\"\n    });\n    let temparray2 = []; //ALPD-5139--Vignesh R(24-12-2024)---added the collection tube type in datagrid\n\n    let scollectiontubetype = this.props.Login.masterData.sfieldnameCollection && this.props.Login.masterData.sfieldnameCollection;\n    let sfieldnameSampleType = this.props.Login.masterData.sfieldnameSampleType && this.props.Login.masterData.sfieldnameSampleType;\n    barcodeFields && barcodeFields.forEach(barcodeItem => {\n      data && data.forEach(dataItem => {\n        const entries = Object.entries(dataItem.jsondata);\n\n        if (entries.length > 0) {\n          entries.forEach(([key]) => {\n            const keyExists = temparray2.some(column => column.idsName === key);\n\n            if (!keyExists) {\n              //    if ('Visit Number' === key || 'Participant ID' === key) {\n              //ALPD-5139--Vignesh R(24-12-2024)---added the collection tube type in datagrid\n              if (barcodeItem.sfieldname === key && barcodeItem.sfieldname !== scollectiontubetype && barcodeItem.sfieldname !== sfieldnameSampleType) {\n                temparray2.push({\n                  idsName: key,\n                  dataField: key,\n                  width: '250px'\n                });\n              }\n            }\n          });\n        }\n      });\n    });\n    const newArray = [...temparray1, ...temparray2];\n    newArray.push({\n      idsName: 'IDS_COMMENTS',\n      dataField: 'scomments',\n      width: '250px'\n    }, {\n      idsName: 'IDS_DEVIATIONCOMMENTS',\n      dataField: 'sdeviationcomments',\n      width: '250px'\n    });\n    return newArray;\n  }\n\n  render() {\n    /* console.log(\"SampleProcessing\", this.props.Login.masterData.SampleProcessing);\r\n     console.log(\"extractedColumnList\", this.extractedColumnList);\r\n     console.log(\"SampleProcessing-Data\", this.state.data);*/\n    let fromDate = \"\";\n    let toDate = \"\";\n    const extractedColumnList = this.gridfillingColumn(this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing || [], this.props.Login.masterData.jsondataBarcodeFields && this.props.Login.masterData.jsondataBarcodeFields);\n    this.extractedColumnList = extractedColumnList;\n    const addId = this.state.controlMap.has(\"AddSampleProcessing\") && this.state.controlMap.get(\"AddSampleProcessing\").ncontrolcode;\n    const editId = this.state.controlMap.has(\"EditSampleProcessing\") && this.state.controlMap.get(\"EditSampleProcessing\").ncontrolcode;\n    const deleteId = this.state.controlMap.has(\"DeleteSampleProcessing\") && this.state.controlMap.get(\"DeleteSampleProcessing\").ncontrolcode;\n    const editParam = {\n      screenName: this.props.Login.displayName,\n      operation: \"update\",\n      userInfo: this.props.Login.userInfo,\n      ncontrolcode: editId,\n      masterData: this.props.Login.masterData,\n      inputParam: this.props.Login.inputParam,\n      primaryKeyField: \"nsampleprocessingcode\",\n      selectedRecord: this.state.selectedRecord || {},\n      dataState: this.state.dataState\n    };\n    const addParam = {\n      screenName: this.props.Login.displayName,\n      primaryKeyField: \"nsampleprocessingcode\",\n      primaryKeyValue: undefined,\n      operation: \"create\",\n      inputParam: this.props.Login.inputParam,\n      userInfo: this.props.Login.userInfo,\n      ncontrolcode: addId,\n      selectedRecord: this.state.selectedRecord,\n      masterData: this.props.Login.masterData\n    }; //\t\t//ALPD-4618--Vignesh R(01-08-2024)\n\n    const deleteParam = {\n      operation: \"delete\",\n      ncontrolcode: deleteId,\n      selectedRecord: this.state.selectedRecord\n    };\n\n    if (this.props.Login.masterData && this.props.Login.masterData.FromDate) {\n      fromDate = this.state.selectedRecord[\"fromdate\"] && getStartOfDay(this.state.selectedRecord[\"fromdate\"]) || rearrangeDateFormat(this.props.Login.userInfo, this.props.Login.masterData.FromDate);\n      toDate = this.state.selectedRecord[\"todate\"] && getEndOfDay(this.state.selectedRecord[\"todate\"]) || rearrangeDateFormat(this.props.Login.userInfo, this.props.Login.masterData.ToDate);\n    }\n\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(ListWrapper, {\n      className: \"client-list-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(DateTimePicker, {\n      name: \"fromdate\",\n      label: this.props.intl.formatMessage({\n        id: \"IDS_FROM\"\n      }),\n      className: \"form-control\",\n      placeholderText: \"Select date..\",\n      selected: this.state.selectedRecord[\"fromdate\"] || fromDate,\n      dateFormat: this.props.Login.userInfo.ssitedate,\n      isClearable: false,\n      onChange: date => this.handleDateChange(\"fromdate\", date),\n      value: this.state.selectedRecord[\"fromdate\"] || fromDate,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 37\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      md: 2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(DateTimePicker, {\n      name: \"todate\",\n      label: this.props.intl.formatMessage({\n        id: \"IDS_TO\"\n      }),\n      className: \"form-control\",\n      placeholderText: \"Select date..\",\n      selected: this.state.selectedRecord[\"todate\"] || toDate,\n      dateFormat: this.props.Login.userInfo.ssitedate,\n      isClearable: false,\n      onChange: date => this.handleDateChange(\"todate\", date),\n      value: this.state.selectedRecord[\"todate\"] || toDate,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 37\n      }\n    })), /*#__PURE__*/React.createElement(Col, {\n      md: 2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(FormSelectSearch, {\n      formLabel: this.props.intl.formatMessage({\n        id: \"IDS_PROJECTTYPE\"\n      }),\n      isSearchable: true,\n      name: \"nprojecttypecode\",\n      isDisabled: false,\n      placeholder: this.props.intl.formatMessage({\n        id: \"IDS_SELECTRECORD\"\n      }),\n      isMandatory: true,\n      isClearable: false,\n      options: this.state.projectType,\n      value: this.state.selectedRecord[\"nprojecttypecode\"] && this.state.selectedRecord[\"nprojecttypecode\"] || this.props.Login.masterData.selectedProjectType,\n      defaultValue: this.state.selectedRecord[\"nprojecttypecode\"],\n      onChange: event => this.onComboChange(event, \"nprojecttypecode\"),\n      closeMenuOnSelect: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 37\n      }\n    })), \"    \"), this.state.data ? /*#__PURE__*/React.createElement(DataGrid, {\n      primaryKeyField: \"nsampleprocessingcode\",\n      data: this.state.data,\n      dataResult: this.state.dataResult,\n      dataState: this.state.dataState,\n      dataStateChange: this.dataStateChange,\n      extractedColumnList: this.extractedColumnList,\n      reloadData: this.reloadData,\n      controlMap: this.state.controlMap,\n      userRoleControlRights: this.state.userRoleControlRights,\n      inputParam: this.props.Login.inputParam,\n      userInfo: this.props.Login.userInfo,\n      scrollable: \"scrollable\",\n      pageable: true,\n      isComponent: true,\n      gridHeight: '600px',\n      isToolBarRequired: true,\n      isActionRequired: true,\n      expandField: \"expanded\",\n      selectedId: this.props.Login.selectedId,\n      addRecord: () => this.props.getComboSampleProcessing(addParam),\n      deleteParam: deleteParam,\n      deleteRecord: this.deleteRecord,\n      fetchRecord: this.props.getActiveSampleProcessingById,\n      editParam: editParam //ATE234 Janakumar ALPD-5577 Sample Storage-->while download the pdf, screen getting freezed\n      ,\n      isDownloadPDFRequired: false,\n      isDownloadExcelRequired: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 33\n      }\n    }) : \"\"))), this.props.Login.openModal && /*#__PURE__*/React.createElement(SlideOutModal, {\n      show: this.props.Login.openModal,\n      closeModal: this.closeModal,\n      operation: this.props.Login.operation,\n      inputParam: this.props.Login.inputParam,\n      screenName: this.props.Login.screenName,\n      onSaveClick: this.onSaveClick,\n      size: 'lg',\n      esign: this.props.Login.loadEsign,\n      validateEsign: this.validateEsign,\n      masterStatus: this.props.Login.masterStatus,\n      updateStore: this.props.updateStore,\n      selectedRecord: this.state.selectedRecord || {},\n      mandatoryFields: this.mandatoryColumns,\n      showSaveContinue: true,\n      addComponent: this.props.Login.loadEsign ? /*#__PURE__*/React.createElement(Esign, {\n        operation: this.props.Login.operation,\n        formatMessage: this.props.intl.formatMessage,\n        onInputOnChange: this.onInputOnChange,\n        inputParam: this.props.Login.inputParam,\n        selectedRecord: this.state.selectedRecord || {},\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 29\n        }\n      }) : /*#__PURE__*/React.createElement(AddSampleProcessing, {\n        autoSaveGetDataProcessing: this.autoSaveGetDataProcessing,\n        selectedRecord: this.state.selectedRecord || {},\n        onInputOnChange: this.onInputOnChange,\n        onComboChange: this.onComboChange,\n        formatMessage: this.props.intl.formatMessage,\n        operation: this.props.Login.operation,\n        sampletype: this.props.Login.sampletype,\n        collectiontubetype: this.props.Login.collectiontubetype,\n        userInfo: this.props.Login.userInfo,\n        handleDateChangeSlidout: this.handleDateChangeSlidout,\n        projectType: this.state.projectType,\n        masterData: this.props.Login.masterData,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 31\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 21\n      }\n    }));\n  }\n\n  componentDidUpdate(previousProps) {\n    let {\n      projectType\n    } = this.state;\n    let bool = false;\n\n    if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\n      this.setState({\n        selectedRecord: this.props.Login.selectedRecord\n      });\n    }\n\n    if (this.props.Login.masterData.projectType !== previousProps.Login.masterData.projectType) {\n      const projectTypeMap = constructOptionList(this.props.Login.masterData.projectType || [], \"nprojecttypecode\", \"sprojecttypename\", undefined, undefined, undefined);\n      projectType = projectTypeMap.get(\"OptionList\");\n      bool = true;\n    }\n\n    if (this.props.Login.masterData.selectedProjectType !== previousProps.Login.masterData.selectedProjectType) {\n      const projectTypeMap = constructOptionList(this.props.Login.masterData.projectType || [], \"nprojecttypecode\", \"sprojecttypename\", undefined, undefined, undefined);\n      projectType = projectTypeMap.get(\"OptionList\");\n      bool = true;\n    } // if (this.props.Login.masterData.SampleProcessing !== previousProps.Login.masterData.SampleProcessing) {\n    //     let samplecollect = [];\n    //     samplecollect = this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing.map(sampleItem => {\n    //         const entries = Object.entries(sampleItem.jsondata);\n    //         if (entries.length > 0) {\n    //             const newItem = { ...sampleItem };\n    //             entries.forEach(([key, value]) => {\n    //                 newItem[key] = value;\n    //             });\n    //             return newItem;\n    //         }\n    //         return sampleItem;\n    //     });\n    //     let { dataState } = this.state;\n    //     if (dataState === undefined) {\n    //         dataState = { skip: 0, take: this.state.dataState.take }\n    //     }\n    //     if (this.state.dataResult.data) {\n    //         if (this.state.dataResult.data.length === 1) {\n    //             let skipcount = this.state.dataState.skip > 0 ? (this.state.dataState.skip - this.state.dataState.take) :\n    //                 this.state.dataState.skip\n    //             dataState = { skip: skipcount, take: this.state.dataState.take }\n    //         }\n    //     }\n    //     this.setState({\n    //         data: samplecollect,\n    //         dataState,\n    //         dataResult: process(samplecollect || [], dataState),\n    //     });\n    // }\n\n\n    if (this.props.Login.masterData !== previousProps.Login.masterData) {\n      if (this.props.Login.userInfo.nformcode !== previousProps.Login.userInfo.nformcode) {\n        const userRoleControlRights = [];\n\n        if (this.props.Login.userRoleControlRights) {\n          this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode] && Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(item => userRoleControlRights.push(item.ncontrolcode));\n        }\n\n        const controlMap = getControlMap(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode);\n        let sampleProcessing = [];\n        sampleProcessing = this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing.map(sampleItem => {\n          const entries = Object.entries(sampleItem.jsondata);\n\n          if (entries.length > 0) {\n            const newItem = { ...sampleItem\n            };\n            entries.forEach(([key, value]) => {\n              newItem[key] = value;\n            });\n            return newItem;\n          }\n\n          return sampleItem;\n        });\n        let {\n          dataState\n        } = this.state;\n\n        if (dataState === undefined) {\n          dataState = {\n            skip: 0,\n            take: this.state.dataState.take\n          };\n        }\n\n        if (this.state.dataResult.data) {\n          if (this.state.dataResult.data.length === 1) {\n            let skipcount = this.state.dataState.skip > 0 ? this.state.dataState.skip - this.state.dataState.take : this.state.dataState.skip;\n            dataState = {\n              skip: skipcount,\n              take: this.state.dataState.take\n            };\n          }\n        }\n\n        this.setState({\n          userRoleControlRights,\n          controlMap,\n          data: sampleProcessing,\n          dataState,\n          dataResult: process(sampleProcessing || [], dataState)\n        });\n      } else {\n        //jana ALPD-4694 Temporary Storage-->While Try to Delete the Records the Fields are Align Wrongly\n        let {\n          dataState\n        } = this.state;\n        let sampleProcessingdata = [];\n        sampleProcessingdata = this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing.map(sampleItem => {\n          const entries = Object.entries(sampleItem.jsondata);\n\n          if (entries.length > 0) {\n            const newItem = { ...sampleItem\n            };\n            entries.forEach(([key, value]) => {\n              newItem[key] = value;\n            });\n            return newItem;\n          }\n\n          return sampleItem;\n        });\n\n        if (this.props.Login.dataState === undefined || this.props.Login.masterData.selectedProjectType !== previousProps.Login.masterData.selectedProjectType) {\n          dataState = {\n            skip: 0,\n            take: this.state.dataState.take\n          };\n        }\n\n        if (this.state.dataResult.data) {\n          if (this.state.dataResult.data.length === 1) {\n            let skipcount = this.state.dataState.skip > 0 ? this.state.dataState.skip - this.state.dataState.take : this.state.dataState.skip;\n            dataState = {\n              skip: skipcount,\n              take: this.state.dataState.take\n            };\n          }\n        }\n\n        this.setState({\n          data: sampleProcessingdata,\n          selectedRecord: this.props.Login.selectedRecord,\n          dataResult: process(sampleProcessingdata || [], dataState),\n          dataState\n        });\n      }\n\n      if (this.props.Login.masterData.jsondataBarcodeFields !== previousProps.Login.masterData.jsondataBarcodeFields) {\n        const retrievedData = sortData(this.props.Login.masterData.jsondataBarcodeFields, \"ascending\", \"nsorter\");\n        this.setState({\n          jsondataBarcodeFields: retrievedData\n        });\n      }\n      /* else {\r\n           if (this.props.Login.masterData.SampleProcessing) {\r\n               let {dataState}=this.state;\r\n               if(dataState===undefined){\r\n                   dataState={skip:0,take:this.state.dataState.take}\r\n               }\r\n                if(this.state.dataResult.data){\r\n                    if(this.state.dataResult.data.length ===1){\r\n                       let skipcount=this.state.dataState.skip>0?(this.state.dataState.skip-this.state.dataState.take):\r\n                       this.state.dataState.skip\r\n                        dataState={skip:skipcount,take:this.state.dataState.take}\r\n                    }\r\n                } \r\n               \r\n               let samplecollect = [];\r\n               samplecollect = this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing.map(sampleItem => {\r\n                   const entries = Object.entries(sampleItem.jsondata);\r\n                   if (entries.length > 0) {\r\n                       const newItem = { ...sampleItem };\r\n                       entries.forEach(([key, value]) => {\r\n                              newItem[key] = value;\r\n                          });\r\n                       return newItem;\r\n                   }\r\n                   return sampleItem;\r\n               });\r\n                  this.setState({\r\n                   data: samplecollect,\r\n                   dataState,\r\n                   dataResult: process(samplecollect || [], dataState),\r\n               });\r\n           }\r\n       }*/\n\n    } else if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\n      this.setState({\n        selectedRecord: this.props.Login.selectedRecord\n      });\n    }\n\n    if (bool) {\n      this.setState({\n        projectType\n      });\n    }\n  }\n\n}\n\nexport default connect(mapStateToProps, {\n  callService,\n  crudMaster,\n  updateStore,\n  validateEsignCredential,\n  getComboSampleProcessing,\n  getBarcodeDataDetails,\n  getSampleProcessType,\n  getProcessduration,\n  saveSampleProcessing,\n  getActiveSampleProcessingById,\n  getSampleProcessing,\n  validateEsignCredentialSampleProcessing\n})(injectIntl(SampleProcessing));","map":{"version":3,"sources":["E:/WorkingFolder/React_Postgres/ALPD/branches/SOURCE-513-PROD/SOURCE-513-ALPD-5500/QuaLISWeb/src/pages/storagemanagement/SampleProcessing.jsx"],"names":["React","connect","injectIntl","Row","Col","toast","process","DataGrid","DateTimePicker","ListWrapper","AddSampleProcessing","SlideOutModal","Esign","SampleCycle","transactionStatus","DEFAULT_RETURN","FormSelectSearch","callService","crudMaster","updateStore","validateEsignCredential","getComboSampleProcessing","getBarcodeDataDetails","getSampleProcessType","getProcessduration","saveSampleProcessing","getActiveSampleProcessingById","getSampleProcessing","validateEsignCredentialSampleProcessing","sortData","getControlMap","getStartOfDay","getEndOfDay","convertDateValuetoString","rearrangeDateFormat","constructOptionList","Lims_JSON_stringify","formatInputDate","showEsign","mapStateToProps","state","Login","SampleProcessing","Component","constructor","props","closeModal","loadEsign","openModal","selectedRecord","operation","updateInfo","typeName","data","dataStateChange","event","setState","dataResult","dataState","validateEsign","inputParam","inputData","userInfo","sreason","nreasoncode","value","spredefinedreason","label","password","screenData","deleteRecord","deleteParam","obj","masterData","FromDate","ToDate","fromDate","toDate","classUrl","methodUrl","displayName","toLowerCase","selectedProjectType","userRoleControlRights","nformcode","ncontrolCode","screenName","intl","formatMessage","id","onSaveClick","saveType","formRef","alertMessage","sbarcodeid","barcodedata","checkCollectionTubeType","checkSampleType","jsonPrimaryKeyValue","nsamplecollectiontypecode","item","ncollectiontubetypecode","length","parseInt","nbarcodelength","invalidbarcode","substring","PROCESSING","undefined","date1","date2","diffenecemill","differenceInMinutes","flag","Date","nngracetimetime","nprocesstime","JSON","stringify","listProcessType","removeIndex","findIndex","splice","map","nsampleprocesstypecode","join","NA","selectedId","sformname","smodulename","ncontrolcode","warn","onComboChange","comboData","fieldName","userinfo","nprojecttypecode","nproductcode","nprocesstypecode","handleDateChangeSlidout","dateName","dateValue","autoSaveGetDataProcessing","stopPropagation","keyCode","target","spositionvalue","nbarcodeLength","jsondata","onInputOnChange","fieldname","type","name","checked","YES","NO","handleDateChange","dateObj","reloadData","searchRef","createRef","skip","take","settings","masterStatus","error","controlMap","Map","showSaveContinue","getDerivedStateFromProps","gridfillingColumn","barcodeFields","temparray1","idsName","dataField","width","controlType","mandatoryColumns","mandatoryLabel","push","sprocessstartdatesecondtime","temparray2","scollectiontubetype","sfieldnameCollection","sfieldnameSampleType","forEach","barcodeItem","dataItem","entries","Object","key","keyExists","some","column","sfieldname","newArray","render","extractedColumnList","jsondataBarcodeFields","addId","has","get","editId","deleteId","editParam","primaryKeyField","addParam","primaryKeyValue","ssitedate","date","projectType","sampletype","collectiontubetype","componentDidUpdate","previousProps","bool","projectTypeMap","values","sampleProcessing","sampleItem","newItem","skipcount","sampleProcessingdata","retrievedData"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { injectIntl } from 'react-intl';\r\nimport { Row, Col } from 'react-bootstrap';\r\nimport { toast } from 'react-toastify';\r\nimport { process } from '@progress/kendo-data-query';\r\nimport DataGrid from '../../components/data-grid/data-grid.component';\r\nimport DateTimePicker from '../../components/date-time-picker/date-time-picker.component';\r\nimport { ListWrapper } from '../../components/client-group.styles';\r\nimport AddSampleProcessing from '../storagemanagement//AddSampleProcessing';\r\nimport SlideOutModal from '../../components/slide-out-modal/SlideOutModal';\r\nimport Esign from '../audittrail/Esign';\r\nimport { SampleCycle, transactionStatus } from '../../components/Enumeration';\r\nimport { DEFAULT_RETURN } from '../../actions/LoginTypes';\r\nimport FormSelectSearch from '../../components/form-select-search/form-select-search.component';\r\n\r\nimport {\r\n    callService, crudMaster,\r\n    updateStore, validateEsignCredential, getComboSampleProcessing, getBarcodeDataDetails,\r\n    getSampleProcessType, getProcessduration, saveSampleProcessing, getActiveSampleProcessingById, getSampleProcessing, validateEsignCredentialSampleProcessing\r\n} from '../../actions';\r\nimport {sortData, getControlMap, getStartOfDay, getEndOfDay, convertDateValuetoString, rearrangeDateFormat, constructOptionList, Lims_JSON_stringify, formatInputDate, showEsign } from '../../components/CommonScript'\r\n\r\n\r\nconst mapStateToProps = state => {\r\n    return ({ Login: state.Login })\r\n}\r\n\r\nclass SampleProcessing extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.searchRef = React.createRef();\r\n\r\n        const dataState = {\r\n            skip: 0,\r\n            take: this.props.Login.settings ? parseInt(this.props.Login.settings[14]) : 5,\r\n        };\r\n        this.state = {\r\n            data: [], masterStatus: \"\", error: \"\", selectedRecord: {},\r\n            dataResult: [],\r\n            dataState: dataState,\r\n            userRoleControlRights: [],\r\n            controlMap: new Map(),\r\n            showSaveContinue: true\r\n        };\r\n\r\n\r\n\r\n    }\r\n    closeModal = () => {\r\n        let loadEsign = this.props.Login.loadEsign;\r\n        let openModal = this.props.Login.openModal;\r\n        let selectedRecord = this.props.Login.selectedRecord;\r\n        if (this.props.Login.loadEsign) {\r\n            if (this.props.Login.operation === \"delete\") {\r\n                loadEsign = false;\r\n                openModal = false;\r\n                selectedRecord = {};\r\n            }\r\n            else {\r\n                loadEsign = false;\r\n                selectedRecord['esignpassword'] = \"\"\r\n                selectedRecord['esignreason'] = \"\"\r\n                selectedRecord['esigncomments'] = \"\"\r\n            }\r\n        }\r\n        else {\r\n            openModal = false;\r\n            selectedRecord = {};\r\n        }\r\n\r\n        const updateInfo = {\r\n            typeName: DEFAULT_RETURN,\r\n            data: { openModal, loadEsign, selectedRecord }\r\n        }\r\n\r\n        this.props.updateStore(updateInfo);\r\n    }\r\n    dataStateChange = (event) => {\r\n        this.setState({\r\n            dataResult: process(this.state.data, event.dataState),\r\n            dataState: event.dataState\r\n        });\r\n    }\r\n\r\n    static getDerivedStateFromProps(props, state) {\r\n\r\n        if (props.Login.masterStatus !== \"\" && props.Login.masterStatus !== state.masterStatus) {\r\n            toast.warn(props.Login.masterStatus);\r\n            props.Login.masterStatus = \"\";\r\n        }\r\n\r\n        if (props.Login.error !== state.error) {\r\n            toast.error(props.Login.error)\r\n            props.Login.error = \"\";\r\n        }\r\n        return null;\r\n    }\r\n\r\n    gridfillingColumn(data, barcodeFields) {\r\n        //  const tempArray = [];\r\n        const temparray1 = [\r\n            { idsName: 'IDS_BARCODEID', dataField: 'sbarcodeid', width: '250px', controlType: 'textinput' },\r\n            { idsName: 'IDS_SAMPLETYPE', dataField: 'sproductname', width: '250px', controlType: 'selectbox' },\r\n            { idsName: 'IDS_COLLECTIONTUBETYPENAME', dataField: 'stubename', width: '250px', controlType: 'selectbox' },\r\n            { idsName: 'IDS_PROCESSTYPENAME', dataField: 'sprocesstypename', width: '250px', controlType: 'selectbox' },\r\n            { idsName: 'IDS_PROCESSDURATION', dataField: 'sprocessduration', width: '250px', controlType: 'selectbox' },\r\n            { idsName: 'IDS_GRACEDURATION', dataField: 'sgraceduration', width: '250px', controlType: 'selectbox' },\r\n            { idsName: 'IDS_STARTDATEANDTIME', dataField: 'sprocessstartdate', width: '250px' },\r\n            { idsName: 'IDS_ENDDATEANDTIME', dataField: 'sprocessenddate', width: '250px' },\r\n        ];\r\n        \r\n        this.mandatoryColumns = [\r\n            { \"mandatory\": true, \"idsName\": 'IDS_SAMPLETYPE', dataField: 'nproductcode', width: '250px', mandatoryLabel: 'IDS_SELECT', controlType: 'selectbox' },\r\n            { \"mandatory\": true, \"idsName\": 'IDS_COLLECTIONTUBETYPENAME', dataField: 'ncollectiontubetypecode', width: '250px', mandatoryLabel: 'IDS_SELECT', controlType: 'selectbox' },\r\n            { \"mandatory\": true, \"idsName\": 'IDS_PROCESSTYPENAME', dataField: 'nprocesstypecode', width: '250px', mandatoryLabel: 'IDS_SELECT', controlType: 'selectbox' },\r\n            { \"mandatory\": true, \"idsName\": \"IDS_BARCODEID\", \"dataField\": \"sbarcodeid\", \"width\": \"250px\", \"mandatoryLabel\": \"IDS_ENTER\", \"controlType\": \"textinput\" }\r\n\r\n        ]\r\n        this.mandatoryColumns.push(\r\n            !(this.props.Login.masterData.sprocessstartdatesecondtime && this.props.Login.masterData.sprocessstartdatesecondtime)\r\n                ? { \"mandatory\": true, \"idsName\": \"IDS_STARTDATEANDTIME\", \"dataField\": \"dprocessstartdate\", \"width\": \"250px\", \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }\r\n                : { \"mandatory\": true, \"idsName\": \"IDS_ENDDATEANDTIME\", \"dataField\": \"dprocessenddate\", \"width\": \"250px\", \"mandatoryLabel\": \"IDS_SELECT\", \"controlType\": \"selectbox\" }\r\n        );\r\n\r\n        let temparray2 = [];\r\n        //ALPD-5139--Vignesh R(24-12-2024)---added the collection tube type in datagrid\r\n        let scollectiontubetype=this.props.Login.masterData.sfieldnameCollection&& this.props.Login.masterData.sfieldnameCollection;\r\n        let sfieldnameSampleType=this.props.Login.masterData.sfieldnameSampleType&& this.props.Login.masterData.sfieldnameSampleType;\r\n\r\n        barcodeFields && barcodeFields.forEach(barcodeItem => {\r\n            data && data.forEach(dataItem => {\r\n                const entries = Object.entries(dataItem.jsondata);\r\n                if (entries.length > 0) {\r\n                    entries.forEach(([key]) => {\r\n                        const keyExists = temparray2.some(column => column.idsName === key);\r\n                        if (!keyExists) {\r\n                            //    if ('Visit Number' === key || 'Participant ID' === key) {\r\n                                    //ALPD-5139--Vignesh R(24-12-2024)---added the collection tube type in datagrid\r\n\r\n                            if (barcodeItem.sfieldname === key && barcodeItem.sfieldname!==scollectiontubetype && barcodeItem.sfieldname!==sfieldnameSampleType) {\r\n                                temparray2.push({\r\n                                    idsName: key,\r\n                                    dataField: key,\r\n                                    width: '250px'\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n        const newArray = [...temparray1, ...temparray2]\r\n        newArray.push(\r\n            { idsName: 'IDS_COMMENTS', dataField: 'scomments', width: '250px' },\r\n            { idsName: 'IDS_DEVIATIONCOMMENTS', dataField: 'sdeviationcomments', width: '250px' }\r\n        );\r\n        return newArray;\r\n    }\r\n\r\n    validateEsign = () => {\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": {\r\n                    ...this.props.Login.userInfo,\r\n                    sreason: this.state.selectedRecord[\"esigncomments\"],\r\n                    nreasoncode: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].value,\r\n                    spredefinedreason: this.state.selectedRecord[\"esignreason\"] && this.state.selectedRecord[\"esignreason\"].label,\r\n\r\n                },\r\n                password: this.state.selectedRecord[\"esignpassword\"]\r\n            },\r\n            screenData: this.props.Login.screenData\r\n        }\r\n        if (this.props.Login.operation === 'update') {\r\n            this.props.validateEsignCredentialSampleProcessing(inputParam, \"openModal\");\r\n        }\r\n\r\n        else {\r\n            this.props.validateEsignCredential(inputParam, \"openModal\");\r\n        }\r\n    }\r\n    render() {\r\n        /* console.log(\"SampleProcessing\", this.props.Login.masterData.SampleProcessing);\r\n         console.log(\"extractedColumnList\", this.extractedColumnList);\r\n         console.log(\"SampleProcessing-Data\", this.state.data);*/\r\n\r\n\r\n        let fromDate = \"\";\r\n        let toDate = \"\";\r\n        const extractedColumnList = this.gridfillingColumn(this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing || [], this.props.Login.masterData.jsondataBarcodeFields && this.props.Login.masterData.jsondataBarcodeFields);\r\n\r\n\r\n\r\n\r\n        this.extractedColumnList = extractedColumnList;\r\n\r\n\r\n        const addId = this.state.controlMap.has(\"AddSampleProcessing\") && this.state.controlMap.get(\"AddSampleProcessing\").ncontrolcode;\r\n        const editId = this.state.controlMap.has(\"EditSampleProcessing\") && this.state.controlMap.get(\"EditSampleProcessing\").ncontrolcode;\r\n        const deleteId = this.state.controlMap.has(\"DeleteSampleProcessing\") && this.state.controlMap.get(\"DeleteSampleProcessing\").ncontrolcode;\r\n        const editParam = {\r\n            screenName: this.props.Login.displayName,\r\n            operation: \"update\",\r\n            userInfo: this.props.Login.userInfo,\r\n            ncontrolcode: editId,\r\n            masterData: this.props.Login.masterData,\r\n            inputParam: this.props.Login.inputParam,\r\n            primaryKeyField: \"nsampleprocessingcode\",\r\n            selectedRecord: this.state.selectedRecord || {},\r\n            dataState:this.state.dataState\r\n\r\n        };\r\n        const addParam = {\r\n            screenName: this.props.Login.displayName, primaryKeyField: \"nsampleprocessingcode\", primaryKeyValue: undefined,\r\n            operation: \"create\", inputParam: this.props.Login.inputParam, userInfo: this.props.Login.userInfo, ncontrolcode: addId,\r\n            selectedRecord: this.state.selectedRecord,\r\n            masterData: this.props.Login.masterData\r\n        };\r\n//\t\t//ALPD-4618--Vignesh R(01-08-2024)\r\n        const deleteParam = { operation: \"delete\", ncontrolcode:deleteId, selectedRecord: this.state.selectedRecord };\r\n\r\n        if (this.props.Login.masterData && this.props.Login.masterData.FromDate) {\r\n            fromDate = (this.state.selectedRecord[\"fromdate\"] && getStartOfDay(this.state.selectedRecord[\"fromdate\"])) || rearrangeDateFormat(this.props.Login.userInfo, this.props.Login.masterData.FromDate);\r\n            toDate = (this.state.selectedRecord[\"todate\"] && getEndOfDay(this.state.selectedRecord[\"todate\"])) || rearrangeDateFormat(this.props.Login.userInfo, this.props.Login.masterData.ToDate);\r\n        }\r\n        return (\r\n            <>\r\n                {/* <Preloader loadng={this.props.Login.loading}/> */}\r\n                <Row>\r\n                    <Col>\r\n                        <ListWrapper className=\"client-list-content\">\r\n                            <Row>\r\n                                <Col md={2}>\r\n                                    <DateTimePicker\r\n                                        name={\"fromdate\"}\r\n                                        label={this.props.intl.formatMessage({ id: \"IDS_FROM\" })}\r\n                                        className='form-control'\r\n                                        placeholderText=\"Select date..\"\r\n                                        selected={this.state.selectedRecord[\"fromdate\"] || fromDate}\r\n                                        dateFormat={this.props.Login.userInfo.ssitedate}\r\n                                        isClearable={false}\r\n                                        onChange={date => this.handleDateChange(\"fromdate\", date)}\r\n                                        value={this.state.selectedRecord[\"fromdate\"] || fromDate}\r\n\r\n                                    />\r\n                                </Col>\r\n                                <Col md={2}>\r\n                                    <DateTimePicker\r\n                                        name={\"todate\"}\r\n                                        label={this.props.intl.formatMessage({ id: \"IDS_TO\" })}\r\n                                        className='form-control'\r\n                                        placeholderText=\"Select date..\"\r\n                                        selected={this.state.selectedRecord[\"todate\"] || toDate}\r\n                                        dateFormat={this.props.Login.userInfo.ssitedate}\r\n                                        isClearable={false}\r\n                                        onChange={date => this.handleDateChange(\"todate\", date)}\r\n                                        value={this.state.selectedRecord[\"todate\"] || toDate}\r\n\r\n                                    />\r\n                                </Col>\r\n                                <Col md={2}>\r\n                                    <FormSelectSearch\r\n                                        formLabel={this.props.intl.formatMessage({ id: \"IDS_PROJECTTYPE\" })}\r\n                                        isSearchable={true}\r\n                                        name={\"nprojecttypecode\"}\r\n                                        isDisabled={false}\r\n                                        placeholder={this.props.intl.formatMessage({ id: \"IDS_SELECTRECORD\" })}\r\n                                        isMandatory={true}\r\n                                        isClearable={false}\r\n                                        options={this.state.projectType}\r\n                                        value={this.state.selectedRecord[\"nprojecttypecode\"] && this.state.selectedRecord[\"nprojecttypecode\"] || this.props.Login.masterData.selectedProjectType}\r\n                                        defaultValue={this.state.selectedRecord[\"nprojecttypecode\"]}\r\n                                        onChange={(event) => this.onComboChange(event, \"nprojecttypecode\")}\r\n                                        closeMenuOnSelect={true}\r\n                                    >\r\n                                    </FormSelectSearch>\r\n                                </Col>    {/* <Col></Col> */}\r\n                            </Row>\r\n\r\n                            {this.state.data ?\r\n                                <DataGrid\r\n                                    primaryKeyField={\"nsampleprocessingcode\"}\r\n                                    data={this.state.data}\r\n                                    dataResult={this.state.dataResult}\r\n                                    dataState={this.state.dataState}\r\n                                    dataStateChange={this.dataStateChange}\r\n                                    extractedColumnList={this.extractedColumnList}\r\n                                    reloadData={this.reloadData}\r\n                                    controlMap={this.state.controlMap}\r\n                                    userRoleControlRights={this.state.userRoleControlRights}\r\n                                    inputParam={this.props.Login.inputParam}\r\n                                    userInfo={this.props.Login.userInfo}\r\n                                    scrollable={\"scrollable\"}\r\n                                    pageable={true}\r\n                                    isComponent={true}\r\n                                    gridHeight={'600px'}\r\n                                    isToolBarRequired={true}\r\n                                    isActionRequired={true}\r\n                                    expandField=\"expanded\"\r\n                                    selectedId={this.props.Login.selectedId}\r\n                                    addRecord={() => this.props.getComboSampleProcessing(addParam)}\r\n                                    deleteParam={deleteParam}\r\n                                    deleteRecord={this.deleteRecord}\r\n                                    fetchRecord={this.props.getActiveSampleProcessingById}\r\n                                    editParam={editParam}\r\n                                    //ATE234 Janakumar ALPD-5577 Sample Storage-->while download the pdf, screen getting freezed\r\n                                    isDownloadPDFRequired={false}\r\n                                    isDownloadExcelRequired={true}\r\n                                />\r\n                                : \"\"}\r\n                        </ListWrapper>\r\n                    </Col>\r\n                </Row>\r\n                {this.props.Login.openModal &&\r\n                    <SlideOutModal show={this.props.Login.openModal}\r\n                        closeModal={this.closeModal}\r\n                        operation={this.props.Login.operation}\r\n                        inputParam={this.props.Login.inputParam}\r\n                        screenName={this.props.Login.screenName}\r\n                        onSaveClick={this.onSaveClick}\r\n                        size={'lg'}\r\n                        esign={this.props.Login.loadEsign}\r\n                        validateEsign={this.validateEsign}\r\n                        masterStatus={this.props.Login.masterStatus}\r\n                        updateStore={this.props.updateStore}\r\n                        selectedRecord={this.state.selectedRecord || {}}\r\n                        mandatoryFields={this.mandatoryColumns}\r\n                        showSaveContinue={true}\r\n                        addComponent={this.props.Login.loadEsign ?\r\n                            <Esign operation={this.props.Login.operation}\r\n                                formatMessage={this.props.intl.formatMessage}\r\n                                onInputOnChange={this.onInputOnChange}\r\n                                inputParam={this.props.Login.inputParam}\r\n                                selectedRecord={this.state.selectedRecord || {}}\r\n                            />\r\n                            : <AddSampleProcessing\r\n                                autoSaveGetDataProcessing={this.autoSaveGetDataProcessing}\r\n                                selectedRecord={this.state.selectedRecord || {}}\r\n                                onInputOnChange={this.onInputOnChange}\r\n                                onComboChange={this.onComboChange}\r\n                                formatMessage={this.props.intl.formatMessage}\r\n                                operation={this.props.Login.operation}\r\n                                sampletype={this.props.Login.sampletype}\r\n                                collectiontubetype={this.props.Login.collectiontubetype}\r\n                                userInfo={this.props.Login.userInfo}\r\n                                handleDateChangeSlidout={this.handleDateChangeSlidout}\r\n                                projectType={this.state.projectType}\r\n                                masterData={this.props.Login.masterData}\r\n\r\n\r\n                            />}\r\n                    />\r\n                }\r\n            </>\r\n        );\r\n    }\r\n    deleteRecord = (deleteParam) => {\r\n        let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n        let fromDate = obj.fromDate;\r\n        let toDate = obj.toDate;\r\n        const inputParam = {\r\n            classUrl: this.props.Login.inputParam.classUrl,\r\n            methodUrl: this.props.Login.inputParam.methodUrl,\r\n            displayName: this.props.Login.inputParam.displayName,\r\n            inputData: {\r\n                [this.props.Login.inputParam.methodUrl.toLowerCase()]: deleteParam.selectedRecord,\r\n                \"userinfo\": this.props.Login.userInfo,\r\n                \"fromDate\": fromDate,\r\n                \"toDate\": toDate,\r\n                \"nprojecttypecode\": this.props.Login.masterData.selectedProjectType.value || -1,\r\n                \"nsampleprocessingcode\": deleteParam.selectedRecord['nsampleprocessingcode'],\r\n                \"sbarcodeid\": deleteParam.selectedRecord['sbarcodeid']\r\n\r\n            },\r\n            operation: deleteParam.operation,\r\n            dataState: this.state.dataState\r\n        }\r\n\r\n        if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, deleteParam.ncontrolCode)) {\r\n            const updateInfo = {\r\n                typeName: DEFAULT_RETURN,\r\n                data: {\r\n                    loadEsign: true, screenData: { inputParam, masterData: this.props.Login.masterData },\r\n                    openModal: true, screenName: this.props.intl.formatMessage({ id: this.props.Login.inputParam.displayName }),\r\n                    operation: deleteParam.operation\r\n                }\r\n            }\r\n            this.props.updateStore(updateInfo);\r\n        }\r\n        else {\r\n            this.props.crudMaster(inputParam, this.props.Login.masterData, \"openModal\");\r\n        }\r\n    }\r\n    onSaveClick = (saveType, formRef) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        let alertMessage;\r\n        const sbarcodeid = this.props.Login.masterData.barcodedata;\r\n\r\n        //ALPD-5139--Vignesh R(24-12-2024)---added the collection tube type in datagrid\r\n             let checkCollectionTubeType=true;\r\n            let checkSampleType=true;\r\n\r\n        //ALPD-5139--Vignesh R(26-12-2024)---while updating this condition,this can't apply\r\n            if(this.props.Login.operation!=='update'){\r\n            let jsonPrimaryKeyValue=this.props.Login.masterData.jsonPrimaryKeyValue;\r\n\r\n            if(jsonPrimaryKeyValue.nsamplecollectiontypecode){\r\n                if(jsonPrimaryKeyValue.nsamplecollectiontypecode !== selectedRecord['nproductcode'].item.nsamplecollectiontypecode){\r\n                    checkSampleType=false;\r\n                }\r\n            }\r\n\r\n            if(jsonPrimaryKeyValue.ncollectiontubetypecode){\r\n            if(jsonPrimaryKeyValue.ncollectiontubetypecode !== selectedRecord['ncollectiontubetypecode'].value){\r\n                checkCollectionTubeType=false;\r\n            }\r\n        }\r\n\r\n    }\r\n    if(checkSampleType){\r\n    if(checkCollectionTubeType){\r\n        if (selectedRecord[\"sbarcodeid\"] && selectedRecord[\"sbarcodeid\"].length === parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength)) {\r\n            let invalidbarcode = selectedRecord[\"sbarcodeid\"].substring(1, 2);\r\n            if (parseInt(invalidbarcode) === SampleCycle.PROCESSING) {\r\n                if (sbarcodeid != undefined && sbarcodeid != '') {\r\n\r\n                    let date1;\r\n                    let date2;\r\n                    let diffenecemill;\r\n                    let differenceInMinutes;\r\n\r\n                    let flag = false;\r\n\r\n                    if (selectedRecord[\"dprocessenddate\"] !== undefined && selectedRecord[\"dprocessenddate\"] !== \"\"&&selectedRecord[\"dprocessenddate\"] !==null) {\r\n\r\n                        date1 = new Date(formatInputDate(selectedRecord[\"dprocessstartdate\"], false));\r\n                        date2 = new Date(formatInputDate(selectedRecord[\"dprocessenddate\"], false));\r\n\r\n                        diffenecemill = date2 - date1;\r\n                        differenceInMinutes = diffenecemill / (1000 * 60);\r\n\r\n                        let nngracetimetime;\r\n                        let nprocesstime;\r\n\r\n                        nngracetimetime = parseInt(selectedRecord['ngracetime']) + parseInt(selectedRecord['nprocesstime']);\r\n                        nprocesstime = parseInt(selectedRecord['nprocesstime']);\r\n                        if (differenceInMinutes > nngracetimetime) {\r\n                            if (selectedRecord[\"sdeviationcomments\"] === undefined || selectedRecord[\"sdeviationcomments\"] === \"\") {\r\n                                flag = true;\r\n                                alertMessage = \"IDS_DEVIATIONCOMMENTS\"\r\n                            }\r\n                        }\r\n                        else if (differenceInMinutes > nprocesstime) {\r\n                            if (selectedRecord[\"scomments\"] === undefined || selectedRecord[\"scomments\"] === \"\") {\r\n                                flag = true;\r\n                                alertMessage = \"IDS_COMMENTS\"\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (!flag) {\r\n                        let inputData = {};\r\n                        inputData[\"sampleprocessing\"] = {};\r\n                        if (this.props.Login.operation === \"create\") {\r\n                            inputData[\"sampleprocessing\"][\"nsamplecollectiontypecode\"] = selectedRecord[\"nsamplecollectiontypecode\"] ? selectedRecord[\"nsamplecollectiontypecode\"] : -1;\r\n                            inputData[\"sampleprocessing\"][\"nproductcode\"] = selectedRecord[\"nproductcode\"] ? selectedRecord[\"nproductcode\"].value : -1;\r\n                            inputData[\"sampleprocessing\"][\"ncollectiontubetypecode\"] = selectedRecord[\"ncollectiontubetypecode\"] ? selectedRecord[\"ncollectiontubetypecode\"].value : -1;\r\n                            inputData[\"sampleprocessing\"][\"jsondata\"] = Lims_JSON_stringify(JSON.stringify(this.props.Login.masterData.barcodedata));\r\n                        \r\n                        let listProcessType=[...this.state.selectedRecord[\"processtype\"]];\r\n\r\n                        \r\n                        const removeIndex = listProcessType.findIndex(item => {\r\n                            return item.value === parseInt(selectedRecord[\"nprocesstypecode\"].value);\r\n                        });\r\n                        \r\n                        if (removeIndex !== -1) {\r\n                            listProcessType.splice(removeIndex, listProcessType.length);\r\n                            if(listProcessType.length>0){\r\n\r\n                                inputData={...inputData,\"listOfnsampleprocesstypecode\":listProcessType.map(item => item.item.nsampleprocesstypecode).join(','),\"nsampleprocesstypecode\":selectedRecord[\"nsampleprocesstypecode\"],\"nprocesstypelength\":listProcessType.length}\r\n                            }else{\r\n                                inputData={...inputData,\"listOfnsampleprocesstypecode\":selectedRecord[\"nsampleprocesstypecode\"],\"nsampleprocesstypecode\":selectedRecord[\"nsampleprocesstypecode\"],\"isSingleProcesstype\":true,\"nprocesstypelength\":1}\r\n\r\n                            }\r\n\r\n                        }\r\n                        \r\n                        }\r\n                        inputData[\"sampleprocessing\"][\"nprojecttypecode\"] = this.props.Login.masterData.selectedProjectType.value || transactionStatus.NA;\r\n                        if (this.props.Login.operation === \"update\") {\r\n                            inputData[\"sampleprocessing\"][\"nsampleprocessingcode\"] = this.props.Login.selectedId;\r\n                        }\r\n                        inputData[\"sampleprocessing\"][\"sbarcodeid\"] = selectedRecord[\"sbarcodeid\"] ? selectedRecord[\"sbarcodeid\"] : -1;\r\n\r\n                inputData[\"sampleprocessing\"][\"nsamplecollectiontypecode\"] = selectedRecord[\"nsamplecollectiontypecode\"] ? selectedRecord[\"nsamplecollectiontypecode\"] : -1;\r\n\r\n                        inputData[\"sampleprocessing\"][\"scomments\"] = selectedRecord[\"scomments\"] && selectedRecord[\"scomments\"] || \"\";\r\n\r\n                        inputData[\"sampleprocessing\"][\"sdeviationcomments\"] = selectedRecord[\"sdeviationcomments\"] && selectedRecord[\"sdeviationcomments\"] || \"\";\r\n\r\n                        inputData[\"sampleprocessing\"][\"dprocessstartdate\"] = formatInputDate(selectedRecord[\"dprocessstartdate\"], false);\r\n                        inputData[\"sampleprocessing\"][\"ntzprocessstartdate\"] = selectedRecord[\"ntzprocessstartdate\"] && selectedRecord[\"ntzprocessstartdate\"].value || transactionStatus.NA\r\n                        inputData[\"sampleprocessing\"][\"noffsetdprocessstartdate\"] = selectedRecord[\"noffsetdprocessenddate\"] && selectedRecord[\"noffsetdprocessenddate\"].value || transactionStatus.NA\r\n\r\n                        inputData[\"sampleprocessing\"][\"nsampleprocesstypecode\"] = selectedRecord[\"nsampleprocesstypecode\"] ? selectedRecord[\"nsampleprocesstypecode\"] : -1;\r\n                        inputData[\"sampleprocessing\"][\"noffsetdprocessenddate\"] = selectedRecord[\"noffsetdprocessenddate\"] && selectedRecord[\"noffsetdprocessenddate\"].value || transactionStatus.NA\r\n                        inputData[\"sampleprocessing\"][\"ntzprocessenddate\"] = selectedRecord[\"ntzprocessenddate\"] && selectedRecord[\"ntzprocessenddate\"].value || transactionStatus.NA\r\n                        if (selectedRecord[\"dprocessenddate\"] !== undefined && selectedRecord[\"dprocessenddate\"] !== \"\" && selectedRecord[\"dprocessenddate\"]!==null) {\r\n                            inputData[\"sampleprocessing\"][\"dprocessenddate\"] = formatInputDate(selectedRecord[\"dprocessenddate\"], false);\r\n\r\n                        }\r\n\r\n\r\n                        let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n                        let fromDate = obj.fromDate;\r\n                        let toDate = obj.toDate;\r\n                        inputData[\"fromDate\"] = fromDate;\r\n                        inputData[\"toDate\"] = toDate;\r\n                        inputData[\"nprojecttypecode\"] = this.props.Login.masterData.selectedProjectType.value || transactionStatus.NA;\r\n                        inputData[\"userinfo\"] = {\r\n                            ...this.props.Login.userInfo,\r\n                            sformname: Lims_JSON_stringify(this.props.Login.userInfo.sformname),\r\n                            smodulename: Lims_JSON_stringify(this.props.Login.userInfo.smodulename)\r\n                        }\r\n\r\n\r\n\r\n                        const inputParam = {\r\n                            nformcode: this.props.Login.userInfo.nformcode,\r\n                            classUrl: \"storagesampleprocessing\",\r\n                            methodUrl: \"SampleProcessing\",\r\n                            inputData: inputData,\r\n                            operation: this.props.Login.operation,\r\n                            saveType, formRef,\r\n                            selectedRecord: this.state.selectedRecord || {}\r\n                        }\r\n\r\n                        const masterData = this.props.Login.masterData;\r\n\r\n                        if (showEsign(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode, this.props.Login.ncontrolcode)) {\r\n                            const updateInfo = {\r\n                                typeName: DEFAULT_RETURN,\r\n                                data: {\r\n                                    loadEsign: true, screenData: { inputParam, masterData }, saveType\r\n                                }\r\n                            }\r\n                            this.props.updateStore(updateInfo);\r\n                        }\r\n                        else {\r\n                            this.props.saveSampleProcessing(inputParam, masterData);\r\n                        }\r\n                    }\r\n                    else {\r\n                        toast.warn(this.props.intl.formatMessage({\r\n                            id: \"IDS_ENTER\",\r\n                        }) + \" \" +\r\n                            this.props.intl.formatMessage({\r\n                                id: alertMessage,\r\n                            })\r\n                        );\r\n                    }\r\n                }\r\n                else {\r\n                    toast.warn(\r\n                        this.props.intl.formatMessage({\r\n                            id: \"IDS_CLICKENTERTOJSONRECORD\",\r\n                        })\r\n                    );\r\n                }\r\n            }\r\n            else {\r\n                toast.warn(\r\n                    this.props.intl.formatMessage({\r\n                        id: \"IDS_INVALIDBARCODEID\",\r\n                    })\r\n                );\r\n            }\r\n        } else {\r\n            toast.warn(\r\n                this.props.intl.formatMessage({\r\n                    id: \"IDS_INVALIDABARCODE\",\t//ALPD-4750 Changed IDS value to throw alert correctly by VISHAKH\r\n                })\r\n            );\r\n        }\r\n    }\r\n    else {\r\n        toast.warn(\r\n            this.props.intl.formatMessage({\r\n                id: \"IDS_INVALIDCOLLECTIONTUBETYPE\",\r\n            })\r\n        );\r\n    }\r\n}\r\n    else {\r\n        toast.warn(\r\n            this.props.intl.formatMessage({\r\n                id: \"IDS_INVALIDSAMPLETYPE\",\r\n            })\r\n        );\r\n    }\r\n\r\n    }\r\n\r\n    onComboChange = (comboData, fieldName) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n\r\n        if (fieldName === 'nprojecttypecode') {\r\n            let inputData = [];\r\n            let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n            let fromDate = obj.fromDate;\r\n            let toDate = obj.toDate;\r\n            inputData[\"fromDate\"] = fromDate;\r\n            inputData[\"toDate\"] = toDate;\r\n            inputData = {\r\n                userinfo: this.props.Login.userInfo,\r\n                nprojecttypecode: parseInt(comboData.value),\r\n                selectedProjectType: comboData,\r\n                toDate: toDate,\r\n                fromDate: fromDate\r\n            }\r\n            delete selectedRecord[\"nproductcode\"];\r\n            delete selectedRecord[\"ncollectiontubetypecode\"];\r\n            delete selectedRecord[\"nprocesstypecode\"];\r\n            const masterData = { ...this.props.Login.masterData }\r\n            const inputParam = { masterData, inputData }\r\n            this.props.getSampleProcessing(inputParam)\r\n        }\r\n        /*  if (fieldName === \"nproductcode\") {\r\n              let inputData = [];\r\n              let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n              let fromDate = obj.fromDate;\r\n              let toDate = obj.toDate;\r\n              inputData[\"fromDate\"] = fromDate;\r\n              inputData[\"toDate\"] = toDate;\r\n              inputData = {\r\n                  userinfo: this.props.Login.userInfo,\r\n                  nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\r\n                  toDate: toDate,\r\n                  fromDate: fromDate\r\n              }\r\n              const masterData = { ...this.props.Login.masterData }\r\n              selectedRecord={...selectedRecord,\"nproductcode\":comboData}\r\n              const inputParam = { masterData, inputData,selectedRecord }\r\n              this.props.getCollectionTubeType(inputParam)\r\n          } else {*/\r\n        if (fieldName === \"ncollectiontubetypecode\" && selectedRecord['nproductcode'] !== undefined) {\r\n            let inputData = [];\r\n            let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n            let fromDate = obj.fromDate;\r\n            let toDate = obj.toDate;\r\n            inputData[\"fromDate\"] = fromDate;\r\n            inputData[\"toDate\"] = toDate;\r\n            inputData = {\r\n                userinfo: this.props.Login.userInfo,\r\n                nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\r\n                nproductcode: selectedRecord['nproductcode'] && selectedRecord['nproductcode'].value || -1,\r\n                nsamplecollectiontypecode: selectedRecord['nsamplecollectiontypecode'] && selectedRecord['nsamplecollectiontypecode'] || -1,\r\n                ncollectiontubetypecode: parseInt(comboData.value),\r\n                toDate: toDate,\r\n                fromDate: fromDate\r\n            }\r\n\r\n            delete selectedRecord[\"ncollectiontubetypecode\"];\r\n            delete selectedRecord[\"nprocesstypecode\"];\r\n            const masterData = { ...this.props.Login.masterData }\r\n            selectedRecord = { ...selectedRecord, [fieldName]: comboData }\r\n            const inputParam = { masterData, inputData, selectedRecord }\r\n\r\n\r\n            this.props.getSampleProcessType(inputParam)\r\n        }\r\n        else if (fieldName === \"nproductcode\" && selectedRecord['ncollectiontubetypecode'] !== undefined) {\r\n            let inputData = [];\r\n            let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n            let fromDate = obj.fromDate;\r\n            let toDate = obj.toDate;\r\n            inputData[\"fromDate\"] = fromDate;\r\n            inputData[\"toDate\"] = toDate;\r\n            inputData = {\r\n                userinfo: this.props.Login.userInfo,\r\n                nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\r\n                nproductcode: parseInt(comboData.value),\r\n                nsamplecollectiontypecode: parseInt(comboData.item.nsamplecollectiontypecode),\r\n                ncollectiontubetypecode: selectedRecord['ncollectiontubetypecode'] && selectedRecord['ncollectiontubetypecode'].value || -1,\r\n                toDate: toDate,\r\n                fromDate: fromDate\r\n            }\r\n            delete selectedRecord[\"ncollectiontubetypecode\"];\r\n            delete selectedRecord[\"nprocesstypecode\"];\r\n            const masterData = { ...this.props.Login.masterData }\r\n            selectedRecord = {\r\n                ...selectedRecord, [fieldName]: comboData, \"nsamplecollectiontypecode\": parseInt(comboData.item.nsamplecollectiontypecode)\r\n            }\r\n            const inputParam = { masterData, inputData, selectedRecord }\r\n            this.props.getSampleProcessType(inputParam)\r\n        }\r\n        else if (fieldName === \"nprocesstypecode\") {\r\n            let inputData = [];\r\n            let obj = convertDateValuetoString(this.props.Login.masterData.FromDate, this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n            let fromDate = obj.fromDate;\r\n            let toDate = obj.toDate;\r\n            inputData[\"fromDate\"] = fromDate;\r\n            inputData[\"toDate\"] = toDate;\r\n\r\n            inputData = {\r\n                userinfo: this.props.Login.userInfo,\r\n                nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\r\n                nproductcode: selectedRecord['nproductcode'] && selectedRecord['nproductcode'].value || -1,\r\n                ncollectiontubetypecode: selectedRecord['ncollectiontubetypecode'] && selectedRecord['ncollectiontubetypecode'].value,\r\n                nsamplecollectiontypecode: selectedRecord['nsamplecollectiontypecode'] && selectedRecord['nsamplecollectiontypecode'] || -1,\r\n                nprocesstypecode: parseInt(comboData.value),\r\n                toDate: toDate,\r\n                fromDate: fromDate\r\n            }\r\n\r\n            const masterData = { ...this.props.Login.masterData }\r\n            selectedRecord = { ...selectedRecord, \"nprocesstypecode\": comboData }\r\n            const inputParam = { masterData, inputData, selectedRecord }\r\n            this.props.getProcessduration(inputParam)\r\n        }\r\n        else {\r\n            selectedRecord[fieldName] = comboData;\r\n            if (fieldName === \"nproductcode\") {\r\n                selectedRecord = { ...selectedRecord, \"nsamplecollectiontypecode\": comboData.item.nsamplecollectiontypecode }\r\n            }\r\n            this.setState({ selectedRecord });\r\n        }\r\n\r\n        //  }\r\n\r\n    }\r\n    handleDateChangeSlidout = (dateName, dateValue) => {\r\n        let selectedRecord = this.state.selectedRecord || {};\r\n        selectedRecord[dateName] = dateValue;\r\n        this.setState({ selectedRecord });\r\n        /* if (selectedRecord[\"sbarcodeid\"] !== undefined) {\r\n              let inputData = {};\r\n              inputData[\"sampleprocessing\"] = {};\r\n            if (dateName === \"dprocessenddate\") {\r\n                  inputData[\"sampleprocessing\"][\"dprocessenddate\"] = formatInputDate(dateValue, false);\r\n                  inputData[\"sampleprocessing\"][\"nsampleprocesstypecode\"] = selectedRecord[\"nsampleprocesstypecode\"] ? selectedRecord[\"nsampleprocesstypecode\"] : -1;\r\n                  inputData[\"sampleprocessing\"][\"sbarcodeid\"] = selectedRecord[\"sbarcodeid\"] ? selectedRecord[\"sbarcodeid\"] : -1;\r\n                  inputData[\"userinfo\"] = {\r\n                      ...this.props.Login.userInfo,\r\n                      sformname: Lims_JSON_stringify(this.props.Login.userInfo.sformname),\r\n                      smodulename: Lims_JSON_stringify(this.props.Login.userInfo.smodulename)\r\n                  }\r\n                  selectedRecord = { ...selectedRecord, [dateName]: dateValue }\r\n  \r\n                  const inputParam = {\r\n                      nformcode: this.props.Login.userInfo.nformcode,\r\n                      inputData: inputData,\r\n                      operation: this.props.Login.operation,\r\n                      selectedRecord: selectedRecord,\r\n                      masterData: this.props.Login.masterData\r\n  \r\n                  }\r\n                  this.props.getCommentsDeviation(inputParam)\r\n              }\r\n              else {\r\n  \r\n                \r\n              }\r\n          } else {\r\n  \r\n              toast.warn(this.props.intl.formatMessage({\r\n                  id: \"IDS_ENTER\",\r\n              }) +\r\n                  this.props.intl.formatMessage({\r\n                      id: \"IDS_BARCODEID\",\r\n                  })\r\n              );\r\n  \r\n          }\r\n  */\r\n    };\r\n    autoSaveGetDataProcessing = (event) => {\r\n        let selectedRecord = this.state.selectedRecord || {}\r\n\r\n        event.stopPropagation();\r\n        //ALPD-4701--Vignesh R(21-08-2024)\r\n        if(event.keyCode === 13){\r\n        if (selectedRecord['ncollectiontubetypecode'] && selectedRecord['nproductcode'] && selectedRecord['nprocesstypecode']) {\r\n            if (parseInt(selectedRecord[\"sbarcodeid\"] && selectedRecord[\"sbarcodeid\"].length) === parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength) && event.keyCode === 13) {\r\n\r\n                let invalidbarcode = event.target.value.substring(1, 2);\r\n                if (parseInt(invalidbarcode) === SampleCycle.PROCESSING) {\r\n                    let checkCollectionTubeType=false;\r\n                    let checkSampleType=false;\r\n\r\n                   \r\n\r\n                //if(checkCollectionTubeType){\r\n                    let inputParam = {\r\n                        nprojecttypecode: this.props.Login.masterData.selectedProjectType.value,\r\n                        spositionvalue: event.target.value,\r\n                        userinfo: this.props.Login.userInfo,\r\n                        nbarcodeLength:  parseInt(this.props.Login.masterData.nbarcodelength && this.props.Login.masterData.nbarcodelength),\r\n                        jsondata: {},\r\n                        masterData: this.props.Login.masterData,\r\n                        selectedRecord: selectedRecord || {}\r\n                    }\r\n                    this.props.getBarcodeDataDetails(inputParam);\r\n                //}\r\n                // else {\r\n                //     toast.warn(\r\n                //         this.props.intl.formatMessage({\r\n                //             id: \"IDS_INVALIDCOLLECTIONTUBETYPE\",\r\n                //         })\r\n                //     );\r\n                // }\r\n                }\r\n                else {\r\n                    toast.warn(\r\n                        this.props.intl.formatMessage({\r\n                            id: \"IDS_INVALIDBARCODEID\",\r\n                        })\r\n                    );\r\n                }\r\n            } \r\n        }\r\n        else {\r\n            event.stopPropagation();    \r\n            if (selectedRecord['nproductcode'] === undefined) {\r\n                toast.warn(this.props.intl.formatMessage({\r\n                    id: \"IDS_SELECT\",\r\n                }) +\r\n                    this.props.intl.formatMessage({\r\n                        id: \"IDS_SAMPLETYPE\",\r\n                    })\r\n                );\r\n            } else if (selectedRecord['ncollectiontubetypecode'] === undefined) {\r\n                toast.warn(this.props.intl.formatMessage({\r\n                    id: \"IDS_SELECT\",\r\n                }) +\r\n                    this.props.intl.formatMessage({\r\n                        id: \"IDS_COLLECTIONTUBETYPENAME\",\r\n                    })\r\n                );\r\n            }\r\n            else {\r\n                toast.warn(this.props.intl.formatMessage({\r\n                    id: \"IDS_SELECT\",\r\n                }) +\r\n                    this.props.intl.formatMessage({\r\n                        id: \"IDS_PROCESSTYPENAME\",\r\n                    })\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    };\r\n    onInputOnChange = (event, fieldname) => {\r\n        const selectedRecord = this.state.selectedRecord || {};\r\n\r\n        if (event.target.type === 'checkbox') {\r\n            selectedRecord[event.target.name] = event.target.checked === true ? transactionStatus.YES : transactionStatus.NO;\r\n        }\r\n        else {\r\n            selectedRecord[event.target.name] = event.target.value;\r\n        }\r\n        this.setState({ selectedRecord });\r\n\r\n    }\r\n    componentDidUpdate(previousProps) {\r\n        let { projectType } = this.state;\r\n        let bool = false;\r\n        if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n            this.setState({ selectedRecord: this.props.Login.selectedRecord });\r\n        }\r\n\r\n        if (this.props.Login.masterData.projectType !== previousProps.Login.masterData.projectType) {\r\n            const projectTypeMap = constructOptionList(this.props.Login.masterData.projectType || [], \"nprojecttypecode\",\r\n                \"sprojecttypename\", undefined, undefined, undefined);\r\n            projectType = projectTypeMap.get(\"OptionList\");\r\n            bool = true;\r\n\r\n        }\r\n\r\n        if (this.props.Login.masterData.selectedProjectType !== previousProps.Login.masterData.selectedProjectType) {\r\n            const projectTypeMap = constructOptionList(this.props.Login.masterData.projectType || [], \"nprojecttypecode\",\r\n                \"sprojecttypename\", undefined, undefined, undefined);\r\n            projectType = projectTypeMap.get(\"OptionList\");\r\n            bool = true;\r\n\r\n        }\r\n\r\n        // if (this.props.Login.masterData.SampleProcessing !== previousProps.Login.masterData.SampleProcessing) {\r\n        //     let samplecollect = [];\r\n        //     samplecollect = this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing.map(sampleItem => {\r\n        //         const entries = Object.entries(sampleItem.jsondata);\r\n        //         if (entries.length > 0) {\r\n        //             const newItem = { ...sampleItem };\r\n        //             entries.forEach(([key, value]) => {\r\n\r\n        //                 newItem[key] = value;\r\n\r\n        //             });\r\n        //             return newItem;\r\n        //         }\r\n        //         return sampleItem;\r\n        //     });\r\n        //     let { dataState } = this.state;\r\n        //     if (dataState === undefined) {\r\n        //         dataState = { skip: 0, take: this.state.dataState.take }\r\n        //     }\r\n        //     if (this.state.dataResult.data) {\r\n        //         if (this.state.dataResult.data.length === 1) {\r\n        //             let skipcount = this.state.dataState.skip > 0 ? (this.state.dataState.skip - this.state.dataState.take) :\r\n        //                 this.state.dataState.skip\r\n        //             dataState = { skip: skipcount, take: this.state.dataState.take }\r\n        //         }\r\n        //     }\r\n\r\n        //     this.setState({\r\n        //         data: samplecollect,\r\n        //         dataState,\r\n        //         dataResult: process(samplecollect || [], dataState),\r\n        //     });\r\n        // }\r\n\r\n\r\n       \r\n        if (this.props.Login.masterData !== previousProps.Login.masterData) {\r\n\r\n            if (this.props.Login.userInfo.nformcode !== previousProps.Login.userInfo.nformcode) {\r\n                const userRoleControlRights = [];\r\n                if (this.props.Login.userRoleControlRights) {\r\n                    this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode] && Object.values(this.props.Login.userRoleControlRights[this.props.Login.userInfo.nformcode]).map(item =>\r\n                        userRoleControlRights.push(item.ncontrolcode))\r\n                }\r\n                const controlMap = getControlMap(this.props.Login.userRoleControlRights, this.props.Login.userInfo.nformcode)\r\n                let sampleProcessing = [];\r\n                sampleProcessing =\r\n                    this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing.map(sampleItem => {\r\n                        const entries = Object.entries(sampleItem.jsondata);\r\n                        if (entries.length > 0) {\r\n                            const newItem = { ...sampleItem };\r\n                            entries.forEach(([key, value]) => {\r\n\r\n                                newItem[key] = value;\r\n\r\n                            });\r\n                            return newItem;\r\n                        }\r\n                        return sampleItem;\r\n                    });\r\n\r\n                let { dataState } = this.state;\r\n                if (dataState === undefined) {\r\n                    dataState = { skip: 0, take: this.state.dataState.take }\r\n                }\r\n                if (this.state.dataResult.data) {\r\n                    if (this.state.dataResult.data.length === 1) {\r\n                        let skipcount = this.state.dataState.skip > 0 ? (this.state.dataState.skip - this.state.dataState.take) :\r\n                            this.state.dataState.skip\r\n                        dataState = { skip: skipcount, take: this.state.dataState.take }\r\n                    }\r\n                }\r\n\r\n                this.setState({\r\n                    userRoleControlRights, controlMap, data: sampleProcessing, dataState,\r\n                    dataResult: process(sampleProcessing || [], dataState),\r\n                });\r\n            }else { \r\n                //jana ALPD-4694 Temporary Storage-->While Try to Delete the Records the Fields are Align Wrongly\r\n\r\n            let {dataState}=this.state;\r\n            let sampleProcessingdata = [];\r\n            sampleProcessingdata =\r\n                this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing.map(sampleItem => {\r\n                    const entries = Object.entries(sampleItem.jsondata);\r\n                    if (entries.length > 0) {\r\n                        const newItem = { ...sampleItem };\r\n                        entries.forEach(([key, value]) => {\r\n\r\n                            newItem[key] = value;\r\n\r\n                        });\r\n                        return newItem;\r\n                    }\r\n                    return sampleItem;\r\n                });\r\n\r\n            if(this.props.Login.dataState===undefined  || this.props.Login.masterData.selectedProjectType !== previousProps.Login.masterData.selectedProjectType){\r\n                dataState={skip:0,take:this.state.dataState.take}\r\n            }\r\n             if(this.state.dataResult.data){\r\n                 if(this.state.dataResult.data.length ===1){\r\n                    let skipcount=this.state.dataState.skip>0?(this.state.dataState.skip-this.state.dataState.take):\r\n                    this.state.dataState.skip\r\n                     dataState={skip:skipcount,take:this.state.dataState.take}\r\n                 }\r\n             } \r\n             this.setState({\r\n                data: sampleProcessingdata, selectedRecord: this.props.Login.selectedRecord,\r\n                dataResult: process(sampleProcessingdata || [],dataState),\r\n                dataState\r\n            });\r\n            }\r\n\r\n            \r\n            if (this.props.Login.masterData.jsondataBarcodeFields !== previousProps.Login.masterData.jsondataBarcodeFields) {\r\n                const retrievedData = sortData(this.props.Login.masterData.jsondataBarcodeFields,\"ascending\",\"nsorter\");\r\n                this.setState({ jsondataBarcodeFields: retrievedData });\r\n            }\r\n            /* else {\r\n                 if (this.props.Login.masterData.SampleProcessing) {\r\n                     let {dataState}=this.state;\r\n                     if(dataState===undefined){\r\n                         dataState={skip:0,take:this.state.dataState.take}\r\n                     }\r\n                      if(this.state.dataResult.data){\r\n                          if(this.state.dataResult.data.length ===1){\r\n                             let skipcount=this.state.dataState.skip>0?(this.state.dataState.skip-this.state.dataState.take):\r\n                             this.state.dataState.skip\r\n                              dataState={skip:skipcount,take:this.state.dataState.take}\r\n                          }\r\n                      } \r\n                     \r\n                     let samplecollect = [];\r\n                     samplecollect = this.props.Login.masterData.SampleProcessing && this.props.Login.masterData.SampleProcessing.map(sampleItem => {\r\n                         const entries = Object.entries(sampleItem.jsondata);\r\n                         if (entries.length > 0) {\r\n                             const newItem = { ...sampleItem };\r\n                             entries.forEach(([key, value]) => {\r\n \r\n                                 newItem[key] = value;\r\n \r\n                             });\r\n                             return newItem;\r\n                         }\r\n                         return sampleItem;\r\n                     });\r\n \r\n                     this.setState({\r\n                         data: samplecollect,\r\n                         dataState,\r\n                         dataResult: process(samplecollect || [], dataState),\r\n                     });\r\n                 }\r\n             }*/\r\n        }else if (this.props.Login.selectedRecord !== previousProps.Login.selectedRecord) {\r\n            this.setState({ selectedRecord: this.props.Login.selectedRecord });\r\n        }\r\n\r\n        if (bool) {\r\n            this.setState({\r\n                projectType\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    handleDateChange = (dateName, dateValue) => {\r\n        const { selectedRecord } = this.state;\r\n        if (dateValue === null) {\r\n            dateValue = new Date();\r\n        }\r\n        if (dateName === 'todate') {\r\n            selectedRecord[dateName] = dateValue;\r\n\r\n        }\r\n        else {\r\n            selectedRecord[dateName] = dateValue;\r\n\r\n        }\r\n        selectedRecord[dateName] = dateValue;\r\n        // this.setState({ selectedRecord });\r\n        // this.reloadData(selectedRecord, true);\r\n\r\n        let dateObj = {};\r\n        let obj = convertDateValuetoString(selectedRecord['fromdate'] && selectedRecord['fromdate'] || this.props.Login.masterData.FromDate, selectedRecord['todate'] && selectedRecord['todate'] || this.props.Login.masterData.ToDate, this.props.Login.userInfo);\r\n        let fromDate = obj.fromDate;\r\n        let toDate = obj.toDate;\r\n\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": this.props.Login.userInfo,\r\n                fromDate: fromDate,\r\n                toDate: toDate,\r\n                nprojecttypecode: this.props.Login.masterData.selectedProjectType && this.props.Login.masterData.selectedProjectType.value || -1\r\n            }\r\n\r\n        };\r\n        this.props.getSampleProcessing(inputParam);\r\n    }\r\n\r\n    reloadData = () => {\r\n        //this.searchRef.current.value = \"\";\r\n        let fromDate = this.props.Login.masterData.FromDate;\r\n        let toDate = this.props.Login.masterData.ToDate;\r\n\r\n        let obj = convertDateValuetoString(fromDate, toDate, this.props.Login.userInfo, true);\r\n        const inputParam = {\r\n            inputData: {\r\n                \"userinfo\": this.props.Login.userInfo,\r\n                fromDate: obj.fromDate,\r\n                toDate: obj.toDate,\r\n                \"nprojecttypecode\": this.props.Login.masterData.selectedProjectType.value || -1\r\n                // currentdate: isDateChange === true ? null : formatInputDate(new Date(), true)\r\n            },\r\n            classUrl: 'storagesampleprocessing',\r\n            methodUrl: \"SampleProcessing\",\r\n            displayName: this.props.Login.inputParam.displayName,\r\n            userInfo: this.props.Login.userInfo,\r\n            selectedRecord: this.state.selectedRecord || {}\r\n        };\r\n        this.props.getSampleProcessing(inputParam);\r\n    }\r\n\r\n\r\n}\r\nexport default connect(mapStateToProps, {\r\n    callService, crudMaster,\r\n    updateStore, validateEsignCredential, getComboSampleProcessing, getBarcodeDataDetails, getSampleProcessType, getProcessduration, saveSampleProcessing,\r\n    getActiveSampleProcessingById, getSampleProcessing, validateEsignCredentialSampleProcessing\r\n})(injectIntl(SampleProcessing));"]},"metadata":{},"sourceType":"module"}