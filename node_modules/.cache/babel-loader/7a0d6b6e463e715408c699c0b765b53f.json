{"ast":null,"code":"import rsapi from '../rsapi';\nimport { DEFAULT_RETURN } from './LoginTypes';\nimport { constructOptionList } from '../components/CommonScript';\nimport { toast } from 'react-toastify';\nimport Axios from 'axios';\nimport { initRequest } from './LoginAction';\nimport { intl } from '../components/App';\nexport function getCityService(methodParam) {\n  return function (dispatch) {\n    const methodTypeService = rsapi.post(\"city/getCity\", {\n      userinfo: methodParam.userInfo\n    });\n    const districtService = rsapi.post(\"city/getDistrict\", {\n      userinfo: methodParam.userInfo\n    });\n    let urlArray = [];\n    let selectedId = null;\n\n    if (methodParam.operation === \"create\") {\n      urlArray = [methodTypeService, districtService];\n    } else {\n      const url = methodParam.inputParam.classUrl + \"/getActive\" + methodParam.inputParam.methodUrl + \"ById\"; //\"method/getActiveMethodById\"      \n\n      const methodById = rsapi.post(url, {\n        [methodParam.primaryKeyField]: methodParam.primaryKeyValue,\n        \"userinfo\": methodParam.userInfo\n      });\n      urlArray = [methodTypeService, districtService, methodById];\n      selectedId = methodParam.primaryKeyValue;\n    }\n\n    dispatch(initRequest(true));\n    Axios.all(urlArray).then(response => {\n      let selectedRecord = {};\n      let districtCode = [];\n      const cityList = constructOptionList(response[0].data || [], \"ncitycode\", \"scityname\", undefined, undefined, undefined);\n      const cityList1 = cityList.get(\"OptionList\");\n      const citydefault = cityList.get(\"DefaultValue\");\n      const district = constructOptionList(response[1].data.districtList || [], \"ndistrictcode\", \"sdistrictname\", undefined, undefined, undefined);\n      const districtList = district.get(\"OptionList\");\n\n      if (methodParam.operation === \"update\") {\n        selectedRecord = response[2].data;\n        districtCode.push({\n          \"value\": response[2].data[\"ndistrictcode\"],\n          \"label\": response[2].data[\"sdistrictname\"]\n        });\n        selectedRecord[\"ndistrictcode\"] = districtCode[0];\n      } else {\n        selectedRecord[\"ncitycode\"] = citydefault;\n      }\n\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          cityList: cityList1 || [],\n          districtList: districtList || [],\n          operation: methodParam.operation,\n          screenName: methodParam.screenName,\n          selectedRecord,\n          openModal: true,\n          ncontrolCode: methodParam.ncontrolCode,\n          loading: false,\n          selectedId\n        }\n      });\n    }).catch(error => {\n      dispatch({\n        type: DEFAULT_RETURN,\n        payload: {\n          loading: false\n        }\n      });\n\n      if (error.response.status === 500) {\n        toast.error(intl.formatMessage({\n          id: error.message\n        }));\n      } else {\n        toast.warn(intl.formatMessage({\n          id: error.response.data\n        }));\n      }\n    });\n  };\n}","map":{"version":3,"sources":["E:/WorkingFolder/React_Postgres/ALPD/branches/SOURCE-513-PROD/QuaLISWeb/src/actions/CityAction.js"],"names":["rsapi","DEFAULT_RETURN","constructOptionList","toast","Axios","initRequest","intl","getCityService","methodParam","dispatch","methodTypeService","post","userinfo","userInfo","districtService","urlArray","selectedId","operation","url","inputParam","classUrl","methodUrl","methodById","primaryKeyField","primaryKeyValue","all","then","response","selectedRecord","districtCode","cityList","data","undefined","cityList1","get","citydefault","district","districtList","push","type","payload","screenName","openModal","ncontrolCode","loading","catch","error","status","formatMessage","id","message","warn"],"mappings":"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","sourcesContent":["import rsapi from '../rsapi';\r\nimport {DEFAULT_RETURN} from './LoginTypes';\r\nimport {constructOptionList} from '../components/CommonScript'\r\nimport { toast } from 'react-toastify';\r\nimport Axios from 'axios';\r\nimport { initRequest } from './LoginAction';\r\nimport { intl } from '../components/App';\r\n\r\nexport function getCityService (methodParam) {            \r\n    return function (dispatch) {   \r\n    const methodTypeService = rsapi.post(\"city/getCity\", \r\n                                    {userinfo:methodParam.userInfo});\r\n    const districtService = rsapi.post(\"city/getDistrict\", \r\n                                    {userinfo:methodParam.userInfo});\r\n    let urlArray = [];\r\n    let selectedId = null;\r\n    \r\n    if (methodParam.operation === \"create\"){\r\n        urlArray = [methodTypeService,districtService];\r\n    }\r\n    else{           \r\n        const url = methodParam.inputParam.classUrl+ \"/getActive\" + methodParam.inputParam.methodUrl + \"ById\";   //\"method/getActiveMethodById\"      \r\n        const methodById =  rsapi.post(url, { [methodParam.primaryKeyField] :methodParam.primaryKeyValue, \"userinfo\": methodParam.userInfo} );\r\n        urlArray = [methodTypeService,districtService,methodById];\r\n        selectedId = methodParam.primaryKeyValue;\r\n    }\r\n    dispatch(initRequest(true));\r\n    Axios.all(urlArray)\r\n        .then(response=>{                  \r\n            \r\n            let selectedRecord =  {};\r\n            let districtCode=[];\r\n            const cityList = constructOptionList(response[0].data  ||[],\"ncitycode\",\r\n            \"scityname\" , undefined, undefined, undefined);\r\n        const  cityList1  = cityList.get(\"OptionList\");\r\n        const  citydefault  = cityList.get(\"DefaultValue\");\r\n        \r\n        const district = constructOptionList(response[1].data.districtList  ||[],\"ndistrictcode\",\r\n            \"sdistrictname\" , undefined, undefined, undefined);\r\n        const  districtList  = district.get(\"OptionList\");\r\n       \r\n          \r\n        if (methodParam.operation === \"update\"){\r\n            selectedRecord = response[2].data;    \r\n            districtCode.push({\"value\" : response[2].data[\"ndistrictcode\"], \"label\" : response[2].data[\"sdistrictname\"]});   \r\n            selectedRecord[\"ndistrictcode\"]=districtCode[0];                      \r\n        }else{\r\n            selectedRecord[\"ncitycode\"] = citydefault; \r\n        }\r\n           \r\n            dispatch({type: DEFAULT_RETURN, \r\n                        payload:{cityList:cityList1 || [],\r\n                        districtList:districtList||[],                       \r\n                        operation:methodParam.operation, \r\n                        screenName:methodParam.screenName, selectedRecord, \r\n                        openModal : true,\r\n                        ncontrolCode:methodParam.ncontrolCode,\r\n                        loading:false,selectedId\r\n                    }});\r\n        })\r\n        .catch(error=>{\r\n            dispatch({type: DEFAULT_RETURN, payload: {loading:false}})\r\n            if (error.response.status === 500){\r\n                toast.error(intl.formatMessage({id: error.message}));\r\n            } \r\n            else{               \r\n                toast.warn(intl.formatMessage({id: error.response.data}));\r\n            }  \r\n        })        \r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}