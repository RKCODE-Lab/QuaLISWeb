{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport React, { Component } from \"react\";\nimport { Utils } from \"@react-awesome-query-builder/core\";\nimport PropTypes from \"prop-types\";\nimport context from \"../../stores/context\";\nimport { pureShouldComponentUpdate } from \"../../utils/reactUtils\";\nimport { connect } from \"react-redux\";\nimport classNames from \"classnames\";\nvar getFieldConfig = Utils.ConfigUtils.getFieldConfig;\n\nvar createRuleContainer = function createRuleContainer(Rule) {\n  var _class;\n\n  return _class = /*#__PURE__*/function (_Component) {\n    _inherits(RuleContainer, _Component);\n\n    var _super = _createSuper(RuleContainer);\n\n    function RuleContainer(props) {\n      var _this;\n\n      _classCallCheck(this, RuleContainer);\n\n      _this = _super.call(this, props);\n\n      _this.dummyFn = function () {};\n\n      _this.removeSelf = function () {\n        _this.props.actions.removeRule(_this.props.path);\n      };\n\n      _this.setLock = function () {\n        var lock = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n        _this.props.actions.setLock(_this.props.path, lock);\n      };\n\n      _this.setField = function (field) {\n        _this.props.actions.setField(_this.props.path, field);\n      };\n\n      _this.setOperator = function (operator) {\n        _this.props.actions.setOperator(_this.props.path, operator);\n      };\n\n      _this.setOperatorOption = function (name, value) {\n        _this.props.actions.setOperatorOption(_this.props.path, name, value);\n      };\n\n      _this.setValue = function (delta, value, type, asyncListValues, __isInternal) {\n        _this.props.actions.setValue(_this.props.path, delta, value, type, asyncListValues, __isInternal);\n      };\n\n      _this.setValueSrc = function (delta, srcKey) {\n        _this.props.actions.setValueSrc(_this.props.path, delta, srcKey);\n      };\n\n      _this.dummyFn.isDummyFn = true;\n      return _this;\n    }\n\n    _createClass(RuleContainer, [{\n      key: \"shouldComponentUpdate\",\n      value: function shouldComponentUpdate(nextProps, nextState) {\n        var prevProps = this.props;\n        var prevState = this.state;\n        var should = pureShouldComponentUpdate(this)(nextProps, nextState);\n\n        if (should) {\n          if (prevState == nextState && prevProps != nextProps) {\n            var draggingId = nextProps.dragging.id || prevProps.dragging.id;\n            var isDraggingMe = draggingId == nextProps.id;\n            var chs = [];\n\n            for (var k in nextProps) {\n              var changed = nextProps[k] != prevProps[k];\n\n              if (k == \"dragging\" && !isDraggingMe) {\n                changed = false; //dragging another item -> ignore\n              }\n\n              if (changed) {\n                chs.push(k);\n              }\n            }\n\n            if (!chs.length) should = false;\n          }\n        }\n\n        return should;\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var isDraggingMe = this.props.dragging.id == this.props.id;\n        var fieldConfig = getFieldConfig(this.props.config, this.props.field);\n        var showErrorMessage = this.props.config.settings.showErrorMessage;\n\n        var _isGroup = fieldConfig && fieldConfig.type == \"!struct\";\n\n        var isInDraggingTempo = !isDraggingMe && this.props.isDraggingTempo;\n        var valueError = this.props.valueError;\n        var oneValueError = valueError && valueError.toArray().filter(function (e) {\n          return !!e;\n        }).shift() || null;\n        var hasError = oneValueError != null && showErrorMessage;\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: classNames(\"group-or-rule-container\", \"rule-container\", hasError ? \"rule-with-error\" : null),\n          \"data-id\": this.props.id\n        }, [isDraggingMe ? /*#__PURE__*/React.createElement(Rule, {\n          key: \"dragging\",\n          id: this.props.id,\n          groupId: this.props.groupId,\n          isDraggingMe: true,\n          isDraggingTempo: true,\n          dragging: this.props.dragging,\n          setField: this.dummyFn,\n          setOperator: this.dummyFn,\n          setOperatorOption: this.dummyFn,\n          setLock: this.dummyFn,\n          removeSelf: this.dummyFn,\n          setValue: this.dummyFn,\n          setValueSrc: this.dummyFn,\n          selectedField: this.props.field || null,\n          parentField: this.props.parentField || null,\n          selectedOperator: this.props.operator || null,\n          value: this.props.value || null,\n          valueSrc: this.props.valueSrc || null,\n          valueError: this.props.valueError || null,\n          operatorOptions: this.props.operatorOptions,\n          config: this.props.config,\n          reordableNodesCnt: this.props.reordableNodesCnt,\n          totalRulesCnt: this.props.totalRulesCnt,\n          asyncListValues: this.props.asyncListValues,\n          isLocked: this.props.isLocked,\n          isTrueLocked: this.props.isTrueLocked,\n          parentReordableNodesCnt: this.props.parentReordableNodesCnt\n        }) : null, /*#__PURE__*/React.createElement(Rule, {\n          key: this.props.id,\n          id: this.props.id,\n          groupId: this.props.groupId,\n          isDraggingMe: isDraggingMe,\n          isDraggingTempo: isInDraggingTempo,\n          onDragStart: this.props.onDragStart,\n          setLock: isInDraggingTempo ? this.dummyFn : this.setLock,\n          removeSelf: isInDraggingTempo ? this.dummyFn : this.removeSelf,\n          setField: isInDraggingTempo ? this.dummyFn : this.setField,\n          setOperator: isInDraggingTempo ? this.dummyFn : this.setOperator,\n          setOperatorOption: isInDraggingTempo ? this.dummyFn : this.setOperatorOption,\n          setValue: isInDraggingTempo ? this.dummyFn : this.setValue,\n          setValueSrc: isInDraggingTempo ? this.dummyFn : this.setValueSrc,\n          selectedField: this.props.field || null,\n          parentField: this.props.parentField || null,\n          selectedOperator: this.props.operator || null,\n          value: this.props.value || null,\n          valueSrc: this.props.valueSrc || null,\n          valueError: this.props.valueError || null,\n          operatorOptions: this.props.operatorOptions,\n          config: this.props.config,\n          reordableNodesCnt: this.props.reordableNodesCnt,\n          totalRulesCnt: this.props.totalRulesCnt,\n          asyncListValues: this.props.asyncListValues,\n          isLocked: this.props.isLocked,\n          isTrueLocked: this.props.isTrueLocked,\n          parentReordableNodesCnt: this.props.parentReordableNodesCnt\n        })]);\n      }\n    }]);\n\n    return RuleContainer;\n  }(Component), _class.propTypes = {\n    id: PropTypes.string.isRequired,\n    groupId: PropTypes.string,\n    config: PropTypes.object.isRequired,\n    path: PropTypes.any.isRequired,\n    //instanceOf(Immutable.List)\n    operator: PropTypes.string,\n    field: PropTypes.string,\n    actions: PropTypes.object.isRequired,\n    //{removeRule: Funciton, setField, setOperator, setOperatorOption, setValue, setValueSrc, ...}\n    onDragStart: PropTypes.func,\n    value: PropTypes.any,\n    //depends on widget\n    valueSrc: PropTypes.any,\n    asyncListValues: PropTypes.array,\n    valueError: PropTypes.any,\n    operatorOptions: PropTypes.object,\n    reordableNodesCnt: PropTypes.number,\n    parentField: PropTypes.string,\n    //from RuleGroup\n    isLocked: PropTypes.bool,\n    isTrueLocked: PropTypes.bool,\n    //connected:\n    dragging: PropTypes.object,\n    //{id, x, y, w, h}\n    isDraggingTempo: PropTypes.bool\n  }, _class;\n};\n\nexport default (function (Rule) {\n  var ConnectedRuleContainer = connect(function (state) {\n    return {\n      dragging: state.dragging\n    };\n  }, null, null, {\n    context: context\n  })(createRuleContainer(Rule));\n  ConnectedRuleContainer.displayName = \"ConnectedRuleContainer\";\n  return ConnectedRuleContainer;\n});","map":{"version":3,"sources":["D:/LIMSWFH/LIMSPOSTGRESQL/QuaLISWeb/node_modules/@react-awesome-query-builder/ui/esm/components/containers/RuleContainer.js"],"names":["_classCallCheck","_createClass","_inherits","_possibleConstructorReturn","_getPrototypeOf","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","arguments","apply","sham","Proxy","Boolean","prototype","valueOf","call","e","React","Component","Utils","PropTypes","context","pureShouldComponentUpdate","connect","classNames","getFieldConfig","ConfigUtils","createRuleContainer","Rule","_class","_Component","RuleContainer","_super","props","_this","dummyFn","removeSelf","actions","removeRule","path","setLock","lock","length","undefined","setField","field","setOperator","operator","setOperatorOption","name","value","setValue","delta","type","asyncListValues","__isInternal","setValueSrc","srcKey","isDummyFn","key","shouldComponentUpdate","nextProps","nextState","prevProps","prevState","state","should","draggingId","dragging","id","isDraggingMe","chs","k","changed","push","render","fieldConfig","config","showErrorMessage","settings","_isGroup","isInDraggingTempo","isDraggingTempo","valueError","oneValueError","toArray","filter","shift","hasError","createElement","className","groupId","selectedField","parentField","selectedOperator","valueSrc","operatorOptions","reordableNodesCnt","totalRulesCnt","isLocked","isTrueLocked","parentReordableNodesCnt","onDragStart","propTypes","string","isRequired","object","any","func","array","number","bool","ConnectedRuleContainer","displayName"],"mappings":"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","sourcesContent":["import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport React, { Component } from \"react\";\nimport { Utils } from \"@react-awesome-query-builder/core\";\nimport PropTypes from \"prop-types\";\nimport context from \"../../stores/context\";\nimport { pureShouldComponentUpdate } from \"../../utils/reactUtils\";\nimport { connect } from \"react-redux\";\nimport classNames from \"classnames\";\nvar getFieldConfig = Utils.ConfigUtils.getFieldConfig;\nvar createRuleContainer = function createRuleContainer(Rule) {\n  var _class;\n  return _class = /*#__PURE__*/function (_Component) {\n    _inherits(RuleContainer, _Component);\n    var _super = _createSuper(RuleContainer);\n    function RuleContainer(props) {\n      var _this;\n      _classCallCheck(this, RuleContainer);\n      _this = _super.call(this, props);\n      _this.dummyFn = function () {};\n      _this.removeSelf = function () {\n        _this.props.actions.removeRule(_this.props.path);\n      };\n      _this.setLock = function () {\n        var lock = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n        _this.props.actions.setLock(_this.props.path, lock);\n      };\n      _this.setField = function (field) {\n        _this.props.actions.setField(_this.props.path, field);\n      };\n      _this.setOperator = function (operator) {\n        _this.props.actions.setOperator(_this.props.path, operator);\n      };\n      _this.setOperatorOption = function (name, value) {\n        _this.props.actions.setOperatorOption(_this.props.path, name, value);\n      };\n      _this.setValue = function (delta, value, type, asyncListValues, __isInternal) {\n        _this.props.actions.setValue(_this.props.path, delta, value, type, asyncListValues, __isInternal);\n      };\n      _this.setValueSrc = function (delta, srcKey) {\n        _this.props.actions.setValueSrc(_this.props.path, delta, srcKey);\n      };\n      _this.dummyFn.isDummyFn = true;\n      return _this;\n    }\n    _createClass(RuleContainer, [{\n      key: \"shouldComponentUpdate\",\n      value: function shouldComponentUpdate(nextProps, nextState) {\n        var prevProps = this.props;\n        var prevState = this.state;\n        var should = pureShouldComponentUpdate(this)(nextProps, nextState);\n        if (should) {\n          if (prevState == nextState && prevProps != nextProps) {\n            var draggingId = nextProps.dragging.id || prevProps.dragging.id;\n            var isDraggingMe = draggingId == nextProps.id;\n            var chs = [];\n            for (var k in nextProps) {\n              var changed = nextProps[k] != prevProps[k];\n              if (k == \"dragging\" && !isDraggingMe) {\n                changed = false; //dragging another item -> ignore\n              }\n\n              if (changed) {\n                chs.push(k);\n              }\n            }\n            if (!chs.length) should = false;\n          }\n        }\n        return should;\n      }\n    }, {\n      key: \"render\",\n      value: function render() {\n        var isDraggingMe = this.props.dragging.id == this.props.id;\n        var fieldConfig = getFieldConfig(this.props.config, this.props.field);\n        var showErrorMessage = this.props.config.settings.showErrorMessage;\n        var _isGroup = fieldConfig && fieldConfig.type == \"!struct\";\n        var isInDraggingTempo = !isDraggingMe && this.props.isDraggingTempo;\n        var valueError = this.props.valueError;\n        var oneValueError = valueError && valueError.toArray().filter(function (e) {\n          return !!e;\n        }).shift() || null;\n        var hasError = oneValueError != null && showErrorMessage;\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: classNames(\"group-or-rule-container\", \"rule-container\", hasError ? \"rule-with-error\" : null),\n          \"data-id\": this.props.id\n        }, [isDraggingMe ? /*#__PURE__*/React.createElement(Rule, {\n          key: \"dragging\",\n          id: this.props.id,\n          groupId: this.props.groupId,\n          isDraggingMe: true,\n          isDraggingTempo: true,\n          dragging: this.props.dragging,\n          setField: this.dummyFn,\n          setOperator: this.dummyFn,\n          setOperatorOption: this.dummyFn,\n          setLock: this.dummyFn,\n          removeSelf: this.dummyFn,\n          setValue: this.dummyFn,\n          setValueSrc: this.dummyFn,\n          selectedField: this.props.field || null,\n          parentField: this.props.parentField || null,\n          selectedOperator: this.props.operator || null,\n          value: this.props.value || null,\n          valueSrc: this.props.valueSrc || null,\n          valueError: this.props.valueError || null,\n          operatorOptions: this.props.operatorOptions,\n          config: this.props.config,\n          reordableNodesCnt: this.props.reordableNodesCnt,\n          totalRulesCnt: this.props.totalRulesCnt,\n          asyncListValues: this.props.asyncListValues,\n          isLocked: this.props.isLocked,\n          isTrueLocked: this.props.isTrueLocked,\n          parentReordableNodesCnt: this.props.parentReordableNodesCnt\n        }) : null, /*#__PURE__*/React.createElement(Rule, {\n          key: this.props.id,\n          id: this.props.id,\n          groupId: this.props.groupId,\n          isDraggingMe: isDraggingMe,\n          isDraggingTempo: isInDraggingTempo,\n          onDragStart: this.props.onDragStart,\n          setLock: isInDraggingTempo ? this.dummyFn : this.setLock,\n          removeSelf: isInDraggingTempo ? this.dummyFn : this.removeSelf,\n          setField: isInDraggingTempo ? this.dummyFn : this.setField,\n          setOperator: isInDraggingTempo ? this.dummyFn : this.setOperator,\n          setOperatorOption: isInDraggingTempo ? this.dummyFn : this.setOperatorOption,\n          setValue: isInDraggingTempo ? this.dummyFn : this.setValue,\n          setValueSrc: isInDraggingTempo ? this.dummyFn : this.setValueSrc,\n          selectedField: this.props.field || null,\n          parentField: this.props.parentField || null,\n          selectedOperator: this.props.operator || null,\n          value: this.props.value || null,\n          valueSrc: this.props.valueSrc || null,\n          valueError: this.props.valueError || null,\n          operatorOptions: this.props.operatorOptions,\n          config: this.props.config,\n          reordableNodesCnt: this.props.reordableNodesCnt,\n          totalRulesCnt: this.props.totalRulesCnt,\n          asyncListValues: this.props.asyncListValues,\n          isLocked: this.props.isLocked,\n          isTrueLocked: this.props.isTrueLocked,\n          parentReordableNodesCnt: this.props.parentReordableNodesCnt\n        })]);\n      }\n    }]);\n    return RuleContainer;\n  }(Component), _class.propTypes = {\n    id: PropTypes.string.isRequired,\n    groupId: PropTypes.string,\n    config: PropTypes.object.isRequired,\n    path: PropTypes.any.isRequired,\n    //instanceOf(Immutable.List)\n    operator: PropTypes.string,\n    field: PropTypes.string,\n    actions: PropTypes.object.isRequired,\n    //{removeRule: Funciton, setField, setOperator, setOperatorOption, setValue, setValueSrc, ...}\n    onDragStart: PropTypes.func,\n    value: PropTypes.any,\n    //depends on widget\n    valueSrc: PropTypes.any,\n    asyncListValues: PropTypes.array,\n    valueError: PropTypes.any,\n    operatorOptions: PropTypes.object,\n    reordableNodesCnt: PropTypes.number,\n    parentField: PropTypes.string,\n    //from RuleGroup\n    isLocked: PropTypes.bool,\n    isTrueLocked: PropTypes.bool,\n    //connected:\n    dragging: PropTypes.object,\n    //{id, x, y, w, h}\n    isDraggingTempo: PropTypes.bool\n  }, _class;\n};\nexport default (function (Rule) {\n  var ConnectedRuleContainer = connect(function (state) {\n    return {\n      dragging: state.dragging\n    };\n  }, null, null, {\n    context: context\n  })(createRuleContainer(Rule));\n  ConnectedRuleContainer.displayName = \"ConnectedRuleContainer\";\n  return ConnectedRuleContainer;\n});"]},"metadata":{},"sourceType":"module"}